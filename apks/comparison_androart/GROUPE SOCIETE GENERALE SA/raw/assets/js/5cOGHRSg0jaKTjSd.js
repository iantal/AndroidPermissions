Class.ns("Functions.transferfunds.domestictransfer");$().loadJavaScript("/js/PYLTm9QmANZReQE2.js");$().loadJavaScript("/js/1hyf9OWY93mTBudZ.js");Functions.transferfunds.domestictransfer.PartnerDelete=Class.extend(Bankingapp.framework.View,{container:null,partnerItemIdField:"partnerId",partnerList:null,listData:[],emptyListResourceKey:"bankingapp_function_domestictransfer_no_partners",formDataFunctionAttributeId:Functions.transferfunds.TransferUtils.DOMESTICTRANSFER_FORMDATA,layoutRender:function(){this.container=$("<div>",{id:"partnerSelectionMainContainer","class":"list maincontainer"});return this.container;},run:function(){this.listData=getFunctionAttribute(Functions.transferfunds.TransferUtils.TRANSFERFUNDS_PARTNERLIST);this.refreshPartnerList();},refreshPartnerList:function(){console.log("refreshPartnerList inputList",this.listData);$("#partnerSelectionContainer").remove();this.partnerSelectionContainer=$("<div>",{id:"partnerSelectionContainer","class":"list maincontainer"});this.partnerList=new Bankingapp.ui.List({baseClass:"list",idProperty:this.partnerItemIdField,listData:this.listData,itemRenderer:Functions.transferfunds.domestictransfer.PartnerDeleteListItem,noresultKey:this.emptyListResourceKey,itemConfig:{nameField:"partnerName",bankField:"partnerBank",accountNumberField:"targetAccount",currencyField:"targetAccountCurrency",baseClass:"accountListItem"}});this.partnerList.bind("itemClick",$.proxy(this.itemClickHandler,this));this.partnerSelectionContainer.append(this.partnerList);this.container.append(this.partnerSelectionContainer);},itemClickHandler:function(b,a){var c=this.partnerList.getItem(a[this.partnerItemIdField]);if(c){$.each(this.partnerList.itemsMap,function(d,e){e.removeClass("state_selected");});c.removeClass("state_default");c.addClass("state_selected");}Bankingapp.framework.Application.showConfirmation(resolve("bankingapp_function_domestictransfer_confirm_delete_partner"),false,$.proxy(this.handleConfirmation,this,a));},handleConfirmation:function(d,a,c){if(a.valueOf()){var b=this.listData.indexOf(d);this.listData.splice(b,1);Bankingapp.framework.Application.callService("/domestictransfer/deletePaymentTemplate",{DomesticTransferRequest:{templateId:d.partnerId}},$.proxy(this.handleDeleteReply,this));console.log("delete partner: "+d);}else{goToPreviousView();}},handleDeleteReply:function(){setFunctionAttribute(Functions.transferfunds.TransferUtils.TRANSFERFUNDS_PARTNERLIST,this.listData);loadView("view://brd/bankingapp/function/transferfunds/domestictransfer/partnerselection",null);}});Bankingapp.framework.Application.setView(Functions.transferfunds.domestictransfer.PartnerDelete);