Class.ns("Bankingapp.functions.fxrates");Bankingapp.functions.fxrates.FxCalculator=Class.extend(Bankingapp.framework.View,{firstCurrency:null,secondCurrency:null,selectedCurrency:null,currencyListContainer:null,currencyList:null,layoutRender:function(){var e=getFunctionAttribute("SELECTED_CURRENCY");removeFunctionAttribute("SELECTED_CURRENCY");var b=getFunctionAttribute("LOCAL_CURRENCY");var d=getFunctionAttribute("LOCATION_CURRENCY");if(d==null||d==""||d==b){d=null;}var a=getFunctionAttribute("CURRENCY_LIST");var g=e!=null?e:d!=null?d:a[0].currency;var f=b;var c=0;while(c<a.length){if(this.firstCurrency==null&&a[c].currency==g){this.firstCurrency=a[c];if(this.secondCurrency!=null){break;}}if(this.secondCurrency==null&&a[c].currency==f){this.secondCurrency=a[c];if(this.firstCurrency!=null){break;}}c++;}this.refreshCurrency();var h=[this.firstCurrency,this.secondCurrency];this.currencyListContainer=$("<div>").attr("id","currencyListMainContainer");this.currencyList=new Bankingapp.ui.List({listData:h,itemRenderer:Bankingapp.ui.CurrencyListItem});this.currencyListContainer.append(this.currencyList);this.currencyList.bind("itemClick",$.proxy(this.itemClickHandler,this));return this.currencyListContainer;},run:function(){},refreshCurrency:function(){var a=getFunctionAttribute("SELECTED_CURRENCY_FROM_LIST");var e=null;var b=getFunctionAttribute("CURRENCY_LIST");var d=0;while(d<b.length){if(b[d].currency==a){e=b[d];break;}d++;}if(e!=null){var c=getFunctionAttribute("OTHER_CURRENCY");this.firstCurrency=getFunctionAttribute("FIRST_CURRENCY");this.secondCurrency=getFunctionAttribute("SECOND_CURRENCY");if(c==this.firstCurrency.currency){this.secondCurrency=e;}else{this.firstCurrency=e;}removeFunctionAttribute("SELECTED_CURRENCY_FROM_LIST");removeFunctionAttribute("OTHER_CURRENCY");removeFunctionAttribute("FIRST_CURRENCY");removeFunctionAttribute("SECOND_CURRENCY");}else{this.firstCurrency=getFunctionAttribute("FIRST_CURRENCY")!=null?getFunctionAttribute("FIRST_CURRENCY"):this.firstCurrency;this.secondCurrency=getFunctionAttribute("SECOND_CURRENCY")!=null?getFunctionAttribute("SECOND_CURRENCY"):this.secondCurrency;removeFunctionAttribute("FIRST_CURRENCY");removeFunctionAttribute("SECOND_CURRENCY");}},itemClickHandler:function(b,a){setFunctionAttribute("OTHER_CURRENCY",a.currency==this.firstCurrency.currency?this.secondCurrency.currency:this.firstCurrency.currency);setFunctionAttribute("FIRST_CURRENCY",this.firstCurrency);setFunctionAttribute("SECOND_CURRENCY",this.secondCurrency);loadView("view://brd/bankingapp/function/fxrates/currencyselector",null);}});Bankingapp.framework.Application.setView(Bankingapp.functions.fxrates.FxCalculator);