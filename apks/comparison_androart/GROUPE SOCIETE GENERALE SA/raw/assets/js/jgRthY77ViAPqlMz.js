Class.ns("Bankingapp.functions.login");Bankingapp.functions.login.PasswordChange=Class.extend(Bankingapp.framework.View,{container:null,button:null,form:null,credentials:null,newPassword:null,newPasswordAgain:null,plsselectLabel:null,nextView:null,layoutRender:function(){this.nextView=getFunctionAttribute("nextView");this.container=$("<div>",{id:"passwordchangeMainContainer","class":"passwordchange maincontainer"});this.form=new Bankingapp.ui.Form({id:"passwordchangeform",submitHandler:$.proxy(this.submitHandler,this)});this.container.append(this.form);$.Validation.addRules({requireequals:{check:$.proxy(this.validatePasswords,this),msg:function(b,a){return resolve("bankingapp_error_passwordequals",{"0":resolve("bankingapp_function_passwordchange_newpassword1"),"1":resolve("bankingapp_function_passwordchange_newpassword2")});}}});this.credentials=new Bankingapp.ui.InputField(resolve("bankingapp_function_passwordchange_oldpassword"),{id:"oldpassword",tabindex:"1",name:"oldPassword",type:"password",validation:{required:true,whitelist:false}},{"for":null});this.newPassword=new Bankingapp.ui.InputField(resolve("bankingapp_function_passwordchange_newpassword1"),{id:"newpassword1",tabindex:"2",name:"newPassword1",type:"password",validation:{required:true,whitelist:false}},{"for":null});this.newPasswordAgain=new Bankingapp.ui.InputField(resolve("bankingapp_function_passwordchange_newpassword2"),{id:"newpassword2",tabindex:"3",name:"newPassword2",type:"password",validation:{required:true,whitelist:false,requireequals:true}},{"for":null});this.plsselectLabel=new Bankingapp.ui.Label(resolve("bankingapp_function_passwordchange_plsselecttext"));this.form.append(this.credentials);this.form.append(this.plsselectLabel);this.form.append(this.newPassword);this.form.append(this.newPasswordAgain);this.button=new Bankingapp.ui.SubmitButton(resolve("bankingapp_function_passwordchange_passwordchange"),{tabindex:"4"});this.form.append(this.button);return this.container;},validatePasswords:function(){return this.newPassword.val()==this.newPasswordAgain.val();},run:function(){},submitHandler:function(){var a=getSessionAttribute("CURRENT_CUSTOMER");var b=a==null?getFunctionAttribute("loginId"):a.loginId;callService({serviceName:"/security/pegasus_security_check",request:{PasswordChangeUserInput:{"@xsi:type":"pegasus.component.password.security.bean.PasswordChangeUserInput",LoginID:b,Credentials:this.credentials.val(),NewPassword:this.newPassword.val(),NewPasswordAgain:this.newPasswordAgain.val()}},callback:Bankingapp.framework.Application.proxy(this.changeHandler,this,true)});this.credentials.setValue("");this.newPassword.setValue("");this.newPasswordAgain.setValue("");},changeHandler:function(a){if(nextView){loadView(nextView);}}});Bankingapp.framework.Application.setView(Bankingapp.functions.login.PasswordChange);