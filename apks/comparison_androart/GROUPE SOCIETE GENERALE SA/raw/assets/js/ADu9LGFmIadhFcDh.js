Class.ns("Bankingapp.functions.receivemoney.splitthebill");$().loadJavaScript("/js/1hyf9OWY93mTBudZ.js");$().loadJavaScript("/js/CF0WiFs1SjIy0Szl.js");Bankingapp.functions.receivemoney.splitthebill.Result=Class.extend(Bankingapp.framework.View,{container:null,homeButton:null,ct:null,dateFormatPattern:resolve("bankingapp_common_dateFormatPattern_per"),layoutRender:function(){this.container=$("<div>");this.ct=$("<div>",{"class":"formcontainer result"});this.container.append(this.ct);return this.container;},run:function(){var h=getFunctionAttribute("splitPartners");Bankingapp.framework.event.BrdServiceMessageHandler.handleMessages();var g=getFunctionAttribute(Functions.transferfunds.TransferUtils.SPLITBILL_SIGN_REPLY);this.formData=getFunctionAttribute(Functions.transferfunds.TransferUtils.SPLITBILL_FORMDATA);var b=getFunctionAttribute("SPLITBILL_FORMDATA_VALUEDATE")?$().dateParserWithTimezone(getFunctionAttribute("SPLITBILL_FORMDATA_VALUEDATE")):new Date();var c=b.dateFormat(this.dateFormatPattern);var j="";j=resolve("bankingapp_brd_function_splitbill_result_details");var d="";if(h.length==1){d="bankingapp_brd_function_splitbill_result_success_one";}else{d="bankingapp_brd_function_splitbill_result_success";}this.transactionId=g.transactionId;var a={status:"successful",message:resolve(d,{partner:h.length}),title:[resolve("bankingapp_brd_function_splitbill_result_bankname"),j],timestamp:g.created,id:g.transactionId,details:[{label:resolve("bankingapp_brd_function_splitbill_result_total_amount"),value:new Bankingapp.functions.util.component.Amount({currency:this.formData.transactionItem.currency,amount:this.formData.transactionItem.amount,decorate:false})},{label:resolve("bankingapp_brd_function_splitbill_result_split_amount"),value:new Bankingapp.functions.util.component.Amount({currency:this.formData.transactionItem.currency,amount:this.formData.transactionItem.amount-getFunctionAttribute("remainingAmount"),decorate:false})},{label:resolve("bankingapp_brd_function_splitbill_result_dest_account"),value:this.formData.transactionItem.customerAccountName}]};debugLog(JSON.stringify(h));for(var e=0;e<h.length;++e){a.details.push({label:resolve("bankingapp_brd_function_splitbill_result_partner",{number:(e+1)}),value:h[e].partnerName});}a.details.push({label:resolve("bankingapp_brd_function_requestmoney_partnerselect_description_field"),value:getFunctionAttribute("SPLITBILL_FORMDATA_DESCRIPTION")});a.details.push({label:resolve("bankingapp_function_transferfunds_valuedate"),value:c});this.ct.append(new Bankingapp.ui.DetailsResultComponent({detailsData:a,displayDateFormatKey:"bankingapp_brd_function_transfer_result_createTimeFormat"}));this.downloadProofOfPaymentButton=new Bankingapp.ui.ComplexButton(resolve("bankingapp_brd_function_transactionhistory_downloadpdf"),{id:"downloadButton","class":"downloadButton"});this.downloadProofOfPaymentButton.bind("buttonClick",$.proxy(this.downloadPdfClickHandler,this));var f=new Bankingapp.ui.ComplexButton(resolve("bankingapp_brd_function_splitbill_back_to_payments"),{});this.ct.append(f);f.bind("buttonClick",$.proxy(this.backToPaymentsHandler,this));Bankingapp.framework.event.ButtonHandler.setButtonHandler("BACK",$.proxy(this.backBtnHandler,this));this.clearFunctionScope();},clearFunctionScope:function(){var a=getFunctionAttributeNames();if(a){for(var b=0;b<a.length;b++){removeFunctionAttribute(a[b]);}}},backToPaymentsHandler:function(){this.goToPaymentsLandingPage();},backBtnHandler:function(a){this.goToPaymentsLandingPage();},goToPaymentsLandingPage:function(){setFunctionAttribute("SplitBillNavigateFrom","resultpage");goToPreviousView("view://brd/bankingapp/function/receivemoney/splitthebill/history");},downloadPdfClickHandler:function(a,b){debugLog("downloadPdfClickHandler ...");if(this.transactionId){Functions.transferfunds.TransferUtils.getDocumentDownloadKey(this.transactionId);}else{debugLog("The authentication reply is not available");showError(resolve("bankingapp_brd_function_payments_download_proofofpayments_failure"));}}});Bankingapp.framework.Application.setView(Bankingapp.functions.receivemoney.splitthebill.Result);