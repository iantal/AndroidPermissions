Class.ns("Bankingapp.functions.deposits.create");$().loadJavaScript("/js/1hyf9OWY93mTBudZ.js");$().loadJavaScript("/js/2OhhKyfVap4GJnSp.js");$().loadJavaScript("/js/icz25N39YleqstwB.js");$().loadJavaScript("/js/AZPz8vN1TNFqZWpw.js");Bankingapp.functions.deposits.create.Confirm=Class.extend(Bankingapp.framework.View,{container:null,formDataFunctionAttributeId:"DEPOSITCREATE_FORMDATA",depositDataFunctionAttributeId:"DEPOSITTYPE_DATA",forecastDataFunctionAttributeId:"DEPOSITCREATE_FORECASTDATA",performDataFunctionAttributeId:"DEPOSITCREATE_PERFORMREPLY",progressIndicatorStepCount:8,progressIndicatorCurrentStep:7,layoutRender:function(){this.depositData=getFunctionAttribute(this.depositDataFunctionAttributeId);this.formData=getFunctionAttribute(this.formDataFunctionAttributeId);this.container=$("<div>",{id:"depositCreateConfirmMainContainer","class":"maincontainer"});this.container.append(new Bankingapp.ui.ProgressIndicator(this.progressIndicatorStepCount,this.progressIndicatorCurrentStep));this.containerDetails=$("<div>",{id:"depositCreateConfirmDetailsContainer","class":""});return this.container;},errorMessageHandler:function(b,a){Bankingapp.framework.event.ServiceMessageHandler.errorMessageHandler(b,a);this.signBlock.remove();this.signBlock=new Bankingapp.ui.ManualSignBlock({signMode:Functions.transferfunds.TransferUtils.SIGNMODE});this.signBlock.bind("formSubmitted",$.proxy(this.depositCreateSignHandler,this));this.container.append(this.signBlock);},run:function(){Bankingapp.framework.Application.unBind("onErrorMessageReceived");$("body").bind("onErrorMessageReceived",$.proxy(this.errorMessageHandler,this));Bankingapp.framework.event.BrdServiceMessageHandler.handleMessages();var a=getFunctionAttribute("FORECAST_DATA");this.forecastData={depositPeriodStartDate:a.forecastReply.depositData.periodStartDate,depositPeriodEndDate:a.forecastReply.depositData.periodEndDate,depositDueDate:a.forecastReply.depositData.dueDate};setFunctionAttribute(this.forecastDataFunctionAttributeId,this.forecastData);this.depositDetail=new Bankingapp.ui.DetailsDepositCreateComponent({depositData:this.depositData,formData:this.formData,forecastData:this.forecastData});this.containerDetails.append(this.depositDetail);this.container.append(this.containerDetails);this.signBlock=new Bankingapp.ui.ManualSignBlock({signMode:Functions.transferfunds.TransferUtils.SIGNMODE});this.signBlock.bind("formSubmitted",$.proxy(this.depositCreateSignHandler,this));this.container.append(this.signBlock);},depositCreateSignHandler:function(a,b){Bankingapp.framework.Application.callService("/depositcreate/perform",{PerformTransactionOperationRequest:{credential:this.signBlock.getCredential(),book:true,sign:true,fingerPrint:this.signBlock.getIsFingerprint()}},$.proxy(this.handleSignResult,this));},handleSignResult:function(a){setFunctionAttribute("PERFORM_RESULT",a);loadView("view://brd/bankingapp/function/deposits/create/Result",null);}});Bankingapp.framework.Application.setView(Bankingapp.functions.deposits.create.Confirm);