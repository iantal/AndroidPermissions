Class.ns("Bankingapp.functions.deposits.terminate");$().loadJavaScript("/js/1hyf9OWY93mTBudZ.js");$().loadJavaScript("/js/icz25N39YleqstwB.js");$().loadJavaScript("/js/CF0WiFs1SjIy0Szl.js");Bankingapp.functions.deposits.terminate.Result=Class.extend(Bankingapp.framework.View,{container:null,dateFormatPatternResourceKey:"bankingapp_common_dateFormatPattern",timeFormatPatternResourceKey:"bankingapp_common_timeFormatPattern",performDataFunctionAttributeId:"DEPOSITTERMINATE_PERFORMREPLY",separator:" - ",layoutRender:function(){this.container=$("<div>",{id:"depositTerminateResultMainContainer","class":"maincontainer"});this.containerDetails=$("<div>",{id:"depositTerminateConfirmDetailsContainer","class":""});return this.container;},run:function(){Bankingapp.framework.event.BrdServiceMessageHandler.handleMessages();this.deposit=getFunctionAttribute("deposit");this.performData=getFunctionAttribute("PERFORM_RESULT");this.transactionId=this.performData.transactionId;var h=$().dateParserWithoutTime(this.deposit.depositDueDate);var d=new Array();if(this.deposit.depositPeriodStartDate){var l=$().dateParserWithoutTime(this.deposit.depositPeriodStartDate);d.push(l.dateFormat(resolve(this.dateFormatPatternResourceKey)));}if(this.deposit.depositPeriodEndDate){var n=$().dateParserWithoutTime(this.deposit.depositPeriodEndDate);d.push(n.dateFormat(resolve(this.dateFormatPatternResourceKey)));}var b=d.join(this.separator);var m=this.deposit.accountNumber;var f=resolve(this.deposit.depositRevolving==="true"?"bankingapp_brd_function_deposits_details_revolving_true":"bankingapp_brd_function_deposits_details_revolving_false");var j=resolve(this.deposit.depositCapOfInterest==="true"?"bankingapp_brd_function_deposits_details_capofinterest_true":"bankingapp_brd_function_deposits_details_capofinterest_false");var e=new Date();var k=$().dateParserWithoutTimezone(this.performData.created);var g="";if(getFunctionAttribute("SOURCE_ACCOUNT_FOR_DEPOSIT_TERMINATION")){var a=getFunctionAttribute("SOURCE_ACCOUNT_FOR_DEPOSIT_TERMINATION");g=a.accountName?(a.accountName+" - "+a.currency):(a.accountNumber+" - "+a.currency);}else{g=(this.deposit.depositSourceAccountName?this.deposit.depositSourceAccountName:this.deposit.depositSourceAccount)+(this.deposit.currency?(" - "+this.deposit.currency):+"");}var c={status:"successful",message:resolve("bankingapp_brd_function_deposits_terminate_result_success"),title:[this.deposit.accountName,this.deposit.depositCodeName+" ("+this.deposit.currency+")"],timestamp:k,displayDateFormatKey:"bankingapp_common_timeFormatPattern",id:resolve("bankingapp_brd_function_deposits_terminate_result_no")+this.performData.transactionId,details:[{label:resolve("bankingapp_brd_function_deposits_terminate_result_interestrate"),value:$().interestFormatter(this.deposit.depositInterestRate)},{label:resolve("bankingapp_brd_function_deposits_terminate_result_interesttype"),value:resolve("bankingapp_brd_function_deposits_details_interesttype_"+(this.deposit.depositInterestType=="false"?"Y":"N"))},{label:resolve("bankingapp_brd_function_deposits_terminate_result_depositaccount"),value:m},{label:resolve("bankingapp_brd_function_deposits_terminate_result_amount"),value:new Bankingapp.functions.util.component.Amount({currency:this.deposit.currency,amount:this.deposit.bookedBalance,decorate:false})},{label:resolve("bankingapp_brd_function_deposits_terminate_result_balancedate"),value:e.dateFormat(resolve(this.timeFormatPatternResourceKey))},{label:resolve("bankingapp_brd_function_deposits_terminate_result_maturity"),value:$().defaultMaturityFormatter(this.deposit.depositMaturityCount)},{label:resolve("bankingapp_brd_function_deposits_terminate_result_sourceaccount"),value:g},{label:resolve("bankingapp_brd_function_deposits_terminate_result_duedate"),value:h.dateFormat(resolve(this.dateFormatPatternResourceKey))},{label:resolve("bankingapp_brd_function_deposits_terminate_result_currentperiod"),value:b},{label:resolve("bankingapp_brd_function_deposits_terminate_result_revolving"),value:f},{label:resolve("bankingapp_brd_function_deposits_terminate_result_capofinterest"),value:j}]};this.container.append(new Bankingapp.ui.DetailsResultComponent({detailsData:c}));this.downloadProofOfPaymentButton=new Bankingapp.ui.ComplexButton(resolve("bankingapp_brd_function_transactionhistory_downloadpdf"),{id:"downloadButton","class":"downloadProofOfPaymentButton"});this.downloadProofOfPaymentButton.bind("buttonClick",$.proxy(this.downloadPdfClickHandler,this));this.container.append(this.downloadProofOfPaymentButton);var i=new Bankingapp.ui.ComplexButton(resolve("bankingapp_brd_function_deposits_backtohome"));i.bind("buttonClick",$.proxy(this.homeBtnHandler,this));Bankingapp.framework.event.ButtonHandler.setButtonHandler("BACK",$.proxy(this.backBtnHandler,this));this.container.append(i);},registerDetailsTypes:function(){Bankingapp.ui.DynamicDetailsFactory.register("result",Bankingapp.ui.DetailsResultComponent);},clearFunctionScope:function(){var a=getFunctionAttributeNames();if(a){for(var b=0;b<a.length;b++){removeFunctionAttribute(a[b]);}}else{removeFunctionAttribute("ACCOUNT_DETAILS");removeFunctionAttribute("deposit");removeFunctionAttribute("DEPOSIT_TERMINATE_SIGN_CREDENTIAL");removeFunctionAttribute("DEPOSIT_ACCOUNTS");removeFunctionAttribute("PENSION_FUNDS");}},backBtnHandler:function(a){this.goToDepositListView();},homeBtnHandler:function(){this.clearFunctionScope();this.goToDepositListView();},goToDepositListView:function(){goToPreviousView("view://brd/bankingapp/function/deposits/list/deposits");},downloadPdfClickHandler:function(a,b){debugLog("downloadPdfClickHandler ...");if(this.transactionId){Functions.transferfunds.TransferUtils.getDocumentDownloadKey(this.transactionId);}else{debugLog("The authentication reply is not available");showError(resolve("bankingapp_brd_function_payments_download_proofofpayments_failure"));}}});Bankingapp.framework.Application.setView(Bankingapp.functions.deposits.terminate.Result);