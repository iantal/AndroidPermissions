Class.ns("Bankingapp.functions.transactionhistory");$().loadJavaScript("/js/22vIF7pUrzu5x6EL.js");Bankingapp.functions.transactionhistory.TransactionHistoryFilter=Class.extend(Bankingapp.framework.View,{container:null,transactionHistoryFilter:{},displayDateFormat:resolve("bankingapp_common_dateFormatPattern"),filterDateFormat:resolve("bankingapp_common_parsedatepattern_withouttime"),layoutRender:function(){this.container=$("<div>",{id:"transactionHistoryFilterContainer","class":"list maincontainer"});this.transactionHistoryFilter=getFunctionAttribute("transactionHistoryFilter");console.log(this.transactionHistoryFilter);this.transactionHistoryFilterTitle=new Bankingapp.ui.Label(resolve("bankingapp_brd_function_transactionhistory_filter_title"),{"class":"pagetitle separator"});this.transactionHistoryFilterTextContainer=$("<div>",{"class":"groupcontainer"});this.transactionHistoryFilterText=new Bankingapp.ui.InputField(resolve("bankingapp_brd_function_transactionhistory_filter_text"),{id:"transactionHistoryFilterText",name:"transactionHistoryFilterText",type:"text",value:(this.transactionHistoryFilter.FreeText?this.transactionHistoryFilter.FreeText:""),validation:{required:false,number:false,maxlength:200,}});this.transactionHistoryFilterTextContainer.append(this.transactionHistoryFilterText);this.transactionHistoryFilterDateContainer=$("<div>",{"class":"groupcontainer"});var a=$().dateParserWithoutTimezone(this.transactionHistoryFilter.CreatedAfter).dateFormat(this.displayDateFormat);var b=$().dateParserWithoutTimezone(this.transactionHistoryFilter.CreatedBefore).dateFormat(this.displayDateFormat);this.transactionHistoryFilterCreatedAfterButton=new Bankingapp.ui.ComplexButton([a],{id:"CreatedAfter","class":"calendar"});this.transactionHistoryFilterCreatedBeforeButton=new Bankingapp.ui.ComplexButton([b],{id:"CreatedBefore","class":"calendar"});this.transactionHistoryFilterCreatedAfterButton.bind("buttonClick",$.proxy(this.transactionHistoryFilterAfterButtonClickHandler,this));this.transactionHistoryFilterCreatedBeforeButton.bind("buttonClick",$.proxy(this.transactionHistoryFilterBeforeButtonClickHandler,this));this.transactionHistoryFilterDateContainer.append(new Bankingapp.ui.LabeledComponent({labelText:resolve("bankingapp_brd_function_transactionhistory_filter_createdafter"),valueComponent:this.transactionHistoryFilterCreatedAfterButton}));this.transactionHistoryFilterDateContainer.append(new Bankingapp.ui.LabeledComponent({labelText:resolve("bankingapp_brd_function_transactionhistory_filter_createdbefore"),valueComponent:this.transactionHistoryFilterCreatedBeforeButton}));this.initialFilterTypes=getFunctionAttribute("transactionHistoryFilterTypes");this.transactionHistoryFilterTransactionType=new Bankingapp.ui.TransactionHistoryFilterTransactionType({currentFilterTypes:this.transactionHistoryFilter.Type,initialFilterType:this.initialFilterTypes});if(this.isCurrentUserOptionAvailable()){this.transactionHistoryFilterCurrentUserContainer=$("<div>",{"class":"groupcontainer"});this.transactionHistoryFilterCurrentUserCheckboxElement=new Bankingapp.ui.Checkbox({id:"OnlyCurrentUser",value:this.transactionHistoryFilter.OnlyCurrentUser});this.transactionHistoryFilterCurrentUserCheckbox=new Bankingapp.ui.LabeledComponent({labelConfig:{value:resolve("bankingapp_brd_function_transactionhistory_filter_currentuser")},valueComponent:this.transactionHistoryFilterCurrentUserCheckboxElement});this.transactionHistoryFilterCurrentUserContainer.append(this.transactionHistoryFilterCurrentUserCheckbox);}this.transactionHistoryFilterSetFilterButton=new Bankingapp.ui.SubmitButton(resolve("bankingapp_brd_function_transactionhistory_filter_setfilterbutton"),{id:"setFilterButton","class":"setFilterButton"});this.transactionHistoryFilterSetDefaultFilterButton=new Bankingapp.ui.SubmitButton(resolve("bankingapp_brd_function_transactionhistory_filter_setdefaultfilterbutton"),{id:"setDefaultFilterButton","class":"setDefaultFilterButton"});this.transactionHistoryFilterSetFilterButton.bind("buttonClick",$.proxy(this.setFilterHandler,this));this.transactionHistoryFilterSetDefaultFilterButton.bind("buttonClick",$.proxy(this.setDefaultFilterHandler,this));this.form=new Bankingapp.ui.Form({id:"transactionHistoryFilterForm",submitHandler:$.proxy(this.setFilterHandler,this),"class":this.formClass});this.form.append(this.transactionHistoryFilterTextContainer);this.form.append(this.transactionHistoryFilterDateContainer);this.form.append(this.transactionHistoryFilterTransactionType);this.form.append(this.transactionHistoryFilterCurrentUserContainer);this.container.append(this.transactionHistoryFilterTitle);this.container.append(this.form);this.container.append(this.transactionHistoryFilterSetFilterButton);this.container.append(this.transactionHistoryFilterSetDefaultFilterButton);return this.container;},isCurrentUserOptionAvailable:function(){return getFunctionAttribute("customerGroup")!="1";},run:function(){},setFilterHandler:function(f,g){if(this.transactionHistoryFilterText.val()!=""&&this.transactionHistoryFilterText.val()!=resolve("bankingapp_component_inputfield_optionaltext")){this.transactionHistoryFilter.FreeText=this.transactionHistoryFilterText.val();}else{this.transactionHistoryFilter.FreeText="";}var c=[];for(var a=0;a<this.transactionHistoryFilterTransactionType.checkboxes.length;a++){var b=this.transactionHistoryFilterTransactionType.checkboxes[a];if(b.val()==true){c.push(b[0].id);}}if(c.length>0){this.transactionHistoryFilter.Type=c;}else{delete this.transactionHistoryFilter.Type;}if(this.isCurrentUserOptionAvailable()){this.transactionHistoryFilter.OnlyCurrentUser=this.transactionHistoryFilterCurrentUserCheckboxElement.val();}else{this.transactionHistoryFilter.OnlyCurrentUser=true;}this.transactionHistoryFilter.FullSearch=true;setFunctionAttribute("transactionHistoryFilterMode","new");setFunctionAttribute("transactionHistoryFilter",this.transactionHistoryFilter);loadView("view://brd/bankingapp/function/transactionhistory/list/transactionhistorylist",null);},setDefaultFilterHandler:function(b,f){this.transactionHistoryFilterText.setValue();this.transactionHistoryFilterTransactionType.resetCheckBoxes();this.transactionHistoryFilterCurrentUserCheckboxElement.setValue(true);this.transactionHistoryFilterCurrentUserCheckboxElement.updateClass();var a=$().dateParserWithoutTime(getFunctionAttribute("defaultCreatedAfter"));this.transactionHistoryFilter.CreatedAfter=a.dateFormat(this.filterDateFormat);$("#CreatedAfter").find(".row0").text(a.dateFormat(this.displayDateFormat));var c=$().dateParserWithoutTime(getFunctionAttribute("defaultCreatedBefore"));this.transactionHistoryFilter.CreatedBefore=c.dateFormat(this.filterDateFormat);$("#CreatedBefore").find(".row0").text(c.dateFormat(this.displayDateFormat));},transactionHistoryFilterAfterButtonClickHandler:function(b,a){showDatePicker(Bankingapp.framework.Application.proxy(this.afterDatePickerHandler,this,true));},transactionHistoryFilterBeforeButtonClickHandler:function(b,a){showDatePicker(Bankingapp.framework.Application.proxy(this.beforeDatePickerHandler,this,true));},afterDatePickerHandler:function(a){this.transactionHistoryFilter.CreatedAfter=a.dateFormat(this.filterDateFormat);$("#CreatedAfter").find(".row0").text(a.dateFormat(this.displayDateFormat));},beforeDatePickerHandler:function(a){this.transactionHistoryFilter.CreatedBefore=a.dateFormat(this.filterDateFormat);$("#CreatedBefore").find(".row0").text(a.dateFormat(this.displayDateFormat));},displayAfterDate:function(a){}});Bankingapp.framework.Application.setView(Bankingapp.functions.transactionhistory.TransactionHistoryFilter);