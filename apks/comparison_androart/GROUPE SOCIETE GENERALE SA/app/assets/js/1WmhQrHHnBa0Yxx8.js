$().loadJavaScript("/js/hTeAcWCQwO3qAj8z.js");$().loadJavaScript("/js/CF0WiFs1SjIy0Szl.js");Class.ns("Bankingapp.functions.loancalculator");Bankingapp.functions.loancalculator.LoanOffer=Class.extend(Bankingapp.framework.View,{nextView:"view://brd/bankingapp/function/loancalculator/loansend",currentProgressStep:2,ProgressSteps:4,loanId:null,period:null,amount:null,currency:null,loanType:null,loanProduct:null,DAE:null,FNGCFee:null,fee:null,adminFee:null,interest:null,interestType:null,mounthRep:null,totalRep:null,container:null,loanInfoPanel:null,label:null,form:null,inputFielContainer:null,DAEField:null,intarestField:null,feeField:null,adminFeeField:null,FNGCField:null,totalRepField:null,mounthRepField:null,submitButton:null,layoutRender:function(){this.container=$("<div>",{id:"container","class":"login maincontainer disclaimer"});this.container.append(new Bankingapp.ui.ProgressIndicator(this.ProgressSteps,this.currentProgressStep));return this.container;},run:function(){this.loanId=getFunctionAttribute("loanId");this.period=parseFloat(getFunctionAttribute("period"));this.amount=parseInt(getFunctionAttribute("amount"));this.currency=getFunctionAttribute("currency");this.loanType=getFunctionAttribute("loanType");this.loanProduct=getFunctionAttribute("loanProduct");var a={LoanId:this.loanId,Period:this.period,Amount:this.amount};console.debug(a.LoanId);Bankingapp.framework.Application.callService("/loanCalculator/calculateOffer",{CalculateOfferRequest:a},$.proxy(this.onCalculateOffer,this));},onCalculateOffer:function(a){console.debug(a);this.DAE=a.dAE;this.FNGCFee=a.fNGCFee;this.fee=a.fee;this.adminFee=a.adminFee;this.interest=a.interest;this.interestType=a.intarestType;this.mounthRep=a.mounthRep;this.totalRep=a.totalRep;this.loanInfoPanel=new Bankingapp.functions.loancalculator.component.LoanAccount({loanType:this.loanType,loanProduct:this.loanProduct,amount:this.amount,period:this.period,accountCurrency:this.currency,});this.offerLabelContainer=$("<div>",{id:"offerLabelContainer","class":"info"});this.label=new Bankingapp.ui.Label(resolve("bankingapp_brd_function_loancalculator_offer_label"),{"class":"detailstitle"});this.offerLabelContainer.append(this.label);this.form=new Bankingapp.ui.Form({submitHandler:$.proxy(this.submitHandler,this)});this.inputFielContainer=$("<div>",{id:"inputFielContainerProduct","class":"groupContainer"});this.DAEField=new Bankingapp.ui.OutputField(resolve("bankingapp_brd_function_loancalculator_offer_dae"),(new Bankingapp.functions.util.component.Amount({amount:this.DAE,decorate:true})).value+"%");this.intarestField=new Bankingapp.ui.OutputField(resolve("bankingapp_brd_function_loancalculator_offer_intarestrate"),(new Bankingapp.functions.util.component.Amount({amount:this.interest,decimals:this.getFractionsLength(this.interest),decorate:true})).value+"%, "+this.interestType);this.feeField=new Bankingapp.ui.OutputField(resolve("bankingapp_brd_function_loancalculator_offer_filefee"),(new Bankingapp.functions.util.component.Amount({currency:this.currency,amount:this.fee,decorate:true})).value);this.adminFeeField=new Bankingapp.ui.OutputField(resolve("bankingapp_brd_function_loancalculator_offer_adminfee"),(new Bankingapp.functions.util.component.Amount({amount:this.adminFee,decorate:true})).value+"%");this.FNGCField=new Bankingapp.ui.OutputField(resolve("bankingapp_brd_function_loancalculator_offer_fngcfee"),(new Bankingapp.functions.util.component.Amount({amount:this.FNGCFee,decorate:true})).value+"%");this.totalRepField=new Bankingapp.ui.OutputField(resolve("bankingapp_brd_function_loancalculator_offer_totalrep"),(new Bankingapp.functions.util.component.Amount({currency:this.currency,amount:this.totalRep,decorate:true})).value);this.mounthRepField=new Bankingapp.ui.OutputField(resolve("bankingapp_brd_function_loancalculator_offer_monthlyrep"),(new Bankingapp.functions.util.component.Amount({currency:this.currency,amount:this.mounthRep,decorate:true})).value);this.submitButton=new Bankingapp.ui.SubmitButton(resolve("bankingapp_brd_function_loancalculator_offer_contactbutton"),{style:"font-size:80%"});this.DAEField.disable();this.intarestField.disable();this.feeField.disable();this.adminFeeField.disable();this.FNGCField.disable();this.totalRepField.disable();this.mounthRepField.disable();this.inputFielContainer.append(this.DAEField);this.inputFielContainer.append(this.intarestField);if(this.fee!=0){this.inputFielContainer.append(this.feeField);}if(this.adminFee!=0){this.inputFielContainer.append(this.adminFeeField);}if(this.FNGCFee!=0){this.inputFielContainer.append(this.FNGCField);}this.inputFielContainer.append(this.totalRepField);this.inputFielContainer.append(this.mounthRepField);this.form.append(this.inputFielContainer);this.form.append(this.submitButton);this.container.append(this.loanInfoPanel);this.container.append(this.offerLabelContainer);this.container.append(this.form);},submitHandler:function(){console.debug("submit");var a={loanId:this.loanId,period:this.period,amount:this.amount,currency:this.currency,loanType:this.loanType,loanProduct:this.loanProduct,DAE:this.DAE,FNGCFee:this.FNGCFee,fee:this.fee,adminFee:this.adminFee,interest:this.interest,interestType:this.interestType,mounthRep:this.mounthRep,totalRep:this.totalRep,};setFunctionAttribute("loanId",this.loanId);setFunctionAttribute("loanType",this.loanType);setFunctionAttribute("loanProduct",this.loanProduct);setFunctionAttribute("currency",this.currency);setFunctionAttribute("amount",this.amount);setFunctionAttribute("period",this.period);setFunctionAttribute("DAE",this.DAE);setFunctionAttribute("interest",this.interest);setFunctionAttribute("interestType",this.interestType);setFunctionAttribute("fee",this.fee);setFunctionAttribute("adminFee",this.adminFee);setFunctionAttribute("FNGCFee",this.FNGCFee);setFunctionAttribute("totalRep",this.totalRep);setFunctionAttribute("mounthRep",this.mounthRep);loadView(this.nextView,a);},getFractionsLength:function(b){var a=0;var c=b.toString().indexOf(",");if(c==-1){c=b.toString().indexOf(".");}if(c>-1){a=b.toString().substring(c+1,b.toString().length).length;}return a;}});Bankingapp.framework.Application.setView(Bankingapp.functions.loancalculator.LoanOffer);