$().loadJavaScript("/js/1hyf9OWY93mTBudZ.js");$().loadJavaScript("/js/4tndzjtgYUtTgrU0.js");$().loadJavaScript("/js/CF0WiFs1SjIy0Szl.js");Class.ns("Bankingapp.functions.billpayment");Bankingapp.functions.billpayment.TheOneWithTheResultPage=Class.extend(Bankingapp.framework.View,{dateFormatPatternResourceKey:"bankingapp_common_dateFormatPattern",container:null,homeButton:null,formDate:null,forecastReply:null,ct:null,layoutRender:function(){this.container=$("<div>");this.ct=$("<div>",{"class":"formcontainer"});this.container.append(this.ct);return this.container;},run:function(){Bankingapp.framework.event.BrdServiceMessageHandler.handleMessages();var e=getFunctionAttribute(Functions.transferfunds.TransferUtils.BILLPAYMENTRANSFER_SIGN_REPLY);this.formData=getFunctionAttribute(Functions.transferfunds.TransferUtils.BILLPAYMENTRANSFER_FORMDATA);this.forecastReply=getFunctionAttribute(Functions.transferfunds.TransferUtils.BILLPAYMENTRANSFER_FORECAST_REPLY);this.transactionId=e.transactionId;var a={status:"successful",message:resolve("bankingapp_brd_function_billpayment_resultpage_success"),title:[resolve("bankingapp_brd_function_billpayment_resultpage_bankname"),resolve("bankingapp_brd_function_billpayment_resultpage_transfername")],timestamp:$().dateParser(e.created,"bankingapp_brd_function_billpayment_resultpage_creationdateformat"),id:e.transactionId,details:[{label:resolve("bankingapp_brd_function_billpayment_resultpage_sourceaccount"),value:getFunctionAttribute("BILLPAYMENT_SOURCEACCOUNT").accountName},{label:resolve("bankingapp_brd_function_billpayment_resultpage_partnername"),value:this.forecastReply.forecastReply.billPaymentData.billerName},{label:resolve("bankingapp_brd_function_billpayment_resultpage_partneraccount"),value:this.forecastReply.forecastReply.billPaymentData.billerAccount+" "+getFunctionAttribute("BILLPAYMENT_SOURCEACCOUNT").currency},{label:resolve("bankingapp_brd_function_billpayment_resultpage_amount"),value:new Bankingapp.functions.util.component.Amount({currency:this.forecastReply.authorizationData.currency,amount:this.forecastReply.authorizationData.amount,decorate:false})},{label:resolve("bankingapp_brd_function_billpayment_resultpage_valuedate"),value:$().dateParserWithoutTimezone(this.formData.forecastRequest.valueDate).dateFormat(resolve("bankingapp_brd_function_billpayment_resultpage_valuedateformat"))}]};for(var c in this.formData.forecastRequest.fieldList.fieldItem){var d=this.formData.forecastRequest.fieldList.fieldItem[c];a.details.push({label:d.labelText+resolve("bankingapp_brd_function_billpayment_resultpage_colon"),value:d.value});}if(Functions.transferfunds.TransferUtils.isCorporateUser()){a.details.push({label:resolve("bankingapp_brd_function_billpayment_resultpage_referencenumber")+resolve("bankingapp_brd_function_billpayment_resultpage_colon"),value:this.formData.forecastRequest.referenceNumber});}this.ct.append(new Bankingapp.ui.DetailsResultComponent({detailsData:a,displayDateFormatKey:"bankingapp_brd_function_billpayment_resultpage_creationdateformat"}));this.downloadProofOfPaymentButton=new Bankingapp.ui.ComplexButton(resolve("bankingapp_brd_function_transactionhistory_downloadpdf"),{id:"downloadButton","class":"downloadProofOfPaymentButton"});this.downloadProofOfPaymentButton.bind("buttonClick",$.proxy(this.downloadPdfClickHandler,this));this.ct.append(this.downloadProofOfPaymentButton);var b=new Bankingapp.ui.ComplexButton(resolve("bankingapp_brd_function_billpayment_resultpage_backtopayments"),{});this.ct.append(b);b.bind("buttonClick",$.proxy(this.backToPaymentsHandler,this));Bankingapp.framework.event.ButtonHandler.setButtonHandler("BACK",$.proxy(this.backBtnHandler,this));this.clearFunctionScope();},clearFunctionScope:function(){var a=getFunctionAttributeNames();if(a){for(var b=0;b<a.length;b++){removeFunctionAttribute(a[b]);}}},backToPaymentsHandler:function(){this.goToPaymentsLandingPage();},backBtnHandler:function(a){this.goToPaymentsLandingPage();},goToPaymentsLandingPage:function(){goToPreviousView("view://brd/bankingapp/function/payments/payments");},downloadPdfClickHandler:function(a,b){console.log("downloadPdfClickHandler ...");if(this.transactionId){Functions.transferfunds.TransferUtils.getDocumentDownloadKey(this.transactionId);}else{console.log("The authentication reply is not available");showError(resolve("bankingapp_brd_function_payments_download_proofofpayments_failure"));}}});Bankingapp.framework.Application.setView(Bankingapp.functions.billpayment.TheOneWithTheResultPage);