$().loadJavaScript("/js/6mS9Q786hXIQQwSk.js");$().loadJavaScript("/js/2ryNVU4Hzt4WY9w8.js");Class.ns("Bankingapp.functions.devicemanagement");Bankingapp.functions.devicemanagement.DeviceManagement=Class.extend(Bankingapp.framework.View,{selectedDevicesAttribute:"UNLINK_SELECTED_DEVICES",unlinkForecastReplyAttribute:"UNLINK_FORECAST_REPLY",signReplyAttribute:"UNLINK_SIGN_REPLY",selectionContainer:null,container:null,deviceList:null,layoutRender:function(){this.container=$("<div>",{id:"deviceManagementMainContainer","class":"titledlist maincontainer"});this.selectionContainer=$("<div>",{id:"devicesSelectionContainer","class":"list maincontainer"});this.deviceListLabel=new Bankingapp.ui.Label(resolve("bankingapp_brd_function_devicemanagement_list_title"),{"class":"separator"});this.deviceList=new Bankingapp.functions.devicemanagement.DeviceList({baseClass:"list",baseElement:"<table>",listData:[],noresultKey:"bankingapp_brd_function_devicemanagement_no_items"});this.selectionContainer.append(this.deviceList);var a=new Bankingapp.ui.SubmitButton(resolve("bankingapp_brd_function_devicemanagement_continue"),{id:"continueButton","class":"continueButton"});a.bind("buttonClick",$.proxy(this.deviceSelectionHandler,this));this.container.append(this.deviceListLabel);this.container.append(this.selectionContainer);this.container.append(a);debugLog("DeviceManagement html: "+this.container.html());return this.container;},run:function(){var a={};debugLog("DeviceManagement run ...");Bankingapp.framework.Application.callService("/devicesmanagement/preinit",{GetChannelDataRequest:a},$.proxy(this.handleDeviceListResponse,this));debugLog("DeviceManagement ready!");},handleDeviceListResponse:function(a){debugLog("handleDeviceListResponse ...");this.deviceList.empty();var b=[];if(a!=undefined&&a.deviceList!==null){b=a.deviceList;}this.deviceList.appendItems(b);debugLog("handleDeviceListResponse ready!");debugLog("DeviceManagement html: "+this.container.html());},deviceSelectionHandler:function(c,d){var e=this.deviceList.getSelectedItems();if(e.length>0){setFunctionAttribute(this.selectedDevicesAttribute,e);for(var a in e){var b=e[a];this.deviceToDelete=b.deviceId;debugLog("deleteItem: "+this.deviceToDelete);break;}Bankingapp.framework.Application.showConfirmation(resolve("bankingapp_function_settings_mobilesettings_devicemanagement_removepopupmessage"),new Boolean(0),$.proxy(this.handleConfirmationResult,this));}else{showError(resolve("bankingapp_brd_function_devicemanagement_noitemsselected"));}},handleForecastResponse:function(a){debugLog("handleForecastResponse "+a);setFunctionAttribute(this.signReplyAttribute,a);loadView("view://brd/bankingapp/function/devicemanagement/unlinkresult",null);},handleConfirmationResult:function(a,c){if(a.valueOf()&&this.deviceToDelete){debugLog("delete device: "+this.deviceToDelete);var b={DisableDeviceRequest:{deviceId:this.deviceToDelete}};Bankingapp.framework.Application.callService("/devicesmanagement/disabledevice",b,$.proxy(this.handleForecastResponse,this));}else{debugLog("cancel request ...");}}});Bankingapp.framework.Application.setView(Bankingapp.functions.devicemanagement.DeviceManagement);