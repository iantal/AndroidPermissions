Class.ns("Bankingapp.functions.receivemoney.splitthebill");$().loadJavaScript("/js/1hyf9OWY93mTBudZ.js");$().loadJavaScript("/js/Iv4hiyfE5T7kWrR4.js");Bankingapp.functions.receivemoney.splitthebill.SplitHistoryList=Class.extend(Bankingapp.framework.View,{container:null,scroll:false,formData:null,formDataField:"transactionItem",statementList:null,navigateFrom:null,layoutRender:function(){this.formData={};Bankingapp.framework.Application.bind("onResume",$.proxy(this.onResume,this));this.container=$("<div>",{id:"transactionHistoryMainContainer","class":"list maincontainer"});this.transactionHistoryList=new Bankingapp.ui.HistoricList([],{itemRenderer:Bankingapp.functions.receivemoney.splitthebill.SplitHistoryListItem,id:"transactionId",dateField:"transactionDate",dataDateFormat:resolve("bankingapp_common_parsedatepattern_withouttimezone"),displayDateFormat:resolve("bankingapp_common_dateFormatPattern"),showDateInPeriods:false,dataOrder:"desc"});this.transactionHistoryList.bind("itemClick",$.proxy(this.loadDetailHandler,this));this.container.append(this.transactionHistoryListTitle);this.container.append(this.transactionHistoryList);this.transactionHistoryLoadMoreButton=new Bankingapp.ui.LandingPageButton([resolve("bankingapp_brd_function_transactionhistory_loadmore_button"),""],{"class":"a"});this.transactionHistoryLoadMoreButton.hide();this.transactionHistoryLoadMoreButton.bind("buttonClick",$.proxy(this.loadMoreHandler,this));this.container.append(this.transactionHistoryLoadMoreButton);return this.container;},onResume:function(){var b=getFunctionAttribute("SplitBillNavigateFrom");debugLog(" SplitHistoryList.onResume navigateFromFA: "+b);if(b!=undefined&&b!=null){this.navigateFrom=b;}debugLog(" SplitHistoryList.onResume this.navigateFrom: "+this.navigateFrom);if(this.navigateFrom===null||this.navigateFrom==="resultpage"){showLoadingPopup();this.clearFunctionScope();this.transactionHistoryList.empty();var a={AccountNumber:"NA",FromDate:new Date(),EndDate:new Date,Credit:false,Debit:true,SplitBill:true};Bankingapp.framework.Application.callService("/statement/getStatementList",{StatementListRequest:a},$.proxy(this.handleStatementsResult,this));Bankingapp.framework.Application.callService("/requestmoney/getPhoneNumberPrefixes",null,$.proxy(this.handlePhoneNumberPrefixesResponse,this));Bankingapp.framework.Application.callService("/splitbilltransfer/init",null,$.proxy(this.handleSplitBillTransferInitResponse,this));}},run:function(){Bankingapp.framework.event.ButtonHandler.setButtonHandler("BACK",$.proxy(this.backBtnHandler,this));},backBtnHandler:function(a){this.clearFunctionScope();removeFunctionAttribute("SplitBillNavigateFrom");goToPreviousView("view://brd/bankingapp/function/receivemoney/landingpage");},handleStatementsResult:function(b,a){this.statementList=b.statementList;this.transactionHistoryList.appendItems(this.statementList);if(this.scroll===true){$("html, body").animate({scrollTop:$(document).height()},1000);}hideLoadingPopup();},handlePhoneNumberPrefixesResponse:function(a){setFunctionAttribute("phoneNumberPrefix",a.validPhoneNumberPrefixes);},handleSplitBillTransferInitResponse:function(a){setFunctionAttribute("splitTheBillInit",a);},loadDetailHandler:function(b,c){var f=JSON.parse(JSON.stringify(c));f.amount=f.amount*(-1);var a={};a[this.formDataField]=f;$.extend(this.formData,a);setFunctionAttribute(Functions.transferfunds.TransferUtils.SPLITBILL_FORMDATA,this.formData);loadView("view://brd/bankingapp/function/receivemoney/splitthebill/splitsumm",null);},clearFunctionScope:function(){removeFunctionAttribute("remainingAmount");removeFunctionAttribute("splitPartners");removeFunctionAttribute("SPLITBILL_FORMDATA_DESCRIPTION");removeFunctionAttribute("SPLITBILL_FORMDATA_DATE");removeFunctionAttribute("SPLITBILL_FORMDATA_VALUEDATE");},});Bankingapp.framework.Application.setView(Bankingapp.functions.receivemoney.splitthebill.SplitHistoryList);