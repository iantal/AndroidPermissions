package c.t.m.g;

import android.location.Location;
import android.os.Bundle;
import android.os.Looper;
import android.os.SystemClock;
import android.util.Pair;
import android.util.SparseArray;
import com.tencent.map.geolocation.TencentLocation;
import com.tencent.map.geolocation.TencentLocationListener;
import com.tencent.map.geolocation.TencentLocationRequest;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.LinkedBlockingQueue;

public final class o
  implements k.b, l.a, m.a, s.a
{
  private static SparseArray a;
  private int b = 1;
  private o.a c;
  private final k d;
  private final m e;
  private final s f;
  private final p g;
  private final r h;
  private final l i;
  private t j;
  private w k;
  private u l;
  private final b m;
  private TencentLocationListener n;
  private final TencentLocationRequest o = TencentLocationRequest.create();
  private af p;
  private int q = 404;
  private final boolean r;
  private final String s;
  private String t;
  private boolean u;
  private final d.a v;
  private af w;
  
  static
  {
    SparseArray localSparseArray = new SparseArray();
    a = localSparseArray;
    localSparseArray.put(0, "OK");
    a.put(1, "ERROR_NETWORK");
    a.put(2, "BAD_JSON");
    a.put(4, "DEFLECT_FAILED");
  }
  
  public o(b paramB, String paramString)
  {
    this.s = paramString;
    this.m = paramB;
    ag.a(paramB.a);
    this.v = d.a;
    this.g = new p(this.m);
    this.h = new r(this.m);
    this.i = new l(this.h);
    this.f = g();
    paramB = f();
    this.d = paramB;
    paramString = e();
    this.e = paramString;
    this.r = c.a.a(paramB, new Object[] { paramString });
  }
  
  private void a(int paramInt, af paramAf)
  {
    if (paramAf == null) {}
    label18:
    label42:
    label70:
    label109:
    label114:
    label268:
    label286:
    label343:
    label349:
    label355:
    label361:
    label392:
    label394:
    label397:
    for (;;)
    {
      return;
      int i1;
      if (this.q == 404)
      {
        i1 = 1;
        if (i1 == 0) {
          break label114;
        }
        this.q = paramInt;
        this.p = paramAf;
        if (this.c != null) {
          break label109;
        }
        paramInt = 1;
        if ((paramInt == 0) && (this.o.getInterval() > 0L)) {
          this.c.sendEmptyMessageDelayed(11999, 0L);
        }
        if (this.o.getInterval() != 0L) {
          break label392;
        }
        if (this.n == null) {
          break label394;
        }
      }
      for (paramInt = 1;; paramInt = 0)
      {
        if (paramInt == 0) {
          break label397;
        }
        b(11998);
        return;
        i1 = 0;
        break label18;
        paramInt = 0;
        break label42;
        if ((this.q == 0) && (paramInt == 0) && (this.p != null))
        {
          long l1 = paramAf.a() - this.p.a();
          double d1;
          int i2;
          if (l1 > 0L)
          {
            d1 = c.a.a(paramAf.getLatitude(), paramAf.getLongitude(), this.p.getLatitude(), this.p.getLongitude());
            double d2 = 1000.0D * d1 / l1;
            new StringBuilder("updateLastLocation: new location got.  distance=").append(d1).append(", velocity=").append(d2).append(",time_delta=").append(l1).toString();
            aj.a();
            i2 = paramAf.b();
            if ((!this.m.f()) || (i2 <= 0) || (i2 >= 3) || (d1 <= 1000.0D)) {
              break label343;
            }
            i1 = 1;
            if ((i2 <= 0) || (paramAf.getAccuracy() <= 800.0F)) {
              break label349;
            }
            i2 = 1;
            if ((i1 == 0) && (i2 == 0)) {
              break label355;
            }
          }
          for (i1 = 1;; i1 = 0)
          {
            if (i1 == 0) {
              break label361;
            }
            new StringBuilder("updateLastLocation: discards bad fix: usedMac=").append(paramAf.b()).append(", distance=").append(d1).toString();
            aj.a();
            return;
            l1 = 1L;
            break;
            i1 = 0;
            break label268;
            i2 = 0;
            break label286;
          }
          if ((d1 < 5.0D) && (d1 > 1.0E-7D))
          {
            aj.a();
            return;
          }
        }
        this.q = paramInt;
        this.p = paramAf;
        break label70;
        break;
      }
    }
  }
  
  private void b(int paramInt)
  {
    if (this.c != null) {
      this.c.sendEmptyMessage(paramInt);
    }
  }
  
  private m e()
  {
    try
    {
      m localM = new m(this.m, this);
      return localM;
    }
    catch (Exception localException)
    {
      aj.a("createGpsProvider: failed", localException);
    }
    return null;
  }
  
  private k f()
  {
    try
    {
      k localK = new k(this.m, this);
      return localK;
    }
    catch (Exception localException)
    {
      aj.a("createCellProvider: failed", localException);
    }
    return null;
  }
  
  private s g()
  {
    try
    {
      s localS = new s(this.m, this);
      return localS;
    }
    catch (Exception localException)
    {
      aj.a("createWifiProvider: failed", localException);
    }
    return null;
  }
  
  private void h()
  {
    int i2 = 1;
    this.g.a();
    r localR = this.h;
    localR.a.clear();
    localR.a.offer(r.a.a);
    localR.g = 0L;
    long l1 = SystemClock.elapsedRealtime();
    long l2 = localR.d;
    long l3 = localR.e;
    new StringBuilder("shutdown: duration=[").append(l1 / 1000L / 60L).append(" min], traffic=[").append(localR.d).append(",").append(localR.e).append(",").append(l2 + l3).append("], requestCount=[").append(localR.c).append("]").toString();
    aj.a();
    localR.c = 0L;
    localR.d = 0L;
    localR.e = 0L;
    if (this.f != null)
    {
      i1 = 1;
      if (i1 != 0) {
        this.f.b();
      }
      if (this.d == null) {
        break label254;
      }
      i1 = 1;
      label197:
      if (i1 != 0) {
        this.d.b();
      }
      if (this.e == null) {
        break label259;
      }
      i1 = 1;
      label217:
      if (i1 != 0) {
        this.e.a();
      }
      if (this.c == null) {
        break label264;
      }
    }
    label254:
    label259:
    label264:
    for (int i1 = i2;; i1 = 0)
    {
      if (i1 != 0) {
        this.c.a();
      }
      return;
      i1 = 0;
      break;
      i1 = 0;
      break label197;
      i1 = 0;
      break label217;
    }
  }
  
  public final int a(TencentLocationRequest paramTencentLocationRequest, TencentLocationListener paramTencentLocationListener, Looper paramLooper)
  {
    int i2 = 1;
    Object localObject = this.s;
    if (((String)localObject).contains(","))
    {
      localObject = ((String)localObject).split(",");
      if ((localObject != null) && (localObject.length > 1) && (com.tencent.tencentmap.lbssdk.service.e.v2(localObject[0], localObject[1]) > 0))
      {
        i1 = 1;
        if (i1 == 0) {
          break label127;
        }
        localObject = localObject[0];
        label70:
        this.t = ((String)localObject);
        if (i1 == 0) {
          break label135;
        }
        i1 = 1;
      }
    }
    for (;;)
    {
      if (i1 >= 0) {
        break label160;
      }
      new StringBuilder("requestLocationUpdates: illegal key [").append(this.s).append("]").toString();
      aj.b();
      return 2;
      i1 = 0;
      break;
      label127:
      localObject = "";
      break label70;
      label135:
      i1 = -1;
      continue;
      i1 = com.tencent.tencentmap.lbssdk.service.e.v((String)localObject);
      this.t = Integer.toString(i1);
    }
    label160:
    if (this.r) {
      return 1;
    }
    this.p = null;
    this.q = 404;
    this.k = null;
    this.j = null;
    this.l = null;
    this.u = false;
    this.m.a("cell").a();
    this.n = paramTencentLocationListener;
    TencentLocationRequest.copy(this.o, paramTencentLocationRequest);
    if (this.c == null)
    {
      i1 = 1;
      if (i1 == 0) {
        break label433;
      }
      this.c = new o.a(this, paramLooper);
      label257:
      h();
      boolean bool = this.o.getExtras().getBoolean("use_network", true);
      paramTencentLocationRequest = this.c;
      this.g.a(paramTencentLocationRequest);
      paramTencentLocationListener = this.h;
      paramTencentLocationListener.b.e().execute(new r.1(paramTencentLocationListener, paramTencentLocationRequest));
      if (bool)
      {
        if (this.f == null) {
          break label468;
        }
        i1 = 1;
        label331:
        if (i1 != 0)
        {
          paramTencentLocationListener = this.f;
          this.o.getInterval();
          paramTencentLocationListener.a(paramTencentLocationRequest);
        }
      }
      if (bool)
      {
        if (this.d == null) {
          break label474;
        }
        i1 = 1;
        label369:
        if (i1 != 0) {
          this.d.a();
        }
      }
      if (this.e == null) {
        break label480;
      }
    }
    label433:
    label468:
    label474:
    label480:
    for (int i1 = i2;; i1 = 0)
    {
      if (i1 != 0)
      {
        paramTencentLocationListener = this.o;
        x.d();
        this.e.a(paramTencentLocationRequest, this.o.getInterval() - 2000L);
      }
      return 0;
      i1 = 0;
      break;
      this.c.removeCallbacksAndMessages(null);
      if (this.c.getLooper() == paramLooper) {
        break label257;
      }
      this.c = new o.a(this, paramLooper);
      break label257;
      i1 = 0;
      break label331;
      i1 = 0;
      break label369;
    }
  }
  
  public final TencentLocation a()
  {
    if (this.q == 0) {
      return this.p;
    }
    return null;
  }
  
  public final void a(int paramInt)
  {
    boolean bool = aj.a;
    if ((this.n != null) && (!bool)) {
      throw new IllegalStateException("removeUpdates MUST called before set coordinate type!");
    }
    this.b = paramInt;
  }
  
  public final void a(int paramInt1, int paramInt2)
  {
    String str1 = null;
    String str2;
    switch (paramInt1)
    {
    default: 
      str2 = null;
    }
    for (;;)
    {
      if (this.n != null) {
        this.n.onStatusUpdate(str2, paramInt2, str1);
      }
      return;
      str2 = "gps";
      if (paramInt2 == 1)
      {
        str1 = "gps enabled";
      }
      else if (paramInt2 == 0)
      {
        str1 = "gps disabled";
      }
      else
      {
        str1 = "unknown";
        continue;
        str2 = "cell";
        if (paramInt2 == 1)
        {
          str1 = "radio enabled";
        }
        else if (paramInt2 == 0)
        {
          str1 = "radio disabled";
        }
        else
        {
          str1 = "unknown";
          continue;
          str2 = "wifi";
          if (paramInt2 == 1) {
            str1 = "wifi enabled";
          } else if (paramInt2 == 0) {
            str1 = "wifi disabled";
          } else {
            str1 = "unknown";
          }
        }
      }
    }
  }
  
  public final void a(Location paramLocation, double[] paramArrayOfDouble, int paramInt)
  {
    int i1 = this.o.getRequestLevel();
    af localAf;
    if (this.w != null)
    {
      localAf = this.w;
      localAf = af.a(localAf).a(paramLocation.getProvider()).a(i1).b(paramLocation);
      new Location(paramLocation);
      x.b();
      if (paramInt == 0)
      {
        paramLocation.setLatitude(paramArrayOfDouble[0]);
        paramLocation.setLongitude(paramArrayOfDouble[1]);
        localAf.a(paramLocation);
      }
      if (paramInt != 0) {
        break label104;
      }
    }
    label104:
    for (paramInt = 0;; paramInt = 4)
    {
      a(paramInt, localAf);
      return;
      localAf = this.p;
      break;
    }
  }
  
  public final void a(t paramT, boolean paramBoolean)
  {
    int i2;
    int i1;
    if (this.j != null)
    {
      i2 = this.j.e;
      i1 = this.j.f;
    }
    for (;;)
    {
      if (i2 == paramT.e) {}
      for (boolean bool = true;; bool = false)
      {
        this.u = bool;
        this.j = paramT;
        String.format("onCellChanged: %d(%d)-->%d(%d)", new Object[] { Integer.valueOf(i2), Integer.valueOf(i1), Integer.valueOf(paramT.e), Integer.valueOf(paramT.f) });
        aj.a();
        if ((!paramBoolean) && (this.f != null)) {
          break;
        }
        aj.a();
        b(3999);
        return;
      }
      i1 = this.f.a();
      if (i1 == 1)
      {
        aj.a();
        b(3999);
        return;
      }
      new StringBuilder("onCellChanged: scan again. status=").append(i1).toString();
      aj.a();
      return;
      i1 = 0;
      i2 = 0;
    }
  }
  
  public final void a(u paramU)
  {
    this.l = paramU;
    paramU = new u(paramU).a;
    double d1;
    double d2;
    if (aj.a)
    {
      d1 = paramU.getLatitude();
      d2 = paramU.getLongitude();
      float f1 = paramU.getAccuracy();
      localObject1 = new StringBuilder("handleLocationWgs84Update: gps=");
      ((StringBuilder)localObject1).append("[");
      ((StringBuilder)localObject1).append("lat=").append(d1).append(", ");
      ((StringBuilder)localObject1).append("lng=").append(d2).append(", ");
      ((StringBuilder)localObject1).append("accu=").append(f1);
      ((StringBuilder)localObject1).append("]");
      ((StringBuilder)localObject1).toString();
      aj.a();
    }
    Object localObject1 = this.p;
    int i3 = this.b;
    int i2 = this.o.getRequestLevel();
    int i1;
    Object localObject3;
    if (i3 == 1)
    {
      i1 = 1;
      if (i1 == 0) {
        break label529;
      }
      if ((localObject1 != null) || (i2 == 0))
      {
        localObject3 = this.i;
        if ((paramU != null) && (this != null)) {
          break label201;
        }
        aj.b();
      }
    }
    for (;;)
    {
      return;
      i1 = 0;
      break;
      label201:
      localObject1 = new double[2];
      if ((Math.abs(((l)localObject3).b) > 1.0E-7D) && (Math.abs(((l)localObject3).c) > 1.0E-7D))
      {
        i1 = 1;
        if (i1 == 0) {
          break label373;
        }
        if ((((l)localObject3).d != null) && (paramU != null)) {
          break label331;
        }
        i1 = 0;
        label259:
        if (i1 == 0) {
          break label373;
        }
        d1 = paramU.getLatitude();
        d2 = ((l)localObject3).b;
        double d3 = paramU.getLongitude();
        double d4 = ((l)localObject3).c;
        localObject1[0] = (d1 + d2);
        localObject1[1] = (d3 + d4);
      }
      for (i1 = 1;; i1 = 0)
      {
        if (i1 == 0) {
          break label385;
        }
        a(paramU, (double[])localObject1, 0);
        return;
        i1 = 0;
        break;
        label331:
        if (c.a.a(paramU.getLatitude(), paramU.getLongitude(), ((l)localObject3).d.getLatitude(), paramU.getLongitude()) < 1500.0D)
        {
          i1 = 1;
          break label259;
        }
        i1 = 0;
        break label259;
        label373:
        ((l)localObject3).d = paramU;
      }
      label385:
      ((l)localObject3).e = this;
      localObject1 = ((l)localObject3).a;
      d1 = paramU.getLatitude();
      d2 = paramU.getLongitude();
      String str = "{\"version\":\"4.0\",\"source\":203,\"access_token\":\"160e7bd42dec9428721034e0146fc6dd\",\"location\":{\"latitude\":" + d1 + ",\"longitude\":" + d2 + "}}";
      Object localObject2 = c.a.a(str.getBytes());
      localObject3 = Pair.create(paramU, localObject3);
      paramU = r.a((byte[])localObject2, 1);
      localObject2 = new r.a(2, (byte[])localObject2, paramU, localObject3);
      new StringBuilder("postDeflectRequest: json=").append(str).append(",url=").append(paramU).toString();
      aj.a();
      ((r)localObject1).a.offer(localObject2);
      return;
      label529:
      if (i3 == 0) {}
      for (i1 = 1; i1 != 0; i1 = 0)
      {
        localObject1 = af.a((af)localObject1).a("gps").a(i2).b(paramU);
        ((af)localObject1).a(paramU);
        a(0, (af)localObject1);
        return;
      }
    }
  }
  
  public final void a(w paramW, boolean paramBoolean)
  {
    int i2 = 0;
    this.k = paramW;
    int i1;
    label30:
    long l1;
    if (this.f != null)
    {
      i1 = 1;
      if (i1 != 0)
      {
        if (this.l != null) {
          break label101;
        }
        i1 = 1;
        if (i1 == 0)
        {
          i1 = i2;
          if (this.l.b - System.currentTimeMillis() <= 5000L) {}
        }
        else
        {
          i1 = 1;
        }
        l1 = this.o.getInterval();
        paramW = this.m.d();
        if (i1 == 0) {
          break label106;
        }
        paramW.a(l1);
      }
    }
    for (;;)
    {
      if (paramBoolean) {
        b(3999);
      }
      return;
      i1 = 0;
      break;
      label101:
      i1 = 0;
      break label30;
      label106:
      paramW.a(l1 + 10000L);
    }
  }
  
  public final void b()
  {
    h();
    this.n = null;
    this.w = null;
    d.a localA = this.v;
  }
  
  public final int c()
  {
    return this.b;
  }
}
