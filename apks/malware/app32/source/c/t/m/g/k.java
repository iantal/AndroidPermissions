package c.t.m.g;

import android.os.Handler;
import android.os.HandlerThread;
import android.telephony.CellLocation;
import android.telephony.PhoneStateListener;
import android.telephony.ServiceState;
import android.telephony.SignalStrength;
import android.telephony.TelephonyManager;

public final class k
  extends PhoneStateListener
{
  volatile boolean a;
  private final k.b b;
  private final b c;
  private CellLocation d = null;
  private SignalStrength e = null;
  private ServiceState f = null;
  private t g = null;
  private long h;
  private HandlerThread i;
  private Handler j;
  private k.a k = null;
  private final Object l = new Object();
  
  public k(b paramB, k.b paramB1)
  {
    if (c.a.a(paramB, paramB1)) {
      throw new NullPointerException();
    }
    this.c = paramB;
    this.b = paramB1;
    if (paramB.a() == null) {}
    for (int m = 1; m != 0; m = 0)
    {
      aj.b();
      throw new NullPointerException("telephony manager is null");
    }
  }
  
  private void a(int paramInt)
  {
    TelephonyManager localTelephonyManager = this.c.a();
    try
    {
      localTelephonyManager.listen(this, paramInt);
      return;
    }
    catch (Exception localException)
    {
      aj.a("listenCellState: failed! flags=" + paramInt, localException);
    }
  }
  
  private void a(long paramLong)
  {
    synchronized (this.l)
    {
      if (this.j != null) {
        this.j.sendEmptyMessageDelayed(5998, paramLong);
      }
      return;
    }
  }
  
  private void c()
  {
    if ((!this.a) || (this.d == null)) {}
    long l1;
    do
    {
      return;
      l1 = System.currentTimeMillis();
    } while (l1 - this.h <= 2000L);
    this.h = l1;
    if (this.k == null) {
      this.k = new k.a(this, (byte)0);
    }
    synchronized (this.l)
    {
      if (this.j != null) {
        this.j.post(this.k);
      }
      return;
    }
  }
  
  private void d()
  {
    int m = 1;
    if (!this.a) {
      return;
    }
    if (this.f != null) {
      if (this.f.getState() != 0) {}
    }
    for (;;)
    {
      this.b.a(12003, m);
      return;
      if (this.f.getState() == 1) {
        m = 0;
      } else {
        m = -1;
      }
    }
  }
  
  public final void a()
  {
    if (this.a) {
      return;
    }
    this.a = true;
    this.i = new HandlerThread("worker");
    this.i.start();
    this.j = new k.1(this, this.i.getLooper());
    a(273);
    aj.a();
    a(3000L);
  }
  
  public final void b()
  {
    if (!this.a) {
      return;
    }
    this.a = false;
    a(0);
    synchronized (this.l)
    {
      if (this.j != null)
      {
        this.j.removeCallbacksAndMessages(null);
        this.j = null;
      }
      this.i.quit();
      this.i = null;
      aj.a();
      this.d = null;
      this.e = null;
      this.f = null;
      this.g = null;
      return;
    }
  }
  
  public final void onCellLocationChanged(CellLocation paramCellLocation)
  {
    super.onCellLocationChanged(paramCellLocation);
    if (paramCellLocation == null) {
      return;
    }
    t localT = t.a(this.c, paramCellLocation, null);
    if (localT == null) {}
    for (boolean bool = true;; bool = c.a.a(localT))
    {
      if (bool) {
        this.d = paramCellLocation;
      }
      c();
      return;
    }
  }
  
  public final void onServiceStateChanged(ServiceState paramServiceState)
  {
    super.onServiceStateChanged(paramServiceState);
    if (paramServiceState == null) {}
    do
    {
      return;
      if (this.f == null)
      {
        this.f = paramServiceState;
        d();
        return;
      }
    } while (this.f.getState() == paramServiceState.getState());
    this.f = paramServiceState;
    d();
  }
  
  public final void onSignalStrengthsChanged(SignalStrength paramSignalStrength)
  {
    int i1 = 0;
    super.onSignalStrengthsChanged(paramSignalStrength);
    if (paramSignalStrength == null) {}
    for (;;)
    {
      return;
      int i2 = this.c.d().b;
      SignalStrength localSignalStrength = this.e;
      int m;
      if ((localSignalStrength == null) || (paramSignalStrength == null)) {
        m = 1;
      }
      while (m != 0)
      {
        this.e = paramSignalStrength;
        c();
        return;
        int n;
        if (c.a.a(i2)) {
          n = localSignalStrength.getGsmSignalStrength() - paramSignalStrength.getGsmSignalStrength();
        }
        for (;;)
        {
          if (!c.a.a(i2)) {
            break label123;
          }
          m = i1;
          if (n <= 3) {
            break;
          }
          m = 1;
          break;
          if (c.a.b(i2)) {
            n = localSignalStrength.getCdmaDbm() - paramSignalStrength.getCdmaDbm();
          } else {
            n = 0;
          }
        }
        label123:
        m = i1;
        if (c.a.b(i2))
        {
          m = i1;
          if (n > 6) {
            m = 1;
          }
        }
      }
    }
  }
}
