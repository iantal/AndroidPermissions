package com.videoclient.player.b;

import android.content.Context;
import android.content.Intent;
import android.os.AsyncTask;
import android.text.TextUtils;
import android.util.Log;
import android.widget.Toast;
import com.jiexinhongye.libforztool.android.ZPhoneInfo;
import com.jiexinhongye.libforztool.android.Zlog;
import com.jshyproject.price.channel.Data;
import com.payeco.android.plugin.PayecoPluginLoadingActivity;
import java.util.ArrayList;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONException;
import org.json.JSONObject;

class m
  extends AsyncTask
{
  m(l paramL, Context paramContext) {}
  
  protected String a(Void... paramVarArgs)
  {
    ArrayList localArrayList = new ArrayList();
    localArrayList.add(new BasicNameValuePair("OrderDesc", l.a(this.a)));
    localArrayList.add(new BasicNameValuePair("Amount", l.b(this.a)));
    String str = ZPhoneInfo.getIMSI(this.b);
    paramVarArgs = str;
    if (TextUtils.isEmpty(str)) {
      paramVarArgs = "46001000000";
    }
    str = "videoyi" + System.currentTimeMillis();
    localArrayList.add(new BasicNameValuePair("channelNo", Data.getChannelKey(this.b)));
    localArrayList.add(new BasicNameValuePair("orderId", str));
    localArrayList.add(new BasicNameValuePair("userId", paramVarArgs));
    localArrayList.add(new BasicNameValuePair("deviceId", this.a.c(this.b)));
    localArrayList.add(new BasicNameValuePair("imsi", paramVarArgs));
    localArrayList.add(new BasicNameValuePair("subject", l.c(this.a)));
    try
    {
      Log.i("test", "正在请求：http://115.28.222.200:8080/apppay/adecopay_order.do");
      paramVarArgs = l.a(this.a, "http://115.28.222.200:8080/apppay/adecopay_order.do", localArrayList);
      return paramVarArgs;
    }
    catch (Exception paramVarArgs)
    {
      Log.e("test", "下单失败，通讯发生异常", paramVarArgs);
      paramVarArgs.printStackTrace();
    }
    return null;
  }
  
  protected void a(String paramString)
  {
    super.onPostExecute(paramString);
    Zlog.syso("YiPayResult:" + paramString);
    if (paramString == null)
    {
      Log.e("test", "下单失败！");
      return;
    }
    Log.i("test", "响应数据：" + paramString);
    try
    {
      localObject = new JSONObject(paramString);
      if ((((JSONObject)localObject).has("RetCode")) && ("0000".equals(((JSONObject)localObject).getString("RetCode")))) {
        break label195;
      }
      if (((JSONObject)localObject).has("RetMsg"))
      {
        Toast.makeText(this.b, ((JSONObject)localObject).getString("RetMsg"), 1).show();
        Log.e("test", ((JSONObject)localObject).getString("RetMsg"));
        return;
      }
    }
    catch (JSONException paramString)
    {
      Log.e("test", "解析处理失败！", paramString);
      paramString.printStackTrace();
      return;
    }
    Toast.makeText(this.b, "返回数据有误:" + paramString, 1).show();
    Log.e("test", "返回数据有误:" + paramString);
    return;
    label195:
    ((JSONObject)localObject).remove("RetCode");
    ((JSONObject)localObject).remove("RetMsg");
    paramString = ((JSONObject)localObject).toString();
    Log.i("test", "请求易联支付插件，参数：" + paramString);
    Object localObject = new Intent(this.b, PayecoPluginLoadingActivity.class);
    ((Intent)localObject).putExtra("upPay.Req", paramString);
    ((Intent)localObject).putExtra("Broadcast", "com.jshy.video.client");
    ((Intent)localObject).putExtra("Environment", "01");
    this.b.startActivity((Intent)localObject);
  }
}
