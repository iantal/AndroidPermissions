package com.videoclient.player;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.os.Environment;
import android.os.Handler;
import android.os.Looper;
import android.view.View;
import android.view.ViewGroup.LayoutParams;
import android.widget.ImageView;
import android.widget.RelativeLayout;
import android.widget.RelativeLayout.LayoutParams;
import android.widget.Toast;
import android.widget.VideoView;
import com.baidu.a.f;
import com.todddavies.components.progressbar.ProgressWheel;
import java.io.File;

public class ShowActivity
  extends Activity
{
  static Handler e = new i(Looper.getMainLooper());
  ProgressWheel a;
  VideoView b;
  com.a.b.g c;
  File d = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_MOVIES);
  private String f;
  private int g;
  private int h;
  private RelativeLayout i;
  
  public ShowActivity() {}
  
  public static boolean a()
  {
    return "mounted".equals(Environment.getExternalStorageState());
  }
  
  private void b()
  {
    Object localObject = this.f.substring(this.f.lastIndexOf("/"));
    String str = ((String)localObject).substring(1, ((String)localObject).length());
    localObject = str;
    if (str.indexOf("?") != -1) {
      localObject = str.substring(0, str.indexOf("?"));
    }
    localObject = new File(this.d, (String)localObject);
    this.c = new com.a.b.g(getCacheDir(), this.f, (File)localObject, new j(this));
    this.c.a(new k(this));
    new Thread(this.c).start();
  }
  
  private void c()
  {
    int m = 1;
    Intent localIntent = getIntent();
    this.f = localIntent.getStringExtra("Viewurl");
    this.g = localIntent.getIntExtra("Vieww", -1);
    this.h = localIntent.getIntExtra("Viewh", -1);
    int j;
    int k;
    if (this.f == null)
    {
      j = 1;
      if (this.g != -1) {
        break label120;
      }
      k = 1;
      label62:
      if (this.h != -1) {
        break label125;
      }
    }
    for (;;)
    {
      if ((j | k | m) != 0)
      {
        Toast.makeText(this, "参数不正确", 0).show();
        finish();
      }
      com.a.a.g.a("url:" + this.f);
      return;
      j = 0;
      break;
      label120:
      k = 0;
      break label62;
      label125:
      m = 0;
    }
  }
  
  private void d()
  {
    setContentView(2130903096);
    this.a = ((ProgressWheel)findViewById(2131165315));
    this.i = ((RelativeLayout)findViewById(2131165397));
    this.b = new VideoView(this);
    this.b.setBackgroundColor(-16777216);
  }
  
  protected void a(String paramString)
  {
    this.i.removeView(this.a);
    Object localObject = new RelativeLayout.LayoutParams(-1, -1);
    ((RelativeLayout.LayoutParams)localObject).addRule(13);
    this.b.setLayoutParams((ViewGroup.LayoutParams)localObject);
    this.i.addView(this.b);
    this.b.setVideoPath(paramString);
    this.b.setOnPreparedListener(new m(this));
    this.b.setOnErrorListener(new n(this, paramString));
    localObject = new ImageView(this);
    ((ImageView)localObject).setImageResource(2130837682);
    RelativeLayout.LayoutParams localLayoutParams = new RelativeLayout.LayoutParams(50, 50);
    localLayoutParams.addRule(11);
    localLayoutParams.addRule(10);
    ((ImageView)localObject).setLayoutParams(localLayoutParams);
    this.i.addView((View)localObject);
    ((ImageView)localObject).setClickable(true);
    ((ImageView)localObject).setOnClickListener(new o(this));
    this.i.setClickable(true);
    this.i.setOnClickListener(new p(this, paramString));
  }
  
  protected void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    requestWindowFeature(1);
    c();
    d();
    if (a())
    {
      if (!this.d.exists()) {
        this.d.mkdir();
      }
      b();
      return;
    }
    a(this.f);
  }
  
  protected void onDestroy()
  {
    super.onDestroy();
    if ((this.b != null) && (this.b.isPlaying()))
    {
      this.b.suspend();
      this.b.clearAnimation();
    }
    if (this.c != null) {
      this.c.d();
    }
  }
  
  protected void onPause()
  {
    super.onPause();
    f.b(this);
  }
  
  protected void onResume()
  {
    super.onResume();
    f.a(this);
  }
}
