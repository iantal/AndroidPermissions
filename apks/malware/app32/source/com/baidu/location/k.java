package com.baidu.location;

import android.content.Context;
import android.content.Intent;
import android.content.ServiceConnection;
import android.os.Bundle;
import android.os.Message;
import android.os.Messenger;
import android.text.TextUtils;
import android.util.Log;
import java.util.ArrayList;
import java.util.Iterator;

public final class k
  implements bb
{
  private Boolean A = Boolean.valueOf(false);
  private Boolean B = Boolean.valueOf(true);
  private boolean C;
  private ServiceConnection D = new l(this);
  private long E = 0L;
  private a F = null;
  private long a = 0L;
  private String b = null;
  private o c = new o();
  private boolean d = false;
  private Context e = null;
  private Messenger f = null;
  private m g = new m(this, null);
  private final Messenger h = new Messenger(this.g);
  private ArrayList j = null;
  private BDLocation k = null;
  private boolean l = false;
  private boolean m = false;
  private boolean n = false;
  private n o = null;
  private boolean p = false;
  private final Object q = new Object();
  private long r = 0L;
  private long s = 0L;
  private cs t = null;
  private boolean u = false;
  private d v = null;
  private String w = null;
  private String x;
  private boolean y = false;
  private Boolean z = Boolean.valueOf(false);
  
  public k(Context paramContext)
  {
    this.e = paramContext;
    this.c = new o();
    this.t = new cs(this.e, this);
  }
  
  private void a(int paramInt)
  {
    if ((this.l == true) || ((this.c.h == true) && (this.k.e() == 61)) || (this.k.e() == 66) || (this.k.e() == 67) || (this.y))
    {
      Iterator localIterator = this.j.iterator();
      while (localIterator.hasNext()) {
        ((d)localIterator.next()).onReceiveLocation(this.k);
      }
      if ((this.k.e() != 66) && (this.k.e() != 67)) {}
    }
    else
    {
      return;
    }
    this.l = false;
    this.s = System.currentTimeMillis();
  }
  
  private void a(Message paramMessage)
  {
    if ((paramMessage == null) || (paramMessage.obj == null)) {
      return;
    }
    paramMessage = (e)paramMessage.obj;
    this.t.a(paramMessage);
  }
  
  private void a(Message paramMessage, int paramInt)
  {
    paramMessage = paramMessage.getData();
    paramMessage.setClassLoader(BDLocation.class.getClassLoader());
    this.k = ((BDLocation)paramMessage.getParcelable("locStr"));
    if (this.k.e() == 61) {
      this.r = System.currentTimeMillis();
    }
    a(paramInt);
  }
  
  private void a(boolean paramBoolean)
  {
    if (this.F != null) {
      this.F.a(paramBoolean);
    }
    this.F = null;
    this.E = 0L;
  }
  
  private void b(Message paramMessage)
  {
    if ((paramMessage == null) || (paramMessage.obj == null)) {
      return;
    }
    paramMessage = (e)paramMessage.obj;
    this.t.b(paramMessage);
  }
  
  /* Error */
  private void c(Message paramMessage)
  {
    // Byte code:
    //   0: aload_1
    //   1: ifnull +10 -> 11
    //   4: aload_1
    //   5: getfield 190	android/os/Message:obj	Ljava/lang/Object;
    //   8: ifnonnull +4 -> 12
    //   11: return
    //   12: aload_1
    //   13: getfield 190	android/os/Message:obj	Ljava/lang/Object;
    //   16: checkcast 64	com/baidu/location/o
    //   19: astore_1
    //   20: aload_0
    //   21: getfield 67	com/baidu/location/k:c	Lcom/baidu/location/o;
    //   24: aload_1
    //   25: invokevirtual 244	com/baidu/location/o:a	(Lcom/baidu/location/o;)Z
    //   28: ifne -17 -> 11
    //   31: aload_0
    //   32: getfield 67	com/baidu/location/k:c	Lcom/baidu/location/o;
    //   35: getfield 247	com/baidu/location/o:d	I
    //   38: aload_1
    //   39: getfield 247	com/baidu/location/o:d	I
    //   42: if_icmpeq +95 -> 137
    //   45: aload_0
    //   46: getfield 103	com/baidu/location/k:q	Ljava/lang/Object;
    //   49: astore_2
    //   50: aload_2
    //   51: monitorenter
    //   52: aload_0
    //   53: getfield 97	com/baidu/location/k:n	Z
    //   56: iconst_1
    //   57: if_icmpne +19 -> 76
    //   60: aload_0
    //   61: getfield 80	com/baidu/location/k:g	Lcom/baidu/location/m;
    //   64: aload_0
    //   65: getfield 99	com/baidu/location/k:o	Lcom/baidu/location/n;
    //   68: invokevirtual 251	com/baidu/location/m:removeCallbacks	(Ljava/lang/Runnable;)V
    //   71: aload_0
    //   72: iconst_0
    //   73: putfield 97	com/baidu/location/k:n	Z
    //   76: aload_1
    //   77: getfield 247	com/baidu/location/o:d	I
    //   80: sipush 1000
    //   83: if_icmplt +52 -> 135
    //   86: aload_0
    //   87: getfield 97	com/baidu/location/k:n	Z
    //   90: ifne +45 -> 135
    //   93: aload_0
    //   94: getfield 99	com/baidu/location/k:o	Lcom/baidu/location/n;
    //   97: ifnonnull +16 -> 113
    //   100: aload_0
    //   101: new 253	com/baidu/location/n
    //   104: dup
    //   105: aload_0
    //   106: aconst_null
    //   107: invokespecial 254	com/baidu/location/n:<init>	(Lcom/baidu/location/k;Lcom/baidu/location/l;)V
    //   110: putfield 99	com/baidu/location/k:o	Lcom/baidu/location/n;
    //   113: aload_0
    //   114: getfield 80	com/baidu/location/k:g	Lcom/baidu/location/m;
    //   117: aload_0
    //   118: getfield 99	com/baidu/location/k:o	Lcom/baidu/location/n;
    //   121: aload_1
    //   122: getfield 247	com/baidu/location/o:d	I
    //   125: i2l
    //   126: invokevirtual 258	com/baidu/location/m:postDelayed	(Ljava/lang/Runnable;J)Z
    //   129: pop
    //   130: aload_0
    //   131: iconst_1
    //   132: putfield 97	com/baidu/location/k:n	Z
    //   135: aload_2
    //   136: monitorexit
    //   137: aload_0
    //   138: new 64	com/baidu/location/o
    //   141: dup
    //   142: aload_1
    //   143: invokespecial 261	com/baidu/location/o:<init>	(Lcom/baidu/location/o;)V
    //   146: putfield 67	com/baidu/location/k:c	Lcom/baidu/location/o;
    //   149: aload_0
    //   150: getfield 73	com/baidu/location/k:f	Landroid/os/Messenger;
    //   153: ifnull -142 -> 11
    //   156: aconst_null
    //   157: bipush 15
    //   159: invokestatic 265	android/os/Message:obtain	(Landroid/os/Handler;I)Landroid/os/Message;
    //   162: astore_1
    //   163: aload_1
    //   164: aload_0
    //   165: getfield 87	com/baidu/location/k:h	Landroid/os/Messenger;
    //   168: putfield 268	android/os/Message:replyTo	Landroid/os/Messenger;
    //   171: aload_1
    //   172: aload_0
    //   173: invokespecial 239	com/baidu/location/k:h	()Landroid/os/Bundle;
    //   176: invokevirtual 272	android/os/Message:setData	(Landroid/os/Bundle;)V
    //   179: aload_0
    //   180: getfield 73	com/baidu/location/k:f	Landroid/os/Messenger;
    //   183: aload_1
    //   184: invokevirtual 275	android/os/Messenger:send	(Landroid/os/Message;)V
    //   187: return
    //   188: astore_1
    //   189: aload_1
    //   190: invokevirtual 278	java/lang/Exception:printStackTrace	()V
    //   193: return
    //   194: astore_3
    //   195: aload_2
    //   196: monitorexit
    //   197: aload_3
    //   198: athrow
    //   199: astore_2
    //   200: goto -63 -> 137
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	203	0	this	k
    //   0	203	1	paramMessage	Message
    //   199	1	2	localException	Exception
    //   194	4	3	localObject2	Object
    // Exception table:
    //   from	to	target	type
    //   156	187	188	java/lang/Exception
    //   52	76	194	finally
    //   76	113	194	finally
    //   113	135	194	finally
    //   135	137	194	finally
    //   195	197	194	finally
    //   45	52	199	java/lang/Exception
    //   197	199	199	java/lang/Exception
  }
  
  private void d(Message paramMessage)
  {
    if ((paramMessage == null) || (paramMessage.obj == null)) {
      return;
    }
    this.v = ((d)paramMessage.obj);
  }
  
  private void e()
  {
    Message localMessage = Message.obtain(null, 28);
    try
    {
      localMessage.replyTo = this.h;
      this.f.send(localMessage);
      return;
    }
    catch (Exception localException)
    {
      localException.printStackTrace();
    }
  }
  
  private void e(Message paramMessage)
  {
    if ((paramMessage == null) || (paramMessage.obj == null)) {
      return;
    }
    paramMessage = (d)paramMessage.obj;
    if (this.j == null) {
      this.j = new ArrayList();
    }
    this.j.add(paramMessage);
  }
  
  private void f()
  {
    if (this.d == true) {
      return;
    }
    bh.b();
    this.b = this.e.getPackageName();
    this.w = (this.b + "_bdls_v2.9");
    d();
    Intent localIntent = new Intent(this.e, f.class);
    try
    {
      localIntent.putExtra("debug_dev", this.C);
      if (this.c == null) {
        this.c = new o();
      }
      if (this.c.a() == q.c) {
        this.c.a(false);
      }
      localIntent.putExtra("cache_exception", this.c.o);
      localIntent.putExtra("kill_process", this.c.p);
      try
      {
        this.e.bindService(localIntent, this.D, 1);
        return;
      }
      catch (Exception localException1)
      {
        localException1.printStackTrace();
        this.d = false;
        return;
      }
    }
    catch (Exception localException2)
    {
      for (;;) {}
    }
  }
  
  private void f(Message paramMessage)
  {
    if ((paramMessage == null) || (paramMessage.obj == null)) {}
    do
    {
      return;
      paramMessage = (d)paramMessage.obj;
    } while ((this.j == null) || (!this.j.contains(paramMessage)));
    this.j.remove(paramMessage);
  }
  
  /* Error */
  private void g()
  {
    // Byte code:
    //   0: aload_0
    //   1: getfield 69	com/baidu/location/k:d	Z
    //   4: ifeq +10 -> 14
    //   7: aload_0
    //   8: getfield 73	com/baidu/location/k:f	Landroid/os/Messenger;
    //   11: ifnonnull +4 -> 15
    //   14: return
    //   15: aconst_null
    //   16: bipush 12
    //   18: invokestatic 265	android/os/Message:obtain	(Landroid/os/Handler;I)Landroid/os/Message;
    //   21: astore_1
    //   22: aload_1
    //   23: aload_0
    //   24: getfield 87	com/baidu/location/k:h	Landroid/os/Messenger;
    //   27: putfield 268	android/os/Message:replyTo	Landroid/os/Messenger;
    //   30: aload_0
    //   31: getfield 73	com/baidu/location/k:f	Landroid/os/Messenger;
    //   34: aload_1
    //   35: invokevirtual 275	android/os/Messenger:send	(Landroid/os/Message;)V
    //   38: aload_0
    //   39: getfield 71	com/baidu/location/k:e	Landroid/content/Context;
    //   42: aload_0
    //   43: getfield 136	com/baidu/location/k:D	Landroid/content/ServiceConnection;
    //   46: invokevirtual 366	android/content/Context:unbindService	(Landroid/content/ServiceConnection;)V
    //   49: aload_0
    //   50: getfield 103	com/baidu/location/k:q	Ljava/lang/Object;
    //   53: astore_1
    //   54: aload_1
    //   55: monitorenter
    //   56: aload_0
    //   57: getfield 97	com/baidu/location/k:n	Z
    //   60: iconst_1
    //   61: if_icmpne +19 -> 80
    //   64: aload_0
    //   65: getfield 80	com/baidu/location/k:g	Lcom/baidu/location/m;
    //   68: aload_0
    //   69: getfield 99	com/baidu/location/k:o	Lcom/baidu/location/n;
    //   72: invokevirtual 251	com/baidu/location/m:removeCallbacks	(Ljava/lang/Runnable;)V
    //   75: aload_0
    //   76: iconst_0
    //   77: putfield 97	com/baidu/location/k:n	Z
    //   80: aload_1
    //   81: monitorexit
    //   82: aload_0
    //   83: getfield 109	com/baidu/location/k:t	Lcom/baidu/location/cs;
    //   86: invokevirtual 368	com/baidu/location/cs:a	()V
    //   89: aload_0
    //   90: aconst_null
    //   91: putfield 73	com/baidu/location/k:f	Landroid/os/Messenger;
    //   94: invokestatic 370	com/baidu/location/bh:c	()V
    //   97: aload_0
    //   98: iconst_0
    //   99: putfield 117	com/baidu/location/k:y	Z
    //   102: aload_0
    //   103: iconst_0
    //   104: putfield 69	com/baidu/location/k:d	Z
    //   107: return
    //   108: astore_1
    //   109: aload_1
    //   110: invokevirtual 278	java/lang/Exception:printStackTrace	()V
    //   113: goto -75 -> 38
    //   116: astore_2
    //   117: aload_1
    //   118: monitorexit
    //   119: aload_2
    //   120: athrow
    //   121: astore_2
    //   122: goto -42 -> 80
    //   125: astore_1
    //   126: goto -77 -> 49
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	129	0	this	k
    //   108	10	1	localException1	Exception
    //   125	1	1	localException2	Exception
    //   116	4	2	localObject2	Object
    //   121	1	2	localException3	Exception
    // Exception table:
    //   from	to	target	type
    //   30	38	108	java/lang/Exception
    //   56	80	116	finally
    //   80	82	116	finally
    //   117	119	116	finally
    //   56	80	121	java/lang/Exception
    //   38	49	125	java/lang/Exception
  }
  
  private void g(Message arg1)
  {
    if (this.f == null) {
      return;
    }
    Message localMessage;
    if (((System.currentTimeMillis() - this.r > 3000L) || (!this.c.h)) && ((!this.y) || (System.currentTimeMillis() - this.s > 20000L))) {
      localMessage = Message.obtain(null, 22);
    }
    try
    {
      localMessage.replyTo = this.h;
      localMessage.arg1 = ???.arg1;
      this.f.send(localMessage);
      this.a = System.currentTimeMillis();
      this.l = true;
      synchronized (this.q)
      {
        if ((this.c != null) && (this.c.d >= 1000) && (!this.n))
        {
          if (this.o == null) {
            this.o = new n(this, null);
          }
          this.g.postDelayed(this.o, this.c.d);
          this.n = true;
        }
        return;
      }
    }
    catch (Exception ???)
    {
      for (;;)
      {
        ???.printStackTrace();
      }
    }
  }
  
  private Bundle h()
  {
    if (this.c == null) {
      return null;
    }
    Bundle localBundle = new Bundle();
    localBundle.putString("packName", this.b);
    localBundle.putString("prodName", this.c.f);
    localBundle.putString("coorType", this.c.a);
    localBundle.putString("addrType", this.c.b);
    localBundle.putBoolean("openGPS", this.c.c);
    localBundle.putBoolean("location_change_notify", this.c.h);
    localBundle.putInt("scanSpan", this.c.d);
    localBundle.putInt("timeOut", this.c.e);
    localBundle.putInt("priority", this.c.g);
    localBundle.putBoolean("map", this.z.booleanValue());
    localBundle.putBoolean("import", this.A.booleanValue());
    localBundle.putBoolean("needDirect", this.c.q);
    return localBundle;
  }
  
  private void h(Message paramMessage)
  {
    paramMessage = paramMessage.getData();
    paramMessage.setClassLoader(BDLocation.class.getClassLoader());
    paramMessage = (BDLocation)paramMessage.getParcelable("locStr");
    if ((this.v == null) || ((this.c != null) && (this.c.b()) && (paramMessage.e() == 65))) {
      return;
    }
    this.v.onReceiveLocation(paramMessage);
  }
  
  private void i()
  {
    if (this.f == null) {
      return;
    }
    Message localMessage = Message.obtain(null, 22);
    try
    {
      localMessage.replyTo = this.h;
      this.f.send(localMessage);
      return;
    }
    catch (Exception localException)
    {
      localException.printStackTrace();
    }
  }
  
  public void a()
  {
    this.g.obtainMessage(11).sendToTarget();
  }
  
  public void a(d paramD)
  {
    Message localMessage = this.g.obtainMessage(8);
    localMessage.obj = paramD;
    localMessage.sendToTarget();
  }
  
  public void a(o paramO)
  {
    o localO;
    if (paramO == null) {
      localO = new o();
    }
    for (;;)
    {
      paramO = this.g.obtainMessage(3);
      paramO.obj = localO;
      paramO.sendToTarget();
      return;
      switch (paramO.g)
      {
      default: 
        localO = paramO;
        break;
      case 1: 
        localO = paramO;
        if (paramO.d != 0)
        {
          localO = paramO;
          if (paramO.d < 1000)
          {
            Log.w("baidu_location_service", String.format("scanSpan time %d less than 1 second, location services may not star", new Object[] { Integer.valueOf(paramO.d) }));
            localO = paramO;
          }
        }
        break;
      case 3: 
        if ((paramO.d != 0) && (paramO.d < 1000))
        {
          Log.w("baidu_location_service", String.format("scanSpan time %d less than 1 second, location services may not star", new Object[] { Integer.valueOf(paramO.d) }));
          localO = paramO;
        }
        else
        {
          localO = paramO;
          if (paramO.d == 0)
          {
            paramO.d = 1000;
            localO = paramO;
          }
        }
        break;
      case 2: 
        localO = paramO;
        if (paramO.d > 1000)
        {
          localO = paramO;
          if (paramO.d < 3000)
          {
            paramO.d = 3000;
            Log.w("baidu_location_service", String.format("scanSpan time %d less than 3 second, location services may not star", new Object[] { Integer.valueOf(paramO.d) }));
            localO = paramO;
          }
        }
        break;
      }
    }
  }
  
  public void b()
  {
    this.g.obtainMessage(1).sendToTarget();
  }
  
  public void b(d paramD)
  {
    if (paramD == null) {
      throw new IllegalStateException("please set a non-null listener");
    }
    Message localMessage = this.g.obtainMessage(5);
    localMessage.obj = paramD;
    localMessage.sendToTarget();
  }
  
  public void c()
  {
    g();
  }
  
  public void c(d paramD)
  {
    if (paramD == null) {
      throw new IllegalStateException("please set a non-null listener");
    }
    Message localMessage = this.g.obtainMessage(6);
    localMessage.obj = paramD;
    localMessage.sendToTarget();
  }
  
  public String d()
  {
    this.x = ci.b(this.e);
    if (TextUtils.isEmpty(this.x)) {
      throw new IllegalStateException("please setting key from Manifest.xml");
    }
    return String.format("KEY=%s;SHA1=%s", new Object[] { this.x, ci.a(this.e) });
  }
}
