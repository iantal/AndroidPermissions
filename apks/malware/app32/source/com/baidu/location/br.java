package com.baidu.location;

import android.os.Bundle;
import android.os.Message;
import android.os.Messenger;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.Locale;

class br
  implements bb
{
  private static br a = null;
  private ArrayList b = null;
  private boolean c = false;
  private boolean d = false;
  
  private br() {}
  
  public static br a()
  {
    if (a == null) {
      a = new br();
    }
    return a;
  }
  
  private bs a(Messenger paramMessenger)
  {
    if (this.b == null) {
      return null;
    }
    Iterator localIterator = this.b.iterator();
    while (localIterator.hasNext())
    {
      bs localBs = (bs)localIterator.next();
      if (localBs.b.equals(paramMessenger)) {
        return localBs;
      }
    }
    return null;
  }
  
  private void a(bs paramBs)
  {
    if (paramBs == null) {
      return;
    }
    if (a(paramBs.b) != null)
    {
      bs.a(paramBs, 14);
      return;
    }
    this.b.add(paramBs);
    bs.a(paramBs, 13);
  }
  
  private void e()
  {
    f();
    d();
  }
  
  private void f()
  {
    Iterator localIterator = this.b.iterator();
    boolean bool1 = false;
    boolean bool2 = false;
    if (localIterator.hasNext())
    {
      bs localBs = (bs)localIterator.next();
      if (localBs.c.c) {
        bool2 = true;
      }
      if (!localBs.c.h) {
        break label89;
      }
      bool1 = true;
    }
    label89:
    for (;;)
    {
      break;
      bh.a = bool1;
      if (this.c != bool2)
      {
        this.c = bool2;
        cl.a().a(this.c);
      }
      return;
    }
  }
  
  public void a(Message paramMessage)
  {
    if ((paramMessage == null) || (paramMessage.replyTo == null)) {
      return;
    }
    a(new bs(this, paramMessage));
    e();
  }
  
  public void a(BDLocation paramBDLocation)
  {
    Object localObject = new ArrayList();
    Iterator localIterator = this.b.iterator();
    while (localIterator.hasNext())
    {
      bs localBs = (bs)localIterator.next();
      localBs.a(paramBDLocation);
      if (localBs.d > 4) {
        ((ArrayList)localObject).add(localBs);
      }
    }
    if ((localObject != null) && (((ArrayList)localObject).size() > 0))
    {
      paramBDLocation = ((ArrayList)localObject).iterator();
      while (paramBDLocation.hasNext())
      {
        localObject = (bs)paramBDLocation.next();
        this.b.remove(localObject);
      }
    }
  }
  
  public void a(BDLocation paramBDLocation, int paramInt)
  {
    Object localObject = new ArrayList();
    Iterator localIterator = this.b.iterator();
    while (localIterator.hasNext())
    {
      bs localBs = (bs)localIterator.next();
      localBs.a(paramBDLocation, paramInt);
      if (localBs.d > 4) {
        ((ArrayList)localObject).add(localBs);
      }
    }
    if ((localObject != null) && (((ArrayList)localObject).size() > 0))
    {
      paramBDLocation = ((ArrayList)localObject).iterator();
      while (paramBDLocation.hasNext())
      {
        localObject = (bs)paramBDLocation.next();
        this.b.remove(localObject);
      }
    }
  }
  
  public void a(BDLocation paramBDLocation, Message paramMessage)
  {
    if ((paramBDLocation == null) || (paramMessage == null)) {}
    do
    {
      do
      {
        return;
        paramMessage = a(paramMessage.replyTo);
      } while (paramMessage == null);
      paramMessage.a(paramBDLocation);
    } while (paramMessage.d <= 4);
    this.b.remove(paramMessage);
  }
  
  public void a(String paramString)
  {
    BDLocation localBDLocation = new BDLocation(paramString);
    ak.a().a = paramString;
    paramString = this.b.iterator();
    while (paramString.hasNext()) {
      ((bs)paramString.next()).b(localBDLocation);
    }
  }
  
  public void b()
  {
    this.b.clear();
    e();
  }
  
  public void b(Message paramMessage)
  {
    paramMessage = a(paramMessage.replyTo);
    if (paramMessage != null) {
      this.b.remove(paramMessage);
    }
    bg.a().c();
    ab.a().c();
    bo.a().c();
    e();
  }
  
  public String c()
  {
    Object localObject = new StringBuffer(256);
    if (this.b.isEmpty()) {
      return "&prod=" + bg.h + ":" + bg.g;
    }
    bs localBs = (bs)this.b.get(0);
    if (localBs.c.f != null) {
      ((StringBuffer)localObject).append(localBs.c.f);
    }
    if (localBs.a != null)
    {
      ((StringBuffer)localObject).append(":");
      ((StringBuffer)localObject).append(localBs.a);
      ((StringBuffer)localObject).append("|");
    }
    localObject = ((StringBuffer)localObject).toString();
    if ((localObject != null) && (!((String)localObject).equals(""))) {
      return "&prod=" + (String)localObject;
    }
    return null;
  }
  
  public boolean c(Message paramMessage)
  {
    boolean bool2 = false;
    bs localBs = a(paramMessage.replyTo);
    if (localBs == null) {
      return false;
    }
    int i = localBs.c.d;
    localBs.c.d = paramMessage.getData().getInt("scanSpan", localBs.c.d);
    boolean bool1;
    String str;
    o localO;
    if (localBs.c.d < 1000)
    {
      bo.a().e();
      bg.a().c();
      ab.a().c();
      cl.a().k();
      bool1 = bool2;
      if (localBs.c.d > 999)
      {
        bool1 = bool2;
        if (i < 1000)
        {
          bool1 = true;
          if (localBs.c.q)
          {
            ab.a().a(localBs.c.q);
            ab.a().b();
          }
          bg.a().b();
        }
      }
      localBs.c.c = paramMessage.getData().getBoolean("openGPS", localBs.c.c);
      str = paramMessage.getData().getString("coorType");
      localO = localBs.c;
      if ((str == null) || (str.equals(""))) {
        break label390;
      }
      label216:
      localO.a = str;
      str = paramMessage.getData().getString("addrType");
      localO = localBs.c;
      if ((str == null) || (str.equals(""))) {
        break label403;
      }
    }
    for (;;)
    {
      localO.b = str;
      if (!bh.f.equals(localBs.c.b)) {
        af.b().g();
      }
      bh.f = localBs.c.b;
      localBs.c.e = paramMessage.getData().getInt("timeOut", localBs.c.e);
      localBs.c.h = paramMessage.getData().getBoolean("location_change_notify", localBs.c.h);
      localBs.c.g = paramMessage.getData().getInt("priority", localBs.c.g);
      e();
      return bool1;
      bo.a().d();
      break;
      label390:
      str = localBs.c.a;
      break label216;
      label403:
      str = localBs.c.b;
    }
  }
  
  public String d(Message paramMessage)
  {
    Object localObject2 = null;
    Object localObject1 = localObject2;
    if (paramMessage != null)
    {
      if (paramMessage.replyTo != null) {
        break label19;
      }
      localObject1 = localObject2;
    }
    label19:
    bs localBs;
    do
    {
      do
      {
        return localObject1;
        localBs = a(paramMessage.replyTo);
        localObject1 = localObject2;
      } while (localBs == null);
      localBs.c.m = paramMessage.getData().getInt("num", localBs.c.m);
      localBs.c.l = paramMessage.getData().getFloat("distance", localBs.c.l);
      localBs.c.k = paramMessage.getData().getBoolean("extraInfo", localBs.c.k);
      localBs.c.j = true;
      paramMessage = String.format(Locale.CHINA, "&poi=%.1f|%d", new Object[] { Float.valueOf(localBs.c.l), Integer.valueOf(localBs.c.m) });
      localObject1 = paramMessage;
    } while (!localBs.c.k);
    return paramMessage + "|1";
  }
  
  public void d()
  {
    Iterator localIterator = this.b.iterator();
    while (localIterator.hasNext()) {
      ((bs)localIterator.next()).a();
    }
  }
  
  public int e(Message paramMessage)
  {
    if ((paramMessage == null) || (paramMessage.replyTo == null)) {}
    do
    {
      return 1;
      paramMessage = a(paramMessage.replyTo);
    } while ((paramMessage == null) || (paramMessage.c == null));
    return paramMessage.c.g;
  }
}
