package com.jiexinhongye.libforztool.android.download;

import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.graphics.Bitmap;
import android.os.Handler;
import android.os.Looper;
import android.widget.RemoteViews;
import com.jiexinhongye.libforztool.android.ResHelper;
import com.jiexinhongye.libforztool.ztool.DefaultZProgressListener;
import com.jiexinhongye.libforztool.ztool.DefaultZProgressListener.SmallTool;

public abstract class NotificationZProgressListener
  extends DefaultZProgressListener
{
  int a;
  private String b = "ztool_download_noti";
  private RemoteViews c;
  private Handler d = new Handler(Looper.getMainLooper());
  private Bitmap e;
  private NotificationManager f = (NotificationManager)getContext().getSystemService("notification");
  private PendingIntent g = getPendingIntent();
  private String h;
  private String i;
  private Notification j;
  private int k;
  private Runnable l;
  
  public NotificationZProgressListener()
  {
    getTaskName();
    this.h = getTaskTitle();
    this.i = getTaskTicker();
    this.a = getTaskId();
    Context localContext = getContext();
    this.c = new RemoteViews(localContext.getPackageName(), ResHelper.getLayoutId(localContext, this.b));
    this.c = this.c;
    this.e = getIcon();
    this.j = new Notification(17301646, this.h, System.currentTimeMillis());
    this.j.tickerText = this.i;
    this.j.contentView = this.c;
    this.j.flags = 18;
    this.c.setTextViewText(ResHelper.getId(getContext(), "noti_title"), getTaskName());
    if (this.e == null) {
      this.c.setImageViewResource(ResHelper.getId(getContext(), "noti_image"), ResHelper.getDrawableId(getContext(), "ztool_download_default"));
    }
    this.l = new c(this);
  }
  
  public abstract Context getContext();
  
  public abstract Bitmap getIcon();
  
  public abstract PendingIntent getPendingIntent();
  
  public abstract int getStepInt();
  
  public abstract int getTaskId();
  
  public abstract String getTaskName();
  
  public abstract String getTaskTicker();
  
  public abstract String getTaskTitle();
  
  public void onPercentChange(int paramInt) {}
  
  public abstract void onProgressChange(long paramLong1, long paramLong2);
  
  public void updateNotification(long paramLong1, long paramLong2)
  {
    int m = getTool().getPercent(paramLong1, paramLong2);
    if (getTool().changePercent(m, getStepInt()))
    {
      this.k = m;
      this.d.post(this.l);
      onPercentChange(m);
    }
  }
}
