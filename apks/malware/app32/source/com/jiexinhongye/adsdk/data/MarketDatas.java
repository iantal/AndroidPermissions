package com.jiexinhongye.adsdk.data;

import android.content.Context;
import android.widget.BaseAdapter;
import android.widget.Toast;
import com.jiexinhongye.adsdk.DataUrl;
import com.jiexinhongye.adsdk.PreData;
import com.jiexinhongye.adsdk.model.AppADItem;
import com.jiexinhongye.libforztool.android.Zlog;
import com.jiexinhongye.libforztool.ztool.JsonTool;
import com.jiexinhongye.libforztool.ztool.ZNetTask;
import java.util.ArrayList;
import java.util.List;
import org.json.JSONException;
import org.json.JSONObject;

public class MarketDatas
  extends DataHelper
{
  private Context a;
  private int b = 8;
  private int c = 1;
  
  public MarketDatas(BaseAdapter paramBaseAdapter, Context paramContext)
  {
    super(paramBaseAdapter, new ArrayList());
    this.a = paramContext;
  }
  
  private static ArrayList a(String paramString)
  {
    String str = ZNetTask.getStr("http://115.28.222.200:8080/AdShow/get_ads.do", paramString, 0);
    Zlog.syso("from data back:" + str + ",param:" + paramString);
    if (str != null) {
      try
      {
        paramString = new JSONObject(str);
        if ("200".equals(paramString.getString("state")))
        {
          paramString = (ArrayList)JsonTool.getListModeFromJson(paramString.getString("data"), AppADItem.class, new ArrayList());
          return paramString;
        }
      }
      catch (JSONException paramString)
      {
        paramString.printStackTrace();
      }
    }
    for (;;)
    {
      return null;
      Zlog.syso("from market data info is null");
    }
  }
  
  public void onDataChange()
  {
    super.onDataChange();
  }
  
  public void onLoadAllCallMoreMethod()
  {
    super.onLoadAllCallMoreMethod();
    Toast.makeText(this.a, "已加载所有数据", 0).show();
  }
  
  public List onMore(List paramList)
  {
    if (paramList.size() > 0) {
      paramList = (AppADItem)paramList.get(paramList.size() - 1);
    }
    for (paramList = paramList.getId();; paramList = "0")
    {
      paramList = new StringBuilder(String.valueOf(DataUrl.makeBaseParams(this.a))).append("&showType=market").append("&lastId=").append(paramList).append("&showedADs=").append(PreData.get("market")).append("&count=").append(this.b).append("&page=");
      int i = this.c + 1;
      this.c = i;
      ArrayList localArrayList = a(i);
      if (localArrayList != null)
      {
        paramList = localArrayList;
        if (localArrayList.size() == 0)
        {
          Zlog.syso("set loadall");
          setLoadedAll(true);
        }
      }
      else
      {
        paramList = null;
      }
      return paramList;
    }
  }
  
  public List onload()
  {
    this.c = 1;
    return a(DataUrl.makeBaseParams(this.a) + "&showType=market" + "&lastId=" + "0" + "&showedADs=" + PreData.get("market") + "&count=" + this.b + "&page=0");
  }
}
