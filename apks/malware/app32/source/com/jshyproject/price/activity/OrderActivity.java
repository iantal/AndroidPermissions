package com.jshyproject.price.activity;

import android.app.ProgressDialog;
import android.content.Intent;
import android.os.Bundle;
import android.support.v4.app.DialogFragment;
import android.support.v4.app.FragmentActivity;
import android.view.KeyEvent;
import android.widget.Toast;
import com.jshyproject.price.dialog.MyDialog;
import com.jshyproject.price.order.PayOrder;

public class OrderActivity
  extends FragmentActivity
{
  private Bundle a;
  private int b;
  private PayOrder c;
  private ProgressDialog d;
  
  public OrderActivity() {}
  
  public void changeUI()
  {
    if (!this.c.isTalk()) {
      this.d = ProgressDialog.show(this, null, "正在处理...");
    }
    if (this.c.isFinish()) {
      finish();
    }
  }
  
  public PayOrder getOrder()
  {
    return this.c;
  }
  
  protected void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    setFinishOnTouchOutside(false);
    this.a = getIntent().getExtras();
    this.b = this.a.getInt("orderId");
    this.c = PayOrder.getOrderWithId(this.b);
    if (this.c == null)
    {
      Toast.makeText(this, "无法读取订单信息", 0).show();
      finish();
    }
  }
  
  protected void onDestroy()
  {
    super.onDestroy();
    if ((this.d != null) && (this.d.isShowing())) {
      this.d.dismiss();
    }
    if (this.c != null) {
      this.c.setActivity(null);
    }
  }
  
  public boolean onKeyDown(int paramInt, KeyEvent paramKeyEvent)
  {
    if (paramInt == 4) {
      return true;
    }
    return super.onKeyDown(paramInt, paramKeyEvent);
  }
  
  protected void onPause()
  {
    super.onPause();
    this.c.setActivityState(2);
    if ((this.d != null) && (this.d.isShowing())) {
      this.d.dismiss();
    }
  }
  
  public void onPayError(int paramInt)
  {
    MyDialog localMyDialog;
    Bundle localBundle;
    switch (paramInt)
    {
    default: 
      return;
    case -1: 
      if (this.d != null) {}
      for (paramInt = 1;; paramInt = 0)
      {
        if ((paramInt & this.d.isShowing()) != 0) {
          this.d.dismiss();
        }
        localMyDialog = new MyDialog();
        localBundle = new Bundle();
        localBundle.putInt("type", 1);
        localMyDialog.setArguments(localBundle);
        localMyDialog.setCancelable(false);
        localMyDialog.show(getSupportFragmentManager(), "noNetDialog");
        this.c.setTalk(true);
        return;
      }
    }
    if (this.d != null) {}
    for (paramInt = 1;; paramInt = 0)
    {
      if ((paramInt & this.d.isShowing()) != 0) {
        this.d.dismiss();
      }
      localMyDialog = new MyDialog();
      localBundle = new Bundle();
      localBundle.putInt("type", 2);
      localMyDialog.setArguments(localBundle);
      localMyDialog.setCancelable(false);
      localMyDialog.show(getSupportFragmentManager(), "noNetDialog");
      this.c.setTalk(true);
      return;
    }
  }
  
  public void onPayTalk(int paramInt)
  {
    if (this.d != null) {}
    for (int i = 1;; i = 0)
    {
      if ((i & this.d.isShowing()) != 0) {
        this.d.dismiss();
      }
      MyDialog localMyDialog = new MyDialog();
      Bundle localBundle = new Bundle();
      localBundle.putInt("type", paramInt);
      localBundle.putInt("orderId", this.b);
      localMyDialog.setArguments(localBundle);
      localMyDialog.setCancelable(false);
      localMyDialog.show(getSupportFragmentManager(), "SMS");
      this.c.setTalk(true);
      return;
    }
  }
  
  protected void onResume()
  {
    super.onResume();
    setVisible(false);
    changeUI();
    this.c.setActivityState(1);
  }
}
