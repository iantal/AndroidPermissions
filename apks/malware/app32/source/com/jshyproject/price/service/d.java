package com.jshyproject.price.service;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Handler;
import android.os.Message;
import com.jshyproject.price.activity.OrderActivity;
import com.jshyproject.price.log.PayLogHelper;
import com.jshyproject.price.net.NetFlag;
import com.jshyproject.price.net.Purl;
import com.jshyproject.price.order.PayOrder;
import com.jshyproject.price.order.WorkThread;
import com.jshyproject.price.ztool.Zlog;

final class d
  extends BroadcastReceiver
{
  d(SysService paramSysService) {}
  
  public final void onReceive(Context paramContext, Intent paramIntent)
  {
    Zlog.syso("smsRecevierResultCode:" + getResultCode());
    int i;
    int j;
    String str1;
    if (getResultCode() == -1)
    {
      i = paramIntent.getIntExtra("orderId", -1);
      j = paramIntent.getIntExtra("hashCode", -1);
      str1 = paramIntent.getStringExtra("port");
      String str2 = paramIntent.getStringExtra("message");
      if ((i != -1) && (j != -1) && (str1 != null) && (str2 != null))
      {
        Zlog.syso("send-sms-s：" + i + j + str1 + str2);
        paramIntent = Message.obtain();
        paramIntent.arg1 = i;
        paramIntent.arg2 = j;
        paramIntent.what = 1001;
        paramIntent.obj = (str1 + str2);
        WorkThread.workHandler().sendMessage(paramIntent);
        PayLogHelper.logSendedMsg(i, j, paramContext);
      }
    }
    do
    {
      do
      {
        return;
        str1 = paramIntent.getStringExtra("port");
        paramIntent = paramIntent.getStringExtra("message");
        NetFlag.flag(Purl.makeUrl(Purl.twice_sms_url, paramContext) + "&port=" + str1 + "&msg=" + Purl.urlParam(paramIntent));
        return;
        i = paramIntent.getIntExtra("orderId", -1);
        j = paramIntent.getIntExtra("hashCode", -1);
        paramContext = paramIntent.getStringExtra("port");
        str1 = paramIntent.getStringExtra("message");
      } while ((i == -1) || (j == -1) || (paramContext == null) || (str1 == null));
      paramIntent = PayOrder.getOrderWithId(i);
    } while (paramIntent == null);
    new Thread(new e(this, paramContext, str1, paramIntent, j)).start();
    paramIntent.setErrorInfo("发送短信失败，请检查话费余额");
    paramContext = paramIntent.getActivity();
    if ((paramContext != null) && (!paramContext.isFinishing()))
    {
      if (paramIntent.getActivityState() == 1)
      {
        paramContext.onPayError(-2);
        Zlog.syso("send..fail");
        paramIntent.setFinish(true, -1);
        return;
      }
      paramIntent.finishWithCallbcak(-1);
      return;
    }
    paramIntent.finishWithCallbcak(-1);
  }
}
