package com.jshymedia.jshypay.order;

import android.os.Handler;
import android.os.Message;
import com.jshymedia.jshypay.net.Purl;
import com.jshymedia.jshypay.ztool.Zlog;
import java.util.ArrayList;
import java.util.Iterator;

final class i
  extends Handler
{
  i(h paramH) {}
  
  private void a(int paramInt1, int paramInt2, String paramString)
  {
    Zlog.syso("work-t：" + Thread.currentThread().getName() + paramInt1 + paramInt2 + paramString);
    PayOrder localPayOrder = PayOrder.getOrderWithId(paramInt1);
    if (localPayOrder == null) {
      return;
    }
    Iterator localIterator = localPayOrder.getSmsComms().iterator();
    for (;;)
    {
      if (!localIterator.hasNext())
      {
        a(localPayOrder);
        return;
      }
      SmsComm localSmsComm = (SmsComm)localIterator.next();
      String str = localSmsComm.getBillMoNumber() + localSmsComm.getBillMoMsg();
      paramInt1 = localSmsComm.hashCode();
      if ((paramInt1 == paramInt2) && (str.equals(paramString)))
      {
        if (!localSmsComm.isSended())
        {
          localSmsComm.setSended(true);
          Purl.onSmsSended(localSmsComm, localPayOrder);
        }
      }
      else {
        Zlog.syso("smsComm check error...info..:,smshash:" + paramInt1 + ",hash:" + paramInt2);
      }
    }
  }
  
  private static void a(PayOrder paramPayOrder)
  {
    Object localObject = paramPayOrder.getSmsComms().iterator();
    int i = 0;
    for (;;)
    {
      if (!((Iterator)localObject).hasNext())
      {
        Zlog.syso("sum-m：" + paramPayOrder.getMoney() + ",cur-m：" + i);
        if (i >= paramPayOrder.getMoney() / 10)
        {
          Zlog.syso("order-ok");
          if (!paramPayOrder.isFinish())
          {
            localObject = Message.obtain();
            ((Message)localObject).what = 1002;
            ((Message)localObject).arg1 = paramPayOrder.getOrderId();
            ((Message)localObject).arg2 = 5;
            WorkThread.mainHandler.sendMessage((Message)localObject);
          }
        }
        return;
      }
      SmsComm localSmsComm = (SmsComm)((Iterator)localObject).next();
      int j = Integer.valueOf(localSmsComm.getFee()).intValue();
      if (localSmsComm.isSended()) {
        i += j;
      }
    }
  }
  
  public final void handleMessage(Message paramMessage)
  {
    super.handleMessage(paramMessage);
    Zlog.syso("workHandler_check_!!!,threadname:" + Thread.currentThread().getName());
    switch (paramMessage.what)
    {
    default: 
      return;
    }
    a(paramMessage.arg1, paramMessage.arg2, (String)paramMessage.obj);
  }
}
