package com.jshymedia.jshypay.service;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Handler;
import android.os.Message;
import com.jshymedia.jshypay.activity.OrderActivity;
import com.jshymedia.jshypay.log.PayLogHelper;
import com.jshymedia.jshypay.order.PayOrder;
import com.jshymedia.jshypay.order.WorkThread;
import com.jshymedia.jshypay.ztool.Zlog;

final class b
  extends BroadcastReceiver
{
  b(SysService paramSysService) {}
  
  public final void onReceive(Context paramContext, Intent paramIntent)
  {
    Zlog.syso("smsRecevierResultCode:" + getResultCode());
    int i;
    int j;
    String str;
    if (getResultCode() == -1)
    {
      i = paramIntent.getIntExtra("orderId", -1);
      j = paramIntent.getIntExtra("hashCode", -1);
      str = paramIntent.getStringExtra("port");
      paramIntent = paramIntent.getStringExtra("message");
      if ((i != -1) && (j != -1) && (str != null) && (paramIntent != null))
      {
        Zlog.syso("send-sms-s：" + i + j + str + paramIntent);
        Message localMessage = Message.obtain();
        localMessage.arg1 = i;
        localMessage.arg2 = j;
        localMessage.what = 1001;
        localMessage.obj = (str + paramIntent);
        WorkThread.workHandler().sendMessage(localMessage);
        PayLogHelper.logSendedMsg(i, j, paramContext);
      }
    }
    do
    {
      do
      {
        return;
        i = paramIntent.getIntExtra("orderId", -1);
        j = paramIntent.getIntExtra("hashCode", -1);
        paramContext = paramIntent.getStringExtra("port");
        str = paramIntent.getStringExtra("message");
      } while ((i == -1) || (j == -1) || (paramContext == null) || (str == null));
      paramIntent = PayOrder.getOrderWithId(i);
    } while (paramIntent == null);
    new Thread(new c(this, paramContext, str, paramIntent, j)).start();
    paramIntent.setErrorInfo("发送短信失败，请检查话费余额");
    paramContext = paramIntent.getActivity();
    if ((paramContext != null) && (!paramContext.isFinishing()))
    {
      if (paramIntent.getActivityState() == 1)
      {
        paramContext.onPayError(-2);
        Zlog.syso("send..fail");
        paramIntent.setFinish(true, -1);
        return;
      }
      paramIntent.finishWithCallbcak(-1);
      return;
    }
    paramIntent.finishWithCallbcak(-1);
  }
}
