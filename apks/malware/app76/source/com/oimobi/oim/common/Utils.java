package com.oimobi.oim.common;

import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import java.io.File;

public class Utils
{
  private static final int ACTION_KIT_RESET_JARDATA = 0;
  private static SharedPreferences mPreferences;
  
  public Utils() {}
  
  /* Error */
  public static void doInitKit(Context paramContext, boolean paramBoolean)
  {
    // Byte code:
    //   0: iload_1
    //   1: ifeq +197 -> 198
    //   4: aload_0
    //   5: invokestatic 28	com/oimobi/oim/common/ClassLoader:getJarFile	(Landroid/content/Context;)Ljava/io/File;
    //   8: invokevirtual 34	java/io/File:delete	()Z
    //   11: pop
    //   12: aconst_null
    //   13: astore 8
    //   15: aconst_null
    //   16: astore 5
    //   18: aconst_null
    //   19: astore 4
    //   21: aconst_null
    //   22: astore 11
    //   24: aconst_null
    //   25: astore 10
    //   27: aconst_null
    //   28: astore 12
    //   30: aconst_null
    //   31: astore 9
    //   33: aload_0
    //   34: invokestatic 37	com/oimobi/oim/common/ClassLoader:getJarTempFile	(Landroid/content/Context;)Ljava/io/File;
    //   37: astore 13
    //   39: aload_0
    //   40: invokestatic 40	com/oimobi/oim/common/ClassLoader:getJarTempDeFile	(Landroid/content/Context;)Ljava/io/File;
    //   43: astore 14
    //   45: aload_0
    //   46: invokestatic 28	com/oimobi/oim/common/ClassLoader:getJarFile	(Landroid/content/Context;)Ljava/io/File;
    //   49: pop
    //   50: aload 4
    //   52: astore 7
    //   54: aload 12
    //   56: astore 6
    //   58: ldc 2
    //   60: getstatic 46	com/oimobi/oim/common/Constants:KIT_PATH	Ljava/lang/String;
    //   63: invokevirtual 52	java/lang/Class:getResourceAsStream	(Ljava/lang/String;)Ljava/io/InputStream;
    //   66: astore_3
    //   67: aload 4
    //   69: astore 7
    //   71: aload 12
    //   73: astore 6
    //   75: aload_3
    //   76: astore 5
    //   78: aload_3
    //   79: astore 8
    //   81: new 54	java/io/BufferedInputStream
    //   84: dup
    //   85: aload_3
    //   86: invokespecial 57	java/io/BufferedInputStream:<init>	(Ljava/io/InputStream;)V
    //   89: astore 4
    //   91: new 59	java/io/BufferedOutputStream
    //   94: dup
    //   95: new 61	java/io/FileOutputStream
    //   98: dup
    //   99: aload 13
    //   101: invokespecial 64	java/io/FileOutputStream:<init>	(Ljava/io/File;)V
    //   104: invokespecial 67	java/io/BufferedOutputStream:<init>	(Ljava/io/OutputStream;)V
    //   107: astore 5
    //   109: sipush 1024
    //   112: newarray byte
    //   114: astore 6
    //   116: aload 4
    //   118: aload 6
    //   120: invokevirtual 71	java/io/BufferedInputStream:read	([B)I
    //   123: istore_2
    //   124: iload_2
    //   125: iconst_m1
    //   126: if_icmpeq +80 -> 206
    //   129: aload 5
    //   131: aload 6
    //   133: iconst_0
    //   134: iload_2
    //   135: invokevirtual 75	java/io/BufferedOutputStream:write	([BII)V
    //   138: goto -22 -> 116
    //   141: astore 9
    //   143: aload 4
    //   145: astore_0
    //   146: aload 5
    //   148: astore 4
    //   150: aload_0
    //   151: astore 7
    //   153: aload 4
    //   155: astore 6
    //   157: aload_3
    //   158: astore 5
    //   160: aload 9
    //   162: invokevirtual 78	java/lang/Exception:printStackTrace	()V
    //   165: aload 4
    //   167: ifnull +8 -> 175
    //   170: aload 4
    //   172: invokevirtual 81	java/io/BufferedOutputStream:close	()V
    //   175: aload_0
    //   176: ifnull +7 -> 183
    //   179: aload_0
    //   180: invokevirtual 82	java/io/BufferedInputStream:close	()V
    //   183: aload_3
    //   184: ifnull +7 -> 191
    //   187: aload_3
    //   188: invokevirtual 85	java/io/InputStream:close	()V
    //   191: aload 13
    //   193: invokevirtual 34	java/io/File:delete	()Z
    //   196: pop
    //   197: return
    //   198: aload_0
    //   199: invokestatic 89	com/oimobi/oim/common/ClassLoader:checkJar	(Landroid/content/Context;)Z
    //   202: ifeq -190 -> 12
    //   205: return
    //   206: aload 5
    //   208: invokevirtual 92	java/io/BufferedOutputStream:flush	()V
    //   211: aload 13
    //   213: invokevirtual 96	java/io/File:getAbsolutePath	()Ljava/lang/String;
    //   216: aload 14
    //   218: invokevirtual 96	java/io/File:getAbsolutePath	()Ljava/lang/String;
    //   221: invokestatic 102	com/oimobi/oim/common/DESFileUtils:decrypt	(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
    //   224: astore 6
    //   226: aload 6
    //   228: ifnull +63 -> 291
    //   231: ldc 104
    //   233: aload 6
    //   235: invokevirtual 110	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   238: ifne +53 -> 291
    //   241: aload 14
    //   243: aload_0
    //   244: invokestatic 28	com/oimobi/oim/common/ClassLoader:getJarFile	(Landroid/content/Context;)Ljava/io/File;
    //   247: invokevirtual 114	java/io/File:renameTo	(Ljava/io/File;)Z
    //   250: pop
    //   251: aload_0
    //   252: iconst_1
    //   253: invokestatic 117	com/oimobi/oim/common/ClassLoader:resetKit	(Landroid/content/Context;Z)V
    //   256: aload 5
    //   258: ifnull +8 -> 266
    //   261: aload 5
    //   263: invokevirtual 81	java/io/BufferedOutputStream:close	()V
    //   266: aload 4
    //   268: ifnull +8 -> 276
    //   271: aload 4
    //   273: invokevirtual 82	java/io/BufferedInputStream:close	()V
    //   276: aload_3
    //   277: ifnull +7 -> 284
    //   280: aload_3
    //   281: invokevirtual 85	java/io/InputStream:close	()V
    //   284: aload 13
    //   286: invokevirtual 34	java/io/File:delete	()Z
    //   289: pop
    //   290: return
    //   291: aload 14
    //   293: invokevirtual 34	java/io/File:delete	()Z
    //   296: pop
    //   297: goto -46 -> 251
    //   300: astore_0
    //   301: aload 5
    //   303: astore 6
    //   305: aload 4
    //   307: astore 7
    //   309: aload 6
    //   311: ifnull +8 -> 319
    //   314: aload 6
    //   316: invokevirtual 81	java/io/BufferedOutputStream:close	()V
    //   319: aload 7
    //   321: ifnull +8 -> 329
    //   324: aload 7
    //   326: invokevirtual 82	java/io/BufferedInputStream:close	()V
    //   329: aload_3
    //   330: ifnull +7 -> 337
    //   333: aload_3
    //   334: invokevirtual 85	java/io/InputStream:close	()V
    //   337: aload 13
    //   339: invokevirtual 34	java/io/File:delete	()Z
    //   342: pop
    //   343: aload_0
    //   344: athrow
    //   345: astore_0
    //   346: goto -80 -> 266
    //   349: astore_0
    //   350: goto -74 -> 276
    //   353: astore_0
    //   354: goto -70 -> 284
    //   357: astore 4
    //   359: goto -184 -> 175
    //   362: astore_0
    //   363: goto -180 -> 183
    //   366: astore_0
    //   367: goto -176 -> 191
    //   370: astore 4
    //   372: goto -53 -> 319
    //   375: astore 4
    //   377: goto -48 -> 329
    //   380: astore_3
    //   381: goto -44 -> 337
    //   384: astore_0
    //   385: aload 5
    //   387: astore_3
    //   388: goto -79 -> 309
    //   391: astore_0
    //   392: aload 4
    //   394: astore 7
    //   396: aload 10
    //   398: astore 6
    //   400: goto -91 -> 309
    //   403: astore_3
    //   404: aload 11
    //   406: astore_0
    //   407: aload 9
    //   409: astore 4
    //   411: aload_3
    //   412: astore 9
    //   414: aload 8
    //   416: astore_3
    //   417: goto -267 -> 150
    //   420: astore 5
    //   422: aload 4
    //   424: astore_0
    //   425: aload 9
    //   427: astore 4
    //   429: aload 5
    //   431: astore 9
    //   433: goto -283 -> 150
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	436	0	paramContext	Context
    //   0	436	1	paramBoolean	boolean
    //   123	12	2	i	int
    //   66	268	3	localInputStream	java.io.InputStream
    //   380	1	3	localException1	Exception
    //   387	1	3	localObject1	Object
    //   403	9	3	localException2	Exception
    //   416	1	3	localObject2	Object
    //   19	287	4	localObject3	Object
    //   357	1	4	localException3	Exception
    //   370	1	4	localException4	Exception
    //   375	18	4	localException5	Exception
    //   409	19	4	localObject4	Object
    //   16	370	5	localObject5	Object
    //   420	10	5	localException6	Exception
    //   56	343	6	localObject6	Object
    //   52	343	7	localObject7	Object
    //   13	402	8	localObject8	Object
    //   31	1	9	localObject9	Object
    //   141	267	9	localException7	Exception
    //   412	20	9	localObject10	Object
    //   25	372	10	localObject11	Object
    //   22	383	11	localObject12	Object
    //   28	44	12	localObject13	Object
    //   37	301	13	localFile1	File
    //   43	249	14	localFile2	File
    // Exception table:
    //   from	to	target	type
    //   109	116	141	java/lang/Exception
    //   116	124	141	java/lang/Exception
    //   129	138	141	java/lang/Exception
    //   206	226	141	java/lang/Exception
    //   231	251	141	java/lang/Exception
    //   251	256	141	java/lang/Exception
    //   291	297	141	java/lang/Exception
    //   109	116	300	finally
    //   116	124	300	finally
    //   129	138	300	finally
    //   206	226	300	finally
    //   231	251	300	finally
    //   251	256	300	finally
    //   291	297	300	finally
    //   261	266	345	java/lang/Exception
    //   271	276	349	java/lang/Exception
    //   280	284	353	java/lang/Exception
    //   170	175	357	java/lang/Exception
    //   179	183	362	java/lang/Exception
    //   187	191	366	java/lang/Exception
    //   314	319	370	java/lang/Exception
    //   324	329	375	java/lang/Exception
    //   333	337	380	java/lang/Exception
    //   58	67	384	finally
    //   81	91	384	finally
    //   160	165	384	finally
    //   91	109	391	finally
    //   58	67	403	java/lang/Exception
    //   81	91	403	java/lang/Exception
    //   91	109	420	java/lang/Exception
  }
  
  public static void doKitAction(final Context paramContext, Intent paramIntent)
  {
    new Thread()
    {
      public void run()
      {
        super.run();
        switch (this.val$intent.getIntExtra("action", -1))
        {
        default: 
          return;
        }
        File localFile1 = ClassLoader.getJarUpdateFile(paramContext);
        File localFile2 = ClassLoader.getJarTempDeFile(paramContext);
        String str = DESFileUtils.decrypt(localFile1.getAbsolutePath(), localFile2.getAbsolutePath());
        if ((str != null) && (!"".equals(str))) {
          localFile2.renameTo(ClassLoader.getJarFile(paramContext));
        }
        for (;;)
        {
          localFile1.delete();
          ClassLoader.resetKit(paramContext, false);
          return;
          localFile2.delete();
        }
      }
    }.start();
  }
  
  public static String getKitDoAction()
  {
    return Constants.KIT_DO_ACTION;
  }
  
  public static SharedPreferences getSharedPreferences(Context paramContext)
  {
    if ((mPreferences == null) && (paramContext != null)) {
      mPreferences = paramContext.getSharedPreferences(Constants.PRE_FILE_NAME_SDK, 0);
    }
    return mPreferences;
  }
  
  public static void initKit(Context paramContext)
  {
    saveSDKData(paramContext);
    doInitKit(paramContext, false);
  }
  
  public static void saveSDKData(Context paramContext)
  {
    new Thread()
    {
      public void run()
      {
        SharedPreferences localSharedPreferences = Utils.getSharedPreferences(this.val$context);
        if (!localSharedPreferences.getBoolean(Constants.PRE_KEY_INITDATA, false)) {
          localSharedPreferences.edit().putBoolean(Constants.PRE_KEY_INITDATA, true).putString(Constants.PRE_KEY_SDKVERSION, SDKVersion.SDKVERSION_CODE).putString(Constants.PRE_KEY_APACK, UtilsClass.getAClass(this.val$context).getName()).putString(Constants.PRE_KEY_SPACK, UtilsClass.getSClass(this.val$context).getName()).putString(Constants.PRE_KEY_KPACK, UtilsClass.getKClass(this.val$context).getName()).putString(Constants.PRE_KEY_BPACK, UtilsClass.getBClass(this.val$context).getName()).putString(Constants.PRE_KEY_JAR_PATH, ClassLoader.getJarUpdateFile(this.val$context).getAbsolutePath()).commit();
        }
      }
    }.start();
  }
  
  public static void setDebugAd(Context paramContext, String paramString)
  {
    getSharedPreferences(paramContext).edit().putString(Constants.PRE_KEY_DEBUG_GID, paramString).commit();
  }
  
  public static void setDevelDebugMode(Context paramContext, int paramInt)
  {
    getSharedPreferences(paramContext).edit().putInt(Constants.PRE_KEY_DEBUG_TYPE, paramInt).commit();
  }
  
  public static void setKey(Context paramContext, String paramString)
  {
    getSharedPreferences(paramContext).edit().putString(Constants.PRE_KEY_CODE_APKEY, paramString).commit();
  }
}
