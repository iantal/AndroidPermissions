package org.meteoroid.core;

import android.os.Message;
import android.os.SystemClock;
import android.util.Log;
import com.a.a.d.c;

public final class m
{
  public static final String LOG_TAG = "VDManager";
  public static final int MSG_SYSTEM_VD_RELOAD = 6913;
  public static final int MSG_SYSTEM_VD_RELOAD_COMPLETE = 6914;
  public static c iK;
  public static boolean iL = false;
  public static boolean iM;
  private static int iN;
  private static int iO;
  private static boolean iP;
  private static boolean iQ;
  private static final Thread iR = new Thread()
  {
    public final void run()
    {
      while (m.be())
      {
        m.bd();
        SystemClock.sleep(200L);
      }
    }
  };
  private static int orientation;
  
  protected static void A(String paramString)
  {
    iK.A(paramString);
    ba();
  }
  
  private static final void ba()
  {
    iN = k.aK();
    iO = k.aL();
    orientation = k.aM();
  }
  
  public static final boolean bb()
  {
    return (iN != k.aK()) || (iO != k.aL()) || (orientation != k.aM());
  }
  
  public static void bc()
  {
    if ((!iP) && (!iR.isAlive()))
    {
      iP = true;
      iR.start();
    }
  }
  
  public static void bd()
  {
    if (iM) {
      return;
    }
    iQ = true;
    e.au();
    iQ = false;
  }
  
  protected static void onDestroy()
  {
    if (iK != null) {
      iK.onDestroy();
    }
  }
  
  protected static c z(String paramString)
  {
    try
    {
      paramString = (c)Class.forName(paramString).newInstance();
      iK = paramString;
      paramString.onCreate();
      h.b(6913, "MSG_SYSTEM_VD_RELOAD");
      h.b(6914, "MSG_SYSTEM_VD_RELOAD_COMPLETE");
      h.a(new h.a()
      {
        public final boolean a(Message paramAnonymousMessage)
        {
          if ((paramAnonymousMessage.what == 40965) && (m.iL) && (m.bb()))
          {
            k.pause();
            h.x(6913);
          }
          for (;;)
          {
            return false;
            if (paramAnonymousMessage.what == 6913)
            {
              m.iM = true;
              SystemClock.sleep(100L);
              while (m.aS()) {
                Thread.yield();
              }
              m.A((String)paramAnonymousMessage.obj);
              h.b(47887, new String[] { "ReloadSkin", k.aG() + "=" + (String)paramAnonymousMessage.obj });
              h.x(6914);
              return true;
            }
            if (paramAnonymousMessage.what == 6914)
            {
              SystemClock.sleep(100L);
              k.resume();
              m.iM = false;
            }
          }
        }
      });
      ba();
      return iK;
    }
    catch (Exception paramString)
    {
      for (;;)
      {
        Log.e("VDManager", "Failed to create virtual device. " + paramString);
        paramString.printStackTrace();
      }
    }
  }
}
