package me.gall.skuld.adapter;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.Intent;
import android.content.res.Resources;
import android.os.Bundle;
import android.os.Handler;
import android.os.Handler.Callback;
import android.os.Message;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.view.Window;
import android.widget.Button;
import android.widget.TextView;
import com.tencent.webnet.WebNetEvent;
import com.tencent.webnet.WebNetInterface;
import java.io.FileNotFoundException;
import java.util.Map;
import me.gall.skuld.SNSPlatformManager;
import org.opensocial.models.skuld.Billing;

public class QQGameCenterAdapter
  extends a
  implements WebNetEvent
{
  private static SNSPlatformAdapter.AsyncResultCallback<Billing> gO;
  private boolean gN;
  
  public QQGameCenterAdapter() {}
  
  public final void b(Map<String, String> paramMap)
  {
    super.b(paramMap);
    WebNetInterface.Init(SNSPlatformManager.ai(), this);
  }
  
  public final void onDestroy()
  {
    if (this.gN) {
      WebNetInterface.Destroy();
    }
  }
  
  public final void onPause() {}
  
  public final void onResume()
  {
    WebNetInterface.SetCurActivity(SNSPlatformManager.ai());
  }
  
  public final void r(int paramInt)
  {
    SNSPlatformManager.ai().runOnUiThread(new Runnable()
    {
      public final void run()
      {
        if (this.gQ == 0)
        {
          WebNetInterface.StartWeb(SNSPlatformManager.ai());
          return;
        }
        WebNetInterface.StartWeb(SNSPlatformManager.ai(), this.gQ);
      }
    });
  }
  
  public static class SMSPaymentActivity
    extends Activity
    implements Handler.Callback
  {
    private static final int HIDE_PROCESSING_DIALOG = 2;
    private static final String LOG = "SMSPaymentActivity";
    private static final int SHOW_PROCESSING_DIALOG = 1;
    private String gR;
    private ViewGroup gS;
    private Handler handler;
    private ProgressDialog progressDialog;
    
    public SMSPaymentActivity() {}
    
    private void am()
    {
      this.handler.sendEmptyMessage(2);
      finish();
    }
    
    private static View findViewByName(Context paramContext, View paramView, String paramString)
    {
      return paramView.findViewById(getViewIdentifier(paramContext, paramString));
    }
    
    private static int getIdentifier(Context paramContext, String paramString1, String paramString2)
    {
      int i = paramContext.getResources().getIdentifier(paramString1, paramString2, paramContext.getPackageName());
      if (i == 0) {
        throw new FileNotFoundException(paramString1 + " is not found in res/" + paramString2 + "/.");
      }
      return i;
    }
    
    private static int getViewIdentifier(Context paramContext, String paramString)
    {
      try
      {
        int i = getIdentifier(paramContext, paramString, "id");
        return i;
      }
      catch (FileNotFoundException paramContext)
      {
        throw new NullPointerException(paramString + " is not found.");
      }
    }
    
    public boolean handleMessage(Message paramMessage)
    {
      switch (paramMessage.what)
      {
      }
      do
      {
        do
        {
          do
          {
            return false;
          } while (!getWindow().isActive());
          if (this.progressDialog == null)
          {
            this.progressDialog = new ProgressDialog(this);
            this.progressDialog.setMessage("请稍候");
            this.progressDialog.setCancelable(false);
          }
        } while (this.progressDialog.isShowing());
        this.progressDialog.show();
        return false;
      } while ((this.progressDialog == null) || (!this.progressDialog.isShowing()));
      this.progressDialog.hide();
      return false;
    }
    
    public void onBackPressed()
    {
      am();
    }
    
    protected void onCreate(Bundle paramBundle)
    {
      super.onCreate(paramBundle);
      getWindow().requestFeature(1);
      Object localObject = getIntent();
      this.handler = new Handler(this);
      if (((Intent)localObject).hasExtra("TEXT")) {}
      for (paramBundle = ((Intent)localObject).getStringExtra("TEXT");; paramBundle = null)
      {
        this.gR = ((Intent)localObject).getStringExtra("BILLINGID");
        try
        {
          this.gS = ((ViewGroup)((LayoutInflater)getSystemService("layout_inflater")).inflate(getIdentifier(this, "skuld_layout_main", "layout"), null));
          setContentView(this.gS);
          localObject = (TextView)findViewByName(this, this.gS, "skuld_view_content");
          new StringBuilder("TEXT:").append(paramBundle).toString();
          ((TextView)localObject).setText(paramBundle);
          ((Button)findViewByName(this, this.gS, "skuld_view_confirm")).setOnClickListener(new View.OnClickListener()
          {
            public final void onClick(View paramAnonymousView)
            {
              QQGameCenterAdapter.SMSPaymentActivity.a(QQGameCenterAdapter.SMSPaymentActivity.this);
              paramAnonymousView = "SMS_TECENT_BILLING_MARK:" + System.currentTimeMillis();
              new StringBuilder("Sending :").append(QQGameCenterAdapter.SMSPaymentActivity.b(QQGameCenterAdapter.SMSPaymentActivity.this)).append(" mark:").append(paramAnonymousView).toString();
              WebNetInterface.SMSBillingPoint(Integer.parseInt(QQGameCenterAdapter.SMSPaymentActivity.b(QQGameCenterAdapter.SMSPaymentActivity.this)), paramAnonymousView);
              QQGameCenterAdapter.SMSPaymentActivity.c(QQGameCenterAdapter.SMSPaymentActivity.this).postDelayed(new Runnable()
              {
                public final void run()
                {
                  QQGameCenterAdapter.SMSPaymentActivity.d(QQGameCenterAdapter.SMSPaymentActivity.this);
                }
              }, 5000L);
            }
          });
          ((Button)findViewByName(this, this.gS, "skuld_view_cancel")).setOnClickListener(new View.OnClickListener()
          {
            public final void onClick(View paramAnonymousView)
            {
              if (QQGameCenterAdapter.al() != null) {
                QQGameCenterAdapter.al().ao();
              }
              QQGameCenterAdapter.SMSPaymentActivity.d(QQGameCenterAdapter.SMSPaymentActivity.this);
            }
          });
          return;
        }
        catch (FileNotFoundException localFileNotFoundException)
        {
          for (;;)
          {
            localFileNotFoundException.printStackTrace();
          }
        }
      }
    }
    
    public void onDestroy()
    {
      if (this.progressDialog != null) {
        this.progressDialog.dismiss();
      }
      this.progressDialog = null;
      super.onDestroy();
    }
  }
}
