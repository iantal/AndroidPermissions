package com.zdtpay.tools;

import android.app.PendingIntent;
import android.app.PendingIntent.CanceledException;
import android.content.Context;
import android.content.Intent;
import android.location.Criteria;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.net.NetworkInfo.State;
import android.net.Uri;
import android.widget.Toast;
import java.util.List;

public class g
{
  private Context a;
  private LocationManager b;
  private String c;
  private String d;
  private Location e = null;
  private com.zdtpay.a.g f = null;
  private final LocationListener g = new h(this);
  
  public g(Context paramContext)
  {
    this.a = paramContext;
    this.b = ((LocationManager)paramContext.getSystemService("location"));
    this.f = new com.zdtpay.a.g();
  }
  
  private void g()
  {
    this.f.a(this.e.getLatitude());
    this.f.b(this.e.getLongitude());
  }
  
  public boolean a()
  {
    if (b(this.a))
    {
      if (!this.b.isProviderEnabled("gps")) {
        c();
      }
      this.d = "gps";
      return true;
    }
    Toast.makeText(this.a, "no GPS", 0).show();
    if (!a(this.a))
    {
      Toast.makeText(this.a, "no network", 0).show();
      return false;
    }
    this.d = "network";
    return true;
  }
  
  public boolean a(Context paramContext)
  {
    paramContext = (ConnectivityManager)paramContext.getSystemService("connectivity");
    int i;
    if (paramContext != null)
    {
      paramContext = paramContext.getAllNetworkInfo();
      if (paramContext != null) {
        i = 0;
      }
    }
    for (;;)
    {
      if (i >= paramContext.length) {
        return false;
      }
      if (paramContext[i].getState() == NetworkInfo.State.CONNECTED) {
        return true;
      }
      i += 1;
    }
  }
  
  public void b()
  {
    if (this.b.isProviderEnabled("gps"))
    {
      Criteria localCriteria = new Criteria();
      localCriteria.setAccuracy(1);
      localCriteria.setAltitudeRequired(false);
      localCriteria.setBearingRequired(false);
      localCriteria.setCostAllowed(false);
      localCriteria.setPowerRequirement(1);
      this.c = this.b.getBestProvider(localCriteria, true);
      this.e = this.b.getLastKnownLocation(this.c);
      if (this.e != null) {
        g();
      }
      do
      {
        return;
        if (this.d == "gps")
        {
          e();
          return;
        }
      } while (this.d != "network");
      d();
      return;
    }
    d();
  }
  
  public boolean b(Context paramContext)
  {
    paramContext = (LocationManager)paramContext.getSystemService("location");
    if (paramContext == null) {
      return false;
    }
    paramContext = paramContext.getAllProviders();
    if (paramContext == null) {
      return false;
    }
    return paramContext.contains("gps");
  }
  
  public void c()
  {
    Intent localIntent = new Intent();
    localIntent.setClassName("com.android.settings", "com.android.settings.widget.SettingsAppWidgetProvider");
    localIntent.addCategory("android.intent.category.ALTERNATIVE");
    localIntent.setData(Uri.parse("custom:3"));
    try
    {
      PendingIntent.getBroadcast(this.a, 0, localIntent, 0).send();
      return;
    }
    catch (PendingIntent.CanceledException localCanceledException)
    {
      localCanceledException.printStackTrace();
    }
  }
  
  public void d()
  {
    this.b.requestLocationUpdates("network", 1000L, 0.0F, this.g);
    this.e = this.b.getLastKnownLocation("network");
    if (this.e != null) {
      g();
    }
  }
  
  public void e()
  {
    this.b.requestLocationUpdates("gps", 1000L, 0.0F, this.g);
    this.e = this.b.getLastKnownLocation("gps");
    if (this.e != null) {
      g();
    }
  }
  
  public com.zdtpay.a.g f()
  {
    return this.f;
  }
}
