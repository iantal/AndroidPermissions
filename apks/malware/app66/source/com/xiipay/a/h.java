package com.xiipay.a;

import android.app.Activity;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Handler;
import com.umpay.huafubao.HuafubaoListener;
import com.xiipay.Bill;
import com.xiipay.Payment.Listener;
import java.util.ArrayList;
import java.util.List;

public final class h
  implements HuafubaoListener
{
  private static boolean B = false;
  public static List a = new ArrayList();
  public static i b;
  private static f v;
  private static Context w;
  private int A;
  private List c;
  private boolean d = false;
  private String e = "PAY.FAILED";
  private Activity f;
  private int g;
  private Payment.Listener h;
  private Handler i;
  private l j;
  private d k;
  private boolean l = true;
  private boolean m = false;
  private boolean n = false;
  private boolean o = false;
  private boolean p = false;
  private boolean q = false;
  private boolean r = false;
  private int s = 1;
  private int t = 60;
  private Object u;
  private Thread x;
  private boolean y = false;
  private int z;
  
  private h(Activity paramActivity, int paramInt, Payment.Listener paramListener, Object paramObject)
  {
    this.f = paramActivity;
    this.g = paramInt;
    this.h = paramListener;
    this.d = false;
    this.u = paramObject;
    this.e = "PAY.FAILED";
    this.i = new Handler();
    this.j = new l(this);
    this.k = new d(this.f);
    this.j.c();
    this.x = new Thread(new h.1(this));
    this.x.start();
  }
  
  public static void a(Activity paramActivity, int paramInt, Payment.Listener paramListener, Object paramObject)
  {
    if ((paramActivity == null) || (paramListener == null) || (paramInt < 0)) {
      throw new RuntimeException("Payment Request Parameter Error");
    }
    if (a.size() > 0) {
      return;
    }
    a.add(new h(paramActivity, paramInt, paramListener, paramObject));
  }
  
  public static void a(Context paramContext)
  {
    w = paramContext;
    if (b == null)
    {
      i localI = new i();
      b = localI;
      localI.a(paramContext);
    }
    if (B) {
      g();
    }
  }
  
  public static void a(Context paramContext, Intent paramIntent, BroadcastReceiver paramBroadcastReceiver)
  {
    if ("android.net.conn.CONNECTIVITY_CHANGE".equals(paramIntent.getAction())) {
      a(paramContext);
    }
    if (b == null) {}
    while (!b.a(paramIntent)) {
      return;
    }
    paramBroadcastReceiver.abortBroadcast();
  }
  
  public static void g()
  {
    if ((v == null) || (!v.isAlive()))
    {
      f localF = new f(w);
      v = localF;
      localF.start();
    }
    B = true;
  }
  
  public final List a()
  {
    return this.c;
  }
  
  public final void a(int paramInt)
  {
    this.s = paramInt;
  }
  
  public final void a(String paramString)
  {
    if (("PAY.SUCCESSED".equals(paramString)) && (this.d)) {}
    try
    {
      c.a(this.f, ((Bill)this.c.get(0)).getParams0());
      this.y = true;
      if (this.j != null)
      {
        l localL = this.j;
        l.a();
      }
      if (this.h != null)
      {
        if (!"PAY.SUCCESSED".equals(paramString)) {
          break label149;
        }
        i1 = this.z;
        if (this.p)
        {
          if (this.g > this.A) {
            i1 = this.A;
          }
        }
        else {
          this.h.onStatus(paramString, i1, this.u);
        }
      }
      else
      {
        a.remove(this);
        return;
      }
    }
    catch (Exception localException)
    {
      for (;;)
      {
        localException.printStackTrace();
        continue;
        int i1 = this.g;
        continue;
        label149:
        this.h.onStatus(paramString, 0, this.u);
      }
    }
  }
  
  public final void a(boolean paramBoolean)
  {
    this.l = paramBoolean;
  }
  
  public final boolean a(String paramString1, String paramString2)
  {
    if (this.c == null) {}
    while (paramString1 == null) {
      return false;
    }
    int i1 = 0;
    boolean bool = false;
    for (;;)
    {
      if (i1 >= this.c.size()) {
        return bool;
      }
      if (((Bill)this.c.get(i1)).onSmsIn(paramString1, paramString2)) {
        bool = true;
      }
      i1 += 1;
    }
  }
  
  public final Activity b()
  {
    return this.f;
  }
  
  public final void b(int paramInt)
  {
    this.t = paramInt;
  }
  
  public final void b(boolean paramBoolean)
  {
    this.m = paramBoolean;
  }
  
  public final void c()
  {
    this.j.d();
    if (this.p)
    {
      this.e = "PAY.SUCCESSED";
      if (!this.r) {
        break label55;
      }
      a(this.e);
    }
    for (;;)
    {
      new Thread(new h.2(this)).start();
      return;
      label55:
      this.j.f();
    }
  }
  
  public final void c(boolean paramBoolean)
  {
    this.n = paramBoolean;
  }
  
  public final void d(boolean paramBoolean)
  {
    this.o = paramBoolean;
  }
  
  public final boolean d()
  {
    return this.y;
  }
  
  public final void e(boolean paramBoolean)
  {
    this.p = paramBoolean;
  }
  
  public final boolean e()
  {
    return this.r;
  }
  
  public final d f()
  {
    return this.k;
  }
  
  public final void f(boolean paramBoolean)
  {
    this.q = paramBoolean;
  }
  
  public final void g(boolean paramBoolean)
  {
    this.r = paramBoolean;
  }
  
  public final boolean onError(int paramInt, String paramString)
  {
    return false;
  }
  
  public final void onResult(String paramString1, String paramString2)
  {
    if ("0".equals(paramString1))
    {
      a("PAY.SUCCESSED");
      return;
    }
    a("PAY.FAILED");
  }
}
