package com.zhangzhifu.sdk.util.sms;

import java.io.StringReader;
import java.net.URLDecoder;
import java.net.URLEncoder;
import java.util.Stack;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;
import org.xml.sax.InputSource;

public class WapPushWbxmlParser
{
  private String cG;
  private byte[] dC;
  private String dD;
  private String dE;
  Stack dF = new Stack();
  
  public WapPushWbxmlParser(byte[] paramArrayOfByte)
  {
    this.dC = paramArrayOfByte;
    this.dD = "";
    this.dE = "";
    this.cG = "";
    this.dF.clear();
    m();
  }
  
  private void m()
  {
    if (this.dC.length == 0) {
      throw new Exception("data zero length");
    }
    this.dD = "<?xml version=\"1.0\" encoding=\"\"?>";
    int n = 1;
    int k = 0;
    int j = 0;
    int m = 0;
    int i = 0;
    Object localObject;
    if (n >= this.dC.length)
    {
      localObject = new InputSource(new StringReader(this.dD));
      localObject = (Element)DocumentBuilderFactory.newInstance().newDocumentBuilder().parse((InputSource)localObject).getDocumentElement().getElementsByTagName("indication").item(0);
      this.cG = URLDecoder.decode(((Element)localObject).getAttribute("href"), "UTF-8");
      this.dE = ((Element)localObject).getFirstChild().getNodeValue();
      return;
    }
    int i1;
    if (m != 0) {
      switch (this.dC[n])
      {
      default: 
        i1 = k;
        k = m;
        m = i;
        i = i1;
      }
    }
    for (;;)
    {
      i1 = n + 1;
      n = m;
      m = k;
      k = i;
      i = n;
      n = i1;
      break;
      localObject = new byte[n - i];
      System.arraycopy(this.dC, i, localObject, 0, n - i);
      if (j != 0)
      {
        this.dD += URLEncoder.encode(new String((byte[])localObject, "UTF-8"), "UTF-8");
        j = 0;
      }
      for (;;)
      {
        if (k != 0)
        {
          this.dD += "\"";
          k = 0;
          m = i;
          i = 0;
          break;
          this.dD += new String((byte[])localObject, "UTF-8");
          continue;
          switch (this.dC[n])
          {
          default: 
            String str = Integer.toHexString(this.dC[n] & 0xFF);
            localObject = str;
            if (str.length() == 1) {
              localObject = "0" + str;
            }
            throw new Exception("Unkonwn byte: 0x" + ((String)localObject).toUpperCase() + " pos: " + n);
          case 5: 
            this.dD += "<!DOCTYPE si PUBLIC \"-//WAPFORUM//DTD SI 1.0//EN\" \"http://www.wapforum.org/DTD/si.dtd\">";
            i1 = i;
            i = k;
            k = m;
            m = i1;
            break;
          case 106: 
            this.dD = this.dD.replaceAll("encoding=\"\"", "encoding=\"UTF-8\"");
            i1 = i;
            i = k;
            k = m;
            m = i1;
            break;
          case 0: 
          case 7: 
          case 8: 
            i1 = i;
            i = k;
            k = m;
            m = i1;
            break;
          case 3: 
            m = n + 1;
            i = k;
            k = 1;
            break;
          case 69: 
            this.dD += "<si>";
            this.dF.add("si");
            i1 = i;
            i = k;
            k = m;
            m = i1;
            break;
          case -58: 
            this.dD += "<indication ";
            this.dF.add("indication");
            this.dF.add(">");
            i1 = i;
            i = k;
            k = m;
            m = i1;
            break;
          case 12: 
            this.dD += "href=\"http://";
            i1 = 1;
            j = 1;
            k = m;
            m = i;
            i = i1;
            break;
          case -61: 
            i1 = i;
            i = k;
            k = m;
            m = i1;
            break;
          case 1: 
            localObject = (String)this.dF.pop();
            if (((String)localObject).equals(">"))
            {
              this.dD += ">";
              i1 = i;
              i = k;
              k = m;
              m = i1;
              break;
            }
            this.dD = (this.dD + "</" + (String)localObject + ">");
            i1 = i;
            i = k;
            k = m;
            m = i1;
            break;
          }
        }
      }
      i1 = 0;
      m = i;
      i = k;
      k = i1;
    }
  }
  
  public String getContent()
  {
    return this.cG;
  }
  
  public String getSI()
  {
    return this.dD;
  }
  
  public String getTitle()
  {
    return this.dE;
  }
}
