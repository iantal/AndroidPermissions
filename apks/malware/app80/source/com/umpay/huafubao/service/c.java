package com.umpay.huafubao.service;

import android.os.Environment;
import android.os.Handler;
import android.os.Message;
import java.io.File;
import java.net.URLEncoder;

final class c
  extends Thread
{
  c(AppUpgradeService paramAppUpgradeService) {}
  
  public final void run()
  {
    if (Environment.getExternalStorageState().equals("mounted"))
    {
      if (AppUpgradeService.f(this.a) == null) {
        AppUpgradeService.a(this.a, new File(Environment.getExternalStorageDirectory().getPath() + "/umpay/huafubao/download"));
      }
      if ((AppUpgradeService.f(this.a).exists()) || (AppUpgradeService.f(this.a).mkdirs()))
      {
        AppUpgradeService.b(this.a, new File(AppUpgradeService.f(this.a).getPath() + "/" + URLEncoder.encode(AppUpgradeService.g(this.a))));
        if ((!AppUpgradeService.a(this.a).exists()) || (!AppUpgradeService.a(this.a).isFile()) || (!this.a.a(AppUpgradeService.a(this.a).getPath()))) {
          break label210;
        }
        this.a.a(AppUpgradeService.a(this.a));
      }
    }
    for (;;)
    {
      this.a.stopSelf();
      return;
      try
      {
        label210:
        AppUpgradeService.a(AppUpgradeService.g(this.a), AppUpgradeService.a(this.a), AppUpgradeService.h(this.a));
      }
      catch (Exception localException)
      {
        Message localMessage = AppUpgradeService.e(this.a).obtainMessage();
        localMessage.what = -1;
        AppUpgradeService.e(this.a).sendMessage(localMessage);
        localException.printStackTrace();
      }
    }
  }
}
