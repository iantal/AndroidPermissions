package com.shortcut.b;

import android.app.ProgressDialog;
import android.os.AsyncTask;
import android.os.Environment;
import android.util.Log;
import java.io.BufferedInputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.URL;
import java.net.URLConnection;
import java.util.Date;

final class e
  extends AsyncTask<String, String, String>
{
  File a;
  
  e(b paramB) {}
  
  private String a(String... paramVarArgs)
  {
    try
    {
      paramVarArgs = new URL(paramVarArgs[0]);
      Object localObject = paramVarArgs.openConnection();
      ((URLConnection)localObject).connect();
      int i = ((URLConnection)localObject).getContentLength();
      paramVarArgs = new BufferedInputStream(paramVarArgs.openStream(), 8192);
      localObject = new File(Environment.getExternalStorageDirectory().getAbsolutePath() + "/myfile");
      if (!((File)localObject).exists()) {
        ((File)localObject).mkdirs();
      }
      this.a = new File((File)localObject, new Date().getTime());
      localObject = new FileOutputStream(this.a);
      byte[] arrayOfByte = new byte['Ѐ'];
      long l = 0L;
      for (;;)
      {
        int j = paramVarArgs.read(arrayOfByte);
        if (j == -1)
        {
          ((OutputStream)localObject).flush();
          ((OutputStream)localObject).close();
          paramVarArgs.close();
          break;
        }
        l += j;
        publishProgress(new String[] { (int)(100L * l / i) });
        ((OutputStream)localObject).write(arrayOfByte, 0, j);
      }
      return null;
    }
    catch (Exception paramVarArgs)
    {
      Log.e("Error: ", paramVarArgs.getMessage());
      paramVarArgs.printStackTrace();
    }
  }
  
  protected final void onPreExecute()
  {
    super.onPreExecute();
    b localB = this.b;
    localB.e = new ProgressDialog(localB.b);
    localB.e.setMessage("Đang tải file...");
    localB.e.setIndeterminate(false);
    localB.e.setMax(100);
    localB.e.setProgressStyle(1);
    localB.e.setCancelable(true);
    localB.e.setCanceledOnTouchOutside(false);
    localB.e.show();
  }
}
