package com.google.android.gms.internal;

import android.app.AlertDialog;
import android.app.AlertDialog.Builder;
import android.content.Context;
import android.net.Uri;
import android.text.TextUtils;
import android.webkit.URLUtil;
import com.google.android.gms.d;
import java.util.Map;

public final class ep
{
  private final mm a;
  private final Map<String, String> b;
  private final Context c;
  
  public ep(mm paramMm, Map<String, String> paramMap)
  {
    this.a = paramMm;
    this.b = paramMap;
    this.c = paramMm.k();
  }
  
  public final void a()
  {
    if (!new br(this.c).c())
    {
      mi.e("Store picture feature is not supported on this device.");
      return;
    }
    if (TextUtils.isEmpty((CharSequence)this.b.get("iurl")))
    {
      mi.e("Image url cannot be empty.");
      return;
    }
    String str1 = (String)this.b.get("iurl");
    if (!URLUtil.isValidUrl(str1))
    {
      mi.e("Invalid image url:" + str1);
      return;
    }
    String str2 = Uri.parse(str1).getLastPathSegment();
    if (!lo.c(str2))
    {
      mi.e("Image type not recognized:");
      return;
    }
    AlertDialog.Builder localBuilder = new AlertDialog.Builder(this.c);
    localBuilder.setTitle(lb.a(d.i, "Save image"));
    localBuilder.setMessage(lb.a(d.h, "Allow Ad to store image in Picture gallery?"));
    localBuilder.setPositiveButton(lb.a(d.a, "Accept"), new eq(this, str1, str2));
    localBuilder.setNegativeButton(lb.a(d.g, "Decline"), new er(this));
    localBuilder.create().show();
  }
}
