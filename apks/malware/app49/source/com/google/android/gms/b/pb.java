package com.google.android.gms.b;

import android.content.Context;
import android.net.Uri;
import android.os.Handler;
import android.view.KeyEvent;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import com.google.android.gms.ads.internal.client.AdSizeParcel;
import com.google.android.gms.ads.internal.client.l;
import com.google.android.gms.ads.internal.g;
import com.google.android.gms.ads.internal.overlay.AdLauncherIntentInfoParcel;
import com.google.android.gms.ads.internal.overlay.AdOverlayInfoParcel;
import com.google.android.gms.ads.internal.overlay.c;
import com.google.android.gms.ads.internal.overlay.h;
import com.google.android.gms.ads.internal.overlay.j;
import com.google.android.gms.ads.internal.overlay.v;
import com.google.android.gms.ads.internal.util.client.b;
import com.google.android.gms.ads.internal.w;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.concurrent.CopyOnWriteArrayList;

public class pb
  extends WebViewClient
{
  protected final pa a;
  private final HashMap<String, List<ff>> b = new HashMap();
  private final Object c = new Object();
  private com.google.android.gms.ads.internal.client.a d;
  private j e;
  private pd f;
  private eu g;
  private boolean h = false;
  private fn i;
  private fp j;
  private boolean k;
  private v l;
  private final iq m;
  private g n;
  private ii o;
  private is p;
  private boolean q;
  private boolean r;
  private boolean s;
  private boolean t;
  private int u;
  
  public pb(pa paramPa, boolean paramBoolean)
  {
    this(paramPa, paramBoolean, new iq(paramPa, paramPa.e(), new cu(paramPa.getContext())));
  }
  
  private pb(pa paramPa, boolean paramBoolean, iq paramIq)
  {
    this.a = paramPa;
    this.k = paramBoolean;
    this.m = paramIq;
    this.o = null;
  }
  
  private void a(Uri paramUri)
  {
    Object localObject2 = paramUri.getPath();
    Object localObject1 = (List)this.b.get(localObject2);
    if (localObject1 != null)
    {
      w.e();
      paramUri = nj.a(paramUri);
      if (b.a(2))
      {
        b.d("Received GMSG: " + (String)localObject2);
        localObject2 = paramUri.keySet().iterator();
        while (((Iterator)localObject2).hasNext())
        {
          String str = (String)((Iterator)localObject2).next();
          b.d("  " + str + ": " + (String)paramUri.get(str));
        }
      }
      localObject1 = ((List)localObject1).iterator();
      while (((Iterator)localObject1).hasNext()) {
        ((ff)((Iterator)localObject1).next()).a(this.a, paramUri);
      }
    }
    b.d("No GMSG handler found for GMSG: " + paramUri);
  }
  
  private void a(AdOverlayInfoParcel paramAdOverlayInfoParcel)
  {
    boolean bool2 = false;
    if (this.o != null) {}
    for (boolean bool1 = this.o.a();; bool1 = false)
    {
      w.c();
      Context localContext = this.a.getContext();
      if (!bool1) {
        bool2 = true;
      }
      h.a(localContext, paramAdOverlayInfoParcel, bool2);
      return;
    }
  }
  
  private void h()
  {
    pd localPd;
    pa localPa;
    if ((this.f != null) && (((this.s) && (this.u <= 0)) || (this.t)))
    {
      localPd = this.f;
      localPa = this.a;
      if (this.t) {
        break label61;
      }
    }
    label61:
    for (boolean bool = true;; bool = false)
    {
      localPd.a(localPa, bool);
      this.f = null;
      return;
    }
  }
  
  public final g a()
  {
    return this.n;
  }
  
  public final void a(int paramInt1, int paramInt2)
  {
    if (this.o != null) {
      this.o.a(paramInt1, paramInt2);
    }
  }
  
  public final void a(int paramInt1, int paramInt2, boolean paramBoolean)
  {
    this.m.a(paramInt1, paramInt2);
    if (this.o != null) {
      this.o.a(paramInt1, paramInt2, paramBoolean);
    }
  }
  
  public final void a(com.google.android.gms.ads.internal.client.a paramA, j paramJ, eu paramEu, v paramV, boolean paramBoolean, fn paramFn, fp paramFp, g paramG, is paramIs)
  {
    g localG = paramG;
    if (paramG == null) {
      localG = new g((byte)0);
    }
    this.o = new ii(this.a, paramIs);
    a("/appEvent", new et(paramEu));
    a("/canOpenURLs", ev.b);
    a("/canOpenIntents", ev.c);
    a("/click", ev.d);
    a("/close", ev.e);
    a("/customClose", ev.f);
    a("/delayPageLoaded", new pf(this, (byte)0));
    a("/httpTrack", ev.g);
    a("/log", ev.h);
    a("/mraid", new fr(localG, this.o));
    a("/open", new fs(paramFn, localG, this.o));
    a("/precache", ev.k);
    a("/touch", ev.i);
    a("/video", ev.j);
    if (paramFp != null) {
      a("/setInterstitialProperties", new fo(paramFp));
    }
    this.d = paramA;
    this.e = paramJ;
    this.g = paramEu;
    this.i = paramFn;
    this.l = paramV;
    this.n = localG;
    this.p = paramIs;
    this.j = paramFp;
    this.h = paramBoolean;
    this.q = false;
  }
  
  public final void a(AdLauncherIntentInfoParcel paramAdLauncherIntentInfoParcel)
  {
    j localJ = null;
    boolean bool = this.a.m();
    com.google.android.gms.ads.internal.client.a localA;
    if ((bool) && (!this.a.h().f))
    {
      localA = null;
      if (!bool) {
        break label75;
      }
    }
    for (;;)
    {
      a(new AdOverlayInfoParcel(paramAdLauncherIntentInfoParcel, localA, localJ, this.l, this.a.l()));
      return;
      localA = this.d;
      break;
      label75:
      localJ = this.e;
    }
  }
  
  public final void a(pd paramPd)
  {
    this.f = paramPd;
  }
  
  public final void a(String paramString, ff paramFf)
  {
    synchronized (this.c)
    {
      List localList = (List)this.b.get(paramString);
      Object localObject1 = localList;
      if (localList == null)
      {
        localObject1 = new CopyOnWriteArrayList();
        this.b.put(paramString, localObject1);
      }
      ((List)localObject1).add(paramFf);
      return;
    }
  }
  
  public final void a(boolean paramBoolean, int paramInt)
  {
    if ((this.a.m()) && (!this.a.h().f)) {}
    for (com.google.android.gms.ads.internal.client.a localA = null;; localA = this.d)
    {
      a(new AdOverlayInfoParcel(localA, this.e, this.l, this.a, paramBoolean, paramInt, this.a.l()));
      return;
    }
  }
  
  public final void a(boolean paramBoolean, int paramInt, String paramString)
  {
    Object localObject = null;
    boolean bool = this.a.m();
    com.google.android.gms.ads.internal.client.a localA;
    if ((bool) && (!this.a.h().f))
    {
      localA = null;
      if (!bool) {
        break label95;
      }
    }
    for (;;)
    {
      a(new AdOverlayInfoParcel(localA, (j)localObject, this.g, this.l, this.a, paramBoolean, paramInt, paramString, this.a.l(), this.i));
      return;
      localA = this.d;
      break;
      label95:
      localObject = new pe(this.a, this.e);
    }
  }
  
  public final void a(boolean paramBoolean, int paramInt, String paramString1, String paramString2)
  {
    boolean bool = this.a.m();
    com.google.android.gms.ads.internal.client.a localA;
    if ((bool) && (!this.a.h().f))
    {
      localA = null;
      if (!bool) {
        break label97;
      }
    }
    label97:
    for (Object localObject = null;; localObject = new pe(this.a, this.e))
    {
      a(new AdOverlayInfoParcel(localA, (j)localObject, this.g, this.l, this.a, paramBoolean, paramInt, paramString1, paramString2, this.a.l(), this.i));
      return;
      localA = this.d;
      break;
    }
  }
  
  public final void b(String paramString, ff paramFf)
  {
    synchronized (this.c)
    {
      paramString = (List)this.b.get(paramString);
      if (paramString == null) {
        return;
      }
      paramString.remove(paramFf);
      return;
    }
  }
  
  public final boolean b()
  {
    synchronized (this.c)
    {
      boolean bool = this.k;
      return bool;
    }
  }
  
  public final void c()
  {
    synchronized (this.c)
    {
      b.d("Loading blank page in WebView, 2...");
      this.r = true;
      this.a.a("about:blank");
      return;
    }
  }
  
  public final void d()
  {
    if (b()) {
      this.m.a();
    }
  }
  
  public final void e()
  {
    synchronized (this.c)
    {
      this.b.clear();
      this.d = null;
      this.e = null;
      this.f = null;
      this.g = null;
      this.h = false;
      this.k = false;
      this.i = null;
      this.l = null;
      if (this.o != null)
      {
        this.o.a(true);
        this.o = null;
      }
      this.q = false;
      return;
    }
  }
  
  public final void f()
  {
    this.h = false;
  }
  
  public final void g()
  {
    synchronized (this.c)
    {
      this.h = false;
      this.k = true;
      this.a.q();
      c localC = this.a.f();
      if (localC != null)
      {
        l.a();
        if (!com.google.android.gms.ads.internal.util.client.a.b()) {
          nj.a.post(new pc(this, localC));
        }
      }
      else
      {
        return;
      }
      localC.m();
    }
  }
  
  public final void onLoadResource(WebView paramWebView, String paramString)
  {
    b.d("Loading resource: " + paramString);
    paramWebView = Uri.parse(paramString);
    if (("gmsg".equalsIgnoreCase(paramWebView.getScheme())) && ("mobileads.google.com".equalsIgnoreCase(paramWebView.getHost()))) {
      a(paramWebView);
    }
  }
  
  public final void onPageFinished(WebView arg1, String paramString)
  {
    synchronized (this.c)
    {
      if ((this.r) && ("about:blank".equals(paramString)))
      {
        b.d("Blank page loaded, 1...");
        this.a.p();
        return;
      }
      this.s = true;
      h();
      return;
    }
  }
  
  public boolean shouldOverrideKeyEvent(WebView paramWebView, KeyEvent paramKeyEvent)
  {
    switch (paramKeyEvent.getKeyCode())
    {
    default: 
      return false;
    }
    return true;
  }
  
  public final boolean shouldOverrideUrlLoading(WebView paramWebView, String paramString)
  {
    b.d("AdWebView shouldOverrideUrlLoading: " + paramString);
    Object localObject1 = Uri.parse(paramString);
    if (("gmsg".equalsIgnoreCase(((Uri)localObject1).getScheme())) && ("mobileads.google.com".equalsIgnoreCase(((Uri)localObject1).getHost()))) {
      a((Uri)localObject1);
    }
    for (;;)
    {
      return true;
      Object localObject2;
      if ((this.h) && (paramWebView == this.a))
      {
        localObject2 = ((Uri)localObject1).getScheme();
        if (("http".equalsIgnoreCase((String)localObject2)) || ("https".equalsIgnoreCase((String)localObject2))) {}
        for (int i1 = 1; i1 != 0; i1 = 0)
        {
          if (!this.q)
          {
            this.q = true;
            if (this.d != null)
            {
              localObject1 = dh.J;
              if (((Boolean)w.n().a((cz)localObject1)).booleanValue()) {
                this.d.e();
              }
            }
          }
          return super.shouldOverrideUrlLoading(paramWebView, paramString);
        }
      }
      if (!this.a.willNotDraw())
      {
        try
        {
          localObject2 = this.a.k();
          paramWebView = (WebView)localObject1;
          if (localObject2 != null)
          {
            paramWebView = (WebView)localObject1;
            if (((ao)localObject2).a((Uri)localObject1)) {
              paramWebView = ((ao)localObject2).a((Uri)localObject1, this.a.getContext());
            }
          }
        }
        catch (ap paramWebView)
        {
          for (;;)
          {
            b.e("Unable to append parameter to URL: " + paramString);
            paramWebView = (WebView)localObject1;
          }
          this.n.a(paramString);
        }
        if ((this.n == null) || (this.n.b())) {
          a(new AdLauncherIntentInfoParcel("android.intent.action.VIEW", paramWebView.toString(), null, null, null, null, null));
        }
      }
      else
      {
        b.e("AdWebView unable to handle URL: " + paramString);
      }
    }
  }
}
