package com.google.android.gms.b;

import android.app.Activity;
import android.content.ActivityNotFoundException;
import android.content.Context;
import android.content.Intent;
import android.content.res.Resources;
import android.graphics.Canvas;
import android.net.Uri;
import android.os.Build.VERSION;
import android.util.DisplayMetrics;
import android.view.Display;
import android.view.MotionEvent;
import android.view.View.MeasureSpec;
import android.view.ViewTreeObserver.OnGlobalLayoutListener;
import android.view.WindowManager;
import android.webkit.DownloadListener;
import android.webkit.ValueCallback;
import android.webkit.WebSettings;
import android.webkit.WebView;
import com.google.android.gms.ads.internal.client.AdSizeParcel;
import com.google.android.gms.ads.internal.client.l;
import com.google.android.gms.ads.internal.overlay.c;
import com.google.android.gms.ads.internal.util.client.VersionInfoParcel;
import com.google.android.gms.ads.internal.util.client.a;
import com.google.android.gms.ads.internal.util.client.b;
import com.google.android.gms.ads.internal.w;
import java.util.HashMap;
import java.util.Map;
import org.json.JSONException;
import org.json.JSONObject;

public final class ph
  extends WebView
  implements ViewTreeObserver.OnGlobalLayoutListener, DownloadListener, pa
{
  boolean a;
  private final pb b;
  private final pi c;
  private final Object d = new Object();
  private final ao e;
  private final VersionInfoParcel f;
  private c g;
  private AdSizeParcel h;
  private boolean i;
  private boolean j;
  private boolean k;
  private boolean l;
  private boolean m;
  private Boolean n;
  private int o;
  private c p;
  private int q = -1;
  private int r = -1;
  private int s = -1;
  private int t = -1;
  private final WindowManager u;
  
  private ph(pi paramPi, AdSizeParcel paramAdSizeParcel, boolean paramBoolean1, boolean paramBoolean2, ao paramAo, VersionInfoParcel paramVersionInfoParcel)
  {
    super(paramPi);
    this.c = paramPi;
    this.h = paramAdSizeParcel;
    this.k = paramBoolean1;
    this.m = false;
    this.o = -1;
    this.e = paramAo;
    this.f = paramVersionInfoParcel;
    this.u = ((WindowManager)getContext().getSystemService("window"));
    setBackgroundColor(0);
    paramAdSizeParcel = getSettings();
    paramAdSizeParcel.setJavaScriptEnabled(true);
    paramAdSizeParcel.setSavePassword(false);
    paramAdSizeParcel.setSupportMultipleWindows(true);
    paramAdSizeParcel.setJavaScriptCanOpenWindowsAutomatically(true);
    if (Build.VERSION.SDK_INT >= 21) {
      paramAdSizeParcel.setMixedContentMode(0);
    }
    w.e().a(paramPi, paramVersionInfoParcel.c, paramAdSizeParcel);
    w.g().a(getContext(), paramAdSizeParcel);
    setDownloadListener(this);
    this.b = w.g().a(this, paramBoolean2);
    setWebViewClient(this.b);
    setWebChromeClient(w.g().a(this));
    u();
    if (rj.b()) {
      addJavascriptInterface(new pj(this), "googleAdsJsInterface");
    }
  }
  
  static ph a(Context paramContext, AdSizeParcel paramAdSizeParcel, boolean paramBoolean1, boolean paramBoolean2, ao paramAo, VersionInfoParcel paramVersionInfoParcel)
  {
    return new ph(new pi(paramContext), paramAdSizeParcel, paramBoolean1, paramBoolean2, paramAo, paramVersionInfoParcel);
  }
  
  private void a(Boolean paramBoolean)
  {
    this.n = paramBoolean;
    w.h().a(paramBoolean);
  }
  
  private void b(String paramString)
  {
    synchronized (this.d)
    {
      if (!o())
      {
        loadUrl(paramString);
        return;
      }
      b.e("The webview is destroyed. Ignoring action.");
    }
  }
  
  /* Error */
  private void c(String paramString)
  {
    // Byte code:
    //   0: invokestatic 217	com/google/android/gms/b/rj:c	()Z
    //   3: ifeq +137 -> 140
    //   6: aload_0
    //   7: invokespecial 220	com/google/android/gms/b/ph:r	()Ljava/lang/Boolean;
    //   10: ifnonnull +46 -> 56
    //   13: aload_0
    //   14: getfield 54	com/google/android/gms/b/ph:d	Ljava/lang/Object;
    //   17: astore_2
    //   18: aload_2
    //   19: monitorenter
    //   20: aload_0
    //   21: invokestatic 197	com/google/android/gms/ads/internal/w:h	()Lcom/google/android/gms/b/mp;
    //   24: invokevirtual 222	com/google/android/gms/b/mp:h	()Ljava/lang/Boolean;
    //   27: putfield 194	com/google/android/gms/b/ph:n	Ljava/lang/Boolean;
    //   30: aload_0
    //   31: getfield 194	com/google/android/gms/b/ph:n	Ljava/lang/Boolean;
    //   34: astore_3
    //   35: aload_3
    //   36: ifnonnull +18 -> 54
    //   39: aload_0
    //   40: ldc -32
    //   42: aconst_null
    //   43: invokevirtual 228	com/google/android/gms/b/ph:evaluateJavascript	(Ljava/lang/String;Landroid/webkit/ValueCallback;)V
    //   46: aload_0
    //   47: iconst_1
    //   48: invokestatic 234	java/lang/Boolean:valueOf	(Z)Ljava/lang/Boolean;
    //   51: invokespecial 235	com/google/android/gms/b/ph:a	(Ljava/lang/Boolean;)V
    //   54: aload_2
    //   55: monitorexit
    //   56: aload_0
    //   57: invokespecial 220	com/google/android/gms/b/ph:r	()Ljava/lang/Boolean;
    //   60: invokevirtual 238	java/lang/Boolean:booleanValue	()Z
    //   63: ifeq +56 -> 119
    //   66: aload_0
    //   67: getfield 54	com/google/android/gms/b/ph:d	Ljava/lang/Object;
    //   70: astore_2
    //   71: aload_2
    //   72: monitorenter
    //   73: aload_0
    //   74: invokevirtual 204	com/google/android/gms/b/ph:o	()Z
    //   77: ifne +29 -> 106
    //   80: aload_0
    //   81: aload_1
    //   82: aconst_null
    //   83: invokevirtual 228	com/google/android/gms/b/ph:evaluateJavascript	(Ljava/lang/String;Landroid/webkit/ValueCallback;)V
    //   86: aload_2
    //   87: monitorexit
    //   88: return
    //   89: astore_3
    //   90: aload_0
    //   91: iconst_0
    //   92: invokestatic 234	java/lang/Boolean:valueOf	(Z)Ljava/lang/Boolean;
    //   95: invokespecial 235	com/google/android/gms/b/ph:a	(Ljava/lang/Boolean;)V
    //   98: goto -44 -> 54
    //   101: astore_1
    //   102: aload_2
    //   103: monitorexit
    //   104: aload_1
    //   105: athrow
    //   106: ldc -47
    //   108: invokestatic 213	com/google/android/gms/ads/internal/util/client/b:e	(Ljava/lang/String;)V
    //   111: goto -25 -> 86
    //   114: astore_1
    //   115: aload_2
    //   116: monitorexit
    //   117: aload_1
    //   118: athrow
    //   119: aload_0
    //   120: new 240	java/lang/StringBuilder
    //   123: dup
    //   124: ldc -14
    //   126: invokespecial 244	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   129: aload_1
    //   130: invokevirtual 248	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   133: invokevirtual 252	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   136: invokespecial 254	com/google/android/gms/b/ph:b	(Ljava/lang/String;)V
    //   139: return
    //   140: aload_0
    //   141: new 240	java/lang/StringBuilder
    //   144: dup
    //   145: ldc -14
    //   147: invokespecial 244	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   150: aload_1
    //   151: invokevirtual 248	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   154: invokevirtual 252	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   157: invokespecial 254	com/google/android/gms/b/ph:b	(Ljava/lang/String;)V
    //   160: return
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	161	0	this	ph
    //   0	161	1	paramString	String
    //   34	2	3	localBoolean	Boolean
    //   89	1	3	localIllegalStateException	IllegalStateException
    // Exception table:
    //   from	to	target	type
    //   39	54	89	java/lang/IllegalStateException
    //   20	35	101	finally
    //   39	54	101	finally
    //   54	56	101	finally
    //   90	98	101	finally
    //   73	86	114	finally
    //   86	88	114	finally
    //   106	111	114	finally
  }
  
  private Boolean r()
  {
    synchronized (this.d)
    {
      Boolean localBoolean = this.n;
      return localBoolean;
    }
  }
  
  private void s()
  {
    Activity localActivity = this.c.a();
    if ((this.m) && (localActivity != null))
    {
      w.g().a(localActivity, this);
      this.m = false;
    }
  }
  
  private void t()
  {
    Activity localActivity = this.c.a();
    if ((!this.m) && (localActivity != null) && (this.a))
    {
      w.e();
      nj.a(localActivity, this);
      this.m = true;
    }
  }
  
  private void u()
  {
    for (;;)
    {
      synchronized (this.d)
      {
        if ((this.k) || (this.h.f))
        {
          if (Build.VERSION.SDK_INT < 14)
          {
            b.a("Disabling hardware acceleration on an overlay.");
            v();
            return;
          }
          b.a("Enabling hardware acceleration on an overlay.");
          w();
        }
      }
      if (Build.VERSION.SDK_INT < 18)
      {
        b.a("Disabling hardware acceleration on an AdView.");
        v();
      }
      else
      {
        b.a("Enabling hardware acceleration on an AdView.");
        w();
      }
    }
  }
  
  private void v()
  {
    synchronized (this.d)
    {
      if (!this.l) {
        w.g().c(this);
      }
      this.l = true;
      return;
    }
  }
  
  private void w()
  {
    synchronized (this.d)
    {
      if (this.l) {
        w.g().b(this);
      }
      this.l = false;
      return;
    }
  }
  
  public final WebView a()
  {
    return this;
  }
  
  public final void a(int paramInt)
  {
    HashMap localHashMap = new HashMap(2);
    localHashMap.put("closetype", String.valueOf(paramInt));
    localHashMap.put("version", this.f.c);
    a("onhide", localHashMap);
  }
  
  public final void a(Context paramContext)
  {
    this.c.setBaseContext(paramContext);
  }
  
  public final void a(Context paramContext, AdSizeParcel paramAdSizeParcel)
  {
    synchronized (this.d)
    {
      s();
      a(paramContext);
      this.g = null;
      this.h = paramAdSizeParcel;
      this.k = false;
      this.i = false;
      this.o = -1;
      w.g().b(this);
      loadUrl("about:blank");
      this.b.e();
      setOnTouchListener(null);
      setOnClickListener(null);
      return;
    }
  }
  
  public final void a(AdSizeParcel paramAdSizeParcel)
  {
    synchronized (this.d)
    {
      this.h = paramAdSizeParcel;
      requestLayout();
      return;
    }
  }
  
  public final void a(c paramC)
  {
    synchronized (this.d)
    {
      this.g = paramC;
      return;
    }
  }
  
  public final void a(String paramString)
  {
    synchronized (this.d)
    {
      super.loadUrl(paramString);
      return;
    }
  }
  
  public final void a(String paramString1, String paramString2)
  {
    c(paramString1 + "(" + paramString2 + ");");
  }
  
  public final void a(String paramString, Map<String, ?> paramMap)
  {
    try
    {
      paramMap = w.e().a(paramMap);
      a(paramString, paramMap);
      return;
    }
    catch (JSONException paramString)
    {
      b.e("Could not convert parameters to JSON.");
    }
  }
  
  public final void a(String paramString, JSONObject paramJSONObject)
  {
    Object localObject = paramJSONObject;
    if (paramJSONObject == null) {
      localObject = new JSONObject();
    }
    paramJSONObject = ((JSONObject)localObject).toString();
    localObject = new StringBuilder();
    ((StringBuilder)localObject).append("AFMA_ReceiveMessage('");
    ((StringBuilder)localObject).append(paramString);
    ((StringBuilder)localObject).append("'");
    ((StringBuilder)localObject).append(",");
    ((StringBuilder)localObject).append(paramJSONObject);
    ((StringBuilder)localObject).append(");");
    b.d("Dispatching AFMA event: " + ((StringBuilder)localObject).toString());
    c(((StringBuilder)localObject).toString());
  }
  
  public final void a(boolean paramBoolean)
  {
    synchronized (this.d)
    {
      this.k = paramBoolean;
      u();
      return;
    }
  }
  
  public final void b()
  {
    HashMap localHashMap = new HashMap(1);
    localHashMap.put("version", this.f.c);
    a("onhide", localHashMap);
  }
  
  public final void b(int paramInt)
  {
    synchronized (this.d)
    {
      this.o = paramInt;
      if (this.g != null) {
        this.g.a(this.o);
      }
      return;
    }
  }
  
  public final void b(c paramC)
  {
    synchronized (this.d)
    {
      this.p = paramC;
      return;
    }
  }
  
  public final void b(String paramString, JSONObject paramJSONObject)
  {
    JSONObject localJSONObject = paramJSONObject;
    if (paramJSONObject == null) {
      localJSONObject = new JSONObject();
    }
    a(paramString, localJSONObject.toString());
  }
  
  public final void b(boolean paramBoolean)
  {
    synchronized (this.d)
    {
      if (this.g != null)
      {
        this.g.a(this.b.b(), paramBoolean);
        return;
      }
      this.i = paramBoolean;
    }
  }
  
  public final void c()
  {
    HashMap localHashMap = new HashMap(1);
    localHashMap.put("version", this.f.c);
    a("onshow", localHashMap);
  }
  
  public final Activity d()
  {
    return this.c.a();
  }
  
  public final void destroy()
  {
    synchronized (this.d)
    {
      s();
      if (this.g != null)
      {
        this.g.a();
        this.g.k();
        this.g = null;
      }
      this.b.e();
      if (this.j) {
        return;
      }
      w.q();
      fw.a(this);
      this.j = true;
      b.d("Initiating WebView self destruct sequence in 3...");
      this.b.c();
      return;
    }
  }
  
  public final Context e()
  {
    return this.c.b();
  }
  
  public final void evaluateJavascript(String paramString, ValueCallback<String> paramValueCallback)
  {
    synchronized (this.d)
    {
      if (o())
      {
        b.e("The webview is destroyed. Ignoring action.");
        if (paramValueCallback != null) {
          paramValueCallback.onReceiveValue(null);
        }
        return;
      }
      super.evaluateJavascript(paramString, paramValueCallback);
      return;
    }
  }
  
  public final c f()
  {
    synchronized (this.d)
    {
      c localC = this.g;
      return localC;
    }
  }
  
  public final c g()
  {
    synchronized (this.d)
    {
      c localC = this.p;
      return localC;
    }
  }
  
  public final AdSizeParcel h()
  {
    synchronized (this.d)
    {
      AdSizeParcel localAdSizeParcel = this.h;
      return localAdSizeParcel;
    }
  }
  
  public final pb i()
  {
    return this.b;
  }
  
  public final boolean j()
  {
    return this.i;
  }
  
  public final ao k()
  {
    return this.e;
  }
  
  public final VersionInfoParcel l()
  {
    return this.f;
  }
  
  public final void loadData(String paramString1, String paramString2, String paramString3)
  {
    synchronized (this.d)
    {
      if (!o())
      {
        super.loadData(paramString1, paramString2, paramString3);
        return;
      }
      b.e("The webview is destroyed. Ignoring action.");
    }
  }
  
  public final void loadDataWithBaseURL(String paramString1, String paramString2, String paramString3, String paramString4, String paramString5)
  {
    synchronized (this.d)
    {
      if (!o())
      {
        super.loadDataWithBaseURL(paramString1, paramString2, paramString3, paramString4, paramString5);
        return;
      }
      b.e("The webview is destroyed. Ignoring action.");
    }
  }
  
  public final void loadUrl(String paramString)
  {
    synchronized (this.d)
    {
      if (!o())
      {
        super.loadUrl(paramString);
        return;
      }
      b.e("The webview is destroyed. Ignoring action.");
    }
  }
  
  public final boolean m()
  {
    synchronized (this.d)
    {
      boolean bool = this.k;
      return bool;
    }
  }
  
  public final int n()
  {
    synchronized (this.d)
    {
      int i1 = this.o;
      return i1;
    }
  }
  
  public final boolean o()
  {
    synchronized (this.d)
    {
      boolean bool = this.j;
      return bool;
    }
  }
  
  protected final void onAttachedToWindow()
  {
    synchronized (this.d)
    {
      super.onAttachedToWindow();
      if (!o())
      {
        this.a = true;
        if (this.b.b()) {
          t();
        }
      }
      return;
    }
  }
  
  protected final void onDetachedFromWindow()
  {
    synchronized (this.d)
    {
      if (!o())
      {
        s();
        this.a = false;
      }
      super.onDetachedFromWindow();
      return;
    }
  }
  
  public final void onDownloadStart(String paramString1, String paramString2, String paramString3, String paramString4, long paramLong)
  {
    try
    {
      paramString2 = new Intent("android.intent.action.VIEW");
      paramString2.setDataAndType(Uri.parse(paramString1), paramString4);
      getContext().startActivity(paramString2);
      return;
    }
    catch (ActivityNotFoundException paramString2)
    {
      b.a("Couldn't find an Activity to view url/mimetype: " + paramString1 + " / " + paramString4);
    }
  }
  
  protected final void onDraw(Canvas paramCanvas)
  {
    if (o()) {}
    while ((Build.VERSION.SDK_INT == 21) && (paramCanvas.isHardwareAccelerated()) && (!isAttachedToWindow())) {
      return;
    }
    super.onDraw(paramCanvas);
  }
  
  public final void onGlobalLayout()
  {
    int i1 = 0;
    if (!this.b.b())
    {
      localObject1 = f();
      if ((localObject1 != null) && (i1 != 0)) {
        ((c)localObject1).n();
      }
      return;
    }
    w.e();
    Object localObject1 = nj.a(this.u);
    l.a();
    int i4 = a.b((DisplayMetrics)localObject1, ((DisplayMetrics)localObject1).widthPixels);
    l.a();
    int i5 = a.b((DisplayMetrics)localObject1, ((DisplayMetrics)localObject1).heightPixels);
    Object localObject2 = this.c.a();
    int i3;
    int i2;
    if ((localObject2 == null) || (((Activity)localObject2).getWindow() == null))
    {
      i3 = i5;
      i2 = i4;
      label106:
      if ((this.r == i4) && (this.q == i5) && (this.s == i2) && (this.t == i3)) {
        break label259;
      }
      if ((this.r == i4) && (this.q == i5)) {
        break label261;
      }
    }
    label259:
    label261:
    for (i1 = 1;; i1 = 0)
    {
      this.r = i4;
      this.q = i5;
      this.s = i2;
      this.t = i3;
      new ir(this).a(i4, i5, i2, i3, ((DisplayMetrics)localObject1).density, this.u.getDefaultDisplay().getRotation());
      break;
      w.e();
      localObject2 = nj.a((Activity)localObject2);
      l.a();
      i2 = a.b((DisplayMetrics)localObject1, localObject2[0]);
      l.a();
      i3 = a.b((DisplayMetrics)localObject1, localObject2[1]);
      break label106;
      break;
    }
  }
  
  protected final void onMeasure(int paramInt1, int paramInt2)
  {
    int i2 = Integer.MAX_VALUE;
    synchronized (this.d)
    {
      if (o())
      {
        setMeasuredDimension(0, 0);
        return;
      }
      if ((isInEditMode()) || (this.k))
      {
        super.onMeasure(paramInt1, paramInt2);
        return;
      }
    }
    if (this.h.f)
    {
      DisplayMetrics localDisplayMetrics = new DisplayMetrics();
      this.u.getDefaultDisplay().getMetrics(localDisplayMetrics);
      setMeasuredDimension(localDisplayMetrics.widthPixels, localDisplayMetrics.heightPixels);
      return;
    }
    int i5 = View.MeasureSpec.getMode(paramInt1);
    int i1 = View.MeasureSpec.getSize(paramInt1);
    int i4 = View.MeasureSpec.getMode(paramInt2);
    int i3 = View.MeasureSpec.getSize(paramInt2);
    if (i5 != Integer.MIN_VALUE) {
      if (i5 == 1073741824) {
        break label345;
      }
    }
    for (;;)
    {
      if ((this.h.h > paramInt1) || (this.h.e > paramInt2))
      {
        float f1 = this.c.getResources().getDisplayMetrics().density;
        b.e("Not enough space to show ad. Needs " + (int)(this.h.h / f1) + "x" + (int)(this.h.e / f1) + " dp, but only has " + (int)(i1 / f1) + "x" + (int)(i3 / f1) + " dp.");
        if (getVisibility() != 8) {
          setVisibility(4);
        }
        setMeasuredDimension(0, 0);
      }
      for (;;)
      {
        return;
        if (getVisibility() != 8) {
          setVisibility(0);
        }
        setMeasuredDimension(this.h.h, this.h.e);
      }
      paramInt1 = Integer.MAX_VALUE;
      break label348;
      label345:
      paramInt1 = i1;
      label348:
      if (i4 != Integer.MIN_VALUE)
      {
        paramInt2 = i2;
        if (i4 != 1073741824) {}
      }
      else
      {
        paramInt2 = i3;
      }
    }
  }
  
  public final void onPause()
  {
    if (o()) {
      return;
    }
    try
    {
      super.onPause();
      return;
    }
    catch (Exception localException)
    {
      b.b("Could not pause webview.", localException);
    }
  }
  
  public final void onResume()
  {
    if (o()) {
      return;
    }
    try
    {
      super.onResume();
      return;
    }
    catch (Exception localException)
    {
      b.b("Could not resume webview.", localException);
    }
  }
  
  public final boolean onTouchEvent(MotionEvent paramMotionEvent)
  {
    if (this.e != null) {
      this.e.a(paramMotionEvent);
    }
    if (o()) {
      return false;
    }
    return super.onTouchEvent(paramMotionEvent);
  }
  
  public final void p()
  {
    synchronized (this.d)
    {
      b.d("Destroying WebView!");
      super.destroy();
      return;
    }
  }
  
  public final void q()
  {
    synchronized (this.d)
    {
      t();
      return;
    }
  }
  
  public final void stopLoading()
  {
    if (o()) {
      return;
    }
    try
    {
      super.stopLoading();
      return;
    }
    catch (Exception localException)
    {
      b.b("Could not stop loading webview.", localException);
    }
  }
}
