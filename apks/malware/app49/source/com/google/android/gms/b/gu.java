package com.google.android.gms.b;

import com.google.android.gms.ads.internal.util.client.b;
import com.google.android.gms.common.internal.aq;

public final class gu
  extends ot<bo>
{
  private final Object d = new Object();
  private go<bo> e;
  private boolean f;
  private int g;
  
  public gu(go<bo> paramGo)
  {
    this.e = paramGo;
    this.f = false;
    this.g = 0;
  }
  
  private void f()
  {
    for (;;)
    {
      synchronized (this.d)
      {
        if (this.g >= 0)
        {
          bool = true;
          aq.a(bool);
          if ((this.f) && (this.g == 0))
          {
            b.d("No reference is left (including root). Cleaning up engine.");
            a(new gx(this), new or());
            return;
          }
          b.d("There are still references to the engine. Not destroying.");
        }
      }
      boolean bool = false;
    }
  }
  
  public final gq a()
  {
    gq localGq = new gq(this);
    synchronized (this.d)
    {
      a(new gv(this, localGq), new gw(this, localGq));
      if (this.g >= 0)
      {
        bool = true;
        aq.a(bool);
        this.g += 1;
        return localGq;
      }
      boolean bool = false;
    }
  }
  
  protected final void b()
  {
    synchronized (this.d)
    {
      if (this.g > 0)
      {
        bool = true;
        aq.a(bool);
        b.d("Releasing 1 reference for JS Engine");
        this.g -= 1;
        f();
        return;
      }
      boolean bool = false;
    }
  }
  
  public final void c()
  {
    boolean bool = true;
    synchronized (this.d)
    {
      if (this.g >= 0)
      {
        aq.a(bool);
        b.d("Releasing root reference. JS Engine will be destroyed once other references are released.");
        this.f = true;
        f();
        return;
      }
      bool = false;
    }
  }
}
