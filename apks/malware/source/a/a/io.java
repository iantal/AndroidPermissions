package a.a;

import android.content.Context;
import android.text.TextUtils;
import com.umeng.analytics.AnalyticsConfig;
import com.umeng.analytics.ReportPolicy.g;
import com.umeng.analytics.f;
import com.umeng.analytics.h;
import com.umeng.analytics.onlineconfig.c;
import java.util.Iterator;
import java.util.List;

public final class io
  implements iy, jf, c
{
  private jb a = null;
  private h b = null;
  private b c = null;
  private l d = new l();
  private iq e = null;
  private int f = 10;
  private int g;
  private Context h;
  
  public io(Context paramContext)
  {
    this.h = paramContext;
    this.a = new jb(paramContext);
    this.c = new b(paramContext);
    this.b = h.a(paramContext);
    this.d.a(this.b.d());
    this.e = new iq(this);
    this.g = this.b.d(-1);
  }
  
  private fs a(byte[] paramArrayOfByte)
  {
    if (paramArrayOfByte == null) {
      return null;
    }
    try
    {
      fs localFs = new fs();
      new gu().a(localFs, paramArrayOfByte);
      return localFs;
    }
    catch (Exception paramArrayOfByte)
    {
      paramArrayOfByte.printStackTrace();
    }
    return null;
  }
  
  private void a(fs paramFs)
  {
    hm localHm;
    if (paramFs != null)
    {
      localHm = hm.a(this.h);
      localHm.a();
      paramFs.a(localHm.b());
      paramFs = b(paramFs);
      if (paramFs != null) {}
    }
    else
    {
      return;
    }
    if (e()) {}
    for (paramFs = gl.b(this.h, AnalyticsConfig.getAppkey(this.h), paramFs);; paramFs = gl.a(this.h, AnalyticsConfig.getAppkey(this.h), paramFs))
    {
      paramFs = paramFs.c();
      h localH = h.a(this.h);
      localH.g();
      localH.b(paramFs);
      localHm.c();
      return;
    }
  }
  
  private void a(boolean paramBoolean)
  {
    boolean bool = this.c.a();
    if (bool) {
      this.a.a(new n(this.c.i()));
    }
    if (b(paramBoolean)) {
      d();
    }
    while ((!bool) && (!c())) {
      return;
    }
    b();
  }
  
  private boolean b(boolean paramBoolean)
  {
    boolean bool2 = true;
    boolean bool1;
    if (!gg.g(this.h))
    {
      if (gh.a) {
        gh.c("MobclickAgent", "network is unavailable");
      }
      bool1 = false;
    }
    do
    {
      do
      {
        return bool1;
        bool1 = bool2;
      } while (this.c.a());
      if (!gh.a) {
        break;
      }
      bool1 = bool2;
    } while (gg.q(this.h));
    return this.e.c().a(paramBoolean);
  }
  
  private byte[] b(fs paramFs)
  {
    if (paramFs == null) {
      return null;
    }
    try
    {
      byte[] arrayOfByte = new gx().a(paramFs);
      if (gh.a) {
        gh.c("MobclickAgent", paramFs.toString());
      }
      return arrayOfByte;
    }
    catch (Exception paramFs)
    {
      gh.b("MobclickAgent", "Fail to serialize log ...", paramFs);
    }
    return null;
  }
  
  private boolean c()
  {
    return this.a.a() > this.f;
  }
  
  private void d()
  {
    try
    {
      if (this.b.h())
      {
        localObject = new jh(this.h, this.c);
        ((jh)localObject).a(this);
        if (this.d.b()) {
          ((jh)localObject).b(true);
        }
        ((jh)localObject).a();
        return;
      }
      Object localObject = a(new int[0]);
      if (localObject == null)
      {
        gh.a("MobclickAgent", "No data to report");
        return;
      }
    }
    catch (Throwable localThrowable)
    {
      if ((!(localThrowable instanceof OutOfMemoryError)) || (localThrowable != null))
      {
        localThrowable.printStackTrace();
        return;
        jh localJh = new jh(this.h, this.c);
        localJh.a(this);
        if (this.d.b()) {
          localJh.b(true);
        }
        localJh.a(localThrowable);
        localJh.a(e());
        localJh.a();
      }
    }
  }
  
  private void d(int paramInt)
  {
    a(a(new int[] { paramInt, (int)(System.currentTimeMillis() - this.c.j()) }));
    f.a(new ip(this), paramInt);
  }
  
  private void e(int paramInt)
  {
    d(paramInt);
  }
  
  private boolean e()
  {
    switch (this.g)
    {
    case 0: 
    default: 
      return false;
    case 1: 
      return true;
    }
    return AnalyticsConfig.sEncrypt;
  }
  
  protected fs a(int... paramVarArgs)
  {
    int i = 0;
    label241:
    label244:
    label247:
    label249:
    for (;;)
    {
      Object localObject1;
      try
      {
        if (TextUtils.isEmpty(AnalyticsConfig.getAppkey(this.h)))
        {
          gh.b("MobclickAgent", "Appkey is missing ,Please check AndroidManifest.xml");
          return null;
        }
        localObject1 = h.a(this.h).f();
        if (localObject1 == null)
        {
          localObject1 = null;
          if ((localObject1 == null) && (this.a.a() == 0)) {
            return null;
          }
        }
        else
        {
          localObject1 = a((byte[])localObject1);
          continue;
        }
        if (localObject1 != null) {
          break label244;
        }
        localObject1 = new fs();
        this.a.a((fs)localObject1);
        if ((gh.a) && (((fs)localObject1).f()))
        {
          localObject2 = ((fs)localObject1).e().iterator();
          if (((Iterator)localObject2).hasNext())
          {
            if (((fe)((Iterator)localObject2).next()).d() <= 0) {
              break label241;
            }
            i = 1;
            break label249;
          }
          if (i == 0) {
            gh.d("MobclickAgent", "missing Activities or PageViews");
          }
        }
        localObject1 = this.d.a(this.h, (fs)localObject1);
        if ((paramVarArgs == null) || (paramVarArgs.length != 2)) {
          break label247;
        }
        Object localObject2 = new ap();
        ((ap)localObject2).a(new dk(paramVarArgs[0] / 1000, paramVarArgs[1]));
        ((fs)localObject1).a((ap)localObject2);
        return localObject1;
      }
      catch (Exception paramVarArgs)
      {
        gh.b("MobclickAgent", "Fail to construct message ...", paramVarArgs);
        h.a(this.h).g();
        return null;
      }
      break label249;
      continue;
      return localObject1;
    }
  }
  
  public void a()
  {
    if (gg.g(this.h)) {
      d();
    }
    while (!gh.a) {
      return;
    }
    gh.c("MobclickAgent", "network is unavailable");
  }
  
  public void a(int paramInt)
  {
    if ((paramInt >= 0) && (paramInt <= 3))
    {
      this.d.a(paramInt);
      this.e.b(paramInt);
    }
  }
  
  public void a(int paramInt, long paramLong)
  {
    this.e.a(paramInt, (int)paramLong);
  }
  
  public void a(iz paramIz)
  {
    if (paramIz != null) {
      this.a.a(paramIz);
    }
    a(paramIz instanceof fe);
  }
  
  public void b()
  {
    if (this.a.a() > 0) {}
    try
    {
      byte[] arrayOfByte = b(a(new int[0]));
      if (arrayOfByte != null) {
        this.b.a(arrayOfByte);
      }
      return;
    }
    catch (Throwable localThrowable)
    {
      do
      {
        if ((localThrowable instanceof OutOfMemoryError)) {
          this.b.g();
        }
      } while (localThrowable == null);
      localThrowable.printStackTrace();
    }
  }
  
  public void b(int paramInt)
  {
    if (paramInt > 0) {
      this.e.a(paramInt);
    }
  }
  
  public void b(iz paramIz)
  {
    this.a.a(paramIz);
  }
  
  public void c(int paramInt)
  {
    this.g = paramInt;
  }
}
