package gqq.wwvrslwg.tnyijqWfo.a.a;

import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageManager;
import android.net.Uri;
import java.io.File;
import java.util.List;

public class f
{
  protected Context a;
  protected String b;
  protected String c;
  protected int d;
  protected String e = "";
  protected g f;
  protected boolean g;
  protected boolean h;
  protected NotificationManager i;
  protected Notification j;
  protected int k;
  
  public f(Context paramContext, String paramString)
  {
    this.a = paramContext;
    this.b = paramString;
    this.c = this.b.substring(this.b.lastIndexOf("/") + 1);
    h();
    this.d = 0;
    this.f = null;
    this.e = null;
    this.g = false;
    this.h = false;
    this.k = (b.a().b().size() + 5);
    this.j = null;
    this.i = ((NotificationManager)this.a.getSystemService("notification"));
    e.a(this.a);
  }
  
  private void h()
  {
    int m = this.c.indexOf("?");
    if (m > 0) {
      this.c = this.c.substring(0, m);
    }
  }
  
  public final String a()
  {
    return this.b;
  }
  
  public void a(int paramInt)
  {
    this.d = paramInt;
    this.j.setLatestEventInfo(this.a.getApplicationContext(), paramInt + " %", this.c, null);
    Notification localNotification = this.j;
    localNotification.flags |= 0x2;
    this.i.notify(this.k, this.j);
    d.a().a(2, this);
  }
  
  public final void a(String paramString)
  {
    this.c = paramString;
    h();
  }
  
  public final String b()
  {
    return e.a().getAbsolutePath() + File.separator + this.c;
  }
  
  public final void b(String paramString)
  {
    this.e = paramString;
  }
  
  public final String c()
  {
    return this.e;
  }
  
  public void d()
  {
    this.j = new Notification(17301633, "Downloading...", System.currentTimeMillis());
    Object localObject = new Intent();
    localObject = PendingIntent.getActivity(this.a.getApplicationContext(), 0, (Intent)localObject, 0);
    this.j.setLatestEventInfo(this.a.getApplicationContext(), "0 %", this.c, (PendingIntent)localObject);
    localObject = this.j;
    ((Notification)localObject).flags |= 0x2;
    this.i.notify(this.k, this.j);
    d.a().a(0, this);
  }
  
  public void e()
  {
    this.d = 100;
    this.f = null;
    this.g = true;
    if (this.j != null) {
      this.i.cancel(this.k);
    }
    this.j = new Notification(17301514, "Finish.", System.currentTimeMillis());
    Object localObject1 = this.j;
    ((Notification)localObject1).flags |= 0x10;
    localObject1 = new Intent("android.intent.action.VIEW");
    ((Intent)localObject1).setDataAndType(Uri.fromFile(new File(b())), "application/vnd.android.package-archive");
    ((Intent)localObject1).addFlags(1);
    ((Intent)localObject1).addFlags(268435456);
    ((Intent)localObject1).setClassName("com.android.packageinstaller", "com.android.packageinstaller.PackageInstallerActivity");
    localObject1 = PendingIntent.getActivity(this.a.getApplicationContext(), 0, (Intent)localObject1, 0);
    this.j.setLatestEventInfo(this.a.getApplicationContext(), this.c, "Finished!", (PendingIntent)localObject1);
    this.i.notify(this.k, this.j);
    localObject1 = this.a;
    Object localObject2 = b();
    try
    {
      if (((Context)localObject1).getPackageManager().getPackageArchiveInfo((String)localObject2, 0) == null)
      {
        localObject1 = new File((String)localObject2);
        if (((File)localObject1).exists()) {
          ((File)localObject1).delete();
        }
      }
      for (;;)
      {
        b.a().b().remove(this);
        d.a().a(1, this);
        return;
        localObject2 = new File((String)localObject2);
        Intent localIntent = new Intent();
        localIntent.addFlags(268435456);
        localIntent.addFlags(1);
        localIntent.setAction("android.intent.action.VIEW");
        localIntent.setDataAndType(Uri.fromFile((File)localObject2), "application/vnd.android.package-archive");
        ((Context)localObject1).startActivity(localIntent);
      }
    }
    catch (Exception localException)
    {
      for (;;) {}
    }
  }
  
  public void f()
  {
    this.d = 100;
    this.f = null;
    this.g = true;
    try
    {
      this.j = new Notification(17301514, "Failed.", System.currentTimeMillis());
      Notification localNotification = this.j;
      localNotification.flags |= 0x10;
      this.j.setLatestEventInfo(this.a.getApplicationContext(), this.c, "Failed!", null);
      this.i.notify(this.k, this.j);
      b.a().b().remove(this);
      d.a().a(3, this);
      return;
    }
    catch (Exception localException)
    {
      for (;;) {}
    }
  }
  
  public void g()
  {
    if (this.f != null) {
      this.f.a();
    }
    this.f = new g(this);
    new Thread(this.f).start();
  }
}
