package cn.domob.android.ads;

import android.app.AlertDialog.Builder;
import android.content.Context;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.content.Intent;
import android.net.Uri;
import android.widget.Toast;
import cn.domob.android.a.a;
import cn.domob.android.a.c;
import java.io.UnsupportedEncodingException;
import java.net.URLDecoder;

class o
{
  private static final String m = "url";
  private static final String n = "auto_run";
  private static final String o = "name";
  private static final String p = "pkg";
  private static final String q = "vc";
  private static final String r = "vn";
  H a = new H(o.class.getSimpleName());
  private Context b;
  private Uri c;
  private i d;
  private String e;
  private boolean f = false;
  private String g;
  private String h;
  private int i;
  private String j;
  private String k;
  private a l;
  
  o(Context paramContext, Uri paramUri, i paramI, a paramA)
  {
    this.b = paramContext;
    this.c = paramUri;
    this.d = paramI;
    this.l = paramA;
  }
  
  o(Context paramContext, String paramString1, String paramString2, String paramString3, int paramInt, String paramString4, z paramZ)
  {
    this(paramContext, paramString1, paramString2, paramString3, paramInt, paramString4, null, paramZ);
  }
  
  o(Context paramContext, String paramString1, String paramString2, String paramString3, int paramInt, String paramString4, String paramString5, z paramZ)
  {
    this.b = paramContext;
    this.e = paramString1;
    this.g = paramString2;
    this.h = paramString3;
    this.i = paramInt;
    this.j = paramString4;
    this.k = paramString5;
    this.l = paramZ;
  }
  
  private String a(Uri paramUri, String paramString)
    throws UnsupportedEncodingException
  {
    paramUri = paramUri.getQueryParameter(paramString);
    if (paramUri != null) {
      return URLDecoder.decode(paramUri, "UTF-8");
    }
    return null;
  }
  
  private void j()
  {
    try
    {
      this.e = a(this.c, "url");
      boolean bool;
      if (a(this.c, "auto_run") == null)
      {
        bool = false;
        this.f = bool;
        this.g = a(this.c, "name");
        this.h = a(this.c, "pkg");
        if (a(this.c, "vc") != null) {
          break label117;
        }
      }
      label117:
      for (int i1 = 1;; i1 = Integer.valueOf(a(this.c, "vc")).intValue())
      {
        this.i = i1;
        this.j = a(this.c, "vn");
        return;
        bool = Boolean.valueOf(a(this.c, "auto_run")).booleanValue();
        break;
      }
      return;
    }
    catch (UnsupportedEncodingException localUnsupportedEncodingException)
    {
      this.a.e("Error happened in getting download info");
    }
  }
  
  private void k()
  {
    this.a.b("Start Download url:" + this.e);
    a.a(this.e, this.g, this.h, this.b, new c()
    {
      public void a()
      {
        Toast.makeText(o.b(o.this), "开始下载 。。。", 0).show();
        if (o.a(o.this) != null) {
          o.a(o.this).e(o.this);
        }
      }
      
      public void a(int paramAnonymousInt, String paramAnonymousString)
      {
        if (o.a(o.this) != null)
        {
          if (paramAnonymousInt == 512) {
            o.a(o.this).g(o.this);
          }
        }
        else {
          return;
        }
        if (paramAnonymousInt == 513)
        {
          o.a(o.this).h(o.this);
          return;
        }
        o.a(o.this).d(o.this);
      }
      
      public void a(String paramAnonymousString)
      {
        if (o.a(o.this) != null) {
          o.a(o.this).c(o.this);
        }
        if (o.a(o.this) != null) {
          o.a(o.this).j(o.this);
        }
      }
      
      public void b()
      {
        if (o.a(o.this) != null) {
          o.a(o.this).f(o.this);
        }
      }
      
      public void b(String paramAnonymousString)
      {
        if (o.a(o.this) != null) {
          o.a(o.this).i(o.this);
        }
      }
    }, this.k, true);
  }
  
  protected i a()
  {
    return this.d;
  }
  
  protected String b()
  {
    return this.g;
  }
  
  protected String c()
  {
    return this.h;
  }
  
  protected int d()
  {
    return this.i;
  }
  
  protected String e()
  {
    return this.j;
  }
  
  protected boolean f()
  {
    return this.f;
  }
  
  protected String g()
  {
    return this.e;
  }
  
  protected Uri h()
  {
    return this.c;
  }
  
  protected void i()
  {
    if (this.c != null) {
      j();
    }
    if (A.e(this.g)) {
      this.g = "应用";
    }
    final Intent localIntent = a.a(this.b, this.e, this.g);
    if (localIntent != null)
    {
      if (this.b != null) {
        new AlertDialog.Builder(this.b).setTitle("安装").setMessage(this.g + "已经下载是否现在安装?").setNegativeButton("否", new DialogInterface.OnClickListener()
        {
          public void onClick(DialogInterface paramAnonymousDialogInterface, int paramAnonymousInt) {}
        }).setPositiveButton("是", new DialogInterface.OnClickListener()
        {
          public void onClick(DialogInterface paramAnonymousDialogInterface, int paramAnonymousInt)
          {
            if (o.a(o.this) != null) {
              o.a(o.this).j(o.this);
            }
            o.b(o.this).startActivity(localIntent);
          }
        }).show();
      }
      return;
    }
    k();
  }
  
  static abstract interface a
  {
    public abstract void c(o paramO);
    
    public abstract void d(o paramO);
    
    public abstract void e(o paramO);
    
    public abstract void f(o paramO);
    
    public abstract void g(o paramO);
    
    public abstract void h(o paramO);
    
    public abstract void i(o paramO);
    
    public abstract void j(o paramO);
  }
}
