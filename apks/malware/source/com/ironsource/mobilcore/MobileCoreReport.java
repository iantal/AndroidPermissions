package com.ironsource.mobilcore;

import android.app.Service;
import android.content.Intent;
import android.os.Handler;
import android.os.IBinder;
import java.util.ArrayList;
import java.util.concurrent.LinkedBlockingQueue;

public class MobileCoreReport
  extends Service
{
  private ArrayList<b> a;
  private LinkedBlockingQueue<a> b;
  private Handler c;
  private int d;
  private Runnable e = new Runnable()
  {
    public final void run()
    {
      A.a("MobileCoreReport service , mStopSelfRunnable , run() | called. stopping self", 55);
      MobileCoreReport.this.stopSelf();
    }
  };
  
  public MobileCoreReport() {}
  
  private void a(boolean paramBoolean)
  {
    A.a("MobileCoreReport service , addRemoveStopSelfRunnable() | called. doAdd:" + paramBoolean, 55);
    if (paramBoolean)
    {
      this.c.postDelayed(this.e, 5000L);
      return;
    }
    this.c.removeCallbacks(this.e);
  }
  
  private int c()
  {
    try
    {
      int i = this.d;
      return i;
    }
    finally
    {
      localObject = finally;
      throw localObject;
    }
  }
  
  public final void a()
  {
    try
    {
      this.d -= 1;
      return;
    }
    finally
    {
      localObject = finally;
      throw localObject;
    }
  }
  
  public final void b()
  {
    try
    {
      this.d += 1;
      return;
    }
    finally
    {
      localObject = finally;
      throw localObject;
    }
  }
  
  public IBinder onBind(Intent paramIntent)
  {
    return null;
  }
  
  public void onCreate()
  {
    int i = 0;
    A.a("MobileCoreReport service onCreate() | called", 55);
    this.b = new LinkedBlockingQueue(50);
    this.a = new ArrayList(5);
    this.c = new Handler();
    this.d = 0;
    while (i < 5)
    {
      b localB = new b();
      this.a.add(localB);
      localB.start();
      i += 1;
    }
  }
  
  public void onDestroy()
  {
    A.a("MobileCoreReport service onDestroy() | called", 55);
    super.onDestroy();
    this.b.clear();
    this.a.clear();
  }
  
  public int onStartCommand(Intent paramIntent, int paramInt1, int paramInt2)
  {
    A.a("MobileCoreReport service , onStartCommand() | startId:" + paramInt2, 55);
    paramIntent = new a(paramInt2, paramIntent);
    try
    {
      a(false);
      this.b.add(paramIntent);
      return 1;
    }
    catch (IllegalStateException paramIntent)
    {
      for (;;)
      {
        A.a("MobileCoreReport service , ServiceTask , doJob() | dropping request:" + paramInt2, 55);
      }
    }
  }
  
  public final class a
  {
    private int b;
    private Intent c;
    
    public a(int paramInt, Intent paramIntent)
    {
      this.b = paramInt;
      this.c = paramIntent;
    }
    
    public final void a()
    {
      if (this.c != null)
      {
        A.a("MobileCoreReport service , ServiceTask , doJob() | mStartId:" + this.b, 55);
        new aJ().a(MobileCoreReport.this, this.c);
      }
    }
  }
  
  public final class b
    extends Thread
  {
    public b() {}
    
    public final void run()
    {
      super.run();
      try
      {
        for (;;)
        {
          MobileCoreReport.a localA = (MobileCoreReport.a)MobileCoreReport.a(MobileCoreReport.this).take();
          MobileCoreReport.this.b();
          localA.a();
          MobileCoreReport.this.a();
          MobileCoreReport.b(MobileCoreReport.this);
        }
        return;
      }
      catch (InterruptedException localInterruptedException) {}
    }
  }
}
