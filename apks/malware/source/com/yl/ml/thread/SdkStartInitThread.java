package com.yl.ml.thread;

import android.content.Context;
import android.os.Handler;
import com.yl.codelib.comm.MyPreference;
import com.yl.codelib.encryption.DESEncryptor;
import com.yl.codelib.encryption.MD5Encoder;
import com.yl.codelib.utils.HttpConnent;
import com.yl.codelib.utils.LogUtil;
import com.yl.codelib.utils.TimeUtil;
import java.util.Map;
import org.json.JSONException;
import org.json.JSONObject;

public class SdkStartInitThread
  extends BaseHttpThread
{
  private Context aU;
  
  public SdkStartInitThread(String paramString, Context paramContext, Handler paramHandler, Map paramMap)
  {
    super(paramString, paramHandler, paramMap);
    this.aU = paramContext;
  }
  
  public void run()
  {
    MyPreference localMyPreference = new MyPreference(this.aU);
    String str1 = TimeUtil.getNowTimeNum();
    String str2 = MD5Encoder.EncoderByMd5(str1 + DESEncryptor.getDec(BaseHttpThread.API_KEY));
    this.maps.put("signkey", str2);
    this.maps.put("reqTime", str1);
    str1 = HttpConnent.doHttpPost(this.url, getPostParams(this.maps), 0);
    try
    {
      localMyPreference.write("province", new JSONObject(str1).getString("province"));
      if (this.handler != null)
      {
        if (str1.equals("NO")) {
          this.handler.sendEmptyMessage(-1);
        }
      }
      else
      {
        LogUtil.v(getFullUrl(this.url, this.maps));
        LogUtil.v(str1 + "-----");
        return;
      }
    }
    catch (JSONException localJSONException)
    {
      for (;;)
      {
        localMyPreference.write("province", "");
        continue;
        this.msg.what = 1;
        this.msg.obj = str1;
        this.handler.sendMessage(this.msg);
      }
    }
  }
}
