package com.shoufu.lib;

import android.util.Log;
import android.util.SparseIntArray;
import java.io.File;
import java.util.ArrayList;

class x
  extends Thread
{
  x(w paramW) {}
  
  public void run()
  {
    int j = 0;
    if (w.a(this.a))
    {
      w.a(this.a, false);
      localObject = new File(w.b(this.a));
      if (!((File)localObject).exists())
      {
        ((File)localObject).mkdirs();
        Log.d(w.c(this.a), w.d(this.a) + "：make dirs");
      }
      if (!new File(w.e(this.a)).exists())
      {
        w.f(this.a).b(w.g(this.a));
        w.f(this.a).e(w.g(this.a));
      }
      if (!w.f(this.a).a(w.g(this.a))) {
        break label627;
      }
      Log.d(w.c(this.a), w.d(this.a) + "：start get fileSize from url");
      w.a(this.a, ad.c(w.g(this.a)));
      if (w.h(this.a) == 0)
      {
        Log.d(w.c(this.a), w.d(this.a) + "：get fileSize error");
        this.a.b();
      }
    }
    else
    {
      return;
    }
    w.f(this.a).a(w.g(this.a), w.i(this.a), w.h(this.a), 0);
    Log.d(w.c(this.a), w.d(this.a) + "：add new file");
    w.a(this.a, new v[w.j(this.a)]);
    Object localObject = this.a;
    int k = w.h(this.a) / w.j(this.a);
    int i;
    if (w.h(this.a) % w.j(this.a) == 0)
    {
      i = 0;
      label405:
      w.b((w)localObject, i + k);
      w.a(this.a, w.f(this.a).d(w.g(this.a)));
      if (w.j(this.a) != w.k(this.a).size())
      {
        w.f(this.a).e(w.g(this.a));
        w.k(this.a).clear();
        i = j;
      }
    }
    for (;;)
    {
      if (i >= w.j(this.a))
      {
        Log.d(w.c(this.a), w.d(this.a) + "：add new threads task");
        Log.d(w.c(this.a), w.d(this.a) + "：init download ok：" + "fileSize--->" + w.h(this.a) + " threadNum--->" + w.j(this.a) + " blockSize--->" + w.l(this.a));
        w.m(this.a);
        return;
        label627:
        w.a(this.a, w.f(this.a).c(w.g(this.a)));
        Log.d(w.c(this.a), w.d(this.a) + "：get fileSize from database");
        break;
        i = 1;
        break label405;
      }
      localObject = new SparseIntArray();
      ((SparseIntArray)localObject).put(i, w.l(this.a) * i);
      w.k(this.a).add(localObject);
      w.f(this.a).a(w.g(this.a), i, (SparseIntArray)localObject);
      i += 1;
    }
  }
}
