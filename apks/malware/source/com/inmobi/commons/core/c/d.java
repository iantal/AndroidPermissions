package com.inmobi.commons.core.c;

import android.content.ContentValues;
import com.inmobi.commons.core.b.b;
import com.inmobi.commons.core.utilities.Logger;
import com.inmobi.commons.core.utilities.Logger.InternalLogLevel;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

public class d
{
  private static final String a = d.class.getSimpleName();
  
  public d()
  {
    b localB = b.a();
    localB.a("telemetry", "(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, componentType TEXT NOT NULL, eventType TEXT NOT NULL, payload TEXT NOT NULL, ts TEXT NOT NULL)");
    localB.a("metric", "(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, componentType TEXT NOT NULL, eventType TEXT NOT NULL, payload TEXT NOT NULL )");
    localB.b();
  }
  
  private void b(List paramList)
  {
    if (paramList.isEmpty()) {
      return;
    }
    b localB = b.a();
    String str = "";
    int i = 0;
    while (i < paramList.size() - 1)
    {
      str = str + ((ContentValues)paramList.get(i)).getAsString("id") + ",";
      i += 1;
    }
    paramList = str + ((ContentValues)paramList.get(paramList.size() - 1)).getAsString("id");
    Logger.a(Logger.InternalLogLevel.INTERNAL, a, "Deleting events with id: " + paramList);
    i = localB.a("telemetry", "id IN (" + paramList + ")", null);
    localB.b();
    Logger.a(Logger.InternalLogLevel.INTERNAL, a, "Deleted Count: " + i);
  }
  
  public List a()
  {
    b localB = b.a();
    List localList = localB.a("metric", null, null, null, null, null, null, null);
    localB.b();
    b();
    return localList;
  }
  
  public List a(int paramInt)
  {
    Logger.a(Logger.InternalLogLevel.INTERNAL, a, "Querying db for events");
    Object localObject = b.a();
    List localList = ((b)localObject).a("telemetry", null, null, null, null, null, "ts ASC", String.valueOf(paramInt));
    b(localList);
    ArrayList localArrayList = new ArrayList();
    ((b)localObject).b();
    localObject = localList.iterator();
    while (((Iterator)localObject).hasNext()) {
      localArrayList.add(e.a((ContentValues)((Iterator)localObject).next()));
    }
    return localArrayList;
  }
  
  public void a(e paramE)
  {
    b localB = b.a();
    localB.a("telemetry", paramE.e());
    localB.b();
  }
  
  public void a(String paramString1, String paramString2, String paramString3)
  {
    b localB = b.a();
    ContentValues localContentValues = new ContentValues();
    localContentValues.put("componentType", paramString1);
    localContentValues.put("eventType", paramString2);
    localContentValues.put("payload", paramString3);
    localB.a("metric", localContentValues);
    localB.b();
  }
  
  public void a(List paramList)
  {
    b localB = b.a();
    paramList = paramList.iterator();
    while (paramList.hasNext()) {
      localB.a("telemetry", ((e)paramList.next()).e());
    }
    localB.b();
  }
  
  public void b()
  {
    b localB = b.a();
    localB.a("metric", null, null);
    localB.b();
  }
  
  public int c()
  {
    b localB = b.a();
    int i = localB.a("telemetry");
    localB.b();
    return i;
  }
}
