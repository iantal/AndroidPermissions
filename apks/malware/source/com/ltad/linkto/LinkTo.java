package com.ltad.linkto;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.net.Uri;
import android.util.Log;
import com.ltad.a.i;
import com.ltad.util.PropertyUtil;
import java.lang.ref.WeakReference;

public class LinkTo
{
  private static final String TAG = "Joy_LinkTo";
  private static long lastGainCoinsTimer = 0L;
  private static LinkTo mInstance = new LinkTo();
  private final boolean isDemo = false;
  private WeakReference mActivityRef;
  
  private LinkTo() {}
  
  public static LinkTo getInstance(Activity paramActivity)
  {
    if ((mInstance.mActivityRef == null) || (paramActivity != mInstance.mActivityRef.get())) {
      mInstance.mActivityRef = new WeakReference(paramActivity);
    }
    return mInstance;
  }
  
  public void destroy()
  {
    Log.i("Joy_LinkTo", "Destroy Complete");
  }
  
  public String link(String paramString)
  {
    Log.i("Joy_LinkTo", "Link To Type: " + paramString);
    String str = "";
    if ((i.a(524288).equals(paramString)) || (i.a(524289).equals(paramString)) || (i.a(524290).equals(paramString))) {
      ((Activity)this.mActivityRef.get()).runOnUiThread(new LinkTo.1(this));
    }
    if (((i.a(524291).equals(paramString)) || (i.a(524292).equals(paramString))) && (this.mActivityRef.get() != null))
    {
      Intent localIntent = new Intent("android.intent.action.VIEW", Uri.parse(i.a(524299) + ((Activity)this.mActivityRef.get()).getPackageName()));
      localIntent.setPackage(i.a(524300));
      ((Activity)this.mActivityRef.get()).startActivity(localIntent);
    }
    if (i.a(524293).equals(paramString))
    {
      link(i.a(524288));
      paramString = i.a(524294);
      if (System.currentTimeMillis() - lastGainCoinsTimer <= 60000L) {
        break label299;
      }
      lastGainCoinsTimer = System.currentTimeMillis();
      paramString = PropertyUtil.getPropertyDefault((Context)this.mActivityRef.get(), i.a(524296), i.a(524295));
    }
    label299:
    for (;;)
    {
      int i = Integer.parseInt(paramString);
      str = paramString;
      if (i > 0)
      {
        ((Activity)this.mActivityRef.get()).runOnUiThread(new LinkTo.2(this, i));
        str = paramString;
      }
      return str;
    }
  }
}
