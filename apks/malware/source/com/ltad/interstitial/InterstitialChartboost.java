package com.ltad.interstitial;

import android.app.Activity;
import android.content.Context;
import android.util.Log;
import com.chartboost.sdk.Chartboost;
import com.ltad.a.i;
import com.ltad.util.InterstitialUtil;
import com.ltad.util.PropertyUtil;
import java.lang.ref.SoftReference;

public class InterstitialChartboost
  extends InterstitialAdapter
{
  private static final String TAG = "Joy_InterstitialChartboost";
  private SoftReference cbRef = null;
  private boolean isAdClosed = true;
  private boolean isLoaded = false;
  private boolean isShow = false;
  private int loadTimes = 0;
  private SoftReference mActivityRef = null;
  private Context mAppContext;
  private String mAppId;
  private String mAppsignatures;
  private Chartboost mChartboost = null;
  
  public InterstitialChartboost() {}
  
  public void destroy()
  {
    this.isAdClosed = true;
    if ((this.cbRef != null) && (this.cbRef.get() != null) && (this.mActivityRef != null) && (this.mActivityRef.get() != null))
    {
      ((Chartboost)this.cbRef.get()).onDestroy((Activity)this.mActivityRef.get());
      this.cbRef.clear();
      this.cbRef = null;
    }
    Log.i("Joy_InterstitialChartboost", "Destroy Complete");
  }
  
  public String getTag()
  {
    return "Joy_InterstitialChartboost";
  }
  
  public void init(Context paramContext)
  {
    this.mAppContext = paramContext.getApplicationContext();
    this.mAppId = PropertyUtil.getPropertyDefault(this.mAppContext, i.a(458766), "");
    this.mAppsignatures = PropertyUtil.getPropertyDefault(this.mAppContext, i.a(458767), "");
    if (("".equals(this.mAppId)) || ("".equals(this.mAppsignatures)))
    {
      Log.e("Joy_InterstitialChartboost", "AppId or Appsignatures is not exist");
      return;
    }
    Log.i("Joy_InterstitialChartboost", "chartboost_appid: " + this.mAppId);
    Log.i("Joy_InterstitialChartboost", "chartboost_appsignatures: " + this.mAppsignatures);
    try
    {
      Class.forName(i.a(458768));
      InterstitialUtil.getInstance(this.mAppContext).addSupportInterstitial(i.a(458758), this);
      Log.i("Joy_InterstitialChartboost", "Init Complete");
      return;
    }
    catch (ClassNotFoundException paramContext)
    {
      Log.e("Joy_InterstitialChartboost", "Exception:" + paramContext.getMessage());
    }
  }
  
  public void preload(Activity paramActivity)
  {
    this.mChartboost = Chartboost.sharedChartboost();
    this.cbRef = new SoftReference(this.mChartboost);
    this.mChartboost.onCreate(paramActivity, this.mAppId, this.mAppsignatures, new InterstitialChartboost.1(this, paramActivity));
    this.mChartboost.onStart(paramActivity);
    this.mChartboost.cacheInterstitial();
  }
  
  public boolean preloadResult()
  {
    return this.isLoaded;
  }
  
  public void setAdClosed(boolean paramBoolean)
  {
    this.isAdClosed = paramBoolean;
  }
  
  public void show(Activity paramActivity)
  {
    this.mActivityRef = new SoftReference(paramActivity);
    this.isAdClosed = false;
    this.isShow = true;
    if ((this.isLoaded) && (this.isShow) && (!this.isAdClosed) && (this.mChartboost != null) && (this.mChartboost.hasCachedInterstitial()))
    {
      this.mChartboost.showInterstitial();
      this.isShow = false;
      this.isLoaded = false;
    }
    preload(paramActivity);
  }
}
