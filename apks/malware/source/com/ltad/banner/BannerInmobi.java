package com.ltad.banner;

import android.app.Activity;
import android.content.Context;
import android.content.res.Resources;
import android.util.DisplayMetrics;
import android.util.Log;
import android.view.View;
import android.widget.FrameLayout.LayoutParams;
import com.inmobi.ads.InMobiBanner;
import com.inmobi.sdk.InMobiSdk;
import com.ltad.a.i;
import com.ltad.util.BannerUtil;
import com.ltad.util.PropertyUtil;

public class BannerInmobi
  extends BannerAdapter
{
  public static final String TAG = "Joy_BannerInmobi";
  private boolean isLoaded = false;
  private boolean isShow = false;
  private int loadTimes = 0;
  private String mAccountId = "";
  private InMobiBanner mAdView = null;
  private Context mAppContext;
  private long mBannerPlacement = 0L;
  
  public BannerInmobi() {}
  
  private InMobiBanner getAdView(Activity paramActivity)
  {
    float f = paramActivity.getResources().getDisplayMetrics().density;
    int i = (int)(320.0F * f + 0.5F);
    int j = (int)(f * 50.0F + 0.5F);
    BannerInmobi.1 local1 = new BannerInmobi.1(this, paramActivity);
    paramActivity = new InMobiBanner(paramActivity, this.mBannerPlacement);
    Log.e("test", "inmobi banner load:" + this.mBannerPlacement + "; acount:" + this.mAccountId);
    paramActivity.setListener(local1);
    paramActivity.setLayoutParams(new FrameLayout.LayoutParams(i, j));
    paramActivity.setEnableAutoRefresh(false);
    paramActivity.load();
    return paramActivity;
  }
  
  public View create(Activity paramActivity)
  {
    this.isShow = true;
    if ((this.isLoaded) && (this.mAdView != null))
    {
      this.isLoaded = false;
      return this.mAdView;
    }
    return preload(paramActivity);
  }
  
  public void destroy()
  {
    this.mAppContext = null;
    this.isLoaded = false;
    this.isShow = false;
    Log.i("Joy_BannerInmobi", "destroy complete");
  }
  
  public String getTag()
  {
    return "Joy_BannerInmobi";
  }
  
  public void init(Context paramContext)
  {
    this.mAppContext = paramContext.getApplicationContext();
    this.mAccountId = PropertyUtil.getPropertyDefault(this.mAppContext, "inmobi_account", "");
    this.mBannerPlacement = Long.parseLong(PropertyUtil.getPropertyDefault(this.mAppContext, "inmobi_banner_placement", "0"));
    if (("".equals(this.mAccountId)) && (this.mBannerPlacement == 0L))
    {
      Log.e("Joy_BannerInmobi", "AccountId or BannerPlacement is not exist");
      return;
    }
    Log.i("Joy_BannerInmobi", "inmobi_account:" + this.mAccountId + "; BannerPlacement:" + this.mBannerPlacement);
    try
    {
      Class.forName("com.inmobi.sdk.InMobiSdk");
      InMobiSdk.init(paramContext, this.mAccountId);
      BannerUtil.getInstance(this.mAppContext).addSupportBanner(i.a(262151), this);
      Log.i("Joy_BannerInmobi", "Init success");
      return;
    }
    catch (ClassNotFoundException paramContext)
    {
      Log.e("Joy_BannerInmobi", "Exception:" + paramContext.getMessage());
    }
  }
  
  public View preload(Activity paramActivity)
  {
    return getAdView(paramActivity);
  }
  
  public boolean preloadResult()
  {
    return this.isLoaded;
  }
}
