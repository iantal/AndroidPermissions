package com.unity3d.player;

import android.app.Dialog;
import android.content.Context;
import android.content.res.Resources;
import android.graphics.drawable.ColorDrawable;
import android.text.Editable;
import android.text.TextWatcher;
import android.text.method.TextKeyListener;
import android.view.KeyEvent;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.View.OnFocusChangeListener;
import android.view.ViewGroup.LayoutParams;
import android.view.Window;
import android.view.inputmethod.InputMethodManager;
import android.widget.Button;
import android.widget.EditText;
import android.widget.RelativeLayout;
import android.widget.RelativeLayout.LayoutParams;
import android.widget.TextView;
import android.widget.TextView.OnEditorActionListener;

public final class p
  extends Dialog
  implements TextWatcher, View.OnClickListener
{
  private Context a = null;
  private UnityPlayer b = null;
  
  public p(Context paramContext, UnityPlayer paramUnityPlayer, String paramString1, int paramInt, boolean paramBoolean1, boolean paramBoolean2, boolean paramBoolean3, String paramString2)
  {
    super(paramContext);
    this.a = paramContext;
    this.b = paramUnityPlayer;
    getWindow().setGravity(80);
    getWindow().requestFeature(1);
    paramContext = new ColorDrawable(0);
    getWindow().setBackgroundDrawable(paramContext);
    setContentView(createSoftInputView());
    getWindow().clearFlags(2);
    paramContext = (EditText)findViewById(1057292289);
    paramUnityPlayer = (Button)findViewById(1057292290);
    paramContext.setImeOptions(6);
    paramContext.setText(paramString1);
    paramContext.setHint(paramString2);
    int j;
    if (paramBoolean1)
    {
      i = 32768;
      if (!paramBoolean2) {
        break label242;
      }
      j = 131072;
      label134:
      if (paramBoolean3) {
        k = 128;
      }
      j = k | j | i;
      i = j;
      if (paramInt >= 0) {
        if (paramInt <= 7) {
          break label248;
        }
      }
    }
    label242:
    label248:
    for (int i = j;; i = j | new int[] { 1, 16385, 12290, 17, 2, 3, 97, 33 }[paramInt])
    {
      paramContext.setInputType(i);
      paramContext.addTextChangedListener(this);
      paramInt = paramContext.getInputType();
      paramContext.setKeyListener(TextKeyListener.getInstance());
      paramContext.setRawInputType(paramInt);
      paramContext.setClickable(true);
      if (!paramBoolean2) {
        paramContext.selectAll();
      }
      paramUnityPlayer.setOnClickListener(this);
      paramContext.setOnFocusChangeListener(new View.OnFocusChangeListener()
      {
        public final void onFocusChange(View paramAnonymousView, boolean paramAnonymousBoolean)
        {
          if (paramAnonymousBoolean) {
            p.this.getWindow().setSoftInputMode(5);
          }
        }
      });
      return;
      i = 0;
      break;
      j = 0;
      break label134;
    }
  }
  
  private String a()
  {
    EditText localEditText = (EditText)findViewById(1057292289);
    if (localEditText == null) {
      return null;
    }
    return localEditText.getText().toString().trim();
  }
  
  public final void afterTextChanged(Editable paramEditable)
  {
    this.b.reportSoftInputStr(paramEditable.toString(), 0);
  }
  
  public final void beforeTextChanged(CharSequence paramCharSequence, int paramInt1, int paramInt2, int paramInt3) {}
  
  protected final View createSoftInputView()
  {
    RelativeLayout localRelativeLayout = new RelativeLayout(this.a);
    localRelativeLayout.setLayoutParams(new ViewGroup.LayoutParams(-1, -1));
    Object localObject = new EditText(this.a)
    {
      public final boolean onKeyPreIme(int paramAnonymousInt, KeyEvent paramAnonymousKeyEvent)
      {
        if (paramAnonymousInt == 4) {
          p.a(p.this, p.a(p.this));
        }
        if (paramAnonymousInt == 84) {
          return true;
        }
        return super.onKeyPreIme(paramAnonymousInt, paramAnonymousKeyEvent);
      }
      
      public final void onWindowFocusChanged(boolean paramAnonymousBoolean)
      {
        super.onWindowFocusChanged(paramAnonymousBoolean);
        if (paramAnonymousBoolean) {
          ((InputMethodManager)p.b(p.this).getSystemService("input_method")).showSoftInput(this, 0);
        }
      }
    };
    RelativeLayout.LayoutParams localLayoutParams = new RelativeLayout.LayoutParams(-1, -2);
    localLayoutParams.addRule(15);
    localLayoutParams.addRule(0, 1057292290);
    ((EditText)localObject).setLayoutParams(localLayoutParams);
    ((EditText)localObject).setId(1057292289);
    localRelativeLayout.addView((View)localObject);
    localObject = new Button(this.a);
    ((Button)localObject).setText(this.a.getResources().getIdentifier("ok", "string", "android"));
    localLayoutParams = new RelativeLayout.LayoutParams(-2, -2);
    localLayoutParams.addRule(15);
    localLayoutParams.addRule(11);
    ((Button)localObject).setLayoutParams(localLayoutParams);
    ((Button)localObject).setId(1057292290);
    localRelativeLayout.addView((View)localObject);
    ((EditText)localRelativeLayout.findViewById(1057292289)).setOnEditorActionListener(new TextView.OnEditorActionListener()
    {
      public final boolean onEditorAction(TextView paramAnonymousTextView, int paramAnonymousInt, KeyEvent paramAnonymousKeyEvent)
      {
        if (paramAnonymousInt == 6) {
          p.a(p.this, p.a(p.this));
        }
        return false;
      }
    });
    return localRelativeLayout;
  }
  
  public final void onBackPressed()
  {
    String str = a();
    this.b.reportSoftInputStr(str, 1);
  }
  
  public final void onClick(View paramView)
  {
    paramView = a();
    this.b.reportSoftInputStr(paramView, 1);
  }
  
  public final void onTextChanged(CharSequence paramCharSequence, int paramInt1, int paramInt2, int paramInt3) {}
}
