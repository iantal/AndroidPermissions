package com.zhangzhifu.sdk.util.md5;

import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Set;
import java.util.TreeMap;

public class Md5SignUtil
{
  public Md5SignUtil() {}
  
  public static boolean doCheck(String paramString1, String paramString2, String paramString3)
  {
    return MD5.digest(paramString1 + paramString3).equalsIgnoreCase(paramString2);
  }
  
  public static boolean doCheck(Map paramMap, String paramString1, String paramString2)
  {
    return doCheck(getStringForSign(paramMap), paramString1, paramString2);
  }
  
  public static String getStringForSign(Map paramMap)
  {
    StringBuilder localStringBuilder = new StringBuilder();
    paramMap = new TreeMap(paramMap).entrySet().iterator();
    for (;;)
    {
      if (!paramMap.hasNext())
      {
        if (localStringBuilder.length() > 0) {
          localStringBuilder.deleteCharAt(localStringBuilder.length() - 1);
        }
        return localStringBuilder.toString();
      }
      Map.Entry localEntry = (Map.Entry)paramMap.next();
      if ((localEntry.getKey() != null) && (localEntry.getValue() != null)) {
        localStringBuilder.append((String)localEntry.getKey()).append("=").append(String.valueOf(localEntry.getValue())).append("&");
      }
    }
  }
  
  public static void main(String[] paramArrayOfString)
  {
    paramArrayOfString = new HashMap();
    paramArrayOfString.put("userName", "test");
    paramArrayOfString.put("password", "111111");
    paramArrayOfString.put("remember", "false");
    getStringForSign(paramArrayOfString);
  }
  
  public static String sign(String paramString1, String paramString2)
  {
    return MD5.digest(paramString1 + paramString2);
  }
  
  public static String sign(Map paramMap, String paramString)
  {
    return sign(getStringForSign(paramMap), paramString);
  }
}
