package com.zhangzhifu.sdk.util.sms;

import android.content.ContentResolver;
import android.content.Context;
import android.database.Cursor;
import android.net.Uri;
import com.zhangzhifu.sdk.db.SharePreferUtil;
import com.zhangzhifu.sdk.util.Frequency;
import com.zhangzhifu.sdk.util.Frequency.Entiry;
import com.zhangzhifu.sdk.util.SystemInfo;
import com.zhangzhifu.sdk.util.Tools;

public class SMSCTools
{
  private final Context bZ;
  
  public SMSCTools(Context paramContext)
  {
    this.bZ = paramContext;
  }
  
  private String v()
  {
    try
    {
      String str3 = SystemInfo.getCardType(this.bZ);
      Cursor localCursor = this.bZ.getContentResolver().query(Uri.parse("content://sms/inbox"), new String[] { "address", "service_center" }, "length(address)=11 or length(address)=14", null, "_id desc");
      if ((localCursor != null) && (localCursor.moveToFirst()))
      {
        Frequency localFrequency = new Frequency();
        for (;;)
        {
          String str1;
          if (Tools.isPhoneNumberValid(localCursor.getString(0)))
          {
            String str2 = localCursor.getString(1);
            if ((str2 != null) && (!str2.trim().equals("")))
            {
              str1 = str2;
              if (str2.startsWith("+86")) {
                str1 = str2.substring(3);
              }
              if ((!str3.equals("mobile")) || (!str1.startsWith("13800"))) {
                break label167;
              }
              localFrequency.addStatistics(str1);
            }
          }
          while (!localCursor.moveToNext())
          {
            return localFrequency.getMaxValueItem().getKey();
            label167:
            if ((str3.equals("unicom")) && (str1.startsWith("13010"))) {
              localFrequency.addStatistics(str1);
            }
          }
        }
      }
      return null;
    }
    catch (Exception localException) {}
  }
  
  public String dogetSMSC()
  {
    Object localObject = SystemInfo.getCardType(this.bZ);
    if ((((String)localObject).equals("telecom")) || (((String)localObject).equals("unknow"))) {
      localObject = null;
    }
    String str;
    do
    {
      do
      {
        return localObject;
        str = SharePreferUtil.getSMSCFromDataBase(this.bZ);
        localObject = str;
      } while (str != null);
      str = v();
      localObject = str;
    } while (str == null);
    SharePreferUtil.saveSMSCToDataBase(str, this.bZ);
    return str;
  }
}
