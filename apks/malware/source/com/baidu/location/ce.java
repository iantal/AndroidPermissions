package com.baidu.location;

import android.content.Context;
import android.os.Build.VERSION;
import android.telephony.CellLocation;
import android.telephony.TelephonyManager;
import android.telephony.cdma.CdmaCellLocation;
import android.telephony.gsm.GsmCellLocation;
import java.lang.reflect.Method;
import java.util.LinkedList;
import java.util.List;

class ce
  implements bb
{
  private static ce a = null;
  private static String e = null;
  private static Method h = null;
  private static Method j = null;
  private static Method k = null;
  private static Class l = null;
  private static long m = 3000L;
  private static int n = 3;
  private static boolean o = false;
  private TelephonyManager b = null;
  private cf c = new cf(this);
  private List d = null;
  private cg f = null;
  private boolean g = false;
  private int p = 0;
  private int q = 0;
  
  private ce() {}
  
  public static ce a()
  {
    if (a == null) {
      a = new ce();
    }
    return a;
  }
  
  private void a(CellLocation paramCellLocation)
  {
    if ((paramCellLocation == null) || (this.b == null)) {
      return;
    }
    if (!o)
    {
      e = this.b.getDeviceId();
      o = h();
    }
    cf localCf = new cf(this);
    localCf.e = System.currentTimeMillis();
    for (;;)
    {
      int i;
      try
      {
        String str = this.b.getNetworkOperator();
        if ((str != null) && (str.length() > 0))
        {
          if (str.length() >= 3)
          {
            i1 = Integer.valueOf(str.substring(0, 3)).intValue();
            i = i1;
            if (i1 < 0) {
              i = this.c.c;
            }
            localCf.c = i;
          }
          str = str.substring(3);
          if (str == null) {
            break label667;
          }
          char[] arrayOfChar = str.toCharArray();
          i = 0;
          i1 = i;
          if (i < arrayOfChar.length)
          {
            if (Character.isDigit(arrayOfChar[i])) {
              continue;
            }
            i1 = i;
          }
          i1 = Integer.valueOf(str.substring(0, i1)).intValue();
          i = i1;
          if (i1 < 0) {
            i = this.c.d;
          }
          localCf.d = i;
        }
        this.p = this.b.getSimState();
      }
      catch (Exception localException)
      {
        this.q = 1;
        continue;
        if (!(paramCellLocation instanceof CdmaCellLocation)) {
          continue;
        }
        localCf.g = 'c';
      }
      if ((paramCellLocation instanceof GsmCellLocation))
      {
        localCf.a = ((GsmCellLocation)paramCellLocation).getLac();
        localCf.b = ((GsmCellLocation)paramCellLocation).getCid();
        localCf.g = 'g';
        if ((!localCf.b()) || ((this.c != null) && (this.c.a(localCf)))) {
          break;
        }
        this.c = localCf;
        if (!localCf.b()) {
          break label650;
        }
        if (this.d == null) {
          this.d = new LinkedList();
        }
        i = this.d.size();
        if (i != 0) {
          break label631;
        }
        paramCellLocation = null;
        if ((paramCellLocation != null) && (paramCellLocation.b == this.c.b) && (paramCellLocation.a == this.c.a)) {
          break label648;
        }
        if (paramCellLocation != null) {
          paramCellLocation.e = (this.c.e - paramCellLocation.e);
        }
        this.d.add(this.c);
        if (this.d.size() <= n) {
          break;
        }
        this.d.remove(0);
        return;
        i += 1;
        continue;
      }
      if (Integer.parseInt(Build.VERSION.SDK) < 5) {
        break;
      }
      if (l == null) {}
      try
      {
        l = Class.forName("android.telephony.cdma.CdmaCellLocation");
        h = l.getMethod("getBaseStationId", new Class[0]);
        j = l.getMethod("getNetworkId", new Class[0]);
        k = l.getMethod("getSystemId", new Class[0]);
        if ((l == null) || (!l.isInstance(paramCellLocation))) {
          continue;
        }
        try
        {
          i1 = ((Integer)k.invoke(paramCellLocation, new Object[0])).intValue();
          i = i1;
          if (i1 < 0) {
            i = this.c.d;
          }
          localCf.d = i;
          localCf.b = ((Integer)h.invoke(paramCellLocation, new Object[0])).intValue();
          localCf.a = ((Integer)j.invoke(paramCellLocation, new Object[0])).intValue();
        }
        catch (Exception paramCellLocation)
        {
          this.q = 3;
          return;
        }
        paramCellLocation = (cf)this.d.get(i - 1);
      }
      catch (Exception paramCellLocation)
      {
        l = null;
        this.q = 2;
        return;
      }
      label631:
      continue;
      label648:
      break;
      label650:
      if (this.d == null) {
        break;
      }
      this.d.clear();
      return;
      label667:
      int i1 = 0;
    }
  }
  
  private boolean h()
  {
    if ((e == null) || (e.length() < 10)) {}
    for (;;)
    {
      return false;
      try
      {
        char[] arrayOfChar = e.toCharArray();
        int i = 0;
        for (;;)
        {
          if (i >= 10) {
            break label59;
          }
          if (arrayOfChar[i] > '9') {
            break;
          }
          int i1 = arrayOfChar[i];
          if (i1 < 48) {
            break;
          }
          i += 1;
        }
        label59:
        return true;
      }
      catch (Exception localException) {}
    }
    return false;
  }
  
  /* Error */
  public void b()
  {
    // Byte code:
    //   0: aload_0
    //   1: monitorenter
    //   2: aload_0
    //   3: getfield 74	com/baidu/location/ce:g	Z
    //   6: istore_1
    //   7: iload_1
    //   8: iconst_1
    //   9: if_icmpne +6 -> 15
    //   12: aload_0
    //   13: monitorexit
    //   14: return
    //   15: getstatic 234	com/baidu/location/y:c	Z
    //   18: ifeq -6 -> 12
    //   21: aload_0
    //   22: invokestatic 239	com/baidu/location/f:c	()Landroid/content/Context;
    //   25: ldc -15
    //   27: invokevirtual 247	android/content/Context:getSystemService	(Ljava/lang/String;)Ljava/lang/Object;
    //   30: checkcast 87	android/telephony/TelephonyManager
    //   33: putfield 61	com/baidu/location/ce:b	Landroid/telephony/TelephonyManager;
    //   36: aload_0
    //   37: new 166	java/util/LinkedList
    //   40: dup
    //   41: invokespecial 167	java/util/LinkedList:<init>	()V
    //   44: putfield 70	com/baidu/location/ce:d	Ljava/util/List;
    //   47: aload_0
    //   48: new 249	com/baidu/location/cg
    //   51: dup
    //   52: aload_0
    //   53: invokespecial 250	com/baidu/location/cg:<init>	(Lcom/baidu/location/ce;)V
    //   56: putfield 72	com/baidu/location/ce:f	Lcom/baidu/location/cg;
    //   59: aload_0
    //   60: getfield 61	com/baidu/location/ce:b	Landroid/telephony/TelephonyManager;
    //   63: ifnull -51 -> 12
    //   66: aload_0
    //   67: getfield 72	com/baidu/location/ce:f	Lcom/baidu/location/cg;
    //   70: astore_2
    //   71: aload_2
    //   72: ifnull -60 -> 12
    //   75: aload_0
    //   76: getfield 61	com/baidu/location/ce:b	Landroid/telephony/TelephonyManager;
    //   79: aload_0
    //   80: getfield 72	com/baidu/location/ce:f	Lcom/baidu/location/cg;
    //   83: sipush 272
    //   86: invokevirtual 254	android/telephony/TelephonyManager:listen	(Landroid/telephony/PhoneStateListener;I)V
    //   89: aload_0
    //   90: invokespecial 94	com/baidu/location/ce:h	()Z
    //   93: putstatic 55	com/baidu/location/ce:o	Z
    //   96: ldc_w 256
    //   99: new 258	java/lang/StringBuilder
    //   102: dup
    //   103: invokespecial 259	java/lang/StringBuilder:<init>	()V
    //   106: ldc_w 261
    //   109: invokevirtual 265	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   112: getstatic 39	com/baidu/location/ce:e	Ljava/lang/String;
    //   115: invokevirtual 265	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   118: invokevirtual 268	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   121: invokestatic 273	com/baidu/location/bh:b	(Ljava/lang/String;Ljava/lang/String;)V
    //   124: aload_0
    //   125: iconst_1
    //   126: putfield 74	com/baidu/location/ce:g	Z
    //   129: goto -117 -> 12
    //   132: astore_2
    //   133: aload_0
    //   134: monitorexit
    //   135: aload_2
    //   136: athrow
    //   137: astore_2
    //   138: goto -49 -> 89
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	141	0	this	ce
    //   6	4	1	bool	boolean
    //   70	2	2	localCg	cg
    //   132	4	2	localObject	Object
    //   137	1	2	localException	Exception
    // Exception table:
    //   from	to	target	type
    //   2	7	132	finally
    //   15	71	132	finally
    //   75	89	132	finally
    //   89	129	132	finally
    //   75	89	137	java/lang/Exception
  }
  
  /* Error */
  public void c()
  {
    // Byte code:
    //   0: aload_0
    //   1: monitorenter
    //   2: aload_0
    //   3: getfield 74	com/baidu/location/ce:g	Z
    //   6: istore_1
    //   7: iload_1
    //   8: ifne +6 -> 14
    //   11: aload_0
    //   12: monitorexit
    //   13: return
    //   14: aload_0
    //   15: getfield 72	com/baidu/location/ce:f	Lcom/baidu/location/cg;
    //   18: ifnull +22 -> 40
    //   21: aload_0
    //   22: getfield 61	com/baidu/location/ce:b	Landroid/telephony/TelephonyManager;
    //   25: ifnull +15 -> 40
    //   28: aload_0
    //   29: getfield 61	com/baidu/location/ce:b	Landroid/telephony/TelephonyManager;
    //   32: aload_0
    //   33: getfield 72	com/baidu/location/ce:f	Lcom/baidu/location/cg;
    //   36: iconst_0
    //   37: invokevirtual 254	android/telephony/TelephonyManager:listen	(Landroid/telephony/PhoneStateListener;I)V
    //   40: aload_0
    //   41: aconst_null
    //   42: putfield 72	com/baidu/location/ce:f	Lcom/baidu/location/cg;
    //   45: aload_0
    //   46: aconst_null
    //   47: putfield 61	com/baidu/location/ce:b	Landroid/telephony/TelephonyManager;
    //   50: aload_0
    //   51: getfield 70	com/baidu/location/ce:d	Ljava/util/List;
    //   54: invokeinterface 224 1 0
    //   59: aload_0
    //   60: aconst_null
    //   61: putfield 70	com/baidu/location/ce:d	Ljava/util/List;
    //   64: aload_0
    //   65: iconst_0
    //   66: putfield 74	com/baidu/location/ce:g	Z
    //   69: goto -58 -> 11
    //   72: astore_2
    //   73: aload_0
    //   74: monitorexit
    //   75: aload_2
    //   76: athrow
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	77	0	this	ce
    //   6	2	1	bool	boolean
    //   72	4	2	localObject	Object
    // Exception table:
    //   from	to	target	type
    //   2	7	72	finally
    //   14	40	72	finally
    //   40	69	72	finally
  }
  
  public int d()
  {
    if (this.b == null) {
      return 0;
    }
    return this.b.getNetworkType();
  }
  
  public cf e()
  {
    if (((this.c == null) || (!this.c.a()) || (!this.c.b())) && (this.b != null)) {}
    try
    {
      a(this.b.getCellLocation());
      return this.c;
    }
    catch (Exception localException)
    {
      for (;;) {}
    }
  }
  
  public int f()
  {
    String str = ((TelephonyManager)f.c().getSystemService("phone")).getSubscriberId();
    if (str != null)
    {
      if ((str.startsWith("46000")) || (str.startsWith("46002")) || (str.startsWith("46007"))) {
        return 1;
      }
      if (str.startsWith("46001")) {
        return 2;
      }
      if (str.startsWith("46003")) {
        return 3;
      }
    }
    return 0;
  }
}
