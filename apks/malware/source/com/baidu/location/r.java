package com.baidu.location;

import android.content.Context;
import android.os.Build.VERSION;
import android.telephony.CellLocation;
import android.telephony.NeighboringCellInfo;
import android.telephony.PhoneStateListener;
import android.telephony.SignalStrength;
import android.telephony.TelephonyManager;
import android.telephony.cdma.CdmaCellLocation;
import android.telephony.gsm.GsmCellLocation;
import java.lang.reflect.Method;
import java.util.Iterator;
import java.util.LinkedList;
import java.util.List;
import java.util.Locale;

class r
  implements au, l
{
  private static long d0 = 3000L;
  private static int d2 = 3;
  private static Class d3;
  private static Method dQ;
  private static r dT = null;
  private static String dV = null;
  private static Method dW;
  private static boolean dX = false;
  private static Method dZ = null;
  private boolean d1 = false;
  private a dO = new a();
  private int dP = 0;
  private b dR = null;
  private List dS = null;
  private TelephonyManager dU = null;
  private int dY = 0;
  
  static
  {
    dW = null;
    dQ = null;
    d3 = null;
  }
  
  private r() {}
  
  private boolean Y()
  {
    if ((dV == null) || (dV.length() < 10)) {}
    for (;;)
    {
      return false;
      try
      {
        char[] arrayOfChar = dV.toCharArray();
        int i = 0;
        for (;;)
        {
          if (i >= 10) {
            break label59;
          }
          if (arrayOfChar[i] > '9') {
            break;
          }
          int j = arrayOfChar[i];
          if (j < 48) {
            break;
          }
          i += 1;
        }
        label59:
        return true;
      }
      catch (Exception localException) {}
    }
    return false;
  }
  
  public static r aa()
  {
    if (dT == null) {
      dT = new r();
    }
    return dT;
  }
  
  private void jdMethod_if(CellLocation paramCellLocation)
  {
    if ((paramCellLocation == null) || (this.dU == null)) {
      return;
    }
    if (!dX)
    {
      dV = this.dU.getDeviceId();
      dX = Y();
    }
    a localA = new a();
    localA.jdField_byte = System.currentTimeMillis();
    for (;;)
    {
      int i;
      try
      {
        String str = this.dU.getNetworkOperator();
        if ((str != null) && (str.length() > 0))
        {
          if (str.length() >= 3)
          {
            j = Integer.valueOf(str.substring(0, 3)).intValue();
            i = j;
            if (j < 0) {
              i = this.dO.jdField_do;
            }
            localA.jdField_do = i;
          }
          str = str.substring(3);
          if (str == null) {
            break label667;
          }
          char[] arrayOfChar = str.toCharArray();
          i = 0;
          j = i;
          if (i < arrayOfChar.length)
          {
            if (Character.isDigit(arrayOfChar[i])) {
              continue;
            }
            j = i;
          }
          j = Integer.valueOf(str.substring(0, j)).intValue();
          i = j;
          if (j < 0) {
            i = this.dO.jdField_if;
          }
          localA.jdField_if = i;
        }
        this.dY = this.dU.getSimState();
      }
      catch (Exception localException)
      {
        this.dP = 1;
        continue;
        if (!(paramCellLocation instanceof CdmaCellLocation)) {
          continue;
        }
        localA.jdField_new = 'c';
      }
      if ((paramCellLocation instanceof GsmCellLocation))
      {
        localA.jdField_for = ((GsmCellLocation)paramCellLocation).getLac();
        localA.jdField_try = ((GsmCellLocation)paramCellLocation).getCid();
        localA.jdField_new = 'g';
        if ((!localA.jdMethod_for()) || ((this.dO != null) && (this.dO.a(localA)))) {
          break;
        }
        this.dO = localA;
        if (!localA.jdMethod_for()) {
          break label650;
        }
        if (this.dS == null) {
          this.dS = new LinkedList();
        }
        i = this.dS.size();
        if (i != 0) {
          break label631;
        }
        paramCellLocation = null;
        if ((paramCellLocation != null) && (paramCellLocation.jdField_try == this.dO.jdField_try) && (paramCellLocation.jdField_for == this.dO.jdField_for)) {
          break label648;
        }
        if (paramCellLocation != null) {
          paramCellLocation.jdField_byte = (this.dO.jdField_byte - paramCellLocation.jdField_byte);
        }
        this.dS.add(this.dO);
        if (this.dS.size() <= d2) {
          break;
        }
        this.dS.remove(0);
        return;
        i += 1;
        continue;
      }
      if (Integer.parseInt(Build.VERSION.SDK) < 5) {
        break;
      }
      if (d3 == null) {}
      try
      {
        d3 = Class.forName("android.telephony.cdma.CdmaCellLocation");
        dZ = d3.getMethod("getBaseStationId", new Class[0]);
        dW = d3.getMethod("getNetworkId", new Class[0]);
        dQ = d3.getMethod("getSystemId", new Class[0]);
        if ((d3 == null) || (!d3.isInstance(paramCellLocation))) {
          continue;
        }
        try
        {
          j = ((Integer)dQ.invoke(paramCellLocation, new Object[0])).intValue();
          i = j;
          if (j < 0) {
            i = this.dO.jdField_if;
          }
          localA.jdField_if = i;
          localA.jdField_try = ((Integer)dZ.invoke(paramCellLocation, new Object[0])).intValue();
          localA.jdField_for = ((Integer)dW.invoke(paramCellLocation, new Object[0])).intValue();
        }
        catch (Exception paramCellLocation)
        {
          this.dP = 3;
          return;
        }
        paramCellLocation = (a)this.dS.get(i - 1);
      }
      catch (Exception paramCellLocation)
      {
        d3 = null;
        this.dP = 2;
        return;
      }
      label631:
      continue;
      label648:
      break;
      label650:
      if (this.dS == null) {
        break;
      }
      this.dS.clear();
      return;
      label667:
      int j = 0;
    }
  }
  
  public a X()
  {
    if (((this.dO == null) || (!this.dO.jdMethod_do()) || (!this.dO.jdMethod_for())) && (this.dU != null)) {}
    try
    {
      jdMethod_if(this.dU.getCellLocation());
      return this.dO;
    }
    catch (Exception localException)
    {
      for (;;) {}
    }
  }
  
  /* Error */
  public void Z()
  {
    // Byte code:
    //   0: aload_0
    //   1: monitorenter
    //   2: aload_0
    //   3: getfield 80	com/baidu/location/r:d1	Z
    //   6: istore_1
    //   7: iload_1
    //   8: iconst_1
    //   9: if_icmpne +6 -> 15
    //   12: aload_0
    //   13: monitorexit
    //   14: return
    //   15: getstatic 259	com/baidu/location/f:isServing	Z
    //   18: ifeq -6 -> 12
    //   21: aload_0
    //   22: invokestatic 263	com/baidu/location/f:getServiceContext	()Landroid/content/Context;
    //   25: ldc_w 265
    //   28: invokevirtual 271	android/content/Context:getSystemService	(Ljava/lang/String;)Ljava/lang/Object;
    //   31: checkcast 113	android/telephony/TelephonyManager
    //   34: putfield 69	com/baidu/location/r:dU	Landroid/telephony/TelephonyManager;
    //   37: aload_0
    //   38: new 183	java/util/LinkedList
    //   41: dup
    //   42: invokespecial 184	java/util/LinkedList:<init>	()V
    //   45: putfield 76	com/baidu/location/r:dS	Ljava/util/List;
    //   48: aload_0
    //   49: new 13	com/baidu/location/r$b
    //   52: dup
    //   53: aload_0
    //   54: invokespecial 272	com/baidu/location/r$b:<init>	(Lcom/baidu/location/r;)V
    //   57: putfield 78	com/baidu/location/r:dR	Lcom/baidu/location/r$b;
    //   60: aload_0
    //   61: getfield 69	com/baidu/location/r:dU	Landroid/telephony/TelephonyManager;
    //   64: ifnull -52 -> 12
    //   67: aload_0
    //   68: getfield 78	com/baidu/location/r:dR	Lcom/baidu/location/r$b;
    //   71: astore_2
    //   72: aload_2
    //   73: ifnull -61 -> 12
    //   76: aload_0
    //   77: getfield 69	com/baidu/location/r:dU	Landroid/telephony/TelephonyManager;
    //   80: aload_0
    //   81: getfield 78	com/baidu/location/r:dR	Lcom/baidu/location/r$b;
    //   84: sipush 272
    //   87: invokevirtual 276	android/telephony/TelephonyManager:listen	(Landroid/telephony/PhoneStateListener;I)V
    //   90: aload_0
    //   91: invokespecial 119	com/baidu/location/r:Y	()Z
    //   94: putstatic 63	com/baidu/location/r:dX	Z
    //   97: ldc_w 278
    //   100: new 280	java/lang/StringBuilder
    //   103: dup
    //   104: invokespecial 281	java/lang/StringBuilder:<init>	()V
    //   107: ldc_w 283
    //   110: invokevirtual 287	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   113: getstatic 47	com/baidu/location/r:dV	Ljava/lang/String;
    //   116: invokevirtual 287	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   119: invokevirtual 290	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   122: invokestatic 295	com/baidu/location/c:if	(Ljava/lang/String;Ljava/lang/String;)V
    //   125: aload_0
    //   126: iconst_1
    //   127: putfield 80	com/baidu/location/r:d1	Z
    //   130: goto -118 -> 12
    //   133: astore_2
    //   134: aload_0
    //   135: monitorexit
    //   136: aload_2
    //   137: athrow
    //   138: astore_2
    //   139: goto -49 -> 90
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	142	0	this	r
    //   6	4	1	bool	boolean
    //   71	2	2	localB	b
    //   133	4	2	localObject	Object
    //   138	1	2	localException	Exception
    // Exception table:
    //   from	to	target	type
    //   2	7	133	finally
    //   15	72	133	finally
    //   76	90	133	finally
    //   90	130	133	finally
    //   76	90	138	java/lang/Exception
  }
  
  public String ab()
  {
    return dV;
  }
  
  public int ac()
  {
    if (this.dU == null) {
      return 0;
    }
    return this.dU.getNetworkType();
  }
  
  public int ad()
  {
    String str = ((TelephonyManager)f.getServiceContext().getSystemService("phone")).getSubscriberId();
    if (str != null)
    {
      if ((str.startsWith("46000")) || (str.startsWith("46002")) || (str.startsWith("46007"))) {
        return 1;
      }
      if (str.startsWith("46001")) {
        return 2;
      }
      if (str.startsWith("46003")) {
        return 3;
      }
    }
    return 0;
  }
  
  /* Error */
  public void af()
  {
    // Byte code:
    //   0: aload_0
    //   1: monitorenter
    //   2: aload_0
    //   3: getfield 80	com/baidu/location/r:d1	Z
    //   6: istore_1
    //   7: iload_1
    //   8: ifne +6 -> 14
    //   11: aload_0
    //   12: monitorexit
    //   13: return
    //   14: aload_0
    //   15: getfield 78	com/baidu/location/r:dR	Lcom/baidu/location/r$b;
    //   18: ifnull +22 -> 40
    //   21: aload_0
    //   22: getfield 69	com/baidu/location/r:dU	Landroid/telephony/TelephonyManager;
    //   25: ifnull +15 -> 40
    //   28: aload_0
    //   29: getfield 69	com/baidu/location/r:dU	Landroid/telephony/TelephonyManager;
    //   32: aload_0
    //   33: getfield 78	com/baidu/location/r:dR	Lcom/baidu/location/r$b;
    //   36: iconst_0
    //   37: invokevirtual 276	android/telephony/TelephonyManager:listen	(Landroid/telephony/PhoneStateListener;I)V
    //   40: aload_0
    //   41: aconst_null
    //   42: putfield 78	com/baidu/location/r:dR	Lcom/baidu/location/r$b;
    //   45: aload_0
    //   46: aconst_null
    //   47: putfield 69	com/baidu/location/r:dU	Landroid/telephony/TelephonyManager;
    //   50: aload_0
    //   51: getfield 76	com/baidu/location/r:dS	Ljava/util/List;
    //   54: invokeinterface 241 1 0
    //   59: aload_0
    //   60: aconst_null
    //   61: putfield 76	com/baidu/location/r:dS	Ljava/util/List;
    //   64: aload_0
    //   65: iconst_0
    //   66: putfield 80	com/baidu/location/r:d1	Z
    //   69: goto -58 -> 11
    //   72: astore_2
    //   73: aload_0
    //   74: monitorexit
    //   75: aload_2
    //   76: athrow
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	77	0	this	r
    //   6	2	1	bool	boolean
    //   72	4	2	localObject	Object
    // Exception table:
    //   from	to	target	type
    //   2	7	72	finally
    //   14	40	72	finally
    //   40	69	72	finally
  }
  
  public class a
  {
    public long jdField_byte = 0L;
    public int jdField_do = -1;
    public int jdField_for = -1;
    public int jdField_if = -1;
    public int jdField_int = -1;
    public char jdField_new = '\000';
    public int jdField_try = -1;
    
    public a()
    {
      this.jdField_byte = System.currentTimeMillis();
    }
    
    public a(int paramInt1, int paramInt2, int paramInt3, int paramInt4, char paramChar)
    {
      this.jdField_for = paramInt1;
      this.jdField_try = paramInt2;
      this.jdField_do = paramInt3;
      this.jdField_if = paramInt4;
      this.jdField_new = paramChar;
      this.jdField_byte = (System.currentTimeMillis() / 1000L);
    }
    
    public String a()
    {
      StringBuffer localStringBuffer = new StringBuffer(128);
      localStringBuffer.append(this.jdField_try + 23);
      localStringBuffer.append("H");
      localStringBuffer.append(this.jdField_for + 45);
      localStringBuffer.append("K");
      localStringBuffer.append(this.jdField_if + 54);
      localStringBuffer.append("Q");
      localStringBuffer.append(this.jdField_do + 203);
      return localStringBuffer.toString();
    }
    
    public boolean a(a paramA)
    {
      return (this.jdField_for == paramA.jdField_for) && (this.jdField_try == paramA.jdField_try) && (this.jdField_if == paramA.jdField_if);
    }
    
    public boolean jdMethod_do()
    {
      return System.currentTimeMillis() - this.jdField_byte < r.ae();
    }
    
    public boolean jdMethod_for()
    {
      return (this.jdField_for > -1) && (this.jdField_try > 0);
    }
    
    public String jdMethod_if()
    {
      StringBuffer localStringBuffer = new StringBuffer(64);
      localStringBuffer.append(String.format(Locale.CHINA, "cell=%d|%d|%d|%d:%d", new Object[] { Integer.valueOf(this.jdField_do), Integer.valueOf(this.jdField_if), Integer.valueOf(this.jdField_for), Integer.valueOf(this.jdField_try), Integer.valueOf(this.jdField_int) }));
      return localStringBuffer.toString();
    }
    
    public String jdMethod_int()
    {
      for (;;)
      {
        int i;
        try
        {
          Object localObject = r.jdMethod_int(r.this).getNeighboringCellInfo();
          if ((localObject == null) || (((List)localObject).isEmpty())) {
            break label297;
          }
          String str = "&nc=";
          localObject = ((List)localObject).iterator();
          i = 0;
          if (((Iterator)localObject).hasNext())
          {
            NeighboringCellInfo localNeighboringCellInfo = (NeighboringCellInfo)((Iterator)localObject).next();
            if (i == 0)
            {
              if (localNeighboringCellInfo.getLac() != this.jdField_for) {
                str = str + localNeighboringCellInfo.getLac() + "|" + localNeighboringCellInfo.getCid() + "|" + localNeighboringCellInfo.getRssi();
              } else {
                str = str + "|" + localNeighboringCellInfo.getCid() + "|" + localNeighboringCellInfo.getRssi();
              }
            }
            else if (i < 8) {
              if (localNeighboringCellInfo.getLac() != this.jdField_for) {
                str = str + ";" + localNeighboringCellInfo.getLac() + "|" + localNeighboringCellInfo.getCid() + "|" + localNeighboringCellInfo.getRssi();
              } else {
                str = str + ";" + "|" + localNeighboringCellInfo.getCid() + "|" + localNeighboringCellInfo.getRssi();
              }
            }
          }
        }
        catch (Exception localException)
        {
          return null;
        }
        return localException;
        label297:
        return null;
        i += 1;
      }
    }
    
    public String toString()
    {
      StringBuffer localStringBuffer = new StringBuffer(128);
      localStringBuffer.append("&nw=");
      localStringBuffer.append(r.jdMethod_for(r.this).jdField_new);
      localStringBuffer.append(String.format(Locale.CHINA, "&cl=%d|%d|%d|%d&cl_s=%d", new Object[] { Integer.valueOf(this.jdField_do), Integer.valueOf(this.jdField_if), Integer.valueOf(this.jdField_for), Integer.valueOf(this.jdField_try), Integer.valueOf(this.jdField_int) }));
      localStringBuffer.append("&cl_t=");
      localStringBuffer.append(this.jdField_byte);
      if ((r.jdMethod_do(r.this) != null) && (r.jdMethod_do(r.this).size() > 0))
      {
        j = r.jdMethod_do(r.this).size();
        localStringBuffer.append("&clt=");
        i = 0;
        if (i < j)
        {
          a localA = (a)r.jdMethod_do(r.this).get(i);
          if (localA.jdField_do != this.jdField_do) {
            localStringBuffer.append(localA.jdField_do);
          }
          localStringBuffer.append("|");
          if (localA.jdField_if != this.jdField_if) {
            localStringBuffer.append(localA.jdField_if);
          }
          localStringBuffer.append("|");
          if (localA.jdField_for != this.jdField_for) {
            localStringBuffer.append(localA.jdField_for);
          }
          localStringBuffer.append("|");
          if (localA.jdField_try != this.jdField_try) {
            localStringBuffer.append(localA.jdField_try);
          }
          localStringBuffer.append("|");
          if (i != j - 1) {
            localStringBuffer.append(localA.jdField_byte / 1000L);
          }
          for (;;)
          {
            localStringBuffer.append(";");
            i += 1;
            break;
            localStringBuffer.append((System.currentTimeMillis() - localA.jdField_byte) / 1000L);
          }
        }
      }
      if (r.jdMethod_new(r.this) > 100) {
        r.jdMethod_if(r.this, 0);
      }
      int i = r.jdMethod_if(r.this);
      int j = r.jdMethod_new(r.this);
      localStringBuffer.append("&cs=" + ((i << 8) + j));
      return localStringBuffer.toString();
    }
  }
  
  private class b
    extends PhoneStateListener
  {
    public b() {}
    
    public void onCellLocationChanged(CellLocation paramCellLocation)
    {
      if (paramCellLocation == null) {
        return;
      }
      try
      {
        r.jdMethod_if(r.this, r.jdMethod_int(r.this).getCellLocation());
        return;
      }
      catch (Exception paramCellLocation) {}
    }
    
    public void onSignalStrengthsChanged(SignalStrength paramSignalStrength)
    {
      if (r.jdMethod_for(r.this) != null)
      {
        if (r.jdMethod_for(r.this).jdField_new != 'g') {
          break label40;
        }
        r.jdMethod_for(r.this).jdField_int = paramSignalStrength.getGsmSignalStrength();
      }
      label40:
      while (r.jdMethod_for(r.this).jdField_new != 'c') {
        return;
      }
      r.jdMethod_for(r.this).jdField_int = paramSignalStrength.getCdmaDbm();
    }
  }
}
