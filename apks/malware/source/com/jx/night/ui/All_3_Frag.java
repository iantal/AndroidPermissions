package com.jx.night.ui;

import android.app.Dialog;
import android.content.Context;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.webkit.JavascriptInterface;
import android.webkit.WebChromeClient;
import android.webkit.WebSettings;
import android.webkit.WebView;
import android.widget.ProgressBar;
import android.widget.TextView;
import com.jx.night.ad.a;
import com.jx.night.ad.b;
import com.jx.night.unit.MyConst;
import com.jx.night.unit.MyWebInterface;
import com.jx.night.unit.n;
import com.litesuits.http.LiteHttp;
import com.litesuits.http.request.FileRequest;

public class All_3_Frag
  extends Fragment
{
  private static String d = MyConst.T;
  private WebView a;
  private Context b;
  private boolean c = false;
  private String e = "";
  private boolean f = false;
  private TextView g;
  private ProgressBar h;
  private Dialog i;
  private int j = 0;
  
  public All_3_Frag() {}
  
  private void a(long paramLong1, long paramLong2)
  {
    int k = (int)((float)paramLong2 / (float)paramLong1 * 100.0F);
    String str;
    if (this.j != k)
    {
      this.j = k;
      str = "下载中,已完成" + this.j + "%";
      if (this.g != null)
      {
        this.g.setText(str);
        this.h.setProgress(this.j);
      }
    }
    else
    {
      return;
    }
    n.a(this.b, str);
  }
  
  private void d()
  {
    if (!MyConst.n) {}
    while (this.f) {
      return;
    }
    this.f = true;
    b.a().f();
  }
  
  private void e()
  {
    WebSettings localWebSettings = this.a.getSettings();
    localWebSettings.supportMultipleWindows();
    localWebSettings.setJavaScriptEnabled(true);
    localWebSettings.setJavaScriptCanOpenWindowsAutomatically(true);
    localWebSettings.setAllowFileAccess(true);
    this.a.setWebChromeClient(new WebChromeClient());
    this.a.setWebViewClient(new j(this));
    this.a.loadUrl(d);
    this.a.requestFocus();
  }
  
  public void a()
  {
    Dialog localDialog = new Dialog(this.b, 2131099660);
    View localView = LayoutInflater.from(this.b).inflate(2130903041, null);
    this.g = ((TextView)localView.findViewById(2131361794));
    this.h = ((ProgressBar)localView.findViewById(2131361795));
    localDialog.setContentView(localView);
    localDialog.show();
    this.i = localDialog;
  }
  
  @JavascriptInterface
  public void a(View paramView)
  {
    this.a = ((WebView)paramView.findViewById(2131361834));
    this.a.setScrollBarStyle(0);
    this.a.addJavascriptInterface(new MyWebInterface(this.b), "APP");
    e();
  }
  
  public void a(String paramString)
  {
    String str = a.a("ChenRen");
    paramString = (FileRequest)new FileRequest(paramString, str + ".tmp").setHttpListener(new i(this, true, true, false));
    MyConst.y.executeAsync(paramString);
  }
  
  public void b()
  {
    if (this.a != null) {
      this.a.loadUrl(d);
    }
    d();
  }
  
  public boolean c()
  {
    if (this.a == null) {}
    while (!this.a.canGoBack()) {
      return false;
    }
    this.a.goBack();
    return true;
  }
  
  public void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    this.b = getActivity();
    MyConst.E = this;
    this.e = "";
  }
  
  public View onCreateView(LayoutInflater paramLayoutInflater, ViewGroup paramViewGroup, Bundle paramBundle)
  {
    paramLayoutInflater = paramLayoutInflater.inflate(2130903050, null);
    a(paramLayoutInflater);
    e();
    return paramLayoutInflater;
  }
}
