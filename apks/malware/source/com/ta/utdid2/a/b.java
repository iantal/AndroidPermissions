package com.ta.utdid2.a;

import android.content.Context;
import android.text.TextUtils;
import android.util.Log;
import com.c.a.a;
import com.ta.utdid2.b.a.c;
import java.io.UnsupportedEncodingException;
import java.net.URLEncoder;
import org.apache.http.client.methods.HttpPost;
import org.json.JSONException;
import org.json.JSONObject;

public class b
{
  private static final String a = b.class.getName();
  private static b b = null;
  private Context c;
  private Object d = new Object();
  
  private b(Context paramContext)
  {
    this.c = paramContext;
  }
  
  public static b a(Context paramContext)
  {
    try
    {
      if (b == null) {
        b = new b(paramContext);
      }
      paramContext = b;
      return paramContext;
    }
    finally {}
  }
  
  private static String b(String paramString1, String paramString2)
  {
    if (!TextUtils.isEmpty(paramString1)) {
      try
      {
        Object localObject = new JSONObject(paramString1);
        if (((JSONObject)localObject).has("data"))
        {
          paramString1 = ((JSONObject)localObject).getJSONObject("data");
          if ((paramString1.has("action")) && (paramString1.has("aid")))
          {
            localObject = paramString1.getString("action");
            if ((((String)localObject).equalsIgnoreCase("new")) || (((String)localObject).equalsIgnoreCase("changed"))) {
              return paramString1.getString("aid");
            }
          }
        }
        else if ((((JSONObject)localObject).has("isError")) && (((JSONObject)localObject).has("status")))
        {
          paramString1 = ((JSONObject)localObject).getString("isError");
          localObject = ((JSONObject)localObject).getString("status");
          if ((paramString1.equalsIgnoreCase("true")) && ((((String)localObject).equalsIgnoreCase("404")) || (((String)localObject).equalsIgnoreCase("401"))))
          {
            if (c.a) {
              Log.d(a, "remove the AID, status:" + (String)localObject);
            }
            return "";
          }
        }
      }
      catch (JSONException paramString1)
      {
        Log.e(a, paramString1.toString());
        return paramString2;
      }
      catch (Exception paramString1)
      {
        Log.e(a, paramString1.toString());
      }
    }
    return paramString2;
  }
  
  private static String b(String paramString1, String paramString2, String paramString3, String paramString4)
  {
    StringBuilder localStringBuilder = new StringBuilder();
    try
    {
      String str = URLEncoder.encode(paramString3, "UTF-8");
      paramString3 = str;
    }
    catch (UnsupportedEncodingException localUnsupportedEncodingException)
    {
      for (;;)
      {
        localUnsupportedEncodingException.printStackTrace();
      }
    }
    return "http://hydra.alibaba.com/" + paramString1 + "/get_aid/?auth[token]=" + paramString2 + "&type=utdid&id=" + paramString3 + "&aid=" + paramString4;
  }
  
  /* Error */
  public final String a(String paramString1, String arg2, String paramString3, String paramString4)
  {
    // Byte code:
    //   0: aload_1
    //   1: aload_2
    //   2: aload_3
    //   3: aload 4
    //   5: invokestatic 146	com/ta/utdid2/a/b:b	(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
    //   8: astore_1
    //   9: aload_0
    //   10: getfield 33	com/ta/utdid2/a/b:c	Landroid/content/Context;
    //   13: invokestatic 151	com/ta/utdid2/b/a/e:b	(Landroid/content/Context;)Z
    //   16: ifeq +128 -> 144
    //   19: sipush 3000
    //   22: istore 5
    //   24: getstatic 98	com/ta/utdid2/b/a/c:a	Z
    //   27: ifeq +36 -> 63
    //   30: getstatic 22	com/ta/utdid2/a/b:a	Ljava/lang/String;
    //   33: new 100	java/lang/StringBuilder
    //   36: dup
    //   37: ldc -103
    //   39: invokespecial 103	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   42: aload_1
    //   43: invokevirtual 107	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   46: ldc -101
    //   48: invokevirtual 107	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   51: iload 5
    //   53: invokevirtual 158	java/lang/StringBuilder:append	(I)Ljava/lang/StringBuilder;
    //   56: invokevirtual 110	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   59: invokestatic 115	android/util/Log:d	(Ljava/lang/String;Ljava/lang/String;)I
    //   62: pop
    //   63: new 160	com/ta/utdid2/a/b$a
    //   66: dup
    //   67: aload_0
    //   68: new 162	org/apache/http/client/methods/HttpPost
    //   71: dup
    //   72: aload_1
    //   73: invokespecial 163	org/apache/http/client/methods/HttpPost:<init>	(Ljava/lang/String;)V
    //   76: invokespecial 166	com/ta/utdid2/a/b$a:<init>	(Lcom/ta/utdid2/a/b;Lorg/apache/http/client/methods/HttpPost;)V
    //   79: astore_1
    //   80: aload_1
    //   81: invokevirtual 169	com/ta/utdid2/a/b$a:start	()V
    //   84: aload_0
    //   85: getfield 31	com/ta/utdid2/a/b:d	Ljava/lang/Object;
    //   88: astore_2
    //   89: aload_2
    //   90: monitorenter
    //   91: aload_0
    //   92: getfield 31	com/ta/utdid2/a/b:d	Ljava/lang/Object;
    //   95: iload 5
    //   97: i2l
    //   98: invokevirtual 173	java/lang/Object:wait	(J)V
    //   101: aload_2
    //   102: monitorexit
    //   103: aload_1
    //   104: invokevirtual 175	com/ta/utdid2/a/b$a:a	()Ljava/lang/String;
    //   107: astore_1
    //   108: getstatic 98	com/ta/utdid2/b/a/c:a	Z
    //   111: ifeq +26 -> 137
    //   114: getstatic 22	com/ta/utdid2/a/b:a	Ljava/lang/String;
    //   117: new 100	java/lang/StringBuilder
    //   120: dup
    //   121: ldc -79
    //   123: invokespecial 103	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   126: aload_1
    //   127: invokevirtual 107	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   130: invokevirtual 110	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   133: invokestatic 115	android/util/Log:d	(Ljava/lang/String;Ljava/lang/String;)I
    //   136: pop
    //   137: aload_1
    //   138: aload 4
    //   140: invokestatic 40	com/ta/utdid2/a/b:b	(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
    //   143: areturn
    //   144: sipush 1000
    //   147: istore 5
    //   149: goto -125 -> 24
    //   152: astore_3
    //   153: aload_2
    //   154: monitorexit
    //   155: aload_3
    //   156: athrow
    //   157: astore_2
    //   158: getstatic 22	com/ta/utdid2/a/b:a	Ljava/lang/String;
    //   161: aload_2
    //   162: invokevirtual 122	java/lang/Exception:toString	()Ljava/lang/String;
    //   165: invokestatic 121	android/util/Log:e	(Ljava/lang/String;Ljava/lang/String;)I
    //   168: pop
    //   169: goto -66 -> 103
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	172	0	this	b
    //   0	172	1	paramString1	String
    //   0	172	3	paramString3	String
    //   0	172	4	paramString4	String
    //   22	126	5	i	int
    // Exception table:
    //   from	to	target	type
    //   91	103	152	finally
    //   84	91	157	java/lang/Exception
    //   153	157	157	java/lang/Exception
  }
  
  public final void a(String paramString1, String paramString2, String paramString3, String paramString4, a paramA)
  {
    paramString3 = b(paramString1, paramString2, paramString3, paramString4);
    if (c.a) {
      Log.d(a, "url:" + paramString3 + "; len:" + paramString3.length());
    }
    new b.a(this, new HttpPost(paramString3), paramA, paramString4, paramString1, paramString2).start();
  }
}
