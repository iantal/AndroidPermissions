package com.ta.utdid2.device;

import android.content.Context;
import android.provider.Settings.System;
import com.ta.utdid2.b.a.b;
import com.ta.utdid2.b.a.f;
import com.ta.utdid2.b.a.h;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.util.Random;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public final class c
{
  private static final Object b = new Object();
  private static c c = null;
  private static final String j = ".UTSystemConfig" + File.separator + "Global";
  private Context a = null;
  private String d = null;
  private d e = null;
  private String f = "xx_utdid_key";
  private String g = "xx_utdid_domain";
  private com.ta.utdid2.c.a.c h = null;
  private com.ta.utdid2.c.a.c i = null;
  private Pattern k = Pattern.compile("[^0-9a-zA-Z=/+]+");
  
  private c(Context paramContext)
  {
    this.a = paramContext;
    this.i = new com.ta.utdid2.c.a.c(paramContext, j, "Alvin2");
    this.h = new com.ta.utdid2.c.a.c(paramContext, ".DataStorage", "ContextData");
    this.e = new d();
    this.f = String.format("K_%d", new Object[] { Integer.valueOf(h.b(this.f)) });
    this.g = String.format("D_%d", new Object[] { Integer.valueOf(h.b(this.g)) });
  }
  
  public static c a(Context paramContext)
  {
    if ((paramContext != null) && (c == null)) {}
    synchronized (b)
    {
      if (c == null)
      {
        paramContext = new c(paramContext);
        c = paramContext;
        if ((paramContext.i != null) && (h.a(paramContext.i.a("UTDID2"))))
        {
          String str = paramContext.i.a("UTDID");
          if (!h.a(str)) {
            paramContext.a(str);
          }
        }
      }
      return c;
    }
  }
  
  private void a(String paramString)
  {
    if (e(paramString))
    {
      String str = paramString;
      if (paramString.endsWith("\n")) {
        str = paramString.substring(0, paramString.length() - 1);
      }
      if ((str.length() == 24) && (this.i != null))
      {
        this.i.a("UTDID2", str);
        this.i.a("UTDID", str);
        this.i.a();
      }
    }
  }
  
  private void b(String paramString)
  {
    if ((paramString != null) && (this.h != null) && (!paramString.equals(this.h.a(this.f))))
    {
      this.h.a(this.f, paramString);
      this.h.a();
    }
  }
  
  private final byte[] b()
  {
    ByteArrayOutputStream localByteArrayOutputStream = new ByteArrayOutputStream();
    int m = (int)(System.currentTimeMillis() / 1000L);
    int n = new Random().nextInt();
    Object localObject1 = com.ta.utdid2.b.a.d.a(m);
    Object localObject2 = com.ta.utdid2.b.a.d.a(n);
    localByteArrayOutputStream.write((byte[])localObject1, 0, 4);
    localByteArrayOutputStream.write((byte[])localObject2, 0, 4);
    localByteArrayOutputStream.write(3);
    localByteArrayOutputStream.write(0);
    try
    {
      localObject1 = f.a(this.a);
      localByteArrayOutputStream.write(com.ta.utdid2.b.a.d.a(h.b((String)localObject1)), 0, 4);
      localObject1 = localByteArrayOutputStream.toByteArray();
      localObject2 = Mac.getInstance("HmacSHA1");
      ((Mac)localObject2).init(new SecretKeySpec("d6fc3a4a06adbde89223bvefedc24fecde188aaa9161".getBytes(), ((Mac)localObject2).getAlgorithm()));
      localByteArrayOutputStream.write(com.ta.utdid2.b.a.d.a(h.b(b.a(((Mac)localObject2).doFinal((byte[])localObject1), 2))));
      return localByteArrayOutputStream.toByteArray();
    }
    catch (Exception localException)
    {
      for (;;)
      {
        String str = new Random().nextInt();
      }
    }
  }
  
  private void c(String paramString)
  {
    if ((this.a.checkCallingOrSelfPermission("android.permission.WRITE_SETTINGS") == 0) && (e(paramString)))
    {
      String str = paramString;
      if (paramString.endsWith("\n")) {
        str = paramString.substring(0, paramString.length() - 1);
      }
      if ((24 == str.length()) && (!e(Settings.System.getString(this.a.getContentResolver(), "mqBRboGZkQPcAkyk")))) {
        Settings.System.putString(this.a.getContentResolver(), "mqBRboGZkQPcAkyk", str);
      }
    }
  }
  
  private void d(String paramString)
  {
    if ((this.a.checkCallingOrSelfPermission("android.permission.WRITE_SETTINGS") == 0) && (paramString != null) && (!paramString.equals(Settings.System.getString(this.a.getContentResolver(), "dxCRMxhQkdGePGnp")))) {
      Settings.System.putString(this.a.getContentResolver(), "dxCRMxhQkdGePGnp", paramString);
    }
  }
  
  private boolean e(String paramString)
  {
    boolean bool2 = false;
    boolean bool1 = bool2;
    if (paramString != null)
    {
      String str = paramString;
      if (paramString.endsWith("\n")) {
        str = paramString.substring(0, paramString.length() - 1);
      }
      bool1 = bool2;
      if (24 == str.length())
      {
        bool1 = bool2;
        if (!this.k.matcher(str).find()) {
          bool1 = true;
        }
      }
    }
    return bool1;
  }
  
  /* Error */
  public final String a()
  {
    // Byte code:
    //   0: aload_0
    //   1: monitorenter
    //   2: aload_0
    //   3: getfield 61	com/ta/utdid2/device/c:d	Ljava/lang/String;
    //   6: ifnull +12 -> 18
    //   9: aload_0
    //   10: getfield 61	com/ta/utdid2/device/c:d	Ljava/lang/String;
    //   13: astore_2
    //   14: aload_0
    //   15: monitorexit
    //   16: aload_2
    //   17: areturn
    //   18: aload_0
    //   19: getfield 59	com/ta/utdid2/device/c:a	Landroid/content/Context;
    //   22: invokevirtual 252	android/content/Context:getContentResolver	()Landroid/content/ContentResolver;
    //   25: ldc -2
    //   27: invokestatic 260	android/provider/Settings$System:getString	(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;
    //   30: astore_3
    //   31: aload_3
    //   32: astore_2
    //   33: aload_0
    //   34: aload_3
    //   35: invokespecial 137	com/ta/utdid2/device/c:e	(Ljava/lang/String;)Z
    //   38: ifne -24 -> 14
    //   41: new 277	com/ta/utdid2/device/e
    //   44: dup
    //   45: invokespecial 278	com/ta/utdid2/device/e:<init>	()V
    //   48: astore 4
    //   50: iconst_0
    //   51: istore_1
    //   52: aload_0
    //   53: getfield 59	com/ta/utdid2/device/c:a	Landroid/content/Context;
    //   56: invokevirtual 252	android/content/Context:getContentResolver	()Landroid/content/ContentResolver;
    //   59: ldc_w 266
    //   62: invokestatic 260	android/provider/Settings$System:getString	(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;
    //   65: astore_2
    //   66: aload_2
    //   67: invokestatic 131	com/ta/utdid2/b/a/h:a	(Ljava/lang/String;)Z
    //   70: ifne +399 -> 469
    //   73: aload 4
    //   75: aload_2
    //   76: invokevirtual 280	com/ta/utdid2/device/e:b	(Ljava/lang/String;)Ljava/lang/String;
    //   79: astore_3
    //   80: aload_0
    //   81: aload_3
    //   82: invokespecial 137	com/ta/utdid2/device/c:e	(Ljava/lang/String;)Z
    //   85: ifeq +30 -> 115
    //   88: aload_0
    //   89: aload_3
    //   90: invokespecial 282	com/ta/utdid2/device/c:c	(Ljava/lang/String;)V
    //   93: aload_3
    //   94: astore_2
    //   95: goto -81 -> 14
    //   98: astore_2
    //   99: aload_0
    //   100: monitorexit
    //   101: aload_2
    //   102: athrow
    //   103: astore_2
    //   104: aload_2
    //   105: invokevirtual 285	java/lang/Exception:printStackTrace	()V
    //   108: ldc_w 287
    //   111: astore_3
    //   112: goto -81 -> 31
    //   115: aload 4
    //   117: aload_2
    //   118: invokevirtual 288	com/ta/utdid2/device/e:a	(Ljava/lang/String;)Ljava/lang/String;
    //   121: astore_3
    //   122: aload_0
    //   123: aload_3
    //   124: invokespecial 137	com/ta/utdid2/device/c:e	(Ljava/lang/String;)Z
    //   127: ifeq +339 -> 466
    //   130: aload_0
    //   131: getfield 63	com/ta/utdid2/device/c:e	Lcom/ta/utdid2/device/d;
    //   134: aload_3
    //   135: invokevirtual 289	com/ta/utdid2/device/d:a	(Ljava/lang/String;)Ljava/lang/String;
    //   138: astore_3
    //   139: aload_3
    //   140: invokestatic 131	com/ta/utdid2/b/a/h:a	(Ljava/lang/String;)Z
    //   143: ifne +323 -> 466
    //   146: aload_0
    //   147: aload_3
    //   148: invokespecial 291	com/ta/utdid2/device/c:d	(Ljava/lang/String;)V
    //   151: aload_0
    //   152: getfield 59	com/ta/utdid2/device/c:a	Landroid/content/Context;
    //   155: invokevirtual 252	android/content/Context:getContentResolver	()Landroid/content/ContentResolver;
    //   158: ldc_w 266
    //   161: invokestatic 260	android/provider/Settings$System:getString	(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;
    //   164: astore_2
    //   165: aload_0
    //   166: getfield 63	com/ta/utdid2/device/c:e	Lcom/ta/utdid2/device/d;
    //   169: aload_2
    //   170: invokevirtual 292	com/ta/utdid2/device/d:b	(Ljava/lang/String;)Ljava/lang/String;
    //   173: astore_3
    //   174: aload_0
    //   175: aload_3
    //   176: invokespecial 137	com/ta/utdid2/device/c:e	(Ljava/lang/String;)Z
    //   179: ifeq +34 -> 213
    //   182: aload_0
    //   183: aload_3
    //   184: putfield 61	com/ta/utdid2/device/c:d	Ljava/lang/String;
    //   187: aload_0
    //   188: aload_3
    //   189: invokespecial 135	com/ta/utdid2/device/c:a	(Ljava/lang/String;)V
    //   192: aload_0
    //   193: aload_2
    //   194: invokespecial 294	com/ta/utdid2/device/c:b	(Ljava/lang/String;)V
    //   197: aload_0
    //   198: aload_0
    //   199: getfield 61	com/ta/utdid2/device/c:d	Ljava/lang/String;
    //   202: invokespecial 282	com/ta/utdid2/device/c:c	(Ljava/lang/String;)V
    //   205: aload_0
    //   206: getfield 61	com/ta/utdid2/device/c:d	Ljava/lang/String;
    //   209: astore_2
    //   210: goto -196 -> 14
    //   213: aload_0
    //   214: getfield 75	com/ta/utdid2/device/c:i	Lcom/ta/utdid2/c/a/c;
    //   217: ifnull +257 -> 474
    //   220: aload_0
    //   221: getfield 75	com/ta/utdid2/device/c:i	Lcom/ta/utdid2/c/a/c;
    //   224: ldc 125
    //   226: invokevirtual 128	com/ta/utdid2/c/a/c:a	(Ljava/lang/String;)Ljava/lang/String;
    //   229: astore_2
    //   230: aload_2
    //   231: invokestatic 131	com/ta/utdid2/b/a/h:a	(Ljava/lang/String;)Z
    //   234: ifne +240 -> 474
    //   237: aload_0
    //   238: getfield 63	com/ta/utdid2/device/c:e	Lcom/ta/utdid2/device/d;
    //   241: aload_2
    //   242: invokevirtual 289	com/ta/utdid2/device/d:a	(Ljava/lang/String;)Ljava/lang/String;
    //   245: ifnull +229 -> 474
    //   248: aload_0
    //   249: aload_2
    //   250: invokespecial 137	com/ta/utdid2/device/c:e	(Ljava/lang/String;)Z
    //   253: ifeq +39 -> 292
    //   256: aload_0
    //   257: getfield 63	com/ta/utdid2/device/c:e	Lcom/ta/utdid2/device/d;
    //   260: aload_2
    //   261: invokevirtual 289	com/ta/utdid2/device/d:a	(Ljava/lang/String;)Ljava/lang/String;
    //   264: astore_3
    //   265: iload_1
    //   266: ifeq +8 -> 274
    //   269: aload_0
    //   270: aload_3
    //   271: invokespecial 291	com/ta/utdid2/device/c:d	(Ljava/lang/String;)V
    //   274: aload_0
    //   275: aload_2
    //   276: invokespecial 282	com/ta/utdid2/device/c:c	(Ljava/lang/String;)V
    //   279: aload_0
    //   280: aload_3
    //   281: invokespecial 294	com/ta/utdid2/device/c:b	(Ljava/lang/String;)V
    //   284: aload_0
    //   285: aload_2
    //   286: putfield 61	com/ta/utdid2/device/c:d	Ljava/lang/String;
    //   289: goto -275 -> 14
    //   292: aload_0
    //   293: getfield 73	com/ta/utdid2/device/c:h	Lcom/ta/utdid2/c/a/c;
    //   296: aload_0
    //   297: getfield 67	com/ta/utdid2/device/c:f	Ljava/lang/String;
    //   300: invokevirtual 128	com/ta/utdid2/c/a/c:a	(Ljava/lang/String;)Ljava/lang/String;
    //   303: astore 5
    //   305: aload 5
    //   307: invokestatic 131	com/ta/utdid2/b/a/h:a	(Ljava/lang/String;)Z
    //   310: ifne +85 -> 395
    //   313: aload 4
    //   315: aload 5
    //   317: invokevirtual 288	com/ta/utdid2/device/e:a	(Ljava/lang/String;)Ljava/lang/String;
    //   320: astore_3
    //   321: aload_3
    //   322: astore_2
    //   323: aload_0
    //   324: aload_3
    //   325: invokespecial 137	com/ta/utdid2/device/c:e	(Ljava/lang/String;)Z
    //   328: ifne +13 -> 341
    //   331: aload_0
    //   332: getfield 63	com/ta/utdid2/device/c:e	Lcom/ta/utdid2/device/d;
    //   335: aload 5
    //   337: invokevirtual 292	com/ta/utdid2/device/d:b	(Ljava/lang/String;)Ljava/lang/String;
    //   340: astore_2
    //   341: aload_0
    //   342: aload_2
    //   343: invokespecial 137	com/ta/utdid2/device/c:e	(Ljava/lang/String;)Z
    //   346: ifeq +49 -> 395
    //   349: aload_0
    //   350: getfield 63	com/ta/utdid2/device/c:e	Lcom/ta/utdid2/device/d;
    //   353: aload_2
    //   354: invokevirtual 289	com/ta/utdid2/device/d:a	(Ljava/lang/String;)Ljava/lang/String;
    //   357: astore_3
    //   358: aload_2
    //   359: invokestatic 131	com/ta/utdid2/b/a/h:a	(Ljava/lang/String;)Z
    //   362: ifne +33 -> 395
    //   365: aload_0
    //   366: aload_2
    //   367: putfield 61	com/ta/utdid2/device/c:d	Ljava/lang/String;
    //   370: iload_1
    //   371: ifeq +8 -> 379
    //   374: aload_0
    //   375: aload_3
    //   376: invokespecial 291	com/ta/utdid2/device/c:d	(Ljava/lang/String;)V
    //   379: aload_0
    //   380: aload_0
    //   381: getfield 61	com/ta/utdid2/device/c:d	Ljava/lang/String;
    //   384: invokespecial 135	com/ta/utdid2/device/c:a	(Ljava/lang/String;)V
    //   387: aload_0
    //   388: getfield 61	com/ta/utdid2/device/c:d	Ljava/lang/String;
    //   391: astore_2
    //   392: goto -378 -> 14
    //   395: aload_0
    //   396: invokespecial 296	com/ta/utdid2/device/c:b	()[B
    //   399: astore_2
    //   400: aload_2
    //   401: ifnull +60 -> 461
    //   404: aload_0
    //   405: aload_2
    //   406: iconst_2
    //   407: invokestatic 234	com/ta/utdid2/b/a/b:a	([BI)Ljava/lang/String;
    //   410: putfield 61	com/ta/utdid2/device/c:d	Ljava/lang/String;
    //   413: aload_0
    //   414: aload_0
    //   415: getfield 61	com/ta/utdid2/device/c:d	Ljava/lang/String;
    //   418: invokespecial 135	com/ta/utdid2/device/c:a	(Ljava/lang/String;)V
    //   421: aload_0
    //   422: getfield 63	com/ta/utdid2/device/c:e	Lcom/ta/utdid2/device/d;
    //   425: aload_2
    //   426: invokevirtual 299	com/ta/utdid2/device/d:a	([B)Ljava/lang/String;
    //   429: astore_2
    //   430: aload_2
    //   431: ifnull +17 -> 448
    //   434: iload_1
    //   435: ifeq +8 -> 443
    //   438: aload_0
    //   439: aload_2
    //   440: invokespecial 291	com/ta/utdid2/device/c:d	(Ljava/lang/String;)V
    //   443: aload_0
    //   444: aload_2
    //   445: invokespecial 294	com/ta/utdid2/device/c:b	(Ljava/lang/String;)V
    //   448: aload_0
    //   449: getfield 61	com/ta/utdid2/device/c:d	Ljava/lang/String;
    //   452: astore_2
    //   453: goto -439 -> 14
    //   456: astore_2
    //   457: aload_2
    //   458: invokevirtual 285	java/lang/Exception:printStackTrace	()V
    //   461: aconst_null
    //   462: astore_2
    //   463: goto -449 -> 14
    //   466: goto -301 -> 165
    //   469: iconst_1
    //   470: istore_1
    //   471: goto -258 -> 213
    //   474: aconst_null
    //   475: astore_2
    //   476: goto -228 -> 248
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	479	0	this	c
    //   51	420	1	m	int
    //   13	82	2	localObject1	Object
    //   98	4	2	localObject2	Object
    //   103	15	2	localException1	Exception
    //   164	289	2	localObject3	Object
    //   456	2	2	localException2	Exception
    //   462	14	2	localObject4	Object
    //   30	346	3	str1	String
    //   48	266	4	localE	e
    //   303	33	5	str2	String
    // Exception table:
    //   from	to	target	type
    //   2	14	98	finally
    //   18	31	98	finally
    //   33	50	98	finally
    //   52	93	98	finally
    //   104	108	98	finally
    //   115	165	98	finally
    //   165	174	98	finally
    //   174	210	98	finally
    //   213	248	98	finally
    //   248	265	98	finally
    //   269	274	98	finally
    //   274	289	98	finally
    //   292	321	98	finally
    //   323	341	98	finally
    //   341	370	98	finally
    //   374	379	98	finally
    //   379	392	98	finally
    //   395	400	98	finally
    //   404	430	98	finally
    //   438	443	98	finally
    //   443	448	98	finally
    //   448	453	98	finally
    //   457	461	98	finally
    //   18	31	103	java/lang/Exception
    //   395	400	456	java/lang/Exception
    //   404	430	456	java/lang/Exception
    //   438	443	456	java/lang/Exception
    //   443	448	456	java/lang/Exception
    //   448	453	456	java/lang/Exception
  }
}
