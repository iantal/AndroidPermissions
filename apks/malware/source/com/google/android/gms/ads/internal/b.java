package com.google.android.gms.ads.internal;

import android.content.Context;
import android.content.Intent;
import android.content.pm.ApplicationInfo;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.content.pm.PackageManager.NameNotFoundException;
import android.content.res.Resources;
import android.os.Bundle;
import android.os.Handler;
import android.os.Messenger;
import android.os.RemoteException;
import android.util.DisplayMetrics;
import com.google.android.gms.ads.internal.client.AdRequestParcel;
import com.google.android.gms.ads.internal.client.AdSizeParcel;
import com.google.android.gms.ads.internal.client.ac;
import com.google.android.gms.ads.internal.overlay.j;
import com.google.android.gms.ads.internal.purchase.GInAppPurchaseManagerInfoParcel;
import com.google.android.gms.ads.internal.purchase.g;
import com.google.android.gms.ads.internal.purchase.h;
import com.google.android.gms.ads.internal.purchase.m;
import com.google.android.gms.ads.internal.request.aa;
import com.google.android.gms.ads.internal.util.client.VersionInfoParcel;
import com.google.android.gms.b.ao;
import com.google.android.gms.b.ba;
import com.google.android.gms.b.cd;
import com.google.android.gms.b.cg;
import com.google.android.gms.b.cz;
import com.google.android.gms.b.dg;
import com.google.android.gms.b.dh;
import com.google.android.gms.b.fn;
import com.google.android.gms.b.hd;
import com.google.android.gms.b.he;
import com.google.android.gms.b.hf;
import com.google.android.gms.b.hj;
import com.google.android.gms.b.ho;
import com.google.android.gms.b.hq;
import com.google.android.gms.b.ht;
import com.google.android.gms.b.jf;
import com.google.android.gms.b.jm;
import com.google.android.gms.b.jy;
import com.google.android.gms.b.ml;
import com.google.android.gms.b.mn;
import com.google.android.gms.b.mp;
import com.google.android.gms.b.ms;
import com.google.android.gms.b.mu;
import com.google.android.gms.b.nj;
import com.google.android.gms.b.nm;
import com.google.android.gms.b.pa;
import com.google.android.gms.b.qx;
import com.google.android.gms.common.internal.aq;
import java.util.ArrayList;
import java.util.List;
import java.util.UUID;

public abstract class b
  extends a
  implements j, com.google.android.gms.ads.internal.purchase.l, fn, hf
{
  protected final hq e;
  protected transient boolean f;
  private final Messenger g;
  
  public b(Context paramContext, AdSizeParcel paramAdSizeParcel, String paramString, hq paramHq, VersionInfoParcel paramVersionInfoParcel)
  {
    this(new x(paramContext, paramAdSizeParcel, paramString, paramVersionInfoParcel), paramHq);
  }
  
  private b(x paramX, hq paramHq)
  {
    super(paramX);
    this.e = paramHq;
    this.g = new Messenger(new jf(this.b.c));
    this.f = false;
  }
  
  private com.google.android.gms.ads.internal.request.a a(AdRequestParcel paramAdRequestParcel, Bundle paramBundle)
  {
    ApplicationInfo localApplicationInfo = this.b.c.getApplicationInfo();
    try
    {
      PackageInfo localPackageInfo1 = this.b.c.getPackageManager().getPackageInfo(localApplicationInfo.packageName, 0);
      localDisplayMetrics = this.b.c.getResources().getDisplayMetrics();
      str1 = null;
      localObject = str1;
      if (this.b.f != null)
      {
        localObject = str1;
        if (this.b.f.getParent() != null)
        {
          localObject = new int[2];
          this.b.f.getLocationOnScreen((int[])localObject);
          int k = localObject[0];
          int m = localObject[1];
          int n = this.b.f.getWidth();
          int i1 = this.b.f.getHeight();
          j = 0;
          i = j;
          if (this.b.f.isShown())
          {
            i = j;
            if (k + n > 0)
            {
              i = j;
              if (m + i1 > 0)
              {
                i = j;
                if (k <= localDisplayMetrics.widthPixels)
                {
                  i = j;
                  if (m <= localDisplayMetrics.heightPixels) {
                    i = 1;
                  }
                }
              }
            }
          }
          localObject = new Bundle(5);
          ((Bundle)localObject).putInt("x", k);
          ((Bundle)localObject).putInt("y", m);
          ((Bundle)localObject).putInt("width", n);
          ((Bundle)localObject).putInt("height", i1);
          ((Bundle)localObject).putInt("visible", i);
        }
      }
      str1 = w.h().b();
      this.b.l = new mn(str1, this.b.b);
      this.b.l.a(paramAdRequestParcel);
      w.e();
      str2 = nj.a(this.b.c, this.b.f, this.b.i);
      j = o.a(this.b.c).c();
      bool = o.a(this.b.c).a();
      l2 = 0L;
      l1 = l2;
      if (this.b.p == null) {}
    }
    catch (PackageManager.NameNotFoundException localNameNotFoundException)
    {
      try
      {
        l1 = this.b.p.a();
        String str3 = UUID.randomUUID().toString();
        localBundle = w.h().a(this.b.c, this, str1);
        localArrayList = new ArrayList();
        int i = 0;
        while (i < this.b.v.size())
        {
          localArrayList.add(this.b.v.b(i));
          i += 1;
        }
        localNameNotFoundException = localNameNotFoundException;
        localPackageInfo2 = null;
      }
      catch (RemoteException localRemoteException)
      {
        DisplayMetrics localDisplayMetrics;
        String str1;
        Object localObject;
        int j;
        String str2;
        boolean bool;
        long l1;
        Bundle localBundle;
        ArrayList localArrayList;
        PackageInfo localPackageInfo2;
        for (;;)
        {
          long l2;
          com.google.android.gms.ads.internal.util.client.b.e("Cannot get correlation id, default to 0.");
          l1 = l2;
        }
        return new com.google.android.gms.ads.internal.request.a((Bundle)localObject, paramAdRequestParcel, this.b.i, this.b.b, localApplicationInfo, localPackageInfo2, str1, w.h().a(), this.b.e, localBundle, this.b.y, localArrayList, paramBundle, w.h().f(), this.g, localDisplayMetrics.widthPixels, localDisplayMetrics.heightPixels, localDisplayMetrics.density, str2, bool, j, l1, localRemoteException, dh.a(), this.b.a, this.b.w);
      }
    }
  }
  
  public void a(jm paramJm)
  {
    aq.b("setInAppPurchaseListener must be called on the main UI thread.");
    this.b.q = paramJm;
  }
  
  public final void a(jy paramJy, String paramString)
  {
    aq.b("setPlayStorePurchaseParams must be called on the main UI thread.");
    this.b.z = new m(paramString);
    this.b.r = paramJy;
    if ((!w.h().e()) && (paramJy != null)) {
      new com.google.android.gms.ads.internal.purchase.c(this.b.c, this.b.r, this.b.z).h();
    }
  }
  
  protected final void a(ml paramMl, boolean paramBoolean)
  {
    if (paramMl == null) {
      com.google.android.gms.ads.internal.util.client.b.e("Ad state was null when trying to ping impression URLs.");
    }
    do
    {
      return;
      super.c(paramMl);
      if ((paramMl.o != null) && (paramMl.o.d != null))
      {
        w.p();
        ho.a(this.b.c, this.b.e.c, paramMl, this.b.b, paramBoolean, a(paramMl.o.d, paramMl.x));
      }
    } while ((paramMl.l == null) || (paramMl.l.g == null));
    w.p();
    ho.a(this.b.c, this.b.e.c, paramMl, this.b.b, paramBoolean, paramMl.l.g);
  }
  
  public final void a(String paramString, ArrayList<String> paramArrayList)
  {
    paramArrayList = new com.google.android.gms.ads.internal.purchase.e(paramString, paramArrayList, this.b.c, this.b.e.c);
    if (this.b.q == null)
    {
      com.google.android.gms.ads.internal.util.client.b.e("InAppPurchaseListener is not set. Try to launch default purchase flow.");
      com.google.android.gms.ads.internal.client.l.a();
      if (!com.google.android.gms.ads.internal.util.client.a.b(this.b.c))
      {
        com.google.android.gms.ads.internal.util.client.b.e("Google Play Service unavailable, cannot launch default purchase flow.");
        return;
      }
      if (this.b.r == null)
      {
        com.google.android.gms.ads.internal.util.client.b.e("PlayStorePurchaseListener is not set.");
        return;
      }
      if (this.b.z == null)
      {
        com.google.android.gms.ads.internal.util.client.b.e("PlayStorePurchaseVerifier is not initialized.");
        return;
      }
      if (this.b.D)
      {
        com.google.android.gms.ads.internal.util.client.b.e("An in-app purchase request is already in progress, abort");
        return;
      }
      this.b.D = true;
      try
      {
        if (!this.b.r.a(paramString))
        {
          this.b.D = false;
          return;
        }
      }
      catch (RemoteException paramString)
      {
        com.google.android.gms.ads.internal.util.client.b.e("Could not start In-App purchase.");
        this.b.D = false;
        return;
      }
      w.o();
      paramString = this.b.c;
      boolean bool = this.b.e.f;
      paramArrayList = new GInAppPurchaseManagerInfoParcel(this.b.c, this.b.z, paramArrayList, this);
      Intent localIntent = new Intent();
      localIntent.setClassName(paramString, "com.google.android.gms.ads.purchase.InAppPurchaseActivity");
      localIntent.putExtra("com.google.android.gms.ads.internal.purchase.useClientJar", bool);
      GInAppPurchaseManagerInfoParcel.a(localIntent, paramArrayList);
      paramString.startActivity(localIntent);
      return;
    }
    try
    {
      this.b.q.a(paramArrayList);
      return;
    }
    catch (RemoteException paramString)
    {
      com.google.android.gms.ads.internal.util.client.b.e("Could not start In-App purchase.");
    }
  }
  
  public final void a(String paramString, boolean paramBoolean, int paramInt, Intent paramIntent, g paramG)
  {
    try
    {
      if (this.b.r != null) {
        this.b.r.a(new h(this.b.c, paramString, paramBoolean, paramInt, paramIntent, paramG));
      }
      nj.a.postDelayed(new c(this, paramIntent), 500L);
      return;
    }
    catch (RemoteException paramString)
    {
      for (;;)
      {
        com.google.android.gms.ads.internal.util.client.b.e("Fail to invoke PlayStorePurchaseListener.");
      }
    }
  }
  
  protected boolean a(AdRequestParcel paramAdRequestParcel, ml paramMl, boolean paramBoolean)
  {
    if ((!paramBoolean) && (this.b.d()))
    {
      if (paramMl.h <= 0L) {
        break label43;
      }
      this.a.a(paramAdRequestParcel, paramMl.h);
    }
    for (;;)
    {
      return this.a.d();
      label43:
      if ((paramMl.o != null) && (paramMl.o.g > 0L)) {
        this.a.a(paramAdRequestParcel, paramMl.o.g);
      } else if ((!paramMl.k) && (paramMl.d == 2)) {
        this.a.a(paramAdRequestParcel);
      }
    }
  }
  
  final boolean a(ml paramMl)
  {
    boolean bool = false;
    Object localObject;
    if (this.c != null)
    {
      localObject = this.c;
      this.c = null;
    }
    for (;;)
    {
      return a((AdRequestParcel)localObject, paramMl, bool);
      AdRequestParcel localAdRequestParcel = paramMl.a;
      localObject = localAdRequestParcel;
      if (localAdRequestParcel.d != null)
      {
        bool = localAdRequestParcel.d.getBoolean("_noRefresh", false);
        localObject = localAdRequestParcel;
      }
    }
  }
  
  protected boolean a(ml paramMl1, ml paramMl2)
  {
    int i = 0;
    if ((paramMl1 != null) && (paramMl1.p != null)) {
      paramMl1.p.a(null);
    }
    if (paramMl2.p != null) {
      paramMl2.p.a(this);
    }
    int j;
    if (paramMl2.o != null)
    {
      j = paramMl2.o.j;
      i = paramMl2.o.k;
    }
    for (;;)
    {
      this.b.A.a(j, i);
      return true;
      j = 0;
    }
  }
  
  public void a_()
  {
    this.d.a(this.b.j);
    this.f = false;
    m();
    this.b.l.c();
  }
  
  public final void b(ml paramMl)
  {
    super.b(paramMl);
    if ((paramMl.d == 3) && (paramMl.o != null) && (paramMl.o.e != null))
    {
      com.google.android.gms.ads.internal.util.client.b.a("Pinging no fill URLs.");
      w.p();
      ho.a(this.b.c, this.b.e.c, paramMl, this.b.b, false, paramMl.o.e);
    }
  }
  
  public boolean b(AdRequestParcel paramAdRequestParcel)
  {
    ao localAo = null;
    if (!q()) {
      return false;
    }
    Object localObject1 = w.h().a(this.b.c);
    Object localObject2 = localAo;
    if (localObject1 != null)
    {
      if (((cg)localObject1).d()) {
        ((cg)localObject1).c();
      }
      localObject2 = ((cg)localObject1).b();
      if (localObject2 == null) {
        break label237;
      }
      localObject1 = ((cd)localObject2).b();
      com.google.android.gms.ads.internal.util.client.b.a("In AdManger: loadAd, " + ((cd)localObject2).toString());
    }
    for (;;)
    {
      localObject2 = localAo;
      if (localObject1 != null)
      {
        localObject2 = new Bundle(1);
        ((Bundle)localObject2).putString("fingerprint", (String)localObject1);
        ((Bundle)localObject2).putInt("v", 1);
      }
      this.a.a();
      this.b.C = 0;
      paramAdRequestParcel = a(paramAdRequestParcel, (Bundle)localObject2);
      localObject1 = this.b;
      w.a();
      localObject2 = this.b.c;
      localAo = this.b.d;
      cz localCz = dh.S;
      if ((((Boolean)w.n().a(localCz)).booleanValue()) && (paramAdRequestParcel.b.d.getBundle("sdk_less_server_data") != null)) {}
      for (paramAdRequestParcel = new aa((Context)localObject2, paramAdRequestParcel, this);; paramAdRequestParcel = new com.google.android.gms.ads.internal.request.e((Context)localObject2, paramAdRequestParcel, localAo, this))
      {
        paramAdRequestParcel.i();
        ((x)localObject1).g = paramAdRequestParcel;
        return true;
      }
      label237:
      localObject1 = null;
    }
  }
  
  public void b_()
  {
    this.f = true;
    n();
  }
  
  protected final boolean c(AdRequestParcel paramAdRequestParcel)
  {
    return (super.c(paramAdRequestParcel)) && (!this.f);
  }
  
  public void d()
  {
    aq.b("pause must be called on the main UI thread.");
    if ((this.b.j != null) && (this.b.d())) {
      w.g().a(this.b.j.b.a());
    }
    if ((this.b.j != null) && (this.b.j.m != null)) {}
    try
    {
      this.b.j.m.d();
      this.d.c(this.b.j);
      this.a.b();
      return;
    }
    catch (RemoteException localRemoteException)
    {
      for (;;)
      {
        com.google.android.gms.ads.internal.util.client.b.e("Could not pause mediation adapter.");
      }
    }
  }
  
  public final void e()
  {
    if (this.b.j == null)
    {
      com.google.android.gms.ads.internal.util.client.b.e("Ad state was null when trying to ping click URLs.");
      return;
    }
    if ((this.b.j.o != null) && (this.b.j.o.c != null))
    {
      w.p();
      ho.a(this.b.c, this.b.e.c, this.b.j, this.b.b, false, a(this.b.j.o.c, this.b.j.x));
    }
    if ((this.b.j.l != null) && (this.b.j.l.f != null))
    {
      w.p();
      ho.a(this.b.c, this.b.e.c, this.b.j, this.b.b, false, this.b.j.l.f);
    }
    super.e();
  }
  
  public void f()
  {
    aq.b("resume must be called on the main UI thread.");
    if ((this.b.j != null) && (this.b.d())) {
      w.g().b(this.b.j.b.a());
    }
    if ((this.b.j != null) && (this.b.j.m != null)) {}
    try
    {
      this.b.j.m.e();
      this.a.c();
      this.d.d(this.b.j);
      return;
    }
    catch (RemoteException localRemoteException)
    {
      for (;;)
      {
        com.google.android.gms.ads.internal.util.client.b.e("Could not resume mediation adapter.");
      }
    }
  }
  
  public void g()
  {
    throw new IllegalStateException("showInterstitial is not supported for current ad type");
  }
  
  public final String k()
  {
    if (this.b.j == null) {
      return null;
    }
    return this.b.j.n;
  }
  
  protected boolean q()
  {
    boolean bool = true;
    w.e();
    if (nj.a(this.b.c.getPackageManager(), this.b.c.getPackageName(), "android.permission.INTERNET"))
    {
      w.e();
      if (nj.a(this.b.c)) {}
    }
    else
    {
      bool = false;
    }
    return bool;
  }
  
  public final void r()
  {
    e();
  }
  
  public final void s()
  {
    a_();
  }
  
  public final void t()
  {
    l();
  }
  
  public final void u()
  {
    b_();
  }
  
  public final void v()
  {
    if (this.b.j != null) {
      com.google.android.gms.ads.internal.util.client.b.e("Mediation adapter " + this.b.j.n + " refreshed, but mediation adapters should never refresh.");
    }
    a(this.b.j, true);
    o();
  }
}
