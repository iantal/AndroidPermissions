package com.google.zxing.client.android;

import android.app.Activity;
import android.app.AlertDialog.Builder;
import android.content.ActivityNotFoundException;
import android.content.Intent;
import android.net.Uri;
import android.provider.ContactsContract.Contacts;
import android.util.Log;
import com.google.zxing.client.result.ParsedResult;
import com.google.zxing.client.result.ParsedResultType;
import java.text.DateFormat;
import java.text.ParsePosition;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.Locale;
import java.util.TimeZone;

public abstract class ResultHandler
{
  private static final String[] ADDRESS_TYPE_STRINGS;
  private static final int[] ADDRESS_TYPE_VALUES = { 1, 2 };
  private static final DateFormat DATE_FORMAT;
  private static final DateFormat DATE_TIME_FORMAT;
  private static final String[] EMAIL_TYPE_STRINGS;
  private static final int[] EMAIL_TYPE_VALUES;
  public static final int MAX_BUTTON_COUNT = 4;
  private static final int NO_TYPE = -1;
  private static final String[] PHONE_TYPE_STRINGS;
  private static final int[] PHONE_TYPE_VALUES;
  private static final String TAG = ResultHandler.class.getSimpleName();
  private final Activity activity;
  private final ParsedResult result;
  
  static
  {
    DATE_FORMAT = new SimpleDateFormat("yyyyMMdd", Locale.ENGLISH);
    DATE_FORMAT.setTimeZone(TimeZone.getTimeZone("GMT"));
    DATE_TIME_FORMAT = new SimpleDateFormat("yyyyMMdd'T'HHmmss", Locale.ENGLISH);
    EMAIL_TYPE_STRINGS = new String[] { "home", "work", "mobile" };
    PHONE_TYPE_STRINGS = new String[] { "home", "work", "mobile", "fax", "pager", "main" };
    ADDRESS_TYPE_STRINGS = new String[] { "home", "work" };
    EMAIL_TYPE_VALUES = new int[] { 1, 2, 4 };
    PHONE_TYPE_VALUES = new int[] { 1, 3, 2, 4, 6, 12 };
  }
  
  ResultHandler(Activity paramActivity, ParsedResult paramParsedResult)
  {
    this.result = paramParsedResult;
    this.activity = paramActivity;
  }
  
  private static long calculateMilliseconds(String paramString)
  {
    if (paramString.length() == 8) {}
    for (;;)
    {
      long l1;
      synchronized (DATE_FORMAT)
      {
        paramString = DATE_FORMAT.parse(paramString, new ParsePosition(0));
        l1 = paramString.getTime();
        return l1;
      }
      synchronized (DATE_TIME_FORMAT)
      {
        Date localDate = DATE_TIME_FORMAT.parse(paramString.substring(0, 15), new ParsePosition(0));
        long l2 = localDate.getTime();
        l1 = l2;
        if (paramString.length() != 16) {
          continue;
        }
        l1 = l2;
        if (paramString.charAt(15) != 'Z') {
          continue;
        }
        paramString = new GregorianCalendar();
        return l2 + (paramString.get(15) + paramString.get(16));
      }
    }
  }
  
  private static int doToContractType(String paramString, String[] paramArrayOfString, int[] paramArrayOfInt)
  {
    if (paramString == null) {}
    for (;;)
    {
      return -1;
      int i = 0;
      while (i < paramArrayOfString.length)
      {
        String str = paramArrayOfString[i];
        if ((paramString.startsWith(str)) || (paramString.startsWith(str.toUpperCase(Locale.ENGLISH)))) {
          return paramArrayOfInt[i];
        }
        i += 1;
      }
    }
  }
  
  private static void putExtra(Intent paramIntent, String paramString1, String paramString2)
  {
    if ((paramString2 != null) && (paramString2.length() > 0)) {
      paramIntent.putExtra(paramString1, paramString2);
    }
  }
  
  private static int toAddressContractType(String paramString)
  {
    return doToContractType(paramString, ADDRESS_TYPE_STRINGS, ADDRESS_TYPE_VALUES);
  }
  
  private static int toEmailContractType(String paramString)
  {
    return doToContractType(paramString, EMAIL_TYPE_STRINGS, EMAIL_TYPE_VALUES);
  }
  
  private static int toPhoneContractType(String paramString)
  {
    return doToContractType(paramString, PHONE_TYPE_STRINGS, PHONE_TYPE_VALUES);
  }
  
  final void addCalendarEvent(String paramString1, String paramString2, String paramString3, String paramString4, String paramString5)
  {
    Intent localIntent = new Intent("android.intent.action.EDIT");
    localIntent.setType("vnd.android.cursor.item/event");
    long l = calculateMilliseconds(paramString2);
    localIntent.putExtra("beginTime", l);
    int i;
    if (paramString2.length() == 8)
    {
      i = 1;
      if (i != 0) {
        localIntent.putExtra("allDay", true);
      }
      if (paramString3 != null) {
        break label133;
      }
      if (i == 0) {
        break label130;
      }
      l += 86400000L;
    }
    for (;;)
    {
      localIntent.putExtra("endTime", l);
      localIntent.putExtra("title", paramString1);
      localIntent.putExtra("eventLocation", paramString4);
      localIntent.putExtra("description", paramString5);
      launchIntent(localIntent);
      return;
      i = 0;
      break;
      label130:
      continue;
      label133:
      l = calculateMilliseconds(paramString3);
    }
  }
  
  final void addContact(String[] paramArrayOfString1, String paramString1, String[] paramArrayOfString2, String[] paramArrayOfString3, String[] paramArrayOfString4, String[] paramArrayOfString5, String paramString2, String paramString3, String paramString4, String paramString5, String paramString6, String paramString7, String paramString8, String paramString9)
  {
    Intent localIntent = new Intent("android.intent.action.INSERT_OR_EDIT", ContactsContract.Contacts.CONTENT_URI);
    localIntent.setType("vnd.android.cursor.item/contact");
    if (paramArrayOfString1 != null)
    {
      paramArrayOfString1 = paramArrayOfString1[0];
      putExtra(localIntent, "name", paramArrayOfString1);
      putExtra(localIntent, "phonetic_name", paramString1);
      if (paramArrayOfString2 == null) {
        break label146;
      }
    }
    int k;
    label146:
    for (int i = paramArrayOfString2.length;; i = 0)
    {
      j = Math.min(i, Contents.PHONE_KEYS.length);
      i = 0;
      while (i < j)
      {
        putExtra(localIntent, Contents.PHONE_KEYS[i], paramArrayOfString2[i]);
        if ((paramArrayOfString3 != null) && (i < paramArrayOfString3.length))
        {
          k = toPhoneContractType(paramArrayOfString3[i]);
          if (k >= 0) {
            localIntent.putExtra(Contents.PHONE_TYPE_KEYS[i], k);
          }
        }
        i += 1;
      }
      paramArrayOfString1 = null;
      break;
    }
    if (paramArrayOfString4 != null) {}
    for (i = paramArrayOfString4.length;; i = 0)
    {
      j = Math.min(i, Contents.EMAIL_KEYS.length);
      i = 0;
      while (i < j)
      {
        putExtra(localIntent, Contents.EMAIL_KEYS[i], paramArrayOfString4[i]);
        if ((paramArrayOfString5 != null) && (i < paramArrayOfString5.length))
        {
          k = toEmailContractType(paramArrayOfString5[i]);
          if (k >= 0) {
            localIntent.putExtra(Contents.EMAIL_TYPE_KEYS[i], k);
          }
        }
        i += 1;
      }
    }
    paramArrayOfString1 = new StringBuilder();
    paramString1 = new String[3];
    paramString1[0] = paramString8;
    paramString1[1] = paramString9;
    paramString1[2] = paramString2;
    int j = paramString1.length;
    i = 0;
    while (i < j)
    {
      paramArrayOfString2 = paramString1[i];
      if (paramArrayOfString2 != null)
      {
        if (paramArrayOfString1.length() > 0) {
          paramArrayOfString1.append('\n');
        }
        paramArrayOfString1.append(paramArrayOfString2);
      }
      i += 1;
    }
    if (paramArrayOfString1.length() > 0) {
      putExtra(localIntent, "notes", paramArrayOfString1.toString());
    }
    putExtra(localIntent, "im_handle", paramString3);
    putExtra(localIntent, "postal", paramString4);
    if (paramString5 != null)
    {
      i = toAddressContractType(paramString5);
      if (i >= 0) {
        localIntent.putExtra("postal_type", i);
      }
    }
    putExtra(localIntent, "company", paramString6);
    putExtra(localIntent, "job_title", paramString7);
    launchIntent(localIntent);
  }
  
  final void addEmailOnlyContact(String[] paramArrayOfString1, String[] paramArrayOfString2)
  {
    addContact(null, null, null, null, paramArrayOfString1, paramArrayOfString2, null, null, null, null, null, null, null, null);
  }
  
  final void addPhoneOnlyContact(String[] paramArrayOfString1, String[] paramArrayOfString2)
  {
    addContact(null, null, paramArrayOfString1, paramArrayOfString2, null, null, null, null, null, null, null, null, null, null);
  }
  
  public boolean areContentsSecure()
  {
    return false;
  }
  
  final void dialPhone(String paramString)
  {
    launchIntent(new Intent("android.intent.action.DIAL", Uri.parse("tel:" + paramString)));
  }
  
  final void dialPhoneFromUri(String paramString)
  {
    launchIntent(new Intent("android.intent.action.DIAL", Uri.parse(paramString)));
  }
  
  Activity getActivity()
  {
    return this.activity;
  }
  
  public abstract int getButtonCount();
  
  public abstract int getButtonText(int paramInt);
  
  public CharSequence getDisplayContents()
  {
    return this.result.getDisplayResult().replace("\r", "");
  }
  
  public abstract int getDisplayTitle();
  
  public ParsedResult getResult()
  {
    return this.result;
  }
  
  public final ParsedResultType getType()
  {
    return this.result.getType();
  }
  
  public abstract void handleButtonPress(int paramInt);
  
  void launchIntent(Intent paramIntent)
  {
    if (paramIntent != null)
    {
      paramIntent.addFlags(524288);
      Log.d(TAG, "Launching intent: " + paramIntent + " with extras: " + paramIntent.getExtras());
    }
    try
    {
      this.activity.startActivity(paramIntent);
      return;
    }
    catch (ActivityNotFoundException paramIntent)
    {
      paramIntent = new AlertDialog.Builder(this.activity);
      paramIntent.setTitle(2131361834);
      paramIntent.setMessage(2131361864);
      paramIntent.setPositiveButton(2131361846, null);
      paramIntent.show();
    }
  }
  
  final void openMap(String paramString)
  {
    launchIntent(new Intent("android.intent.action.VIEW", Uri.parse(paramString)));
  }
  
  final void openURL(String paramString)
  {
    launchIntent(new Intent("android.intent.action.VIEW", Uri.parse(paramString)));
  }
  
  final void searchMap(String paramString, CharSequence paramCharSequence)
  {
    String str = paramString;
    if (paramCharSequence != null)
    {
      str = paramString;
      if (paramCharSequence.length() > 0) {
        str = paramString + " (" + paramCharSequence + ')';
      }
    }
    launchIntent(new Intent("android.intent.action.VIEW", Uri.parse("geo:0,0?q=" + Uri.encode(str))));
  }
  
  final void sendEmail(String paramString1, String paramString2, String paramString3)
  {
    sendEmailFromUri("mailto:" + paramString1, paramString1, paramString2, paramString3);
  }
  
  final void sendEmailFromUri(String paramString1, String paramString2, String paramString3, String paramString4)
  {
    paramString1 = new Intent("android.intent.action.SEND", Uri.parse(paramString1));
    if (paramString2 != null) {
      paramString1.putExtra("android.intent.extra.EMAIL", new String[] { paramString2 });
    }
    putExtra(paramString1, "android.intent.extra.SUBJECT", paramString3);
    putExtra(paramString1, "android.intent.extra.TEXT", paramString4);
    paramString1.setType("text/plain");
    launchIntent(paramString1);
  }
  
  final void sendMMS(String paramString1, String paramString2, String paramString3)
  {
    sendMMSFromUri("mmsto:" + paramString1, paramString2, paramString3);
  }
  
  final void sendMMSFromUri(String paramString1, String paramString2, String paramString3)
  {
    paramString1 = new Intent("android.intent.action.SENDTO", Uri.parse(paramString1));
    if ((paramString2 == null) || (paramString2.length() == 0)) {
      putExtra(paramString1, "subject", this.activity.getString(2131361863));
    }
    for (;;)
    {
      putExtra(paramString1, "sms_body", paramString3);
      paramString1.putExtra("compose_mode", true);
      launchIntent(paramString1);
      return;
      putExtra(paramString1, "subject", paramString2);
    }
  }
  
  final void sendSMS(String paramString1, String paramString2)
  {
    sendSMSFromUri("smsto:" + paramString1, paramString2);
  }
  
  final void sendSMSFromUri(String paramString1, String paramString2)
  {
    paramString1 = new Intent("android.intent.action.SENDTO", Uri.parse(paramString1));
    putExtra(paramString1, "sms_body", paramString2);
    paramString1.putExtra("compose_mode", true);
    launchIntent(paramString1);
  }
  
  final void shareByEmail(String paramString)
  {
    sendEmailFromUri("mailto:", null, this.activity.getString(2131361862), paramString);
  }
  
  final void shareBySMS(String paramString)
  {
    sendSMSFromUri("smsto:", this.activity.getString(2131361862) + ":\n" + paramString);
  }
  
  final void webSearch(String paramString)
  {
    Intent localIntent = new Intent("android.intent.action.WEB_SEARCH");
    localIntent.putExtra("query", paramString);
    launchIntent(localIntent);
  }
}
