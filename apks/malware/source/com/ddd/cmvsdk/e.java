package com.ddd.cmvsdk;

import android.util.Base64;
import com.loopj.android.http.AsyncHttpResponseHandler;
import com.qdzg.yqwzo.manager.SecurityManager;
import java.io.ByteArrayInputStream;
import org.apache.http.Header;

final class e
  extends AsyncHttpResponseHandler
{
  e(CMVSDK paramCMVSDK) {}
  
  public final void onFailure(Throwable paramThrowable) {}
  
  public final void onSuccess(int paramInt, Header[] paramArrayOfHeader, String paramString)
  {
    paramArrayOfHeader = null;
    String str2;
    String str1;
    try
    {
      CMVSDK.b(this.a);
      if ((paramString != null) && (paramString.contains("\"code\"")))
      {
        if (CMVSDK.o()) {
          return;
        }
        CMVSDK.a(null, null, null);
        return;
      }
      str2 = new String(SecurityManager.deEncryptBytes(Base64.decode(paramString, 0)), "utf-8");
      if (!str2.contains("</root>")) {
        break label178;
      }
      paramInt = str2.indexOf("</root>");
      if (paramInt > 0)
      {
        str1 = str2.substring(0, paramInt + 7);
        paramString = this.a;
        if (str1 != null) {
          paramArrayOfHeader = l.a(new ByteArrayInputStream(str1.getBytes()));
        }
        CMVSDK.a(paramString, paramArrayOfHeader);
      }
      CMVSDK.a(this.a, CMVSDK.b(str2));
      this.a.a("doauth");
      if (CMVSDK.c(this.a) != null)
      {
        this.a.a(13);
        CMVSDK.a(5, null);
        return;
      }
    }
    catch (Exception paramArrayOfHeader)
    {
      paramArrayOfHeader.printStackTrace();
      return;
    }
    CMVSDK.a(6, null);
    return;
    label178:
    if (str2.contains("\"playUrl\""))
    {
      if ((str2 != null) && ("msisdn=" != null))
      {
        paramArrayOfHeader = str2.replace("'", "\"");
        paramInt = paramArrayOfHeader.indexOf("msisdn=");
        if ((paramInt <= 0) || (paramArrayOfHeader.length() <= "msisdn=".length() + paramInt + 11)) {}
      }
      for (paramArrayOfHeader = paramArrayOfHeader.substring("msisdn=".length() + paramInt, "msisdn=".length() + paramInt + 11);; paramArrayOfHeader = null)
      {
        str1 = l.a(str2, "http://");
        paramString = str1;
        if (str1 == null) {
          paramString = l.a(str2, "rtsp://");
        }
        if (paramString != null) {
          CMVSDK.e(paramString);
        }
        if (paramArrayOfHeader != null)
        {
          CMVSDK.f(paramArrayOfHeader);
          paramArrayOfHeader = this.a;
          CMVSDK.b("mobile", CMVSDK.p());
        }
        if (CMVSDK.q())
        {
          CMVSDK.b(false);
          this.a.a("doorder");
        }
        CMVSDK.a(7, "orderok2");
        return;
      }
    }
  }
}
