package com.qbiki.seattleclouds;

import android.content.Intent;
import android.content.res.Configuration;
import android.content.res.Resources;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import com.actionbarsherlock.app.ActionBar;
import com.actionbarsherlock.app.SherlockFragmentActivity;
import com.actionbarsherlock.view.Menu;
import com.actionbarsherlock.view.MenuInflater;
import com.actionbarsherlock.view.MenuItem;
import com.qbiki.ads.AdManager;
import java.util.List;
import java.util.Map;

public class SCFragmentHelper
{
  public static final String ARG_IS_ROOT_FRAGMENT = "ARG_IS_ROOT_FRAGMENT";
  private static final boolean DEBUG = false;
  public static final String TAG = "SCFragmentHelper";
  private static SCFragmentHelper mInstance;
  
  public SCFragmentHelper() {}
  
  private void fireActiveChangedIfNotHidden(Fragment paramFragment, boolean paramBoolean)
  {
    if ((paramFragment instanceof SCFragmentInterface))
    {
      SCFragmentInterface localSCFragmentInterface = (SCFragmentInterface)paramFragment;
      if (!isFragmentHidden(paramFragment)) {
        localSCFragmentInterface.onActiveChanged(paramBoolean);
      }
    }
  }
  
  public static SCFragmentHelper getInstance()
  {
    if (mInstance == null) {
      mInstance = new SCFragmentHelper();
    }
    return mInstance;
  }
  
  public static NavigationFragment getNavigationFragment(Fragment paramFragment)
  {
    if (paramFragment == null) {
      return null;
    }
    paramFragment = paramFragment.getParentFragment();
    if (paramFragment == null) {
      return null;
    }
    if ((paramFragment instanceof NavigationFragment)) {
      return (NavigationFragment)paramFragment;
    }
    return getNavigationFragment(paramFragment);
  }
  
  public static Page getPageForFragment(Fragment paramFragment)
  {
    paramFragment = paramFragment.getArguments();
    if (paramFragment == null) {}
    do
    {
      return null;
      paramFragment = paramFragment.getString("PAGE_ID");
    } while (paramFragment == null);
    return (Page)App.appConfig.getPages().get(paramFragment);
  }
  
  public static Fragment getRootFragment(Fragment paramFragment)
  {
    if (paramFragment == null) {}
    do
    {
      return null;
      paramFragment = paramFragment.getParentFragment();
    } while (paramFragment == null);
    return getRootFragmentRecurs(paramFragment);
  }
  
  private static Fragment getRootFragmentRecurs(Fragment paramFragment)
  {
    if (paramFragment == null) {
      paramFragment = null;
    }
    Fragment localFragment;
    do
    {
      return paramFragment;
      localFragment = paramFragment.getParentFragment();
    } while (localFragment == null);
    return getRootFragmentRecurs(localFragment);
  }
  
  public static SherlockFragmentActivity getSherlockActivity(Fragment paramFragment)
  {
    paramFragment = paramFragment.getActivity();
    if ((paramFragment instanceof SherlockFragmentActivity)) {
      return (SherlockFragmentActivity)paramFragment;
    }
    return null;
  }
  
  public static boolean isFragmentHidden(Fragment paramFragment)
  {
    if (paramFragment == null) {}
    Fragment localFragment;
    do
    {
      return true;
      localFragment = getRootFragment(paramFragment);
    } while ((paramFragment.isHidden()) || ((localFragment != null) && (localFragment.isHidden())));
    return false;
  }
  
  private void refreshPollfishIfNeeded(Fragment paramFragment)
  {
    if ((paramFragment instanceof NavigationFragment)) {}
    while (isFragmentHidden(paramFragment)) {
      return;
    }
    int i = 0;
    if (getNavigationFragment(paramFragment) != null) {
      i = paramFragment.getResources().getInteger(2131296265) + 10;
    }
    AdManager.refreshPollfish(paramFragment, getPageForFragment(paramFragment), i);
  }
  
  public static void setActionBarTitle(Fragment paramFragment, String paramString)
  {
    paramFragment = getSherlockActivity(paramFragment);
    if (paramFragment != null) {
      paramFragment.getSupportActionBar().setTitle(paramString);
    }
  }
  
  public static void setActionBarVisible(Fragment paramFragment, boolean paramBoolean)
  {
    paramFragment = getSherlockActivity(paramFragment);
    if (paramFragment != null)
    {
      if (paramBoolean) {
        paramFragment.getSupportActionBar().show();
      }
    }
    else {
      return;
    }
    paramFragment.getSupportActionBar().hide();
  }
  
  public void onCreateOptionsMenu(Fragment paramFragment, Menu paramMenu, MenuInflater paramMenuInflater)
  {
    paramMenu = paramMenu.findItem(2131100328);
    if (paramMenu == null) {
      return;
    }
    boolean bool2 = true;
    paramFragment = getNavigationFragment(paramFragment);
    boolean bool1 = bool2;
    if (paramFragment != null)
    {
      bool1 = bool2;
      if (paramFragment.getFragments().size() != 1) {
        bool1 = false;
      }
    }
    paramMenu.setVisible(bool1);
    paramMenu.setEnabled(bool1);
  }
  
  public void onFragmentActiveChanged(Fragment paramFragment, boolean paramBoolean)
  {
    if (paramBoolean)
    {
      Page localPage = getPageForFragment(paramFragment);
      if (localPage != null)
      {
        String str2 = localPage.getTitle();
        String str1;
        if (str2 != null)
        {
          str1 = str2;
          if (str2.length() != 0) {}
        }
        else
        {
          str1 = paramFragment.getString(2131361834);
        }
        setActionBarTitle(paramFragment, str1);
        setActionBarVisible(paramFragment, localPage.isActionBarVisible());
      }
    }
    else
    {
      return;
    }
    setActionBarTitle(paramFragment, paramFragment.getString(2131361834));
    setActionBarVisible(paramFragment, true);
  }
  
  public void onFragmentConfigurationChanged(Fragment paramFragment, Configuration paramConfiguration) {}
  
  public void onFragmentPaused(Fragment paramFragment)
  {
    fireActiveChangedIfNotHidden(paramFragment, false);
  }
  
  public void onFragmentResumed(Fragment paramFragment)
  {
    fireActiveChangedIfNotHidden(paramFragment, true);
  }
  
  public boolean startActivityForResult(Fragment paramFragment, Intent paramIntent, int paramInt)
  {
    paramFragment = getRootFragment(paramFragment);
    if (paramFragment != null)
    {
      paramFragment.startActivityForResult(paramIntent, paramInt);
      return true;
    }
    return false;
  }
}
