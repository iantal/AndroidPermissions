package com.qbiki.location;

import android.content.Intent;
import android.os.Bundle;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentTransaction;
import android.util.Log;
import com.qbiki.seattleclouds.SCFragmentActivity;

public class LocationDetectorActivity
  extends SCFragmentActivity
{
  public static final String ACTION_PICK_LOCATION = "com.qbiki.modules.ACTION_PICK_LOCATION";
  private static final String TAG = "LocationDetectorActivity";
  private boolean LOGV = false;
  private boolean mHandledFirstIntent = false;
  private LocationDetectorFragment mLocationDetectorFragment;
  
  public LocationDetectorActivity() {}
  
  private void handleIntent(Intent paramIntent)
  {
    if (this.LOGV) {
      Log.v("LocationDetectorActivity", "handleIntent");
    }
    if ("android.intent.action.SEARCH".equals(paramIntent.getAction()))
    {
      paramIntent = paramIntent.getStringExtra("query");
      this.mLocationDetectorFragment.handleSearchAction(paramIntent);
    }
  }
  
  protected void onCreate(Bundle paramBundle)
  {
    if (this.LOGV) {
      Log.v("LocationDetectorActivity", "onCreate");
    }
    super.onCreate(paramBundle);
    setContentView(2130903062);
    if (getSupportFragmentManager().findFragmentById(2131099720) != null)
    {
      if (this.LOGV) {
        Log.v("LocationDetectorActivity", "Fragment already added...");
      }
      return;
    }
    Bundle localBundle = getIntent().getExtras();
    paramBundle = localBundle;
    if (localBundle == null) {
      paramBundle = new Bundle();
    }
    paramBundle.putBoolean("ARG_USE_ACTIVITY_SEARCH", true);
    if ("com.qbiki.modules.ACTION_PICK_LOCATION".equals(getIntent().getAction())) {
      paramBundle.putBoolean("ARG_PICKER_MODE_ENABLED", true);
    }
    this.mLocationDetectorFragment = new LocationDetectorFragment();
    this.mLocationDetectorFragment.setArguments(paramBundle);
    getSupportFragmentManager().beginTransaction().add(2131099720, this.mLocationDetectorFragment).commit();
  }
  
  protected void onNewIntent(Intent paramIntent)
  {
    if (this.LOGV) {
      Log.v("LocationDetectorActivity", "onNewIntent");
    }
    setIntent(paramIntent);
    handleIntent(paramIntent);
  }
  
  protected void onResume()
  {
    if (this.LOGV) {
      Log.v("LocationDetectorActivity", "onResume");
    }
    if (!this.mHandledFirstIntent)
    {
      this.mHandledFirstIntent = true;
      handleIntent(getIntent());
    }
    super.onResume();
  }
}
