package com.qbiki.modules.starbucks;

import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ListAdapter;
import android.widget.ListView;
import com.qbiki.seattleclouds.SCListActivity;
import java.util.ArrayList;
import java.util.HashMap;

public class CardsListActivity
  extends SCListActivity
{
  private ListView mCardsList;
  private CardStorageManager mCardsManager;
  private HashMap<String, ArrayList<String>> mStarbucksCards;
  private String mStorePath;
  
  public CardsListActivity() {}
  
  protected void initParams()
  {
    Bundle localBundle = getIntent().getExtras();
    if (localBundle != null) {
      this.mStorePath = localBundle.getString("storePath");
    }
  }
  
  protected void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    initParams();
    setContentView(2130903225);
    this.mCardsManager = new CardStorageManager(this.mStorePath);
    this.mStarbucksCards = this.mCardsManager.getCards();
    this.mCardsList = ((ListView)findViewById(16908298));
    ((Button)findViewById(2131100234)).setOnClickListener(new View.OnClickListener()
    {
      public void onClick(View paramAnonymousView)
      {
        paramAnonymousView = new Intent(CardsListActivity.this, AddCardActivity.class);
        paramAnonymousView.putExtra("storePath", CardsListActivity.this.mStorePath);
        CardsListActivity.this.startActivity(paramAnonymousView);
      }
    });
  }
  
  protected void onListItemClick(ListView paramListView, View paramView, int paramInt, long paramLong)
  {
    paramListView = new Intent(this, ViewCardActivity.class);
    paramView = this.mCardsList.getAdapter().getItem(paramInt).toString();
    Object localObject = (ArrayList)this.mStarbucksCards.get(paramView);
    String str = (String)((ArrayList)localObject).get(0);
    localObject = (String)((ArrayList)localObject).get(1);
    paramListView.putExtra("card_number", paramView);
    paramListView.putExtra("card_secure_code", str);
    paramListView.putExtra("card_balance", (String)localObject);
    paramListView.putExtra("storePath", this.mStorePath);
    startActivity(paramListView);
  }
  
  protected void onResume()
  {
    super.onResume();
    this.mStarbucksCards = this.mCardsManager.readStoreConfig();
    this.mCardsList.setAdapter(new CardsListAdapter(this, this.mStarbucksCards));
  }
}
