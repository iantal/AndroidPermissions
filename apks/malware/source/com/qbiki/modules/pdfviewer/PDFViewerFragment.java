package com.qbiki.modules.pdfviewer;

import android.annotation.SuppressLint;
import android.app.ProgressDialog;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Rect;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.SystemClock;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.View.OnTouchListener;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.AdapterView.OnItemLongClickListener;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.BaseAdapter;
import android.widget.Gallery;
import android.widget.Gallery.LayoutParams;
import android.widget.ImageView;
import android.widget.ProgressBar;
import com.actionbarsherlock.view.Menu;
import com.actionbarsherlock.view.MenuInflater;
import com.actionbarsherlock.view.MenuItem;
import com.qbiki.seattleclouds.App;
import com.qbiki.seattleclouds.SCFragment;
import com.qbiki.util.ImageCache;
import java.io.File;
import java.lang.ref.WeakReference;
import java.util.HashMap;
import pdftron.Common.PDFNetException;
import pdftron.PDF.PDFDoc;
import pdftron.PDF.PDFDraw;
import pdftron.PDF.PDFViewCtrl;
import pdftron.PDF.Page;

@SuppressLint({"UseSparseArrays"})
public class PDFViewerFragment
  extends SCFragment
{
  public static final String NEXT_PAGE_IDENTIFIER = "nextpage";
  public static final String PDFTRON_LICENSE_KEY_IDENTIFIER = "pdftronLicenseKey";
  public static final String PDF_FILE_IDENTIFIER = "pdffile";
  public static final String TAG = "PDFViewer";
  private static boolean nativeLibsLoaded = true;
  private ImageView bigThumbnailImageView = null;
  private ProgressBar bigThumbnailProgress = null;
  private BigThumbnailTask bigThumbnailTask = null;
  private String cachePath = "";
  private boolean canShowBigThumbnail = false;
  private int currentBigThumbnailIndex = -1;
  private View fview = null;
  private ImageCache imageCache = new ImageCache();
  private String nextPage = null;
  private PDFDoc pdfDoc = null;
  private String pdfFile = "";
  private PDFViewCtrl pdfView = null;
  private ThumbnailsPrecacheTask preTask = null;
  private ThumbnailsAdapter thumbnailAdapter = null;
  private Gallery thumbnailGallery = null;
  private int thumbnailHeight = 90;
  private int thumbnailWidth = 70;
  private HashMap<Integer, ImageView> thumbnailsArray = new HashMap();
  
  static
  {
    try
    {
      System.loadLibrary("PDFNetC");
      return;
    }
    catch (UnsatisfiedLinkError localUnsatisfiedLinkError)
    {
      Log.w("PDFViewer", "Could not load native library: lib");
      nativeLibsLoaded = false;
    }
  }
  
  public PDFViewerFragment() {}
  
  private Bitmap getThumbnailForIndex(Integer paramInteger)
  {
    return getThumbnailForIndex(paramInteger, this.thumbnailWidth, this.thumbnailHeight);
  }
  
  private Bitmap getThumbnailForIndex(Integer paramInteger, int paramInt1, int paramInt2)
  {
    localObject1 = "" + paramInteger + "_" + paramInt1 + "_" + paramInt2 + ".png";
    localObject1 = this.cachePath + (String)localObject1;
    if (new File((String)localObject1).exists()) {
      return BitmapFactory.decodeFile((String)localObject1);
    }
    Object localObject3 = null;
    Object localObject2 = null;
    localObject1 = localObject3;
    for (;;)
    {
      try
      {
        localPDFDoc = this.pdfDoc;
        localObject1 = localObject3;
        localObject1 = localObject2;
      }
      catch (PDFNetException paramInteger)
      {
        PDFDoc localPDFDoc;
        Log.d("PDFViewer", "Exception:", paramInteger);
        paramInteger = (Integer)localObject1;
        continue;
      }
      try
      {
        paramInteger = this.pdfDoc.getPage(paramInteger.intValue() + 1);
        localObject1 = paramInteger;
        return getThumbnailForPage(paramInteger, paramInt1, paramInt2);
      }
      finally {}
    }
  }
  
  /* Error */
  private Bitmap getThumbnailForPage(Page paramPage, int paramInt1, int paramInt2)
  {
    // Byte code:
    //   0: aconst_null
    //   1: astore 4
    //   3: aload_1
    //   4: ifnull +27 -> 31
    //   7: new 266	pdftron/PDF/PDFDraw
    //   10: dup
    //   11: invokespecial 267	pdftron/PDF/PDFDraw:<init>	()V
    //   14: astore 4
    //   16: aload 4
    //   18: iload_2
    //   19: iload_3
    //   20: invokevirtual 271	pdftron/PDF/PDFDraw:setImageSize	(II)V
    //   23: aload 4
    //   25: aload_1
    //   26: invokevirtual 275	pdftron/PDF/PDFDraw:getBitmap	(Lpdftron/PDF/Page;)Landroid/graphics/Bitmap;
    //   29: astore 4
    //   31: aload 4
    //   33: areturn
    //   34: astore_1
    //   35: ldc 43
    //   37: ldc_w 258
    //   40: aload_1
    //   41: invokestatic 262	android/util/Log:d	(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    //   44: pop
    //   45: aconst_null
    //   46: areturn
    //   47: astore_1
    //   48: goto -13 -> 35
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	51	0	this	PDFViewerFragment
    //   0	51	1	paramPage	Page
    //   0	51	2	paramInt1	int
    //   0	51	3	paramInt2	int
    //   1	31	4	localObject	Object
    // Exception table:
    //   from	to	target	type
    //   7	16	34	java/lang/Exception
    //   16	31	47	java/lang/Exception
  }
  
  private void hideBigThumbnail()
  {
    if (this.bigThumbnailTask != null)
    {
      this.bigThumbnailTask.cancel(true);
      this.bigThumbnailTask = null;
    }
    this.currentBigThumbnailIndex = -1;
    this.bigThumbnailProgress.setVisibility(8);
    this.bigThumbnailImageView.setVisibility(8);
  }
  
  private void setThumbnailAdapter()
  {
    this.thumbnailGallery.setAdapter(this.thumbnailAdapter);
    this.thumbnailGallery.setOnItemClickListener(new AdapterView.OnItemClickListener()
    {
      public void onItemClick(AdapterView<?> paramAnonymousAdapterView, View paramAnonymousView, int paramAnonymousInt, long paramAnonymousLong)
      {
        PDFViewerFragment.this.pdfView.setCurrentPage(paramAnonymousInt + 1);
      }
    });
    this.thumbnailGallery.setOnItemLongClickListener(new AdapterView.OnItemLongClickListener()
    {
      public boolean onItemLongClick(AdapterView<?> paramAnonymousAdapterView, View paramAnonymousView, int paramAnonymousInt, long paramAnonymousLong)
      {
        PDFViewerFragment.access$502(PDFViewerFragment.this, true);
        return false;
      }
    });
    this.thumbnailGallery.setOnTouchListener(new View.OnTouchListener()
    {
      public boolean onTouch(View paramAnonymousView, MotionEvent paramAnonymousMotionEvent)
      {
        if (paramAnonymousMotionEvent.getAction() == 1)
        {
          PDFViewerFragment.access$502(PDFViewerFragment.this, false);
          PDFViewerFragment.this.hideBigThumbnail();
        }
        if (PDFViewerFragment.this.canShowBigThumbnail)
        {
          int i = PDFViewerFragment.this.thumbnailGallery.pointToPosition((int)paramAnonymousMotionEvent.getX(), (int)paramAnonymousMotionEvent.getY());
          if (i != -1)
          {
            int j = PDFViewerFragment.this.thumbnailGallery.getFirstVisiblePosition();
            paramAnonymousView = (ImageView)PDFViewerFragment.this.thumbnailGallery.getChildAt(i - j);
            if (paramAnonymousView != null) {
              PDFViewerFragment.this.showBigThumbnail(((Integer)paramAnonymousView.getTag()).intValue());
            }
          }
        }
        return false;
      }
    });
    this.thumbnailGallery.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener()
    {
      public void onItemSelected(AdapterView<?> paramAnonymousAdapterView, View paramAnonymousView, int paramAnonymousInt, long paramAnonymousLong)
      {
        int i;
        if (paramAnonymousInt - 10 >= 0)
        {
          i = paramAnonymousInt - 10;
          if (PDFViewerFragment.this.thumbnailsArray.size() - 1 <= paramAnonymousInt + 10) {
            break label81;
          }
          paramAnonymousInt += 10;
          label37:
          if (i >= paramAnonymousInt) {
            return;
          }
          paramAnonymousAdapterView = (ImageView)PDFViewerFragment.this.thumbnailsArray.get(Integer.valueOf(i));
          if (paramAnonymousAdapterView != null) {
            break label95;
          }
        }
        for (;;)
        {
          i += 1;
          break label37;
          i = 0;
          break;
          label81:
          paramAnonymousInt = PDFViewerFragment.this.thumbnailsArray.size();
          break label37;
          label95:
          paramAnonymousView = new Rect();
          PDFViewerFragment.this.thumbnailGallery.getHitRect(paramAnonymousView);
          if (!paramAnonymousAdapterView.getLocalVisibleRect(paramAnonymousView)) {
            paramAnonymousAdapterView.setImageBitmap(null);
          }
        }
      }
      
      public void onNothingSelected(AdapterView<?> paramAnonymousAdapterView) {}
    });
  }
  
  private void showBigThumbnail(int paramInt)
  {
    if (this.currentBigThumbnailIndex == paramInt) {
      return;
    }
    if (this.bigThumbnailTask != null)
    {
      this.bigThumbnailTask.cancel(true);
      this.bigThumbnailTask = null;
    }
    this.bigThumbnailTask = new BigThumbnailTask(null);
    this.bigThumbnailTask.setImageView(this.bigThumbnailImageView);
    this.bigThumbnailTask.execute(new Integer[] { Integer.valueOf(paramInt) });
    this.currentBigThumbnailIndex = paramInt;
    this.bigThumbnailProgress.setVisibility(0);
    this.bigThumbnailImageView.setVisibility(0);
    this.bigThumbnailImageView.setImageBitmap(getThumbnailForIndex(Integer.valueOf(paramInt)));
  }
  
  private void showHideSearchBar()
  {
    simulateTocuh(this.pdfView, 10.0F, 10.0F, 0);
    simulateTocuh(this.pdfView, 10.0F, 10.0F, 1);
  }
  
  private void showHideThumbnailPreview()
  {
    if (this.thumbnailGallery.getVisibility() == 8)
    {
      this.thumbnailGallery.setVisibility(0);
      return;
    }
    this.thumbnailGallery.setVisibility(8);
  }
  
  private void simulateTocuh(View paramView, float paramFloat1, float paramFloat2, int paramInt)
  {
    MotionEvent localMotionEvent = MotionEvent.obtain(SystemClock.uptimeMillis(), SystemClock.uptimeMillis() + 100L, paramInt, paramFloat1, paramFloat2, 0);
    paramView.dispatchTouchEvent(localMotionEvent);
    localMotionEvent.recycle();
  }
  
  private void writeThumbnailBitmapToFile(Page paramPage, int paramInt)
  {
    String str = "" + paramInt + "_" + this.thumbnailWidth + "_" + this.thumbnailHeight + ".png";
    str = this.cachePath + str;
    if (new File(str).exists()) {}
    while (paramPage == null) {
      return;
    }
    try
    {
      PDFDraw localPDFDraw = new PDFDraw();
      Log.d("PDFViewer", "Exception:", paramPage);
    }
    catch (PDFNetException paramPage)
    {
      try
      {
        localPDFDraw.setImageSize(this.thumbnailWidth, this.thumbnailHeight);
        localPDFDraw.export(paramPage, str);
        return;
      }
      catch (PDFNetException paramPage)
      {
        for (;;) {}
      }
      paramPage = paramPage;
    }
  }
  
  /* Error */
  protected void init()
  {
    // Byte code:
    //   0: getstatic 82	com/qbiki/modules/pdfviewer/PDFViewerFragment:nativeLibsLoaded	Z
    //   3: ifne +25 -> 28
    //   6: aload_0
    //   7: invokevirtual 375	com/qbiki/modules/pdfviewer/PDFViewerFragment:getActivity	()Landroid/support/v4/app/FragmentActivity;
    //   10: ldc_w 376
    //   13: ldc_w 377
    //   16: new 6	com/qbiki/modules/pdfviewer/PDFViewerFragment$1
    //   19: dup
    //   20: aload_0
    //   21: invokespecial 378	com/qbiki/modules/pdfviewer/PDFViewerFragment$1:<init>	(Lcom/qbiki/modules/pdfviewer/PDFViewerFragment;)V
    //   24: invokestatic 384	com/qbiki/util/DialogUtil:showAlert	(Landroid/content/Context;IILandroid/content/DialogInterface$OnClickListener;)V
    //   27: return
    //   28: aload_0
    //   29: invokevirtual 388	com/qbiki/modules/pdfviewer/PDFViewerFragment:getArguments	()Landroid/os/Bundle;
    //   32: astore_3
    //   33: ldc -123
    //   35: astore_1
    //   36: aload_3
    //   37: ifnull +52 -> 89
    //   40: aload_0
    //   41: aload_3
    //   42: ldc 40
    //   44: invokevirtual 394	android/os/Bundle:getString	(Ljava/lang/String;)Ljava/lang/String;
    //   47: putfield 137	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfFile	Ljava/lang/String;
    //   50: aload_0
    //   51: getfield 137	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfFile	Ljava/lang/String;
    //   54: ifnonnull +9 -> 63
    //   57: aload_0
    //   58: ldc -123
    //   60: putfield 137	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfFile	Ljava/lang/String;
    //   63: aload_3
    //   64: ldc 37
    //   66: invokevirtual 394	android/os/Bundle:getString	(Ljava/lang/String;)Ljava/lang/String;
    //   69: astore_2
    //   70: aload_2
    //   71: astore_1
    //   72: aload_2
    //   73: ifnonnull +6 -> 79
    //   76: ldc -123
    //   78: astore_1
    //   79: aload_0
    //   80: aload_3
    //   81: ldc 34
    //   83: invokevirtual 394	android/os/Bundle:getString	(Ljava/lang/String;)Ljava/lang/String;
    //   86: putfield 139	com/qbiki/modules/pdfviewer/PDFViewerFragment:nextPage	Ljava/lang/String;
    //   89: aload_0
    //   90: getfield 137	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfFile	Ljava/lang/String;
    //   93: invokestatic 400	com/qbiki/seattleclouds/App:getResourceStream	(Ljava/lang/String;)Ljava/io/InputStream;
    //   96: astore 5
    //   98: aload 5
    //   100: ifnonnull +25 -> 125
    //   103: aload_0
    //   104: invokevirtual 375	com/qbiki/modules/pdfviewer/PDFViewerFragment:getActivity	()Landroid/support/v4/app/FragmentActivity;
    //   107: ldc_w 376
    //   110: ldc_w 401
    //   113: new 8	com/qbiki/modules/pdfviewer/PDFViewerFragment$2
    //   116: dup
    //   117: aload_0
    //   118: invokespecial 402	com/qbiki/modules/pdfviewer/PDFViewerFragment$2:<init>	(Lcom/qbiki/modules/pdfviewer/PDFViewerFragment;)V
    //   121: invokestatic 384	com/qbiki/util/DialogUtil:showAlert	(Landroid/content/Context;IILandroid/content/DialogInterface$OnClickListener;)V
    //   124: return
    //   125: aload_0
    //   126: invokevirtual 375	com/qbiki/modules/pdfviewer/PDFViewerFragment:getActivity	()Landroid/support/v4/app/FragmentActivity;
    //   129: aload_1
    //   130: invokestatic 408	pdftron/PDF/PDFNet:initialize	(Landroid/content/Context;Ljava/lang/String;)V
    //   133: aconst_null
    //   134: astore_3
    //   135: aload_0
    //   136: invokevirtual 375	com/qbiki/modules/pdfviewer/PDFViewerFragment:getActivity	()Landroid/support/v4/app/FragmentActivity;
    //   139: aload_0
    //   140: getfield 137	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfFile	Ljava/lang/String;
    //   143: iconst_0
    //   144: invokevirtual 414	android/support/v4/app/FragmentActivity:getSharedPreferences	(Ljava/lang/String;I)Landroid/content/SharedPreferences;
    //   147: ldc_w 416
    //   150: aconst_null
    //   151: invokeinterface 421 3 0
    //   156: astore 6
    //   158: aload_3
    //   159: astore_2
    //   160: getstatic 426	com/qbiki/seattleclouds/asynctasks/SyncResourcesAsyncTask:fileListFilePath	Ljava/lang/String;
    //   163: ifnull +67 -> 230
    //   166: aload_3
    //   167: astore_2
    //   168: new 228	java/io/File
    //   171: dup
    //   172: getstatic 426	com/qbiki/seattleclouds/asynctasks/SyncResourcesAsyncTask:fileListFilePath	Ljava/lang/String;
    //   175: invokespecial 230	java/io/File:<init>	(Ljava/lang/String;)V
    //   178: invokevirtual 234	java/io/File:exists	()Z
    //   181: ifeq +49 -> 230
    //   184: aconst_null
    //   185: astore 4
    //   187: aconst_null
    //   188: astore_2
    //   189: new 428	java/io/ObjectInputStream
    //   192: dup
    //   193: new 430	java/io/FileInputStream
    //   196: dup
    //   197: getstatic 426	com/qbiki/seattleclouds/asynctasks/SyncResourcesAsyncTask:fileListFilePath	Ljava/lang/String;
    //   200: invokespecial 431	java/io/FileInputStream:<init>	(Ljava/lang/String;)V
    //   203: invokespecial 434	java/io/ObjectInputStream:<init>	(Ljava/io/InputStream;)V
    //   206: astore_1
    //   207: aload_1
    //   208: invokevirtual 438	java/io/ObjectInputStream:readObject	()Ljava/lang/Object;
    //   211: checkcast 122	java/util/HashMap
    //   214: astore 4
    //   216: aload 4
    //   218: astore_2
    //   219: aload_1
    //   220: ifnull +10 -> 230
    //   223: aload_1
    //   224: invokevirtual 441	java/io/ObjectInputStream:close	()V
    //   227: aload 4
    //   229: astore_2
    //   230: aload_0
    //   231: new 207	java/lang/StringBuilder
    //   234: dup
    //   235: invokespecial 208	java/lang/StringBuilder:<init>	()V
    //   238: invokestatic 444	com/qbiki/seattleclouds/App:getAppProtectedStoragePath	()Ljava/lang/String;
    //   241: invokevirtual 212	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   244: ldc_w 446
    //   247: invokevirtual 212	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   250: aload_0
    //   251: getfield 137	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfFile	Ljava/lang/String;
    //   254: invokevirtual 212	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   257: ldc_w 448
    //   260: invokevirtual 212	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   263: invokevirtual 226	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   266: putfield 135	com/qbiki/modules/pdfviewer/PDFViewerFragment:cachePath	Ljava/lang/String;
    //   269: new 228	java/io/File
    //   272: dup
    //   273: aload_0
    //   274: getfield 135	com/qbiki/modules/pdfviewer/PDFViewerFragment:cachePath	Ljava/lang/String;
    //   277: invokespecial 230	java/io/File:<init>	(Ljava/lang/String;)V
    //   280: astore_1
    //   281: aload_2
    //   282: ifnonnull +400 -> 682
    //   285: aload_1
    //   286: invokevirtual 234	java/io/File:exists	()Z
    //   289: ifeq +8 -> 297
    //   292: aload_1
    //   293: invokestatic 454	org/apache/commons/io/FileUtils:deleteQuietly	(Ljava/io/File;)Z
    //   296: pop
    //   297: aload_1
    //   298: invokevirtual 234	java/io/File:exists	()Z
    //   301: ifne +8 -> 309
    //   304: aload_1
    //   305: invokevirtual 457	java/io/File:mkdirs	()Z
    //   308: pop
    //   309: aload_0
    //   310: aload_0
    //   311: invokevirtual 375	com/qbiki/modules/pdfviewer/PDFViewerFragment:getActivity	()Landroid/support/v4/app/FragmentActivity;
    //   314: aload_0
    //   315: getfield 118	com/qbiki/modules/pdfviewer/PDFViewerFragment:thumbnailWidth	I
    //   318: i2f
    //   319: invokestatic 463	com/qbiki/util/DeviceUtil:dpToPx	(Landroid/content/Context;F)I
    //   322: putfield 118	com/qbiki/modules/pdfviewer/PDFViewerFragment:thumbnailWidth	I
    //   325: aload_0
    //   326: aload_0
    //   327: invokevirtual 375	com/qbiki/modules/pdfviewer/PDFViewerFragment:getActivity	()Landroid/support/v4/app/FragmentActivity;
    //   330: aload_0
    //   331: getfield 120	com/qbiki/modules/pdfviewer/PDFViewerFragment:thumbnailHeight	I
    //   334: i2f
    //   335: invokestatic 463	com/qbiki/util/DeviceUtil:dpToPx	(Landroid/content/Context;F)I
    //   338: putfield 120	com/qbiki/modules/pdfviewer/PDFViewerFragment:thumbnailHeight	I
    //   341: aload_0
    //   342: aload_0
    //   343: getfield 146	com/qbiki/modules/pdfviewer/PDFViewerFragment:fview	Landroid/view/View;
    //   346: ldc_w 464
    //   349: invokevirtual 468	android/view/View:findViewById	(I)Landroid/view/View;
    //   352: checkcast 289	android/widget/Gallery
    //   355: putfield 110	com/qbiki/modules/pdfviewer/PDFViewerFragment:thumbnailGallery	Landroid/widget/Gallery;
    //   358: aload_0
    //   359: aload_0
    //   360: getfield 146	com/qbiki/modules/pdfviewer/PDFViewerFragment:fview	Landroid/view/View;
    //   363: ldc_w 469
    //   366: invokevirtual 468	android/view/View:findViewById	(I)Landroid/view/View;
    //   369: checkcast 286	android/widget/ImageView
    //   372: putfield 112	com/qbiki/modules/pdfviewer/PDFViewerFragment:bigThumbnailImageView	Landroid/widget/ImageView;
    //   375: aload_0
    //   376: aload_0
    //   377: getfield 146	com/qbiki/modules/pdfviewer/PDFViewerFragment:fview	Landroid/view/View;
    //   380: ldc_w 470
    //   383: invokevirtual 468	android/view/View:findViewById	(I)Landroid/view/View;
    //   386: checkcast 281	android/widget/ProgressBar
    //   389: putfield 114	com/qbiki/modules/pdfviewer/PDFViewerFragment:bigThumbnailProgress	Landroid/widget/ProgressBar;
    //   392: aload_0
    //   393: getfield 146	com/qbiki/modules/pdfviewer/PDFViewerFragment:fview	Landroid/view/View;
    //   396: ldc_w 471
    //   399: invokevirtual 468	android/view/View:findViewById	(I)Landroid/view/View;
    //   402: checkcast 473	android/widget/FrameLayout
    //   405: astore_1
    //   406: aload_0
    //   407: new 475	pdftron/PDF/PDFViewCtrl
    //   410: dup
    //   411: aload_0
    //   412: invokevirtual 375	com/qbiki/modules/pdfviewer/PDFViewerFragment:getActivity	()Landroid/support/v4/app/FragmentActivity;
    //   415: aconst_null
    //   416: invokespecial 478	pdftron/PDF/PDFViewCtrl:<init>	(Landroid/content/Context;Landroid/util/AttributeSet;)V
    //   419: putfield 106	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfView	Lpdftron/PDF/PDFViewCtrl;
    //   422: aload_0
    //   423: invokevirtual 375	com/qbiki/modules/pdfviewer/PDFViewerFragment:getActivity	()Landroid/support/v4/app/FragmentActivity;
    //   426: getstatic 483	com/qbiki/seattleclouds/R$styleable:PDFViewer	[I
    //   429: invokevirtual 487	android/support/v4/app/FragmentActivity:obtainStyledAttributes	([I)Landroid/content/res/TypedArray;
    //   432: astore_2
    //   433: aload_0
    //   434: getfield 106	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfView	Lpdftron/PDF/PDFViewCtrl;
    //   437: aload_2
    //   438: invokevirtual 491	pdftron/PDF/PDFViewCtrl:initScrollbars	(Landroid/content/res/TypedArray;)V
    //   441: aload_1
    //   442: aload_0
    //   443: getfield 106	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfView	Lpdftron/PDF/PDFViewCtrl;
    //   446: iconst_0
    //   447: new 493	android/widget/FrameLayout$LayoutParams
    //   450: dup
    //   451: iconst_m1
    //   452: iconst_m1
    //   453: invokespecial 495	android/widget/FrameLayout$LayoutParams:<init>	(II)V
    //   456: invokevirtual 499	android/widget/FrameLayout:addView	(Landroid/view/View;ILandroid/view/ViewGroup$LayoutParams;)V
    //   459: new 501	pdftron/PDF/Tools/ToolManager
    //   462: dup
    //   463: invokespecial 502	pdftron/PDF/Tools/ToolManager:<init>	()V
    //   466: astore_1
    //   467: aload_0
    //   468: getfield 106	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfView	Lpdftron/PDF/PDFViewCtrl;
    //   471: aload_1
    //   472: invokevirtual 506	pdftron/PDF/PDFViewCtrl:setToolManager	(Lpdftron/PDF/PDFViewCtrl$ToolManager;)V
    //   475: aload_0
    //   476: getfield 106	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfView	Lpdftron/PDF/PDFViewCtrl;
    //   479: iconst_1
    //   480: invokevirtual 509	pdftron/PDF/PDFViewCtrl:setPagePresentationMode	(I)V
    //   483: aload_0
    //   484: getfield 106	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfView	Lpdftron/PDF/PDFViewCtrl;
    //   487: iconst_1
    //   488: iconst_0
    //   489: invokevirtual 513	pdftron/PDF/PDFViewCtrl:setUseThumbView	(ZZ)V
    //   492: aload_0
    //   493: getfield 106	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfView	Lpdftron/PDF/PDFViewCtrl;
    //   496: iconst_1
    //   497: invokevirtual 517	pdftron/PDF/PDFViewCtrl:setHighlightFields	(Z)V
    //   500: aload_0
    //   501: getfield 106	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfView	Lpdftron/PDF/PDFViewCtrl;
    //   504: iconst_2
    //   505: dconst_1
    //   506: ldc2_w 518
    //   509: invokevirtual 523	pdftron/PDF/PDFViewCtrl:setZoomLimits	(IDD)V
    //   512: aload_0
    //   513: getfield 106	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfView	Lpdftron/PDF/PDFViewCtrl;
    //   516: new 10	com/qbiki/modules/pdfviewer/PDFViewerFragment$3
    //   519: dup
    //   520: aload_0
    //   521: invokespecial 524	com/qbiki/modules/pdfviewer/PDFViewerFragment$3:<init>	(Lcom/qbiki/modules/pdfviewer/PDFViewerFragment;)V
    //   524: invokevirtual 528	pdftron/PDF/PDFViewCtrl:setOnClickListener	(Landroid/view/View$OnClickListener;)V
    //   527: aload_0
    //   528: aconst_null
    //   529: putfield 108	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfDoc	Lpdftron/PDF/PDFDoc;
    //   532: aload_0
    //   533: new 248	pdftron/PDF/PDFDoc
    //   536: dup
    //   537: aload 5
    //   539: invokespecial 529	pdftron/PDF/PDFDoc:<init>	(Ljava/io/InputStream;)V
    //   542: putfield 108	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfDoc	Lpdftron/PDF/PDFDoc;
    //   545: aload_0
    //   546: getfield 106	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfView	Lpdftron/PDF/PDFViewCtrl;
    //   549: aload_0
    //   550: getfield 108	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfDoc	Lpdftron/PDF/PDFDoc;
    //   553: invokevirtual 533	pdftron/PDF/PDFViewCtrl:setDoc	(Lpdftron/PDF/PDFDoc;)V
    //   556: aload_0
    //   557: getfield 108	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfDoc	Lpdftron/PDF/PDFDoc;
    //   560: ifnull -533 -> 27
    //   563: aload_0
    //   564: new 23	com/qbiki/modules/pdfviewer/PDFViewerFragment$ThumbnailsAdapter
    //   567: dup
    //   568: aload_0
    //   569: aconst_null
    //   570: invokespecial 534	com/qbiki/modules/pdfviewer/PDFViewerFragment$ThumbnailsAdapter:<init>	(Lcom/qbiki/modules/pdfviewer/PDFViewerFragment;Lcom/qbiki/modules/pdfviewer/PDFViewerFragment$1;)V
    //   573: putfield 116	com/qbiki/modules/pdfviewer/PDFViewerFragment:thumbnailAdapter	Lcom/qbiki/modules/pdfviewer/PDFViewerFragment$ThumbnailsAdapter;
    //   576: new 26	com/qbiki/modules/pdfviewer/PDFViewerFragment$ThumbnailsPrecacheTask
    //   579: dup
    //   580: aload_0
    //   581: aconst_null
    //   582: invokespecial 535	com/qbiki/modules/pdfviewer/PDFViewerFragment$ThumbnailsPrecacheTask:<init>	(Lcom/qbiki/modules/pdfviewer/PDFViewerFragment;Lcom/qbiki/modules/pdfviewer/PDFViewerFragment$1;)V
    //   585: astore_1
    //   586: aload_1
    //   587: iconst_1
    //   588: anewarray 242	java/lang/Integer
    //   591: dup
    //   592: iconst_0
    //   593: aload_0
    //   594: getfield 108	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfDoc	Lpdftron/PDF/PDFDoc;
    //   597: invokevirtual 538	pdftron/PDF/PDFDoc:getPageCount	()I
    //   600: invokestatic 325	java/lang/Integer:valueOf	(I)Ljava/lang/Integer;
    //   603: aastore
    //   604: invokevirtual 539	com/qbiki/modules/pdfviewer/PDFViewerFragment$ThumbnailsPrecacheTask:execute	([Ljava/lang/Object;)Landroid/os/AsyncTask;
    //   607: pop
    //   608: return
    //   609: astore_1
    //   610: ldc 43
    //   612: ldc_w 258
    //   615: aload_1
    //   616: invokestatic 262	android/util/Log:d	(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    //   619: pop
    //   620: return
    //   621: astore_1
    //   622: aload_0
    //   623: invokevirtual 375	com/qbiki/modules/pdfviewer/PDFViewerFragment:getActivity	()Landroid/support/v4/app/FragmentActivity;
    //   626: invokestatic 542	pdftron/PDF/PDFNet:initialize	(Landroid/content/Context;)V
    //   629: goto -496 -> 133
    //   632: astore_1
    //   633: ldc 43
    //   635: ldc_w 544
    //   638: aload_1
    //   639: invokestatic 262	android/util/Log:d	(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    //   642: pop
    //   643: return
    //   644: astore_1
    //   645: aload_2
    //   646: astore_1
    //   647: aload_3
    //   648: astore_2
    //   649: aload_1
    //   650: ifnull -420 -> 230
    //   653: aload_1
    //   654: invokevirtual 441	java/io/ObjectInputStream:close	()V
    //   657: aload_3
    //   658: astore_2
    //   659: goto -429 -> 230
    //   662: astore_1
    //   663: aload_3
    //   664: astore_2
    //   665: goto -435 -> 230
    //   668: astore_1
    //   669: aload 4
    //   671: astore_2
    //   672: aload_2
    //   673: ifnull +7 -> 680
    //   676: aload_2
    //   677: invokevirtual 441	java/io/ObjectInputStream:close	()V
    //   680: aload_1
    //   681: athrow
    //   682: aload_2
    //   683: aload_0
    //   684: getfield 137	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfFile	Ljava/lang/String;
    //   687: invokevirtual 548	java/util/HashMap:get	(Ljava/lang/Object;)Ljava/lang/Object;
    //   690: checkcast 550	java/lang/String
    //   693: astore_2
    //   694: aload_2
    //   695: ifnull -398 -> 297
    //   698: aload_0
    //   699: invokevirtual 375	com/qbiki/modules/pdfviewer/PDFViewerFragment:getActivity	()Landroid/support/v4/app/FragmentActivity;
    //   702: aload_0
    //   703: getfield 137	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfFile	Ljava/lang/String;
    //   706: iconst_0
    //   707: invokevirtual 414	android/support/v4/app/FragmentActivity:getSharedPreferences	(Ljava/lang/String;I)Landroid/content/SharedPreferences;
    //   710: invokeinterface 554 1 0
    //   715: astore_3
    //   716: aload_3
    //   717: ldc_w 416
    //   720: aload_2
    //   721: invokeinterface 560 3 0
    //   726: pop
    //   727: aload_3
    //   728: invokeinterface 563 1 0
    //   733: pop
    //   734: aload_2
    //   735: aload 6
    //   737: invokevirtual 567	java/lang/String:equalsIgnoreCase	(Ljava/lang/String;)Z
    //   740: ifne -443 -> 297
    //   743: aload_1
    //   744: invokestatic 454	org/apache/commons/io/FileUtils:deleteQuietly	(Ljava/io/File;)Z
    //   747: pop
    //   748: goto -451 -> 297
    //   751: astore_1
    //   752: aload_0
    //   753: aconst_null
    //   754: putfield 108	com/qbiki/modules/pdfviewer/PDFViewerFragment:pdfDoc	Lpdftron/PDF/PDFDoc;
    //   757: goto -212 -> 545
    //   760: astore_1
    //   761: aload 4
    //   763: astore_2
    //   764: goto -534 -> 230
    //   767: astore_2
    //   768: goto -88 -> 680
    //   771: astore_3
    //   772: aload_1
    //   773: astore_2
    //   774: aload_3
    //   775: astore_1
    //   776: goto -104 -> 672
    //   779: astore_2
    //   780: goto -133 -> 647
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	783	0	this	PDFViewerFragment
    //   35	552	1	localObject1	Object
    //   609	7	1	localPDFNetException	PDFNetException
    //   621	1	1	localException1	Exception
    //   632	7	1	localException2	Exception
    //   644	1	1	localException3	Exception
    //   646	8	1	localObject2	Object
    //   662	1	1	localException4	Exception
    //   668	76	1	localFile	File
    //   751	1	1	localException5	Exception
    //   760	13	1	localException6	Exception
    //   775	1	1	localObject3	Object
    //   69	695	2	localObject4	Object
    //   767	1	2	localException7	Exception
    //   773	1	2	localException8	Exception
    //   779	1	2	localException9	Exception
    //   32	696	3	localObject5	Object
    //   771	4	3	localObject6	Object
    //   185	577	4	localHashMap	HashMap
    //   96	442	5	localInputStream	java.io.InputStream
    //   156	580	6	str	String
    // Exception table:
    //   from	to	target	type
    //   586	608	609	pdftron/Common/PDFNetException
    //   125	133	621	java/lang/Exception
    //   622	629	632	java/lang/Exception
    //   189	207	644	java/lang/Exception
    //   653	657	662	java/lang/Exception
    //   189	207	668	finally
    //   532	545	751	java/lang/Exception
    //   223	227	760	java/lang/Exception
    //   676	680	767	java/lang/Exception
    //   207	216	771	finally
    //   207	216	779	java/lang/Exception
  }
  
  public void onCreateOptionsMenu(Menu paramMenu, MenuInflater paramMenuInflater)
  {
    paramMenuInflater.inflate(2131558426, paramMenu);
    if ((this.nextPage == null) || (this.nextPage.length() == 0)) {
      paramMenu.removeItem(2131100310);
    }
    super.onCreateOptionsMenu(paramMenu, paramMenuInflater);
  }
  
  public View onCreateView(LayoutInflater paramLayoutInflater, ViewGroup paramViewGroup, Bundle paramBundle)
  {
    this.fview = paramLayoutInflater.inflate(2130903187, paramViewGroup, false);
    init();
    return this.fview;
  }
  
  public void onDestroy()
  {
    super.onDestroy();
    if (this.pdfView != null) {
      this.pdfView.destroy();
    }
    if (this.preTask != null) {
      this.preTask.cancel(true);
    }
  }
  
  public void onLowMemory()
  {
    super.onLowMemory();
    if (this.pdfView != null) {
      this.pdfView.purgeMemory();
    }
  }
  
  public boolean onOptionsItemSelected(MenuItem paramMenuItem)
  {
    switch (paramMenuItem.getItemId())
    {
    default: 
      return super.onOptionsItemSelected(paramMenuItem);
    case 2131100309: 
      showHideSearchBar();
      return true;
    case 2131100308: 
      showHideThumbnailPreview();
      return true;
    }
    App.showPage(App.getResourceUrl(this.nextPage), this);
    return true;
  }
  
  public void onPause()
  {
    super.onPause();
    if (this.pdfView != null) {
      this.pdfView.pause();
    }
  }
  
  public void onResume()
  {
    super.onResume();
    if (this.pdfView != null) {
      this.pdfView.resume();
    }
  }
  
  private class BigThumbnailTask
    extends AsyncTask<Integer, Bitmap, Bitmap>
  {
    private WeakReference<ImageView> imageView = null;
    
    private BigThumbnailTask() {}
    
    protected Bitmap doInBackground(Integer... paramVarArgs)
    {
      int i = paramVarArgs[0].intValue();
      paramVarArgs = getImageView();
      return PDFViewerFragment.this.getThumbnailForIndex(Integer.valueOf(i), paramVarArgs.getWidth(), paramVarArgs.getHeight());
    }
    
    public ImageView getImageView()
    {
      return (ImageView)this.imageView.get();
    }
    
    protected void onCancelled() {}
    
    protected void onPostExecute(Bitmap paramBitmap)
    {
      if (isCancelled()) {
        return;
      }
      getImageView().setImageBitmap(paramBitmap);
      PDFViewerFragment.this.bigThumbnailProgress.setVisibility(8);
    }
    
    protected void onPreExecute()
    {
      PDFViewerFragment.this.bigThumbnailProgress.setVisibility(0);
    }
    
    public void setImageView(ImageView paramImageView)
    {
      this.imageView = new WeakReference(paramImageView);
    }
  }
  
  private class ThumbnailsAdapter
    extends BaseAdapter
  {
    private ThumbnailsAdapter() {}
    
    public int getCount()
    {
      try
      {
        int i = PDFViewerFragment.this.pdfDoc.getPageCount();
        return i;
      }
      catch (PDFNetException localPDFNetException)
      {
        Log.d("PDFViewer", "Exception:", localPDFNetException);
      }
      return 0;
    }
    
    public Page getItem(int paramInt)
    {
      Object localObject3 = null;
      Page localPage = null;
      localObject1 = localObject3;
      try
      {
        PDFDoc localPDFDoc = PDFViewerFragment.this.pdfDoc;
        localObject1 = localObject3;
        localObject1 = localPage;
        try
        {
          localPage = PDFViewerFragment.this.pdfDoc.getPage(paramInt + 1);
          localObject1 = localPage;
          return localPage;
        }
        finally {}
        return localObject1;
      }
      catch (PDFNetException localPDFNetException)
      {
        Log.d("PDFViewer", "Exception:", localPDFNetException);
      }
    }
    
    public long getItemId(int paramInt)
    {
      return paramInt;
    }
    
    public View getView(int paramInt, View paramView, ViewGroup paramViewGroup)
    {
      paramViewGroup = (ImageView)PDFViewerFragment.this.thumbnailsArray.get(Integer.valueOf(paramInt));
      paramView = paramViewGroup;
      if (paramViewGroup == null)
      {
        paramView = new ImageView(PDFViewerFragment.this.getActivity());
        paramView.setLayoutParams(new Gallery.LayoutParams(PDFViewerFragment.this.thumbnailWidth, PDFViewerFragment.this.thumbnailHeight));
        paramView.setPadding(5, 5, 5, 5);
        paramView.setBackgroundColor(-1);
        paramView.setTag(Integer.valueOf(paramInt));
        PDFViewerFragment.this.thumbnailsArray.put(Integer.valueOf(paramInt), paramView);
      }
      Bitmap localBitmap = PDFViewerFragment.this.imageCache.get("" + paramInt);
      paramViewGroup = localBitmap;
      if (localBitmap == null)
      {
        paramViewGroup = PDFViewerFragment.this.getThumbnailForIndex(Integer.valueOf(paramInt));
        PDFViewerFragment.this.imageCache.put("" + paramInt, paramViewGroup);
      }
      paramView.setImageBitmap(paramViewGroup);
      return paramView;
    }
  }
  
  private class ThumbnailsPrecacheTask
    extends AsyncTask<Integer, Integer, Integer>
  {
    ProgressDialog progressDialog = null;
    int total = 0;
    
    private ThumbnailsPrecacheTask() {}
    
    protected Integer doInBackground(Integer... paramVarArgs)
    {
      this.total = paramVarArgs[0].intValue();
      int i = 0;
      for (;;)
      {
        if (i < paramVarArgs[0].intValue())
        {
          PDFViewerFragment.this.writeThumbnailBitmapToFile(PDFViewerFragment.this.thumbnailAdapter.getItem(i), i);
          updateProgress(i);
          if (!isCancelled()) {}
        }
        else
        {
          return Integer.valueOf(this.total);
        }
        i += 1;
      }
    }
    
    protected void onCancelled()
    {
      this.progressDialog.dismiss();
      super.onCancelled();
    }
    
    protected void onPostExecute(Integer paramInteger)
    {
      this.progressDialog.dismiss();
      PDFViewerFragment.this.setThumbnailAdapter();
      super.onPostExecute(paramInteger);
    }
    
    protected void onPreExecute()
    {
      this.progressDialog = new ProgressDialog(PDFViewerFragment.this.getActivity());
      this.progressDialog.setProgressStyle(1);
      this.progressDialog.setMessage("Precaching...");
      this.progressDialog.setCancelable(false);
      this.progressDialog.setMax(this.total);
      this.progressDialog.show();
      super.onPreExecute();
    }
    
    protected void updateProgress(int paramInt)
    {
      this.progressDialog.setProgress((int)(paramInt / this.total * 100.0F));
    }
  }
}
