package com.qbiki.util;

import android.content.Context;
import android.media.MediaScannerConnection;
import android.media.MediaScannerConnection.MediaScannerConnectionClient;
import android.net.Uri;

public class FroyoMediaScannerConnection
  extends MediaScannerConnection
{
  public FroyoMediaScannerConnection(Context paramContext, MediaScannerConnection.MediaScannerConnectionClient paramMediaScannerConnectionClient)
  {
    super(paramContext, paramMediaScannerConnectionClient);
  }
  
  public static void scanFile(Context paramContext, String paramString1, String paramString2, OnScanCompletedListener paramOnScanCompletedListener)
  {
    paramString1 = new ClientProxy(new String[] { paramString1 }, new String[] { paramString2 }, paramOnScanCompletedListener);
    paramContext = new MediaScannerConnection(paramContext, paramString1);
    paramString1.mConnection = paramContext;
    paramContext.connect();
  }
  
  public static void scanFile(Context paramContext, String[] paramArrayOfString1, String[] paramArrayOfString2, OnScanCompletedListener paramOnScanCompletedListener)
  {
    paramArrayOfString1 = new ClientProxy(paramArrayOfString1, paramArrayOfString2, paramOnScanCompletedListener);
    paramContext = new MediaScannerConnection(paramContext, paramArrayOfString1);
    paramArrayOfString1.mConnection = paramContext;
    paramContext.connect();
  }
  
  static class ClientProxy
    implements MediaScannerConnection.MediaScannerConnectionClient
  {
    final FroyoMediaScannerConnection.OnScanCompletedListener mClient;
    MediaScannerConnection mConnection;
    final String[] mMimeTypes;
    int mNextPath;
    final String[] mPaths;
    
    ClientProxy(String[] paramArrayOfString1, String[] paramArrayOfString2, FroyoMediaScannerConnection.OnScanCompletedListener paramOnScanCompletedListener)
    {
      this.mPaths = paramArrayOfString1;
      this.mMimeTypes = paramArrayOfString2;
      this.mClient = paramOnScanCompletedListener;
    }
    
    public void onMediaScannerConnected()
    {
      scanNextPath();
    }
    
    public void onScanCompleted(String paramString, Uri paramUri)
    {
      if (this.mClient != null) {
        this.mClient.onScanCompleted(paramString, paramUri);
      }
      scanNextPath();
    }
    
    void scanNextPath()
    {
      if (this.mNextPath >= this.mPaths.length)
      {
        this.mConnection.disconnect();
        return;
      }
      if (this.mMimeTypes != null) {}
      for (String str = this.mMimeTypes[this.mNextPath];; str = null)
      {
        this.mConnection.scanFile(this.mPaths[this.mNextPath], str);
        this.mNextPath += 1;
        return;
      }
    }
  }
  
  public static abstract interface OnScanCompletedListener
  {
    public abstract void onScanCompleted(String paramString, Uri paramUri);
  }
}
