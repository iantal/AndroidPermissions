package com.waps;

import android.content.Context;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.graphics.Bitmap;
import android.graphics.Color;
import android.os.Build.VERSION;
import android.os.Handler;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup.LayoutParams;
import android.widget.ImageView;
import android.widget.ImageView.ScaleType;
import android.widget.LinearLayout;
import android.widget.TextView;
import java.util.ArrayList;
import java.util.List;

public class MiniAdView
  implements DisplayAdNotifier
{
  private static final long DELETE_ICON_LIMIT_TIME = 604800000L;
  static long e = 0L;
  static int f = 5;
  protected static List g;
  private static List p;
  private static int v = 0;
  LinearLayout a;
  boolean b = false;
  View c;
  Context d;
  TextView h;
  private int[] i;
  private int j;
  private AnimationType k;
  private int l = -1;
  private String m = "";
  final Handler mHandler = new Handler();
  final Runnable mUpdateResults = new ah(this);
  private int n = AppConnect.J;
  private boolean o = true;
  private int q = 0;
  private String r;
  private String s;
  private String t;
  private int u;
  private String w = "/Android/data/cache/iconCache";
  private String x = "CacheTime";
  private SharedPreferences y = null;
  private SharedPreferences.Editor z = null;
  
  public MiniAdView() {}
  
  public MiniAdView(Context paramContext)
  {
    this.d = paramContext;
  }
  
  public MiniAdView(Context paramContext, LinearLayout paramLinearLayout)
  {
    a(this.w);
    this.d = paramContext;
    this.a = paramLinearLayout;
    this.a.setBackgroundColor(AppConnect.I);
    this.i = new int[] { -2 };
    this.j = -2;
    this.l = 0;
    this.y = paramContext.getSharedPreferences("AppSettings", 0);
    this.z = this.y.edit();
  }
  
  private LinearLayout a(Context paramContext, Bitmap paramBitmap, String paramString, int paramInt)
  {
    LinearLayout localLinearLayout = new LinearLayout(paramContext);
    localLinearLayout.setOrientation(0);
    localLinearLayout.setGravity(17);
    localLinearLayout.setBackgroundColor(Color.argb(0, 0, 0, 0));
    localLinearLayout.setPadding(5, 0, 0, 0);
    int i1 = (int)(paramInt / 16.0F);
    paramInt = (int)(paramInt / 16.0F);
    ImageView localImageView = new ImageView(paramContext);
    localImageView.setLayoutParams(new ViewGroup.LayoutParams(i1, paramInt));
    if (paramBitmap != null) {
      if (paramBitmap.getWidth() > paramInt)
      {
        localImageView.setScaleType(ImageView.ScaleType.CENTER_INSIDE);
        localImageView.setImageBitmap(paramBitmap);
      }
    }
    for (;;)
    {
      this.h = new TextView(paramContext);
      this.h.setText(paramString);
      this.h.setTextSize(15.0F);
      this.h.setTextColor(this.n);
      this.h.setPadding(5, 0, 0, 0);
      localLinearLayout.addView(localImageView);
      localLinearLayout.addView(this.h);
      return localLinearLayout;
      localImageView.setScaleType(ImageView.ScaleType.FIT_CENTER);
      break;
      localImageView.setImageResource(17301516);
    }
  }
  
  /* Error */
  private void a(String paramString)
  {
    // Byte code:
    //   0: new 230	com/waps/SDKUtils
    //   3: dup
    //   4: aload_0
    //   5: getfield 109	com/waps/MiniAdView:d	Landroid/content/Context;
    //   8: invokespecial 231	com/waps/SDKUtils:<init>	(Landroid/content/Context;)V
    //   11: aload_0
    //   12: getfield 95	com/waps/MiniAdView:x	Ljava/lang/String;
    //   15: aload_1
    //   16: invokevirtual 235	com/waps/SDKUtils:loadStringFromLocal	(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
    //   19: astore 6
    //   21: aload 6
    //   23: invokestatic 239	com/waps/SDKUtils:isNull	(Ljava/lang/String;)Z
    //   26: ifeq +30 -> 56
    //   29: new 230	com/waps/SDKUtils
    //   32: dup
    //   33: aload_0
    //   34: getfield 109	com/waps/MiniAdView:d	Landroid/content/Context;
    //   37: invokespecial 231	com/waps/SDKUtils:<init>	(Landroid/content/Context;)V
    //   40: invokestatic 245	java/lang/System:currentTimeMillis	()J
    //   43: invokestatic 251	java/lang/String:valueOf	(J)Ljava/lang/String;
    //   46: aload_0
    //   47: getfield 95	com/waps/MiniAdView:x	Ljava/lang/String;
    //   50: aload_1
    //   51: iconst_1
    //   52: invokevirtual 255	com/waps/SDKUtils:saveDataToLocal	(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)V
    //   55: return
    //   56: aload 6
    //   58: invokestatic 239	com/waps/SDKUtils:isNull	(Ljava/lang/String;)Z
    //   61: ifne +142 -> 203
    //   64: aload 6
    //   66: ldc_w 257
    //   69: ldc 75
    //   71: invokevirtual 260	java/lang/String:replaceAll	(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
    //   74: invokestatic 266	java/lang/Long:parseLong	(Ljava/lang/String;)J
    //   77: lstore_2
    //   78: invokestatic 245	java/lang/System:currentTimeMillis	()J
    //   81: lstore 4
    //   83: lload 4
    //   85: lload_2
    //   86: lsub
    //   87: ldc2_w 9
    //   90: lcmp
    //   91: iflt +112 -> 203
    //   94: invokestatic 272	android/os/Environment:getExternalStorageState	()Ljava/lang/String;
    //   97: ldc_w 274
    //   100: invokevirtual 278	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   103: ifeq +51 -> 154
    //   106: new 280	java/io/File
    //   109: dup
    //   110: new 282	java/lang/StringBuilder
    //   113: dup
    //   114: invokespecial 283	java/lang/StringBuilder:<init>	()V
    //   117: invokestatic 287	android/os/Environment:getExternalStorageDirectory	()Ljava/io/File;
    //   120: invokevirtual 290	java/io/File:toString	()Ljava/lang/String;
    //   123: invokevirtual 294	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   126: aload_1
    //   127: invokevirtual 294	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   130: invokevirtual 295	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   133: invokespecial 297	java/io/File:<init>	(Ljava/lang/String;)V
    //   136: astore 6
    //   138: new 230	com/waps/SDKUtils
    //   141: dup
    //   142: aload_0
    //   143: getfield 109	com/waps/MiniAdView:d	Landroid/content/Context;
    //   146: invokespecial 231	com/waps/SDKUtils:<init>	(Landroid/content/Context;)V
    //   149: aload 6
    //   151: invokevirtual 301	com/waps/SDKUtils:deleteLocalFiles	(Ljava/io/File;)V
    //   154: new 230	com/waps/SDKUtils
    //   157: dup
    //   158: aload_0
    //   159: getfield 109	com/waps/MiniAdView:d	Landroid/content/Context;
    //   162: invokespecial 231	com/waps/SDKUtils:<init>	(Landroid/content/Context;)V
    //   165: new 282	java/lang/StringBuilder
    //   168: dup
    //   169: invokespecial 283	java/lang/StringBuilder:<init>	()V
    //   172: invokestatic 245	java/lang/System:currentTimeMillis	()J
    //   175: invokevirtual 304	java/lang/StringBuilder:append	(J)Ljava/lang/StringBuilder;
    //   178: ldc 75
    //   180: invokevirtual 294	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   183: invokevirtual 295	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   186: aload_0
    //   187: getfield 95	com/waps/MiniAdView:x	Ljava/lang/String;
    //   190: aload_1
    //   191: iconst_1
    //   192: invokevirtual 255	com/waps/SDKUtils:saveDataToLocal	(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)V
    //   195: return
    //   196: astore_1
    //   197: return
    //   198: astore 6
    //   200: goto -46 -> 154
    //   203: return
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	204	0	this	MiniAdView
    //   0	204	1	paramString	String
    //   77	9	2	l1	long
    //   81	3	4	l2	long
    //   19	131	6	localObject	Object
    //   198	1	6	localException	Exception
    // Exception table:
    //   from	to	target	type
    //   0	55	196	java/lang/Exception
    //   56	83	196	java/lang/Exception
    //   154	195	196	java/lang/Exception
    //   94	154	198	java/lang/Exception
  }
  
  private void b(int paramInt)
  {
    try
    {
      this.u = paramInt;
      if (v == 0)
      {
        this.b = true;
        this.mHandler.post(this.mUpdateResults);
        return;
      }
      this.r = ((a)g.get(this.u)).a();
      this.s = ((a)g.get(this.u)).b();
      this.t = ((a)g.get(this.u)).c();
      Object localObject = a(this.d, this.s, this.r, this.w);
      paramInt = new SDKUtils(this.d).initAdWidth();
      int i1 = (int)(paramInt / 13.333333F);
      this.c = a(this.d, (Bitmap)localObject, this.t, paramInt);
      localObject = new ViewGroup.LayoutParams(paramInt, i1);
      this.c.setLayoutParams((ViewGroup.LayoutParams)localObject);
      this.mHandler.post(new aj(this));
      this.c.setOnClickListener(getMiniAdClickListener(this.d, this.u));
      if (this.c != null)
      {
        this.b = true;
        this.mHandler.post(this.mUpdateResults);
      }
      this.z.putInt("MiniAd_ShowTag", this.u);
      this.z.commit();
      return;
    }
    catch (Exception localException) {}
  }
  
  private void c()
  {
    try
    {
      this.a.removeView(this.a.getChildAt(0));
      this.a.removeAllViews();
      if ((this.c != null) && (this.b))
      {
        if (v == 0)
        {
          ViewGroup.LayoutParams localLayoutParams = new ViewGroup.LayoutParams(0, 0);
          this.c.setLayoutParams(localLayoutParams);
          return;
        }
        this.a.refreshDrawableState();
        this.a.setAlwaysDrawnWithCacheEnabled(true);
        this.a.clearFocus();
        this.a.clearDisappearingChildren();
        this.a.addView(this.c);
        this.m = Build.VERSION.SDK;
        this.a.clearAnimation();
        this.c.clearAnimation();
        if (this.l == 0) {
          this.k = new AnimationType(this.i);
        }
        for (;;)
        {
          this.k.startAnimation(this.c);
          this.b = false;
          return;
          if (this.l == 1) {
            this.k = new AnimationType(this.j);
          } else if (this.l == 2) {
            this.k = new AnimationType(this.i);
          }
        }
      }
      return;
    }
    catch (Exception localException) {}
  }
  
  private void d()
  {
    e = System.currentTimeMillis();
    this.y = this.d.getSharedPreferences("AppSettings", 0);
    int i1 = this.y.getInt("MiniAd_ShowTag", -1);
    if (i1 != -1) {
      this.q = (i1 + 1);
    }
    if (this.q >= v) {
      this.q = 0;
    }
    b(this.q);
    new ai(this).start();
  }
  
  private void e()
  {
    int i1 = 0;
    while (i1 < p.size())
    {
      int i2 = 0;
      while (i2 < g.size())
      {
        if (((a)g.get(i2)).a().equals(p.get(i1))) {
          g.remove(g.get(i2));
        }
        i2 += 1;
      }
      i1 += 1;
    }
    p = null;
    p = new ArrayList();
  }
  
  public void DisplayAd()
  {
    DisplayAd(f);
  }
  
  public void DisplayAd(int paramInt)
  {
    try
    {
      if (this.d.getSharedPreferences("ShowAdFlag", 3).getBoolean("show_mini_flag", true))
      {
        showADS();
        p = new ArrayList();
      }
      f = paramInt;
      if (paramInt < 5) {
        f = 5;
      }
      return;
    }
    catch (Exception localException) {}
  }
  
  protected Bitmap a(Context paramContext, String paramString1, String paramString2, String paramString3)
  {
    return new AppConnect().a(paramContext, paramString1, paramString2, paramString3);
  }
  
  public void getDisplayAdResponse(View paramView) {}
  
  public void getDisplayAdResponse(Object paramObject)
  {
    g = (List)paramObject;
    v = g.size();
    d();
  }
  
  public void getDisplayAdResponseFailed(String paramString)
  {
    this.b = false;
    this.mHandler.post(this.mUpdateResults);
  }
  
  public View.OnClickListener getMiniAdClickListener(Context paramContext, int paramInt)
  {
    return new al(this, paramContext, paramInt);
  }
  
  public MiniAdView setAnimationType(int paramInt)
  {
    this.j = paramInt;
    this.l = 1;
    return this;
  }
  
  public MiniAdView setAnimationType(int[] paramArrayOfInt)
  {
    this.i = paramArrayOfInt;
    this.l = 2;
    return this;
  }
  
  public void showADS()
  {
    AppConnect.getInstance(this.d).a(this);
  }
}
