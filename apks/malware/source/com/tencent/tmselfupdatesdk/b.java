package com.tencent.tmselfupdatesdk;

import android.os.Bundle;
import android.text.TextUtils;
import com.tencent.tmassistant.aidl.TMAssistantDownloadTaskInfo;
import com.tencent.tmassistantbase.util.TMLog;
import com.tencent.tmassistantsdk.TMAssistantCallYYBParamStruct;
import com.tencent.tmdownloader.TMAssistantDownloadClient;
import com.tencent.tmdownloader.TMAssistantDownloadConst;

class b
  implements Runnable
{
  b(TMSelfUpdateManager paramTMSelfUpdateManager, TMAssistantCallYYBParamStruct paramTMAssistantCallYYBParamStruct) {}
  
  public void run()
  {
    try
    {
      if (this.b.a(false) != null)
      {
        Object localObject = new Bundle();
        ((Bundle)localObject).putString(TMAssistantDownloadConst.PARAM_APPID, "50801");
        ((Bundle)localObject).putString(TMAssistantDownloadConst.PARAM_TASK_PACKNAME, "com.tencent.android.qqdownloader");
        ((Bundle)localObject).putString(TMAssistantDownloadConst.PARAM_CHANNELID, this.b.mYybChannelId);
        ((Bundle)localObject).putString(TMAssistantDownloadConst.PARAM_VIA, this.a.via);
        ((Bundle)localObject).putByte(TMAssistantDownloadConst.PARAM_DOWNLOADTYPE, (byte)2);
        int i = this.b.a(false).startDownloadTask(this.b.e, "application/vnd.android.package-archive", (Bundle)localObject);
        this.b.f = i;
        TMLog.i("TMSelfUpdateManager", "startDownloadTask result :" + i);
        if (4 == i)
        {
          localObject = this.b.a(false).getDownloadTaskState(this.b.e);
          if (localObject != null)
          {
            localObject = ((TMAssistantDownloadTaskInfo)localObject).mSavePath;
            TMLog.i("TMSelfUpdateManager", "yyb apk has yet existsï¼šurl:" + this.b.e + ";  yybpath:" + (String)localObject);
            if (!TextUtils.isEmpty((CharSequence)localObject))
            {
              TMSelfUpdateManager.a(this.b, (String)localObject, "com.tencent.android.qqdownloader", this.b.updateType);
              this.b.g = true;
              TMLog.i("TMSelfUpdateManager", "isFromStartUpdate;startUpdate():" + this.b.g);
            }
          }
        }
      }
      return;
    }
    catch (Throwable localThrowable)
    {
      TMLog.e("TMSelfUpdateManager", "exception:", localThrowable);
      localThrowable.printStackTrace();
    }
  }
}
