package com.tencent.android.tpush.stat;

import android.content.Context;
import com.tencent.android.tpush.XGPush4Msdk;
import com.tencent.android.tpush.XGPushConfig;
import com.tencent.android.tpush.stat.a.g;
import com.tencent.android.tpush.stat.a.i;
import com.tencent.android.tpush.stat.event.b;
import java.util.Map;
import java.util.Properties;
import java.util.concurrent.ConcurrentHashMap;
import org.json.JSONException;
import org.json.JSONObject;

public class j
{
  static volatile int a = 0;
  static volatile long b = 0L;
  private static com.tencent.android.tpush.stat.a.e c;
  private static volatile Map d = new ConcurrentHashMap();
  private static volatile long e = 0L;
  private static volatile int f = 0;
  private static i g = g.b();
  private static Thread.UncaughtExceptionHandler h = null;
  private static volatile boolean i = true;
  private static Context j = null;
  private static long k = 0L;
  
  public j() {}
  
  static int a(Context paramContext, boolean paramBoolean, long paramLong)
  {
    int n = 1;
    paramLong = System.currentTimeMillis();
    if (e == 0L) {
      e = g.c();
    }
    if (f == 0) {}
    for (int m = 1;; m = 0)
    {
      if (paramLong >= e)
      {
        e = g.c();
        if (t.a(paramContext).b(paramContext).d() != 1) {
          t.a(paramContext).b(paramContext).a(1);
        }
        a = 0;
        m = n;
      }
      for (;;)
      {
        if (m != 0) {
          f(paramContext);
        }
        if (i) {
          i = false;
        }
        return f;
      }
    }
  }
  
  public static Context a(Context paramContext)
  {
    if (paramContext != null) {
      return paramContext;
    }
    return j;
  }
  
  public static void a(Context paramContext, int paramInt)
  {
    if (!d.c()) {}
    do
    {
      return;
      if (d.b()) {
        g.b("commitEvents, maxNumber=" + paramInt);
      }
      paramContext = a(paramContext);
      if (paramContext == null)
      {
        g.e("The Context of StatService.commitEvents() can not be null!");
        return;
      }
      if ((paramInt < -1) || (paramInt == 0))
      {
        g.e("The maxNumber of StatService.commitEvents() should be -1 or bigger than 0.");
        return;
      }
    } while ((!a.a(paramContext).e()) || (e(paramContext) == null));
    c.a(new m(paramContext, paramInt));
  }
  
  public static void a(Context paramContext, String paramString, Properties paramProperties, long paramLong1, long paramLong2)
  {
    if (!d.c()) {}
    do
    {
      return;
      paramContext = a(paramContext);
      if (paramContext == null)
      {
        g.e("The Context of StatService.trackCustomEvent() can not be null!");
        return;
      }
      if (a(paramString))
      {
        g.e("The event_id of StatService.trackCustomEvent() can not be null or empty.");
        return;
      }
      paramString = new b(paramString, null, paramProperties);
    } while (e(paramContext) == null);
    c.a(new l(paramContext, paramLong1, paramString, paramLong2));
  }
  
  static boolean a()
  {
    if (a >= 2)
    {
      b = System.currentTimeMillis();
      return true;
    }
    return false;
  }
  
  static boolean a(String paramString)
  {
    return (paramString == null) || (paramString.length() == 0);
  }
  
  static JSONObject b()
  {
    JSONObject localJSONObject1 = new JSONObject();
    try
    {
      JSONObject localJSONObject2 = new JSONObject();
      if (d.b.d != 0) {
        localJSONObject2.put("v", d.b.d);
      }
      localJSONObject1.put(Integer.toString(d.b.a), localJSONObject2);
      localJSONObject2 = new JSONObject();
      if (d.a.d != 0) {
        localJSONObject2.put("v", d.a.d);
      }
      localJSONObject1.put(Integer.toString(d.a.a), localJSONObject2);
      return localJSONObject1;
    }
    catch (JSONException localJSONException)
    {
      g.b(localJSONException);
    }
    return localJSONObject1;
  }
  
  public static void b(Context paramContext)
  {
    if (paramContext != null) {
      j = paramContext.getApplicationContext();
    }
  }
  
  static void c()
  {
    a = 0;
    b = 0L;
  }
  
  static boolean c(Context paramContext)
  {
    boolean bool2 = false;
    long l1 = com.tencent.android.tpush.stat.a.j.a(paramContext, d.c, 0L);
    long l2 = g.b("2.0.4");
    boolean bool1 = true;
    if (l2 <= l1)
    {
      g.e("MTA is disable for current version:" + l2 + ",wakeup version:" + l1);
      bool1 = false;
    }
    l1 = com.tencent.android.tpush.stat.a.j.a(paramContext, d.d, 0L);
    if (l1 > System.currentTimeMillis())
    {
      g.e("MTA is disable for current time:" + System.currentTimeMillis() + ",wakeup time:" + l1);
      bool1 = bool2;
    }
    for (;;)
    {
      d.b(bool1);
      return bool1;
    }
  }
  
  static void d()
  {
    a += 1;
    b = System.currentTimeMillis();
    g(j);
  }
  
  static void d(Context paramContext)
  {
    if (paramContext == null) {}
    for (;;)
    {
      return;
      try
      {
        if ((c != null) || (!c(paramContext))) {
          continue;
        }
        paramContext = paramContext.getApplicationContext();
        j = paramContext;
        k = XGPushConfig.getAccessId(j);
        if (k <= 0L) {
          k = XGPush4Msdk.getQQAccessId(j);
        }
        c = new com.tencent.android.tpush.stat.a.e();
        c.a(new k(paramContext));
      }
      finally {}
    }
  }
  
  /* Error */
  public static com.tencent.android.tpush.stat.a.e e(Context paramContext)
  {
    // Byte code:
    //   0: getstatic 136	com/tencent/android/tpush/stat/j:c	Lcom/tencent/android/tpush/stat/a/e;
    //   3: ifnonnull +21 -> 24
    //   6: ldc 2
    //   8: monitorenter
    //   9: getstatic 136	com/tencent/android/tpush/stat/j:c	Lcom/tencent/android/tpush/stat/a/e;
    //   12: astore_1
    //   13: aload_1
    //   14: ifnonnull +7 -> 21
    //   17: aload_0
    //   18: invokestatic 261	com/tencent/android/tpush/stat/j:d	(Landroid/content/Context;)V
    //   21: ldc 2
    //   23: monitorexit
    //   24: getstatic 136	com/tencent/android/tpush/stat/j:c	Lcom/tencent/android/tpush/stat/a/e;
    //   27: areturn
    //   28: astore_0
    //   29: getstatic 43	com/tencent/android/tpush/stat/j:g	Lcom/tencent/android/tpush/stat/a/i;
    //   32: aload_0
    //   33: invokevirtual 263	com/tencent/android/tpush/stat/a/i:a	(Ljava/lang/Throwable;)V
    //   36: iconst_0
    //   37: invokestatic 237	com/tencent/android/tpush/stat/d:b	(Z)V
    //   40: goto -19 -> 21
    //   43: astore_0
    //   44: ldc 2
    //   46: monitorexit
    //   47: aload_0
    //   48: athrow
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	49	0	paramContext	Context
    //   12	2	1	localE	com.tencent.android.tpush.stat.a.e
    // Exception table:
    //   from	to	target	type
    //   17	21	28	java/lang/Throwable
    //   9	13	43	finally
    //   17	21	43	finally
    //   21	24	43	finally
    //   29	40	43	finally
    //   44	47	43	finally
  }
  
  static void f(Context paramContext)
  {
    if (e(paramContext) != null)
    {
      if (d.b()) {
        g.h("start new session.");
      }
      if (f == 0) {
        f = g.a();
      }
      new p(new com.tencent.android.tpush.stat.event.e(paramContext, f, b(), k)).a();
    }
  }
  
  public static void g(Context paramContext)
  {
    if (!d.c()) {}
    while (d.h <= 0) {
      return;
    }
    paramContext = a(paramContext);
    if (paramContext == null)
    {
      g.e("The Context of StatService.testSpeed() can not be null!");
      return;
    }
    t.a(paramContext).c();
  }
}
