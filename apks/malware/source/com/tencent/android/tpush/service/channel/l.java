package com.tencent.android.tpush.service.channel;

import com.tencent.android.tpush.logging.TLog;
import com.tencent.android.tpush.service.channel.exception.ChannelException;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Set;
import java.util.concurrent.ConcurrentHashMap;

class l
  implements Runnable
{
  private l(b paramB) {}
  
  public void run()
  {
    for (;;)
    {
      long l3;
      int i;
      label144:
      int j;
      long l2;
      Object localObject6;
      try
      {
        TLog.v("XGService", "@@TimeoutRunnable run()");
        long l4 = System.currentTimeMillis();
        l1 = Long.MAX_VALUE;
        l3 = com.tencent.android.tpush.service.a.a.f;
        i = 0;
        if (l3 >= 15000L) {
          break label541;
        }
        l3 = 15000L;
        Object localObject1 = new ChannelException(10107, "TpnsMessage wait for response timeout!");
        Object localObject3 = b.e(this.a).keySet().iterator();
        Object localObject7;
        if (((Iterator)localObject3).hasNext())
        {
          localObject5 = (com.tencent.android.tpush.service.channel.a.a)((Iterator)localObject3).next();
          ??? = (ConcurrentHashMap)b.e(this.a).get(localObject5);
          if ((??? == null) || (((ConcurrentHashMap)???).size() == 0)) {
            break label566;
          }
          ??? = ((ConcurrentHashMap)???).entrySet().iterator();
          localObject5 = ((com.tencent.android.tpush.service.channel.a.a)localObject5).e();
          j = i;
          l2 = l1;
          if (!((Iterator)???).hasNext()) {
            break label571;
          }
          localObject6 = (n)((Map.Entry)((Iterator)???).next()).getValue();
          if (localObject6 != null)
          {
            l2 = l4 - ((n)localObject6).b;
            ((a)localObject5).a(3, Long.valueOf(l2));
            if (l2 < 0L) {
              continue;
            }
            if (l2 <= l3) {
              break label544;
            }
            localObject7 = ((n)localObject6).d;
            if (localObject7 != null)
            {
              ((o)localObject7).a(((n)localObject6).c, (ChannelException)localObject1, (a)localObject5);
              ((n)localObject6).d = null;
            }
            ((Iterator)???).remove();
            i = 1;
            break label538;
          }
          ((Iterator)???).remove();
          break label563;
        }
        Object localObject5 = new ChannelException(10106, "TpnsMessage wait for response timeout!");
        localObject1 = null;
        synchronized (this.a)
        {
          localObject6 = b.c(this.a).iterator();
          if (!((Iterator)localObject6).hasNext()) {
            break label523;
          }
          localObject7 = (n)((Iterator)localObject6).next();
          if (localObject7 == null) {
            break label513;
          }
          l2 = l4 - ((n)localObject7).a;
          if (l2 < 0L) {
            continue;
          }
          if (l2 > l3)
          {
            o localO = ((n)localObject7).d;
            localObject3 = localObject1;
            if (localO != null)
            {
              localObject3 = localObject1;
              if (localObject1 == null)
              {
                if (b.d(this.a) != null)
                {
                  localObject3 = b.d(this.a).e();
                  ((a)localObject3).a(3, Long.valueOf(l2));
                }
              }
              else
              {
                localO.a(((n)localObject7).c, (ChannelException)localObject5, (a)localObject3);
                ((n)localObject7).d = null;
              }
            }
            else
            {
              localObject1 = localObject3;
              ((Iterator)localObject6).remove();
              i = 1;
              break;
            }
            localObject3 = new a();
          }
        }
        if (l3 - l2 >= l1) {
          break label582;
        }
      }
      catch (Exception localException)
      {
        TLog.e("XGService", "TimeoutRunnable.run", localException);
        return;
      }
      long l1 = l3 - l2;
      break;
      label513:
      ((Iterator)localObject6).remove();
      break label582;
      label523:
      if (i != 0)
      {
        this.a.e();
        return;
        label538:
        label541:
        label544:
        label563:
        for (;;)
        {
          break label144;
          break;
          if (l3 - l2 < l1) {
            l1 = l3 - l2;
          }
        }
        label566:
        l2 = l1;
        j = i;
        label571:
        l1 = l2;
        i = j;
      }
    }
    label582:
    for (;;)
    {
      break;
    }
  }
}
