package com.tencent.midas.control;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.Intent;
import android.text.TextUtils;
import android.webkit.JsResult;
import android.webkit.WebView;
import com.tencent.midas.api.APMidasResponse;
import com.tencent.midas.api.IAPMidasNetCallBack;
import com.tencent.midas.api.IAPMidasPayCallBack;
import com.tencent.midas.api.request.APMidasBaseRequest;
import com.tencent.midas.api.request.APMidasNetRequest;
import com.tencent.midas.comm.APLog;
import com.tencent.midas.plugin.APPluginProxyActivity;
import com.tencent.midas.plugin.APPluginUtils;

public class APMidasPayHelper
{
  public static String MED_DISTRIBUTE_CALL = "openMidasCall";
  public static String MED_DISTRIBUTE_H5PAY = "openMidasH5Pay";
  public static String MED_DISTRIBUTE_NET;
  public static String MED_DISTRIBUTE_PAY;
  public static String MIDAS_PLUGIN_NAME = "MidasPay";
  public static final String MIDAS_PLUGIN_VERSION = "1.3.9e";
  public static String PKG_DISTRIBUTE = "com.tencent.midas.pay.APMidasDistribute";
  private static IAPMidasPayCallBack d = null;
  private static IAPMidasNetCallBack e = null;
  private static int f = 0;
  private static int g = -1;
  private static Object h = new Object();
  private static Object i = new Object();
  private static WebView j;
  private Activity a;
  private String b = "release";
  private boolean c;
  public int saveType = 0;
  public int screenType = 0;
  
  static
  {
    MED_DISTRIBUTE_PAY = "openMidasPay";
    MED_DISTRIBUTE_NET = "openMidasNet";
  }
  
  public APMidasPayHelper() {}
  
  private int a(Activity paramActivity, WebView paramWebView, String paramString1, String paramString2, JsResult paramJsResult, String paramString3)
  {
    this.a = paramActivity;
    APLog.i("APMidasPayHelper", "toMidas initState: " + g);
    synchronized (h)
    {
      ProgressDialog localProgressDialog = new ProgressDialog(paramActivity);
      localProgressDialog.setIndeterminate(false);
      localProgressDialog.setProgressStyle(0);
      localProgressDialog.setTitle("温馨提示");
      localProgressDialog.setMessage("腾讯支付服务初始化中");
      if ((g == -1) || (g == 0)) {
        localProgressDialog.show();
      }
      if (g == -1) {
        b(paramActivity);
      }
      if (g == 0)
      {
        new Thread(new c(this, localProgressDialog, paramActivity, paramWebView, paramString1, paramString2, paramJsResult, paramString3)).start();
        return 0;
      }
      int k = b(paramActivity, paramWebView, paramString1, paramString2, paramJsResult, paramString3);
      return k;
    }
  }
  
  private int a(Activity paramActivity, APMidasBaseRequest paramAPMidasBaseRequest, String paramString)
  {
    if (paramAPMidasBaseRequest == null)
    {
      APLog.i("APMidasPayHelper", "toMidas pay request is null");
      return -1;
    }
    this.a = paramActivity;
    APLog.i("APMidasPayHelper", "toMidas initState: " + g);
    synchronized (h)
    {
      ProgressDialog localProgressDialog = new ProgressDialog(paramActivity);
      localProgressDialog.setIndeterminate(false);
      localProgressDialog.setProgressStyle(0);
      localProgressDialog.setTitle("温馨提示");
      localProgressDialog.setMessage("腾讯支付服务初始化中");
      if ((g == -1) || (g == 0)) {
        localProgressDialog.show();
      }
      if (g == -1) {
        b(paramActivity);
      }
      if (g == 0)
      {
        new Thread(new a(this, localProgressDialog, paramActivity, paramAPMidasBaseRequest, paramString)).start();
        return 0;
      }
      int k = b(paramActivity, paramAPMidasBaseRequest, paramString);
      return k;
    }
  }
  
  private void a(Intent paramIntent, String paramString)
  {
    APPluginProxyActivity localAPPluginProxyActivity = new APPluginProxyActivity();
    try
    {
      paramIntent = localAPPluginProxyActivity.initPluginInterface(this.a, MIDAS_PLUGIN_NAME, PKG_DISTRIBUTE, paramString, new Object[] { this.a, paramIntent });
      APLog.i("APMidasPayHelper", "openPlugin obj:" + paramIntent);
      return;
    }
    catch (Exception paramIntent)
    {
      for (;;)
      {
        paramIntent.printStackTrace();
        paramIntent = null;
      }
    }
  }
  
  private int b(Activity paramActivity, WebView arg2, String paramString1, String paramString2, JsResult paramJsResult, String paramString3)
  {
    synchronized (h)
    {
      if (g == 2)
      {
        APLog.i("APMidasPayHelper", "toMidasPay plugin init error");
        c();
        return -1;
      }
      if (!APPluginUtils.isPluginValid(paramActivity))
      {
        APLog.i("APMidasPayHelper", "toMidasPay isPluginValid false");
        APPluginUtils.unInstallPlugin(paramActivity);
        g = -1;
        c();
        return -1;
      }
    }
    paramActivity.runOnUiThread(new d(this, paramString1, paramString2, paramString3));
    return 0;
  }
  
  private int b(Activity paramActivity, APMidasBaseRequest paramAPMidasBaseRequest, String paramString)
  {
    synchronized (h)
    {
      if (g == 2)
      {
        APLog.i("APMidasPayHelper", "toMidasPay plugin init error");
        c();
        return -1;
      }
      if (!APPluginUtils.isPluginValid(paramActivity))
      {
        APLog.i("APMidasPayHelper", "toMidasPay isPluginValid false");
        APPluginUtils.unInstallPlugin(paramActivity);
        g = -1;
        c();
        return -1;
      }
    }
    paramActivity.runOnUiThread(new b(this, paramAPMidasBaseRequest, paramString));
    return 0;
  }
  
  private static void b(Context paramContext)
  {
    synchronized (h)
    {
      g = 0;
      new Thread(new e(paramContext)).start();
      return;
    }
  }
  
  private void c()
  {
    if (d != null) {
      this.a.runOnUiThread(new f(this));
    }
  }
  
  /* Error */
  private static void c(Context arg0)
  {
    // Byte code:
    //   0: aload_0
    //   1: invokestatic 235	com/tencent/midas/plugin/APPluginUtils:isNeedUpdateFromLocal	(Landroid/content/Context;)Z
    //   4: istore_2
    //   5: ldc 88
    //   7: new 90	java/lang/StringBuilder
    //   10: dup
    //   11: ldc -19
    //   13: invokespecial 95	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   16: iload_2
    //   17: invokevirtual 240	java/lang/StringBuilder:append	(Z)Ljava/lang/StringBuilder;
    //   20: invokevirtual 103	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   23: invokestatic 108	com/tencent/midas/comm/APLog:i	(Ljava/lang/String;Ljava/lang/String;)V
    //   26: iload_2
    //   27: ifeq +8 -> 35
    //   30: aload_0
    //   31: invokestatic 244	com/tencent/midas/plugin/APPluginUtils:installFromLocal	(Landroid/content/Context;)I
    //   34: pop
    //   35: aload_0
    //   36: invokestatic 247	com/tencent/midas/plugin/APPluginUtils:isNeedUpdateFromAssets	(Landroid/content/Context;)Z
    //   39: istore_2
    //   40: ldc 88
    //   42: new 90	java/lang/StringBuilder
    //   45: dup
    //   46: ldc -7
    //   48: invokespecial 95	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   51: iload_2
    //   52: invokevirtual 240	java/lang/StringBuilder:append	(Z)Ljava/lang/StringBuilder;
    //   55: invokevirtual 103	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   58: invokestatic 108	com/tencent/midas/comm/APLog:i	(Ljava/lang/String;Ljava/lang/String;)V
    //   61: iconst_0
    //   62: istore_1
    //   63: iload_2
    //   64: ifeq +8 -> 72
    //   67: aload_0
    //   68: invokestatic 252	com/tencent/midas/plugin/APPluginUtils:installPlugin	(Landroid/content/Context;)I
    //   71: istore_1
    //   72: ldc 88
    //   74: new 90	java/lang/StringBuilder
    //   77: dup
    //   78: ldc -2
    //   80: invokespecial 95	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   83: iload_1
    //   84: invokevirtual 99	java/lang/StringBuilder:append	(I)Ljava/lang/StringBuilder;
    //   87: invokevirtual 103	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   90: invokestatic 108	com/tencent/midas/comm/APLog:i	(Ljava/lang/String;Ljava/lang/String;)V
    //   93: getstatic 72	com/tencent/midas/control/APMidasPayHelper:h	Ljava/lang/Object;
    //   96: astore_3
    //   97: aload_3
    //   98: monitorenter
    //   99: iload_1
    //   100: ifeq +48 -> 148
    //   103: iconst_2
    //   104: putstatic 67	com/tencent/midas/control/APMidasPayHelper:g	I
    //   107: ldc 88
    //   109: new 90	java/lang/StringBuilder
    //   112: dup
    //   113: ldc_w 256
    //   116: invokespecial 95	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   119: getstatic 67	com/tencent/midas/control/APMidasPayHelper:g	I
    //   122: invokevirtual 99	java/lang/StringBuilder:append	(I)Ljava/lang/StringBuilder;
    //   125: invokevirtual 103	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   128: invokestatic 108	com/tencent/midas/comm/APLog:i	(Ljava/lang/String;Ljava/lang/String;)V
    //   131: aload_3
    //   132: monitorexit
    //   133: getstatic 74	com/tencent/midas/control/APMidasPayHelper:i	Ljava/lang/Object;
    //   136: astore_0
    //   137: aload_0
    //   138: monitorenter
    //   139: getstatic 74	com/tencent/midas/control/APMidasPayHelper:i	Ljava/lang/Object;
    //   142: invokevirtual 259	java/lang/Object:notify	()V
    //   145: aload_0
    //   146: monitorexit
    //   147: return
    //   148: iconst_1
    //   149: putstatic 67	com/tencent/midas/control/APMidasPayHelper:g	I
    //   152: aload_0
    //   153: invokestatic 264	com/tencent/midas/plugin/APPluginStatic:preCreateClassLoaderByPath	(Landroid/content/Context;)V
    //   156: goto -49 -> 107
    //   159: astore_0
    //   160: aload_0
    //   161: invokevirtual 186	java/lang/Exception:printStackTrace	()V
    //   164: goto -57 -> 107
    //   167: astore_0
    //   168: aload_3
    //   169: monitorexit
    //   170: aload_0
    //   171: athrow
    //   172: astore_3
    //   173: aload_0
    //   174: monitorexit
    //   175: aload_3
    //   176: athrow
    // Local variable table:
    //   start	length	slot	name	signature
    //   62	38	1	k	int
    //   4	60	2	bool	boolean
    //   96	73	3	localObject1	Object
    //   172	4	3	localObject2	Object
    // Exception table:
    //   from	to	target	type
    //   152	156	159	java/lang/Exception
    //   103	107	167	finally
    //   107	133	167	finally
    //   148	152	167	finally
    //   152	156	167	finally
    //   160	164	167	finally
    //   168	170	167	finally
    //   139	147	172	finally
    //   173	175	172	finally
  }
  
  public static String getJSContent(Context paramContext)
  {
    try
    {
      APLog.i("APMidasPayHelper", "h5Init");
      init(paramContext);
      paramContext = (String)new APMidasPayHelper().callWithContext(paramContext, "getH5JS", new Object[] { paramContext });
      return paramContext;
    }
    finally
    {
      paramContext = finally;
      throw paramContext;
    }
  }
  
  /* Error */
  public static void h5Init(Activity paramActivity, WebView paramWebView)
  {
    // Byte code:
    //   0: ldc 2
    //   2: monitorenter
    //   3: ldc 88
    //   5: ldc_w 268
    //   8: invokestatic 108	com/tencent/midas/comm/APLog:i	(Ljava/lang/String;Ljava/lang/String;)V
    //   11: aload_0
    //   12: invokestatic 271	com/tencent/midas/control/APMidasPayHelper:init	(Landroid/content/Context;)V
    //   15: new 2	com/tencent/midas/control/APMidasPayHelper
    //   18: dup
    //   19: invokespecial 272	com/tencent/midas/control/APMidasPayHelper:<init>	()V
    //   22: aload_0
    //   23: ldc_w 274
    //   26: iconst_1
    //   27: anewarray 4	java/lang/Object
    //   30: dup
    //   31: iconst_0
    //   32: aload_0
    //   33: aastore
    //   34: invokevirtual 285	com/tencent/midas/control/APMidasPayHelper:call	(Landroid/app/Activity;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/Object;
    //   37: checkcast 280	java/lang/String
    //   40: astore_0
    //   41: aload_0
    //   42: invokestatic 291	android/text/TextUtils:isEmpty	(Ljava/lang/CharSequence;)Z
    //   45: istore_2
    //   46: iload_2
    //   47: ifne +24 -> 71
    //   50: aload_1
    //   51: new 90	java/lang/StringBuilder
    //   54: dup
    //   55: ldc_w 293
    //   58: invokespecial 95	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   61: aload_0
    //   62: invokevirtual 296	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   65: invokevirtual 103	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   68: invokevirtual 301	android/webkit/WebView:loadUrl	(Ljava/lang/String;)V
    //   71: ldc 2
    //   73: monitorexit
    //   74: return
    //   75: astore_0
    //   76: ldc 88
    //   78: new 90	java/lang/StringBuilder
    //   81: dup
    //   82: ldc_w 303
    //   85: invokespecial 95	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   88: aload_0
    //   89: invokevirtual 304	java/lang/Exception:toString	()Ljava/lang/String;
    //   92: invokevirtual 296	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   95: invokevirtual 103	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   98: invokestatic 307	com/tencent/midas/comm/APLog:w	(Ljava/lang/String;Ljava/lang/String;)V
    //   101: goto -30 -> 71
    //   104: astore_0
    //   105: ldc 2
    //   107: monitorexit
    //   108: aload_0
    //   109: athrow
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	110	0	paramActivity	Activity
    //   0	110	1	paramWebView	WebView
    //   45	2	2	bool	boolean
    // Exception table:
    //   from	to	target	type
    //   50	71	75	java/lang/Exception
    //   3	46	104	finally
    //   50	71	104	finally
    //   76	101	104	finally
  }
  
  public static void init(Context paramContext)
  {
    try
    {
      APLog.i("APMidasPayHelper", "init initCount:" + f);
      if (f < 1)
      {
        APPluginUtils.release();
        b(paramContext);
      }
      f += 1;
      return;
    }
    finally {}
  }
  
  public static void midasCallBack(APMidasResponse paramAPMidasResponse)
  {
    if (d != null) {
      d.MidasPayCallBack(paramAPMidasResponse);
    }
    APPluginUtils.release();
  }
  
  public static void midasH5CallBack(String paramString)
  {
    APLog.i("APMidasPayHelper", "midasH5CallBack params:" + paramString);
    if (j != null) {}
    try
    {
      j.loadUrl(paramString);
      APPluginUtils.release();
      return;
    }
    catch (Exception paramString)
    {
      for (;;)
      {
        APLog.w("APMidasPayHelper", "midasH5CallBack error:" + paramString.toString());
      }
    }
  }
  
  public static void midasLoginExpire()
  {
    if (d != null) {
      d.MidasPayNeedLogin();
    }
    APPluginUtils.release();
  }
  
  public static void onNetError(String paramString1, Integer paramInteger, String paramString2)
  {
    if (e != null) {
      e.MidasNetError(paramString1, paramInteger.intValue(), paramString2);
    }
  }
  
  public static void onNetFinish(String paramString1, String paramString2)
  {
    if (e != null) {
      e.MidasNetFinish(paramString1, paramString2);
    }
  }
  
  public static void onNetStop(String paramString)
  {
    if (e != null) {
      e.MidasNetStop(paramString);
    }
  }
  
  public Object call(Activity paramActivity, String paramString, Object[] paramArrayOfObject)
  {
    return callWithContext(paramActivity, paramString, paramArrayOfObject);
  }
  
  /* Error */
  public Object callWithContext(Context paramContext, String arg2, Object[] paramArrayOfObject)
  {
    // Byte code:
    //   0: new 173	com/tencent/midas/plugin/APPluginProxyActivity
    //   3: dup
    //   4: invokespecial 174	com/tencent/midas/plugin/APPluginProxyActivity:<init>	()V
    //   7: astore 4
    //   9: aload 4
    //   11: aload_1
    //   12: getstatic 39	com/tencent/midas/control/APMidasPayHelper:MIDAS_PLUGIN_NAME	Ljava/lang/String;
    //   15: getstatic 43	com/tencent/midas/control/APMidasPayHelper:PKG_DISTRIBUTE	Ljava/lang/String;
    //   18: getstatic 55	com/tencent/midas/control/APMidasPayHelper:MED_DISTRIBUTE_CALL	Ljava/lang/String;
    //   21: iconst_2
    //   22: anewarray 4	java/lang/Object
    //   25: dup
    //   26: iconst_0
    //   27: aload_2
    //   28: aastore
    //   29: dup
    //   30: iconst_1
    //   31: aload_3
    //   32: aastore
    //   33: invokevirtual 178	com/tencent/midas/plugin/APPluginProxyActivity:initPluginInterface	(Landroid/content/Context;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/Object;
    //   36: astore_1
    //   37: aload_1
    //   38: ifnonnull +15 -> 53
    //   41: getstatic 72	com/tencent/midas/control/APMidasPayHelper:h	Ljava/lang/Object;
    //   44: astore_2
    //   45: aload_2
    //   46: monitorenter
    //   47: iconst_2
    //   48: putstatic 67	com/tencent/midas/control/APMidasPayHelper:g	I
    //   51: aload_2
    //   52: monitorexit
    //   53: aload_1
    //   54: areturn
    //   55: astore_1
    //   56: aload_1
    //   57: invokevirtual 186	java/lang/Exception:printStackTrace	()V
    //   60: aconst_null
    //   61: astore_1
    //   62: goto -25 -> 37
    //   65: astore_1
    //   66: aload_2
    //   67: monitorexit
    //   68: aload_1
    //   69: athrow
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	70	0	this	APMidasPayHelper
    //   0	70	1	paramContext	Context
    //   0	70	3	paramArrayOfObject	Object[]
    //   7	3	4	localAPPluginProxyActivity	APPluginProxyActivity
    // Exception table:
    //   from	to	target	type
    //   9	37	55	java/lang/Exception
    //   47	53	65	finally
    //   66	68	65	finally
  }
  
  public int h5Pay(Activity paramActivity, WebView paramWebView, String paramString1, String paramString2, JsResult paramJsResult)
  {
    j = paramWebView;
    APLog.i("APMidasPayHelper", "h5Pay msg:" + paramString2);
    if ((!TextUtils.isEmpty(paramString2)) && (paramString2.startsWith("midas_js_bridge_"))) {
      return a(paramActivity, paramWebView, paramString1, paramString2, paramJsResult, MED_DISTRIBUTE_H5PAY);
    }
    return -2;
  }
  
  public int net(Activity paramActivity, APMidasNetRequest paramAPMidasNetRequest, IAPMidasNetCallBack paramIAPMidasNetCallBack)
  {
    e = paramIAPMidasNetCallBack;
    return a(paramActivity, paramAPMidasNetRequest, MED_DISTRIBUTE_NET);
  }
  
  public int pay(Activity paramActivity, APMidasBaseRequest paramAPMidasBaseRequest, IAPMidasPayCallBack paramIAPMidasPayCallBack)
  {
    d = paramIAPMidasPayCallBack;
    return a(paramActivity, paramAPMidasBaseRequest, MED_DISTRIBUTE_PAY);
  }
  
  public void setEnv(String paramString)
  {
    String str = paramString;
    if (!"release".equals(paramString))
    {
      str = paramString;
      if (!"test".equals(paramString))
      {
        str = paramString;
        if (!"dev".equals(paramString))
        {
          str = paramString;
          if (!"debug".equals(paramString)) {
            str = "release";
          }
        }
      }
    }
    this.b = str;
  }
  
  public void setLogEnable(boolean paramBoolean)
  {
    this.c = paramBoolean;
  }
  
  public void setScreenType(int paramInt)
  {
    this.screenType = paramInt;
  }
}
