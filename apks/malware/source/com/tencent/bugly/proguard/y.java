package com.tencent.bugly.proguard;

import android.content.Context;
import com.tencent.bugly.crashreport.common.strategy.c;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.Iterator;
import java.util.List;

public final class y
{
  private r a;
  private l b;
  private c c;
  
  public y(Context paramContext, r paramR, l paramL, c paramC)
  {
    this.a = paramR;
    this.b = paramL;
    this.c = paramC;
  }
  
  private x a(List<w> paramList, x paramX)
  {
    if ((paramList == null) || (paramList.size() == 0))
    {
      paramList = paramX;
      return paramList;
    }
    Object localObject1 = null;
    Object localObject2 = new ArrayList(10);
    Object localObject3 = paramList.iterator();
    w localW;
    while (((Iterator)localObject3).hasNext())
    {
      localW = (w)((Iterator)localObject3).next();
      if (localW.e) {
        ((List)localObject2).add(localW);
      }
    }
    if (((List)localObject2).size() > 0)
    {
      localObject3 = this.b.b((List)localObject2);
      if ((localObject3 != null) && (((List)localObject3).size() > 0))
      {
        Collections.sort((List)localObject3);
        int i = 0;
        while (i < ((List)localObject3).size())
        {
          localObject2 = (x)((List)localObject3).get(i);
          if (i == 0)
          {
            localObject1 = localObject2;
            label157:
            i += 1;
          }
          else
          {
            if (((x)localObject2).s == null) {
              break label538;
            }
            localObject2 = ((x)localObject2).s.split("\n");
            if (localObject2 == null) {
              break label538;
            }
            int k = localObject2.length;
            int j = 0;
            while (j < k)
            {
              localW = localObject2[j];
              if (!((x)localObject1).s.contains(localW))
              {
                ((x)localObject1).t += 1;
                ((x)localObject1).s = (((x)localObject1).s + localW + "\n");
              }
              j += 1;
            }
          }
        }
      }
    }
    for (;;)
    {
      if (localObject1 == null)
      {
        paramX.j = true;
        paramX.t = 0;
        paramX.s = "";
        localObject1 = paramX;
      }
      for (;;)
      {
        paramList = paramList.iterator();
        while (paramList.hasNext())
        {
          localObject2 = (w)paramList.next();
          if ((!((w)localObject2).e) && (!((w)localObject2).d) && (!((x)localObject1).s.contains(((w)localObject2).b)))
          {
            ((x)localObject1).t += 1;
            ((x)localObject1).s = (((x)localObject1).s + ((w)localObject2).b + "\n");
          }
        }
        paramList = (List<w>)localObject1;
        if (((x)localObject1).r == paramX.r) {
          break;
        }
        paramList = (List<w>)localObject1;
        if (((x)localObject1).s.contains(paramX.r)) {
          break;
        }
        ((x)localObject1).t += 1;
        ((x)localObject1).s = (((x)localObject1).s + paramX.r + "\n");
        return localObject1;
      }
      label538:
      break label157;
      localObject1 = null;
    }
  }
  
  private static List<w> a(List<w> paramList)
  {
    if ((paramList == null) || (paramList.size() == 0)) {
      return null;
    }
    long l = a.n();
    ArrayList localArrayList = new ArrayList();
    paramList = paramList.iterator();
    while (paramList.hasNext())
    {
      w localW = (w)paramList.next();
      if ((localW.d) && (localW.b < l - 86400000L)) {
        localArrayList.add(localW);
      }
    }
    return localArrayList;
  }
  
  public final void a(x paramX)
  {
    this.c.a(paramX);
    Object localObject3 = this.b.c();
    Object localObject2 = null;
    Object localObject1 = localObject2;
    if (localObject3 != null)
    {
      localObject1 = localObject2;
      if (((List)localObject3).size() > 0)
      {
        localObject1 = new ArrayList(10);
        localObject2 = new ArrayList(10);
        ((List)localObject1).addAll(a((List)localObject3));
        ((List)localObject3).removeAll((Collection)localObject1);
        localObject3 = ((List)localObject3).iterator();
        int j;
        for (int i = 0; ((Iterator)localObject3).hasNext(); i = j)
        {
          w localW = (w)((Iterator)localObject3).next();
          j = i;
          if (paramX.u.equals(localW.c))
          {
            if (localW.e) {
              i = 1;
            }
            ((List)localObject2).add(localW);
            j = i;
          }
        }
        if ((i != 0) || (((List)localObject2).size() + 1 >= 5))
        {
          u.a("same crash occur too much do merged!", new Object[0]);
          paramX = a((List)localObject2, paramX);
          paramX.a = -1L;
          this.b.a(paramX);
          ((List)localObject1).addAll((Collection)localObject2);
          paramX = this.b;
          l.c((List)localObject1);
          return;
        }
      }
    }
    paramX.l = 1;
    this.b.a(paramX);
    localObject2 = this.b;
    l.c((List)localObject1);
    u.a("try to upload right now", new Object[0]);
    localObject1 = new ArrayList();
    ((List)localObject1).add(paramX);
    this.a.a((List)localObject1, this.c, 5000L);
  }
}
