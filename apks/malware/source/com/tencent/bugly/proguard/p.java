package com.tencent.bugly.proguard;

import android.content.Context;
import android.net.Proxy;
import java.io.IOException;
import java.util.Locale;
import java.util.Map;
import org.apache.http.Header;
import org.apache.http.HttpEntity;
import org.apache.http.HttpHost;
import org.apache.http.HttpResponse;
import org.apache.http.StatusLine;
import org.apache.http.client.HttpClient;
import org.apache.http.client.HttpRequestRetryHandler;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.params.BasicHttpParams;
import org.apache.http.params.HttpConnectionParams;
import org.apache.http.params.HttpParams;
import org.apache.http.protocol.HttpContext;

public final class p
{
  private Context a;
  
  public p(Context paramContext)
  {
    this.a = paramContext.getApplicationContext();
  }
  
  /* Error */
  private HttpResponse a(String paramString1, byte[] paramArrayOfByte, String paramString2, Map<String, String> paramMap)
  {
    // Byte code:
    //   0: aconst_null
    //   1: astore 6
    //   3: aload_1
    //   4: ifnonnull +17 -> 21
    //   7: ldc 27
    //   9: iconst_0
    //   10: anewarray 4	java/lang/Object
    //   13: invokestatic 33	com/tencent/bugly/proguard/u:c	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   16: pop
    //   17: aconst_null
    //   18: astore_1
    //   19: aload_1
    //   20: areturn
    //   21: aload_2
    //   22: ifnull +37 -> 59
    //   25: new 35	org/apache/http/entity/ByteArrayEntity
    //   28: dup
    //   29: aload_2
    //   30: invokespecial 38	org/apache/http/entity/ByteArrayEntity:<init>	([B)V
    //   33: astore 5
    //   35: aload_0
    //   36: aload_3
    //   37: invokespecial 41	com/tencent/bugly/proguard/p:a	(Ljava/lang/String;)Lorg/apache/http/client/HttpClient;
    //   40: astore 7
    //   42: aload 7
    //   44: ifnonnull +130 -> 174
    //   47: ldc 43
    //   49: iconst_0
    //   50: anewarray 4	java/lang/Object
    //   53: invokestatic 33	com/tencent/bugly/proguard/u:c	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   56: pop
    //   57: aconst_null
    //   58: areturn
    //   59: new 35	org/apache/http/entity/ByteArrayEntity
    //   62: dup
    //   63: ldc 45
    //   65: invokevirtual 51	java/lang/String:getBytes	()[B
    //   68: invokespecial 38	org/apache/http/entity/ByteArrayEntity:<init>	([B)V
    //   71: astore 5
    //   73: goto -38 -> 35
    //   76: astore 4
    //   78: aconst_null
    //   79: astore_2
    //   80: aload 6
    //   82: astore_3
    //   83: aload 4
    //   85: invokestatic 54	com/tencent/bugly/proguard/u:a	(Ljava/lang/Throwable;)Z
    //   88: ifne +8 -> 96
    //   91: aload 4
    //   93: invokevirtual 57	java/lang/Throwable:printStackTrace	()V
    //   96: new 59	java/lang/StringBuilder
    //   99: dup
    //   100: invokespecial 60	java/lang/StringBuilder:<init>	()V
    //   103: aload 4
    //   105: invokevirtual 64	java/lang/Object:getClass	()Ljava/lang/Class;
    //   108: invokevirtual 70	java/lang/Class:getName	()Ljava/lang/String;
    //   111: invokevirtual 74	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   114: ldc 76
    //   116: invokevirtual 74	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   119: aload 4
    //   121: invokevirtual 79	java/lang/Throwable:getMessage	()Ljava/lang/String;
    //   124: invokevirtual 74	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   127: invokevirtual 82	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   130: astore 4
    //   132: invokestatic 87	com/tencent/bugly/crashreport/common/strategy/c:a	()Lcom/tencent/bugly/crashreport/common/strategy/c;
    //   135: new 59	java/lang/StringBuilder
    //   138: dup
    //   139: invokespecial 60	java/lang/StringBuilder:<init>	()V
    //   142: aload_1
    //   143: invokevirtual 74	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   146: ldc 89
    //   148: invokevirtual 74	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   151: aload 4
    //   153: invokevirtual 74	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   156: invokevirtual 82	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   159: invokevirtual 93	com/tencent/bugly/crashreport/common/strategy/c:b	(Ljava/lang/String;)V
    //   162: aload_2
    //   163: astore_1
    //   164: aload_3
    //   165: ifnull -146 -> 19
    //   168: aload_3
    //   169: invokevirtual 98	org/apache/http/client/methods/HttpPost:abort	()V
    //   172: aload_2
    //   173: areturn
    //   174: new 95	org/apache/http/client/methods/HttpPost
    //   177: dup
    //   178: aload_1
    //   179: invokespecial 100	org/apache/http/client/methods/HttpPost:<init>	(Ljava/lang/String;)V
    //   182: astore_2
    //   183: aload_2
    //   184: ldc 102
    //   186: ldc 104
    //   188: invokevirtual 108	org/apache/http/client/methods/HttpPost:setHeader	(Ljava/lang/String;Ljava/lang/String;)V
    //   191: aload_2
    //   192: aload 5
    //   194: invokevirtual 112	org/apache/http/client/methods/HttpPost:setEntity	(Lorg/apache/http/HttpEntity;)V
    //   197: aload 4
    //   199: ifnull +109 -> 308
    //   202: aload 4
    //   204: invokeinterface 118 1 0
    //   209: ifle +99 -> 308
    //   212: aload 4
    //   214: invokeinterface 122 1 0
    //   219: invokeinterface 128 1 0
    //   224: astore 4
    //   226: aload 4
    //   228: invokeinterface 134 1 0
    //   233: ifeq +42 -> 275
    //   236: aload 4
    //   238: invokeinterface 138 1 0
    //   243: checkcast 140	java/util/Map$Entry
    //   246: astore 5
    //   248: aload_2
    //   249: aload 5
    //   251: invokeinterface 143 1 0
    //   256: checkcast 47	java/lang/String
    //   259: aload 5
    //   261: invokeinterface 146 1 0
    //   266: checkcast 47	java/lang/String
    //   269: invokevirtual 108	org/apache/http/client/methods/HttpPost:setHeader	(Ljava/lang/String;Ljava/lang/String;)V
    //   272: goto -46 -> 226
    //   275: aload_2
    //   276: ldc -108
    //   278: aload_3
    //   279: invokevirtual 108	org/apache/http/client/methods/HttpPost:setHeader	(Ljava/lang/String;Ljava/lang/String;)V
    //   282: aload_2
    //   283: ldc -106
    //   285: new 59	java/lang/StringBuilder
    //   288: dup
    //   289: invokespecial 60	java/lang/StringBuilder:<init>	()V
    //   292: aload_0
    //   293: getfield 21	com/tencent/bugly/proguard/p:a	Landroid/content/Context;
    //   296: invokestatic 156	com/tencent/bugly/proguard/a:j	(Landroid/content/Context;)Ljava/lang/String;
    //   299: invokevirtual 74	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   302: invokevirtual 82	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   305: invokevirtual 108	org/apache/http/client/methods/HttpPost:setHeader	(Ljava/lang/String;Ljava/lang/String;)V
    //   308: new 158	org/apache/http/protocol/BasicHttpContext
    //   311: dup
    //   312: invokespecial 159	org/apache/http/protocol/BasicHttpContext:<init>	()V
    //   315: astore_3
    //   316: aload 7
    //   318: aload_2
    //   319: aload_3
    //   320: invokeinterface 165 3 0
    //   325: astore 5
    //   327: aload_3
    //   328: ldc -89
    //   330: invokeinterface 173 2 0
    //   335: checkcast 175	org/apache/http/HttpRequest
    //   338: invokeinterface 179 1 0
    //   343: invokevirtual 180	java/lang/Object:toString	()Ljava/lang/String;
    //   346: pop
    //   347: invokestatic 182	com/tencent/bugly/proguard/u:a	()Z
    //   350: pop
    //   351: aload_2
    //   352: invokevirtual 98	org/apache/http/client/methods/HttpPost:abort	()V
    //   355: aload 5
    //   357: areturn
    //   358: astore_1
    //   359: aconst_null
    //   360: astore_2
    //   361: aload_2
    //   362: ifnull +7 -> 369
    //   365: aload_2
    //   366: invokevirtual 98	org/apache/http/client/methods/HttpPost:abort	()V
    //   369: aload_1
    //   370: athrow
    //   371: astore_1
    //   372: goto -11 -> 361
    //   375: astore_1
    //   376: aload_3
    //   377: astore_2
    //   378: goto -17 -> 361
    //   381: astore 4
    //   383: aload_2
    //   384: astore_3
    //   385: aload 5
    //   387: astore_2
    //   388: goto -305 -> 83
    //   391: astore 4
    //   393: aconst_null
    //   394: astore 5
    //   396: aload_2
    //   397: astore_3
    //   398: aload 5
    //   400: astore_2
    //   401: goto -318 -> 83
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	404	0	this	p
    //   0	404	1	paramString1	String
    //   0	404	2	paramArrayOfByte	byte[]
    //   0	404	3	paramString2	String
    //   0	404	4	paramMap	Map<String, String>
    //   33	366	5	localObject1	Object
    //   1	80	6	localObject2	Object
    //   40	277	7	localHttpClient	HttpClient
    // Exception table:
    //   from	to	target	type
    //   25	35	76	java/lang/Throwable
    //   35	42	76	java/lang/Throwable
    //   47	57	76	java/lang/Throwable
    //   59	73	76	java/lang/Throwable
    //   174	183	76	java/lang/Throwable
    //   25	35	358	finally
    //   35	42	358	finally
    //   47	57	358	finally
    //   59	73	358	finally
    //   174	183	358	finally
    //   183	197	371	finally
    //   202	226	371	finally
    //   226	272	371	finally
    //   275	308	371	finally
    //   308	327	371	finally
    //   327	351	371	finally
    //   83	96	375	finally
    //   96	162	375	finally
    //   327	351	381	java/lang/Throwable
    //   183	197	391	java/lang/Throwable
    //   202	226	391	java/lang/Throwable
    //   226	272	391	java/lang/Throwable
    //   275	308	391	java/lang/Throwable
    //   308	327	391	java/lang/Throwable
  }
  
  private HttpClient a(String paramString)
  {
    try
    {
      Object localObject = new BasicHttpParams();
      HttpConnectionParams.setConnectionTimeout((HttpParams)localObject, 30000);
      HttpConnectionParams.setSoTimeout((HttpParams)localObject, 10000);
      HttpConnectionParams.setSocketBufferSize((HttpParams)localObject, 2000);
      ((BasicHttpParams)localObject).setBooleanParameter("http.protocol.handle-redirects", false);
      localObject = new DefaultHttpClient((HttpParams)localObject);
      ((DefaultHttpClient)localObject).setHttpRequestRetryHandler(new HttpRequestRetryHandler()
      {
        public final boolean retryRequest(IOException paramAnonymousIOException, int paramAnonymousInt, HttpContext paramAnonymousHttpContext)
        {
          return false;
        }
      });
      if ((paramString != null) && (paramString.toLowerCase(Locale.US).contains("wap")))
      {
        u.a();
        paramString = new HttpHost(Proxy.getDefaultHost(), Proxy.getDefaultPort());
        ((DefaultHttpClient)localObject).getParams().setParameter("http.route.default-proxy", paramString);
        return localObject;
      }
      ((DefaultHttpClient)localObject).getParams().removeParameter("http.route.default-proxy");
      return localObject;
    }
    catch (Throwable paramString)
    {
      if (!u.a(paramString)) {
        paramString.printStackTrace();
      }
    }
    return null;
  }
  
  /* Error */
  private static byte[] a(HttpResponse paramHttpResponse)
  {
    // Byte code:
    //   0: aload_0
    //   1: ifnonnull +5 -> 6
    //   4: aconst_null
    //   5: areturn
    //   6: aload_0
    //   7: invokeinterface 269 1 0
    //   12: invokeinterface 274 1 0
    //   17: istore_1
    //   18: iload_1
    //   19: sipush 200
    //   22: if_icmpeq +32 -> 54
    //   25: ldc_w 276
    //   28: iconst_2
    //   29: anewarray 4	java/lang/Object
    //   32: dup
    //   33: iconst_0
    //   34: iload_1
    //   35: invokestatic 282	java/lang/Integer:valueOf	(I)Ljava/lang/Integer;
    //   38: aastore
    //   39: dup
    //   40: iconst_1
    //   41: aload_0
    //   42: invokeinterface 269 1 0
    //   47: aastore
    //   48: invokestatic 284	com/tencent/bugly/proguard/u:b	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   51: pop
    //   52: aconst_null
    //   53: areturn
    //   54: aload_0
    //   55: invokeinterface 288 1 0
    //   60: astore_0
    //   61: aload_0
    //   62: ifnonnull +16 -> 78
    //   65: ldc_w 290
    //   68: iconst_0
    //   69: anewarray 4	java/lang/Object
    //   72: invokestatic 33	com/tencent/bugly/proguard/u:c	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   75: pop
    //   76: aconst_null
    //   77: areturn
    //   78: new 292	java/io/BufferedInputStream
    //   81: dup
    //   82: new 294	java/io/DataInputStream
    //   85: dup
    //   86: aload_0
    //   87: invokeinterface 300 1 0
    //   92: invokespecial 303	java/io/DataInputStream:<init>	(Ljava/io/InputStream;)V
    //   95: invokespecial 304	java/io/BufferedInputStream:<init>	(Ljava/io/InputStream;)V
    //   98: astore_2
    //   99: aload_2
    //   100: astore_0
    //   101: new 306	java/io/ByteArrayOutputStream
    //   104: dup
    //   105: invokespecial 307	java/io/ByteArrayOutputStream:<init>	()V
    //   108: astore_3
    //   109: aload_2
    //   110: astore_0
    //   111: aload_2
    //   112: invokevirtual 310	java/io/BufferedInputStream:read	()I
    //   115: istore_1
    //   116: iload_1
    //   117: iconst_m1
    //   118: if_icmpeq +46 -> 164
    //   121: aload_2
    //   122: astore_0
    //   123: aload_3
    //   124: iload_1
    //   125: invokevirtual 314	java/io/ByteArrayOutputStream:write	(I)V
    //   128: goto -19 -> 109
    //   131: astore_3
    //   132: aload_2
    //   133: astore_0
    //   134: aload_3
    //   135: invokestatic 54	com/tencent/bugly/proguard/u:a	(Ljava/lang/Throwable;)Z
    //   138: ifne +9 -> 147
    //   141: aload_2
    //   142: astore_0
    //   143: aload_3
    //   144: invokevirtual 57	java/lang/Throwable:printStackTrace	()V
    //   147: aload_2
    //   148: ifnull -144 -> 4
    //   151: aload_2
    //   152: invokevirtual 317	java/io/BufferedInputStream:close	()V
    //   155: aconst_null
    //   156: areturn
    //   157: astore_0
    //   158: aload_0
    //   159: invokevirtual 57	java/lang/Throwable:printStackTrace	()V
    //   162: aconst_null
    //   163: areturn
    //   164: aload_2
    //   165: astore_0
    //   166: aload_3
    //   167: invokevirtual 320	java/io/ByteArrayOutputStream:flush	()V
    //   170: aload_2
    //   171: astore_0
    //   172: aload_3
    //   173: invokevirtual 323	java/io/ByteArrayOutputStream:toByteArray	()[B
    //   176: astore_3
    //   177: aload_2
    //   178: invokevirtual 317	java/io/BufferedInputStream:close	()V
    //   181: aload_3
    //   182: areturn
    //   183: astore_0
    //   184: aload_0
    //   185: invokevirtual 57	java/lang/Throwable:printStackTrace	()V
    //   188: aload_3
    //   189: areturn
    //   190: astore_2
    //   191: aconst_null
    //   192: astore_0
    //   193: aload_0
    //   194: ifnull +7 -> 201
    //   197: aload_0
    //   198: invokevirtual 317	java/io/BufferedInputStream:close	()V
    //   201: aload_2
    //   202: athrow
    //   203: astore_0
    //   204: aload_0
    //   205: invokevirtual 57	java/lang/Throwable:printStackTrace	()V
    //   208: goto -7 -> 201
    //   211: astore_2
    //   212: goto -19 -> 193
    //   215: astore_3
    //   216: aconst_null
    //   217: astore_2
    //   218: goto -86 -> 132
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	221	0	paramHttpResponse	HttpResponse
    //   17	108	1	i	int
    //   98	80	2	localBufferedInputStream	java.io.BufferedInputStream
    //   190	12	2	localObject1	Object
    //   211	1	2	localObject2	Object
    //   217	1	2	localObject3	Object
    //   108	16	3	localByteArrayOutputStream	java.io.ByteArrayOutputStream
    //   131	42	3	localThrowable1	Throwable
    //   176	13	3	arrayOfByte	byte[]
    //   215	1	3	localThrowable2	Throwable
    // Exception table:
    //   from	to	target	type
    //   101	109	131	java/lang/Throwable
    //   111	116	131	java/lang/Throwable
    //   123	128	131	java/lang/Throwable
    //   166	170	131	java/lang/Throwable
    //   172	177	131	java/lang/Throwable
    //   151	155	157	java/lang/Throwable
    //   177	181	183	java/lang/Throwable
    //   78	99	190	finally
    //   197	201	203	java/lang/Throwable
    //   101	109	211	finally
    //   111	116	211	finally
    //   123	128	211	finally
    //   134	141	211	finally
    //   143	147	211	finally
    //   166	170	211	finally
    //   172	177	211	finally
    //   78	99	215	java/lang/Throwable
  }
  
  public final byte[] a(String paramString, byte[] paramArrayOfByte, q paramQ, Map<String, String> paramMap)
  {
    if (paramString == null)
    {
      u.c("rqdp{  no destUrl!}", new Object[0]);
      return null;
    }
    int m = 0;
    long l2;
    int k;
    int i;
    if (paramArrayOfByte == null)
    {
      l2 = 0L;
      u.a();
      k = 0;
      i = 0;
    }
    for (;;)
    {
      label37:
      int j = i + 1;
      if ((i >= 3) || (m >= 2)) {
        break label494;
      }
      if (k != 0) {
        i = 0;
      }
      for (;;)
      {
        String str = a.j(this.a);
        if (str != null) {
          break label167;
        }
        u.b("req but network not avail,so drop!", new Object[0]);
        k = i;
        i = j;
        break label37;
        l2 = paramArrayOfByte.length;
        break;
        i = k;
        if (j > 1)
        {
          new StringBuilder("try time ").append(j).toString();
          u.a();
          try
          {
            Thread.sleep(10000L);
            i = k;
          }
          catch (InterruptedException localInterruptedException)
          {
            localInterruptedException.printStackTrace();
            i = k;
          }
        }
      }
      label167:
      if (paramQ != null) {
        paramQ.a(l2);
      }
      HttpResponse localHttpResponse = a(paramString, paramArrayOfByte, localInterruptedException, paramMap);
      if (localHttpResponse != null)
      {
        HttpEntity localHttpEntity = localHttpResponse.getEntity();
        int i1 = localHttpResponse.getStatusLine().getStatusCode();
        if (i1 == 200)
        {
          paramString = a(localHttpResponse);
          if (paramQ != null) {
            if (paramString != null) {
              break label254;
            }
          }
          label254:
          for (l1 = 0L;; l1 = paramString.length)
          {
            paramQ.b(l1);
            return paramString;
          }
        }
        if ((i1 == 301) || (i1 == 302) || (i1 == 303) || (i1 == 307)) {}
        for (k = 1;; k = 0)
        {
          n = m;
          if (k == 0) {
            break label384;
          }
          i = 1;
          paramString = localHttpResponse.getFirstHeader("Location");
          if (paramString != null) {
            break;
          }
          u.c("rqdp{  redirect code:}" + i1 + "rqdp{   Location is null! return}", new Object[0]);
          return null;
        }
        int n = m + 1;
        j = 0;
        paramString = paramString.getValue();
        u.a();
        label384:
        u.b("response code " + i1, new Object[0]);
        long l1 = 0L;
        if (localHttpEntity != null)
        {
          long l3 = localHttpEntity.getContentLength();
          l1 = l3;
          if (l3 < 0L) {
            l1 = 0L;
          }
        }
        if (paramQ != null) {
          paramQ.b(l1);
        }
        k = i;
        m = n;
        i = j;
      }
      else
      {
        u.a();
        if (paramQ != null) {
          paramQ.b(0L);
        }
        k = i;
        i = j;
      }
    }
    label494:
    return null;
  }
}
