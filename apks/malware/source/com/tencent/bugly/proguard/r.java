package com.tencent.bugly.proguard;

import android.content.Context;
import com.tencent.bugly.crashreport.common.strategy.b;
import com.tencent.bugly.crashreport.common.strategy.c;
import com.tencent.bugly.crashreport.common.strategy.d;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;

public final class r
{
  private static r a = null;
  private final t b;
  private final n c;
  private final l d;
  private final p e;
  private final Context f;
  private long[] g = { -1L, -1L, -1L };
  
  private r(Context paramContext, t paramT, n paramN, p paramP, l paramL)
  {
    this.f = paramContext;
    this.b = paramT;
    this.c = paramN;
    this.d = paramL;
    this.e = paramP;
  }
  
  public static r a()
  {
    try
    {
      r localR = a;
      return localR;
    }
    finally
    {
      localObject = finally;
      throw localObject;
    }
  }
  
  public static r a(Context paramContext, t paramT, n paramN, l paramL)
  {
    try
    {
      if (a == null) {
        a = new r(paramContext, paramT, paramN, new p(paramContext), paramL);
      }
      paramContext = a;
      return paramContext;
    }
    finally {}
  }
  
  private void a(final List<d> paramList, c paramC, int paramInt, final boolean paramBoolean)
  {
    b localB = paramC.d();
    if ((!localB.e) && (!localB.f)) {
      u.b("remote uin&query is diable!", new Object[0]);
    }
    while ((paramList == null) || (paramList.size() == 0)) {
      return;
    }
    label114:
    T localT;
    for (;;)
    {
      n localN;
      try
      {
        localN = this.c;
        if (paramList == null) {
          break label817;
        }
        if (paramList.size() != 0) {
          break label114;
        }
      }
      catch (Throwable paramList)
      {
        u.c("req ur error %s", new Object[] { paramList.toString() });
      }
      if (localObject != null) {
        break label737;
      }
      u.b("create uPkg fail!", new Object[0]);
      return;
      if (u.b(paramList)) {
        break;
      }
      paramList.printStackTrace();
      return;
      localT = new T();
      localT.b = localN.B();
      localT.c = localN.l();
      ArrayList localArrayList = new ArrayList();
      Iterator localIterator = paramList.iterator();
      if (localIterator.hasNext())
      {
        d localD = (d)localIterator.next();
        if (localD == null) {
          localObject = null;
        }
        while (localObject != null)
        {
          localArrayList.add(localObject);
          break;
          localObject = new S();
          ((S)localObject).a = localD.e;
          ((S)localObject).d = localD.c;
          ((S)localObject).c = localD.d;
          switch (localD.b)
          {
          case 1: 
            if ((localD.b >= 10) && (localD.b < 20)) {
              ((S)localObject).b = ((byte)localD.b);
            }
          case 3: 
          case 2: 
            for (;;)
            {
              label276:
              int i = ((S)localObject).b;
              u.a();
              break;
              ((S)localObject).b = 1;
              continue;
              ((S)localObject).b = 2;
              continue;
              ((S)localObject).b = 4;
            }
            u.c("unknown uinfo type %d ", new Object[] { Integer.valueOf(localD.b) });
            localObject = null;
          }
        }
      }
      localT.d = localArrayList;
      localT.e = new HashMap();
      localT.e.put("A7", localN.h());
      localT.e.put("A6", localN.v());
      localT.e.put("A5", localN.u());
      localT.e.put("A2", localN.s());
      localT.e.put("A1", localN.s());
      localT.e.put("A24", localN.j());
      localT.e.put("A17", localN.t());
      localT.e.put("A15", localN.x());
      localT.e.put("A13", localN.z());
      switch (paramInt)
      {
      case 1: 
        label696:
        u.c("unknown up type %d ", new Object[] { Integer.valueOf(paramInt) });
        localObject = null;
      }
    }
    localT.a = 1;
    break label829;
    localT.a = 2;
    break label829;
    label737:
    Object localObject = a.a((j)localObject);
    if (localObject == null)
    {
      u.b("send encode fail!", new Object[0]);
      return;
    }
    for (;;)
    {
      label760:
      localObject = a.a(paramInt, (byte[])localObject, this.c, localB);
      this.b.a(new s(this.f, (O)localObject, this.c, paramC, this.e, this)
      {
        protected final void a()
        {
          super.a();
          long l = new Date().getTime();
          r.this.a(2, l);
          if (paramBoolean) {
            r.this.a(1, l);
          }
        }
        
        protected final void a(boolean paramAnonymousBoolean, int paramAnonymousInt, String paramAnonymousString)
        {
          super.a(paramAnonymousBoolean, paramAnonymousInt, paramAnonymousString);
          if ((paramList != null) && (paramList.size() > 0) && (paramAnonymousBoolean))
          {
            u.a();
            long l = new Date().getTime();
            paramAnonymousString = paramList.iterator();
            while (paramAnonymousString.hasNext()) {
              ((d)paramAnonymousString.next()).f = l;
            }
            l.a(r.a(r.this)).e(paramList);
          }
        }
      });
      return;
      label817:
      label829:
      do
      {
        paramInt = 520;
        break label760;
        localObject = null;
        break;
        break label276;
        break label696;
        localObject = localT;
        break;
      } while (!paramBoolean);
      paramInt = 540;
    }
  }
  
  /* Error */
  public final long a(int paramInt)
  {
    // Byte code:
    //   0: aload_0
    //   1: monitorenter
    //   2: iload_1
    //   3: iflt +23 -> 26
    //   6: iload_1
    //   7: aload_0
    //   8: getfield 39	com/tencent/bugly/proguard/r:g	[J
    //   11: arraylength
    //   12: if_icmpge +14 -> 26
    //   15: aload_0
    //   16: getfield 39	com/tencent/bugly/proguard/r:g	[J
    //   19: iload_1
    //   20: laload
    //   21: lstore_2
    //   22: aload_0
    //   23: monitorexit
    //   24: lload_2
    //   25: lreturn
    //   26: ldc_w 270
    //   29: iconst_1
    //   30: anewarray 4	java/lang/Object
    //   33: dup
    //   34: iconst_0
    //   35: iload_1
    //   36: invokestatic 170	java/lang/Integer:valueOf	(I)Ljava/lang/Integer;
    //   39: aastore
    //   40: invokestatic 97	com/tencent/bugly/proguard/u:c	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   43: pop
    //   44: ldc2_w 271
    //   47: lstore_2
    //   48: goto -26 -> 22
    //   51: astore 4
    //   53: aload_0
    //   54: monitorexit
    //   55: aload 4
    //   57: athrow
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	58	0	this	r
    //   0	58	1	paramInt	int
    //   21	27	2	l	long
    //   51	5	4	localObject	Object
    // Exception table:
    //   from	to	target	type
    //   6	22	51	finally
    //   26	44	51	finally
  }
  
  /* Error */
  public final void a(int paramInt, long paramLong)
  {
    // Byte code:
    //   0: aload_0
    //   1: monitorenter
    //   2: iload_1
    //   3: iflt +26 -> 29
    //   6: iload_1
    //   7: aload_0
    //   8: getfield 39	com/tencent/bugly/proguard/r:g	[J
    //   11: arraylength
    //   12: if_icmpge +17 -> 29
    //   15: aload_0
    //   16: getfield 39	com/tencent/bugly/proguard/r:g	[J
    //   19: iload_1
    //   20: lload_2
    //   21: lastore
    //   22: invokestatic 162	com/tencent/bugly/proguard/u:a	()Z
    //   25: pop
    //   26: aload_0
    //   27: monitorexit
    //   28: return
    //   29: ldc_w 270
    //   32: iconst_1
    //   33: anewarray 4	java/lang/Object
    //   36: dup
    //   37: iconst_0
    //   38: iload_1
    //   39: invokestatic 170	java/lang/Integer:valueOf	(I)Ljava/lang/Integer;
    //   42: aastore
    //   43: invokestatic 97	com/tencent/bugly/proguard/u:c	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   46: pop
    //   47: goto -21 -> 26
    //   50: astore 4
    //   52: aload_0
    //   53: monitorexit
    //   54: aload 4
    //   56: athrow
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	57	0	this	r
    //   0	57	1	paramInt	int
    //   0	57	2	paramLong	long
    //   50	5	4	localObject	Object
    // Exception table:
    //   from	to	target	type
    //   6	26	50	finally
    //   29	47	50	finally
  }
  
  protected final void a(long paramLong)
  {
    try
    {
      com.tencent.bugly.crashreport.common.strategy.a localA = new com.tencent.bugly.crashreport.common.strategy.a();
      localA.b = 3;
      localA.e = a.n();
      localA.c = "";
      localA.d = "";
      localA.f = a.a(paramLong);
      l localL = this.d;
      l.b(3);
      this.d.a(localA);
      u.a();
      return;
    }
    finally
    {
      localObject = finally;
      throw localObject;
    }
  }
  
  public final void a(c paramC)
  {
    Object localObject = paramC.d();
    if (!((b)localObject).f) {
      u.b("remote query is disable!", new Object[0]);
    }
    do
    {
      return;
      try
      {
        localObject = a.a(510, null, this.c, (b)localObject);
        this.b.a(new s(this.f, (O)localObject, this.c, paramC, this.e, this)
        {
          protected final void a()
          {
            super.a();
            r.this.a(this.a, new Date().getTime());
          }
        });
        return;
      }
      catch (Throwable paramC)
      {
        u.c("req error %s", new Object[] { paramC.toString() });
      }
    } while (u.b(paramC));
    paramC.printStackTrace();
  }
  
  public final void a(final List<x> paramList, c paramC)
  {
    Object localObject1 = paramC.d();
    if (!((b)localObject1).d) {}
    do
    {
      u.b("remote report is disable!", new Object[0]);
      do
      {
        return;
      } while ((paramList == null) || (paramList.size() == 0));
      try
      {
        localObject2 = a.a(paramList, this.c);
        if (localObject2 != null) {
          break;
        }
        u.b("create eupPkg fail!", new Object[0]);
        return;
      }
      catch (Throwable paramList)
      {
        u.c("req cr error %s", new Object[] { paramList.toString() });
      }
    } while (u.b(paramList));
    paramList.printStackTrace();
    return;
    Object localObject2 = a.a((j)localObject2);
    if (localObject2 == null)
    {
      u.b("send encode fail!", new Object[0]);
      return;
    }
    localObject1 = a.a(530, (byte[])localObject2, this.c, (b)localObject1);
    this.b.a(new s(this.f, (O)localObject1, this.c, paramC, this.e, this)
    {
      protected final void a()
      {
        super.a();
        r.this.a(0, new Date().getTime());
      }
      
      protected final void a(boolean paramAnonymousBoolean, int paramAnonymousInt, String paramAnonymousString)
      {
        super.a(paramAnonymousBoolean, paramAnonymousInt, paramAnonymousString);
        if ((paramList != null) && (paramList.size() > 0))
        {
          long l = new Date().getTime();
          paramAnonymousString = new ArrayList();
          u.a();
          Iterator localIterator = paramList.iterator();
          while (localIterator.hasNext())
          {
            x localX = (x)localIterator.next();
            localX.l += 1;
            localX.d = paramAnonymousBoolean;
            if ((localX.r < l - 86400000L) && (paramAnonymousBoolean))
            {
              localIterator.remove();
              paramAnonymousString.add(localX);
              u.a();
            }
          }
          l.a(r.a(r.this));
          l.d(paramAnonymousString);
          l.a(r.a(r.this)).a(paramList);
        }
      }
    });
  }
  
  public final void a(List<d> paramList, c paramC, int paramInt)
  {
    a(paramList, paramC, paramInt, true);
  }
  
  public final void a(final List<x> paramList, c paramC, long paramLong)
  {
    Object localObject1 = paramC.d();
    if ((paramC.b()) && (!((b)localObject1).d))
    {
      u.c("crash report was closed by remote , will not upload to Bugly!", new Object[0]);
      paramC.a("remoteClose", false);
    }
    do
    {
      do
      {
        return;
      } while ((paramList == null) || (paramList.size() == 0));
      try
      {
        localObject2 = a.a(paramList, this.c);
        if (localObject2 != null) {
          break;
        }
        u.b("create eupPkg fail!", new Object[0]);
        paramC.a("packageFail", false);
        return;
      }
      catch (Throwable paramList)
      {
        u.c("req cr error %s", new Object[] { paramList.toString() });
      }
    } while (u.b(paramList));
    paramList.printStackTrace();
    return;
    Object localObject2 = a.a((j)localObject2);
    if (localObject2 == null)
    {
      u.b("send encode fail!", new Object[0]);
      return;
    }
    u.a("wait for crash report! " + paramList.size(), new Object[0]);
    localObject1 = a.a(530, (byte[])localObject2, this.c, (b)localObject1);
    paramList = new Thread(new s(this.f, (O)localObject1, this.c, paramC, this.e, this)
    {
      protected final void a()
      {
        super.a();
        r.this.a(0, new Date().getTime());
      }
      
      protected final void a(boolean paramAnonymousBoolean, int paramAnonymousInt, String paramAnonymousString)
      {
        super.a(paramAnonymousBoolean, paramAnonymousInt, paramAnonymousString);
        if ((paramList != null) && (paramList.size() > 0))
        {
          long l = new Date().getTime();
          paramAnonymousString = new ArrayList();
          u.a();
          Iterator localIterator = paramList.iterator();
          while (localIterator.hasNext())
          {
            x localX = (x)localIterator.next();
            localX.l += 1;
            localX.d = paramAnonymousBoolean;
            if ((localX.r < l - 86400000L) && (paramAnonymousBoolean))
            {
              localIterator.remove();
              paramAnonymousString.add(localX);
              u.a();
            }
          }
          l.a(r.a(r.this));
          l.d(paramAnonymousString);
          l.a(r.a(r.this)).a(paramList);
        }
      }
    });
    paramList.setName("CrashUploadThread");
    paramList.start();
    paramList.join(5000L);
    u.a("wake up! ", new Object[0]);
  }
  
  protected final long b()
  {
    long l3 = 0L;
    long l4 = a.n();
    List localList = this.d.a(3);
    long l1;
    if ((localList != null) && (localList.size() > 0))
    {
      l1 = l3;
      try
      {
        localObject = (com.tencent.bugly.crashreport.common.strategy.a)localList.get(0);
        l2 = l3;
        l1 = l3;
        if (((com.tencent.bugly.crashreport.common.strategy.a)localObject).e >= l4)
        {
          l1 = l3;
          l2 = a.d(((com.tencent.bugly.crashreport.common.strategy.a)localObject).f);
          l1 = l2;
          localList.remove(localObject);
        }
        l1 = l2;
      }
      catch (Throwable localThrowable)
      {
        for (;;)
        {
          Object localObject;
          u.c("error local type %d", new Object[] { Integer.valueOf(3) });
        }
      }
      l2 = l1;
      if (localList.size() > 0)
      {
        localObject = this.d;
        l.g(localList);
      }
    }
    for (long l2 = l1;; l2 = 0L)
    {
      u.a();
      return l2;
    }
  }
  
  public final void b(List<d> paramList, c paramC, int paramInt)
  {
    a(paramList, paramC, paramInt, false);
  }
}
