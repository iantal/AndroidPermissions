package com.tencent.tmapkupdatesdk.internal.logic.protocol.a;

import android.os.Message;
import com.qq.taf.jce.JceStruct;
import com.tencent.tmapkupdatesdk.internal.logic.protocol.jce.ApkFileInfo;
import com.tencent.tmapkupdatesdk.internal.logic.protocol.jce.ReportApkFileInfoRequest;
import com.tencent.tmapkupdatesdk.internal.logic.protocol.jce.ReportApkFileInfoResponse;
import com.tencent.tmassistantbase.util.TMLog;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

public class b
  extends com.tencent.tmapkupdatesdk.internal.logic.protocol.a
{
  private static String a = "UploadApkHttpRequest";
  private final List b;
  
  public b(List paramList)
  {
    this.b = paramList;
  }
  
  protected void a()
  {
    TMLog.i(a, "enter");
    super.a();
    Object localObject = new ReportApkFileInfoRequest();
    ((ReportApkFileInfoRequest)localObject).apkFileInfoList = ((ArrayList)this.b);
    a((JceStruct)localObject);
    localObject = new StringBuffer("prepareData; apkFileInfoList= [");
    Iterator localIterator = this.b.iterator();
    while (localIterator.hasNext())
    {
      ApkFileInfo localApkFileInfo = (ApkFileInfo)localIterator.next();
      ((StringBuffer)localObject).append("pkgname=" + localApkFileInfo.packageName + ";apkId=" + localApkFileInfo.apkId + "| \n\r");
    }
    TMLog.i(a, ((StringBuffer)localObject).toString() + "]");
    TMLog.i(a, "exit");
  }
  
  protected void a(JceStruct paramJceStruct1, JceStruct paramJceStruct2)
  {
    if ((paramJceStruct2 != null) && ((paramJceStruct2 instanceof ReportApkFileInfoResponse)))
    {
      paramJceStruct2 = (ReportApkFileInfoResponse)paramJceStruct2;
      TMLog.i(a, "onFinished; ret=" + paramJceStruct2.ret);
      if (paramJceStruct2.ret == 0)
      {
        paramJceStruct2 = com.tencent.tmapkupdatesdk.internal.logic.a.a().obtainMessage();
        paramJceStruct2.what = 3;
        paramJceStruct2.sendToTarget();
        TMLog.i(a, "send Message ApkUpdateMessageHandler.UploadApkDetailSucceed");
        if (paramJceStruct1 != null)
        {
          Object localObject = (ReportApkFileInfoRequest)paramJceStruct1;
          paramJceStruct1 = new ArrayList();
          paramJceStruct2 = new StringBuffer("reportedPackageNames = [");
          localObject = ((ReportApkFileInfoRequest)localObject).apkFileInfoList.iterator();
          while (((Iterator)localObject).hasNext())
          {
            ApkFileInfo localApkFileInfo = (ApkFileInfo)((Iterator)localObject).next();
            paramJceStruct1.add(localApkFileInfo.packageName);
            paramJceStruct2.append("pkgname=" + localApkFileInfo.packageName + ";");
          }
          TMLog.i(a, paramJceStruct2.toString() + "]");
          if (paramJceStruct1.size() > 0)
          {
            paramJceStruct2 = com.tencent.tmapkupdatesdk.internal.logic.a.a().obtainMessage();
            paramJceStruct2.what = 8;
            paramJceStruct2.obj = paramJceStruct1;
            paramJceStruct2.sendToTarget();
            TMLog.i(a, "send Message ApkUpdateMessageHandler.UploadApkDetail");
          }
        }
      }
    }
  }
  
  protected void b()
  {
    Message localMessage = com.tencent.tmapkupdatesdk.internal.logic.a.a().obtainMessage();
    localMessage.what = 4;
    localMessage.sendToTarget();
    TMLog.i(a, "send Message ApkUpdateMessageHandler.UploadApkDetailFailed");
  }
}
