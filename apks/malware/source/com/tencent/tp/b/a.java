package com.tencent.tp.b;

import android.content.Context;
import com.tencent.tp.a.d;
import com.tencent.tp.a.d.a;
import com.tencent.tp.a.o;
import com.tencent.tp.c.h;
import com.tencent.tp.j;
import com.tencent.tp.l;

public class a
  implements c.a
{
  private o a;
  private c b;
  private Context c;
  private String d;
  private d.a e = new b(this);
  
  public a(Context paramContext)
  {
    this.c = paramContext;
  }
  
  private String b(int paramInt)
  {
    return String.format("%.2fMB", new Object[] { Double.valueOf(paramInt * 1.0D / 1024.0D / 1024.0D) });
  }
  
  public void a()
  {
    if (this.a != null)
    {
      this.a.a();
      this.a = null;
    }
    try
    {
      String str = h.c("http://dldir1.qq.com/gamesafe/mobile/app/android/tpsafe.apk");
      str = h.c(this.c, str);
      if (h.a(str))
      {
        new com.tencent.tp.c.a(this.c).a(str);
        Thread.sleep(2000L);
        j.b();
        return;
      }
      l.a(str + "not exists");
      return;
    }
    catch (Exception localException)
    {
      l.a(localException.toString());
    }
  }
  
  public void a(int paramInt)
  {
    if (this.a != null)
    {
      this.a.a();
      this.a = null;
    }
    new d(this.c).b("错误", "发生未知错误，错误码：" + paramInt + "。", "确定", null, this.e);
  }
  
  public void a(int paramInt1, int paramInt2)
  {
    if (paramInt2 > 0)
    {
      int i = paramInt1 * 100 / paramInt2;
      if (this.a == null)
      {
        this.a = new o(this.c);
        this.a.a(this.d, null, null);
      }
      if ((this.a != null) && (this.a.b()))
      {
        this.a.a(i);
        this.a.b(b(paramInt1));
        this.a.c("/" + b(paramInt2));
      }
    }
  }
  
  public void a(String paramString)
  {
    this.d = paramString;
    this.a = new o(this.c);
    this.a.a(this.d, null, null);
    this.b = new c(this.c, this, "http://dldir1.qq.com/gamesafe/mobile/app/android/tpsafe.apk");
    this.b.execute(new Void[0]);
  }
  
  public void b()
  {
    if (this.a != null)
    {
      this.a.a();
      this.a = null;
    }
    new d(this.c).b("错误", "系统网络异常，请检查您的网络链接是否正常。", "确定", null, this.e);
  }
  
  public void c()
  {
    if (this.a != null)
    {
      this.a.a();
      this.a = null;
    }
    new d(this.c).b("错误", "文件读写异常，请检查您的手机存储空间是否已满。", "确定", null, this.e);
  }
}
