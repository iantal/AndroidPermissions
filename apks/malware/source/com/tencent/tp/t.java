package com.tencent.tp;

import android.app.Activity;
import android.content.Context;
import android.content.pm.PackageManager;
import android.content.pm.PackageManager.NameNotFoundException;
import com.tencent.tp.a.p;
import com.tencent.tp.b.e;
import com.tencent.tp.b.g;
import com.tencent.tp.b.k;
import com.tencent.tp.b.n;

public class t
{
  private Context a;
  
  public t() {}
  
  private void doInvokeRootkitAppRequest()
    throws Exception
  {
    Activity localActivity = TssSdkRuntime.getCurrentActivity();
    if (localActivity == null) {
      l.a("TssSdkRuntime.getCurrentActivity err");
    }
    boolean bool2;
    boolean bool1;
    do
    {
      return;
      this.a = localActivity;
      bool2 = isRootkitAppInstalled(localActivity);
      bool1 = false;
      if (bool2) {
        bool1 = isRootkitAppRunning();
      }
    } while (((bool2) && (bool1)) && (bool1));
    if (bool2)
    {
      invokeLaunchRootkitAppRequest();
      return;
    }
    invokeInstallRootkitAppRequest();
  }
  
  public static void invokeForceUpdateRootkitAppRequest()
  {
    if (e.a()) {
      return;
    }
    Activity localActivity = TssSdkRuntime.getCurrentActivity();
    if (localActivity == null)
    {
      l.a("TssSdkRuntime.getCurrentActivity err");
      return;
    }
    try
    {
      bool = isRootkitAppInstalled(localActivity);
      if (bool)
      {
        new n(localActivity).a();
        return;
      }
    }
    catch (Exception localException)
    {
      for (;;)
      {
        boolean bool = false;
      }
      invokeRootkitAppRequest();
    }
  }
  
  private void invokeInstallRootkitAppRequest()
  {
    new g(this.a).a();
  }
  
  private void invokeLaunchRootkitAppRequest()
  {
    new k(this.a).execute(new Void[0]);
  }
  
  public static void invokeRootkitAppRequest()
  {
    if (e.a()) {
      return;
    }
    t localT = new t();
    try
    {
      localT.doInvokeRootkitAppRequest();
      return;
    }
    catch (Exception localException)
    {
      l.a(localException.toString());
    }
  }
  
  public static void invokeRootkitIsRunningTip()
  {
    if (e.a()) {
      return;
    }
    Activity localActivity = TssSdkRuntime.getCurrentActivity();
    if (localActivity == null)
    {
      l.a("TssSdkRuntime.getCurrentActivity err");
      return;
    }
    new p(localActivity).b("腾讯游戏安全中心正在保护您的游戏");
  }
  
  public static boolean isApkInstalled(PackageManager paramPackageManager)
  {
    Object localObject = null;
    try
    {
      paramPackageManager = paramPackageManager.getPackageInfo("com.tencent.tpsafe", 64);
      return paramPackageManager != null;
    }
    catch (Exception paramPackageManager)
    {
      for (;;)
      {
        paramPackageManager = localObject;
      }
    }
    catch (PackageManager.NameNotFoundException paramPackageManager)
    {
      for (;;)
      {
        paramPackageManager = localObject;
      }
    }
  }
  
  public static boolean isRootkitAppInstalled(Context paramContext)
    throws Exception
  {
    paramContext = paramContext.getPackageManager();
    if (paramContext == null) {
      throw new Exception("Object not found");
    }
    return isApkInstalled(paramContext);
  }
  
  private boolean isRootkitAppRunning()
  {
    return j.d() == 1;
  }
}
