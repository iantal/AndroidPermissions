package com.zyypt.video.mpdemo.implbyself;

import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.widget.Toast;
import com.zyypt.video.a;
import com.zyypt.video.mpdemo.c;
import java.util.Random;

public class MPDemoReceiver
  extends BroadcastReceiver
{
  private MPDestService a;
  private SharedPreferences b;
  
  public MPDemoReceiver() {}
  
  public MPDemoReceiver(MPDestService paramMPDestService)
  {
    this.a = paramMPDestService;
    this.b = this.a.d();
  }
  
  private int a()
  {
    return this.b.getInt("Icon", 0);
  }
  
  private void a(Context paramContext, Bundle paramBundle)
  {
    String str1 = paramBundle.getString("Title");
    a.a("MSG_TITLE: " + str1);
    String str2 = paramBundle.getString("Summary");
    a.a("MSG_SUMMARY: " + str2);
    paramBundle = paramBundle.getString("MsgUri");
    a.a("MSG_URI: " + paramBundle);
    if (b())
    {
      if (e()) {
        Toast.makeText(paramContext, str1, 1).show();
      }
      a.a("isDaemonEnabled: " + b());
      Notification localNotification = new Notification();
      localNotification.icon = a();
      localNotification.defaults = 4;
      if (c()) {
        localNotification.defaults |= 0x1;
      }
      if (d()) {
        localNotification.defaults |= 0x2;
      }
      localNotification.flags |= 0x10;
      localNotification.when = System.currentTimeMillis();
      localNotification.tickerText = str2;
      Intent localIntent = new Intent(paramContext, c.class);
      localIntent.putExtra("DAEMON_ID", "0");
      localIntent.putExtra("DAEMON_TITLE", str1);
      localIntent.putExtra("DAEMON_MESSAGE", str2);
      localIntent.putExtra("DAEMON_URI", paramBundle);
      localIntent.setFlags(268435456);
      localIntent.setFlags(8388608);
      localIntent.setFlags(1073741824);
      localIntent.setFlags(536870912);
      localIntent.setFlags(67108864);
      int i = new Random(System.currentTimeMillis()).nextInt();
      localNotification.setLatestEventInfo(paramContext, str1, str2, PendingIntent.getActivity(paramContext, i, localIntent, 134217728));
      ((NotificationManager)paramContext.getSystemService("notification")).notify(i, localNotification);
      a.a("daemonManager:notify===hou ");
    }
  }
  
  private boolean b()
  {
    return this.b.getBoolean("DaemonEnable", true);
  }
  
  private boolean c()
  {
    return this.b.getBoolean("DaemonSound", true);
  }
  
  private boolean d()
  {
    return this.b.getBoolean("DaemonVibrate", false);
  }
  
  private boolean e()
  {
    return this.b.getBoolean("DaemonToast", false);
  }
  
  public void onReceive(Context paramContext, Intent paramIntent)
  {
    a.a("[MsgPushReceiver] onReceive()...");
    String str = paramIntent.getAction();
    a.a("action=" + str);
    if (paramIntent.getAction().equals("android.intent.action.BOOT_COMPLETED"))
    {
      a.a("MsgPushReceiver::onReceive: ACTION_BOOT_COMPLETED===IN");
      paramContext.startService(new Intent(paramContext, MPDestService.class));
      return;
    }
    if ("com.daemon.video.msgpush.implbyself.show_daemon".equals(str))
    {
      a(paramContext, paramIntent.getExtras());
      return;
    }
    a.a("MsgPushReceiver::onReceive: ACTION_BOOT_COMPLETED===IN");
    paramContext.startService(new Intent(paramContext, MPDestService.class));
  }
}
