package bitter.jnibridge;

import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;

public class JNIBridge
{
  public JNIBridge() {}
  
  static void disableInterfaceProxy(Object paramObject)
  {
    ((a)Proxy.getInvocationHandler(paramObject)).a();
  }
  
  static native Object invoke(long paramLong, Method paramMethod, Object[] paramArrayOfObject);
  
  static Object newInterfaceProxy(long paramLong, Class paramClass)
  {
    ClassLoader localClassLoader = paramClass.getClassLoader();
    a localA = new a(paramLong);
    return Proxy.newProxyInstance(localClassLoader, new Class[] { paramClass }, localA);
  }
  
  private static final class a
    implements InvocationHandler
  {
    private Object a = new Object[0];
    private long b;
    
    public a(long paramLong)
    {
      this.b = paramLong;
    }
    
    public final void a()
    {
      synchronized (this.a)
      {
        this.b = 0L;
        return;
      }
    }
    
    public final Object invoke(Object arg1, Method paramMethod, Object[] paramArrayOfObject)
    {
      synchronized (this.a)
      {
        if (this.b == 0L) {
          return null;
        }
        paramMethod = JNIBridge.invoke(this.b, paramMethod, paramArrayOfObject);
        return paramMethod;
      }
    }
  }
}
