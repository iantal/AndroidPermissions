package cqmbkjulys.hienfdz.euul;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.media.MediaPlayer;
import android.media.MediaPlayer.OnErrorListener;
import android.media.MediaPlayer.OnPreparedListener;
import android.os.Bundle;
import android.widget.MediaController;
import android.widget.RelativeLayout;
import android.widget.RelativeLayout.LayoutParams;
import android.widget.Toast;

public class Play
  extends Activity
  implements MediaPlayer.OnErrorListener, MediaPlayer.OnPreparedListener
{
  boolean a = false;
  m b;
  ProgressDialog c;
  
  public Play() {}
  
  protected void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    paramBundle = new RelativeLayout(this);
    RelativeLayout.LayoutParams localLayoutParams = new RelativeLayout.LayoutParams(-1, -1);
    this.b = new m(this, this);
    this.b.setLayoutParams(localLayoutParams);
    paramBundle.addView(this.b);
    setContentView(paramBundle);
    paramBundle = getIntent().getStringExtra("url");
    this.b.setMediaController(new MediaController(this));
    this.b.setOnPreparedListener(this);
    this.b.setOnErrorListener(this);
    if (paramBundle != null)
    {
      this.b.setVideoPath(paramBundle);
      this.b.requestFocus();
      this.b.start();
      this.c = ProgressDialog.show(this, "", "视频正在加载...");
      return;
    }
    finish();
  }
  
  protected void onDestroy()
  {
    super.onDestroy();
    if ((this.b != null) && (this.b.isPlaying())) {
      this.b.stopPlayback();
    }
  }
  
  public boolean onError(MediaPlayer paramMediaPlayer, int paramInt1, int paramInt2)
  {
    if ((this.c != null) && (this.c.isShowing())) {
      this.c.dismiss();
    }
    if ((this.b != null) && (this.b.isPlaying())) {
      this.b.stopPlayback();
    }
    Toast.makeText(this, "视频解析失败", 0).show();
    finish();
    return true;
  }
  
  protected void onPause()
  {
    super.onPause();
    this.b.pause();
    this.a = true;
  }
  
  public void onPrepared(MediaPlayer paramMediaPlayer)
  {
    if ((this.c != null) && (this.c.isShowing())) {
      this.c.dismiss();
    }
  }
  
  protected void onResume()
  {
    super.onResume();
    if (this.a)
    {
      this.a = false;
      this.b.resume();
    }
  }
}
