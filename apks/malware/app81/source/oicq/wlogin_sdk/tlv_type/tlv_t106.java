package oicq.wlogin_sdk.tlv_type;

import oicq.wlogin_sdk.tools.MD5;
import oicq.wlogin_sdk.tools.cryptor;
import oicq.wlogin_sdk.tools.util;

public class tlv_t106
  extends tlv_t
{
  int _SSoVer = 1;
  int _TGTGTVer = 1;
  int _t106_body_len = 69;
  
  public tlv_t106()
  {
    this._cmd = 262;
    if (util.SSO_VERSION <= 2)
    {
      this._TGTGTVer = 1;
      this._t106_body_len = 69;
      return;
    }
    this._TGTGTVer = 2;
    this._t106_body_len = 90;
  }
  
  public byte[] get_tlv_106(long paramLong1, int paramInt1, long paramLong2, byte[] paramArrayOfByte1, byte[] paramArrayOfByte2, int paramInt2, byte[] paramArrayOfByte3, byte[] paramArrayOfByte4, int paramInt3, byte[] paramArrayOfByte5)
  {
    if (util.SSO_VERSION <= 2)
    {
      paramArrayOfByte5 = new byte[this._t106_body_len];
      util.int16_to_buf(paramArrayOfByte5, 0, this._TGTGTVer);
      paramInt3 = 0 + 2;
      util.int32_to_buf(paramArrayOfByte5, paramInt3, util.get_rand_32());
      paramInt3 += 4;
      util.int32_to_buf(paramArrayOfByte5, paramInt3, this._SSoVer);
      paramInt3 += 4;
      util.int32_to_buf(paramArrayOfByte5, paramInt3, (int)paramLong1);
      paramInt3 += 4;
      util.int32_to_buf(paramArrayOfByte5, paramInt3, paramInt1);
      paramInt1 = paramInt3 + 4;
      util.int64_to_buf(paramArrayOfByte5, paramInt1, paramLong2);
      System.arraycopy(paramArrayOfByte1, 0, paramArrayOfByte5, paramInt1 + 8, paramArrayOfByte1.length);
      paramInt1 = paramArrayOfByte1.length + 26;
      System.arraycopy(paramArrayOfByte2, 0, paramArrayOfByte5, paramInt1, paramArrayOfByte2.length);
      paramInt1 += paramArrayOfByte2.length;
      util.int8_to_buf(paramArrayOfByte5, paramInt1, paramInt2);
      paramInt1 += 1;
      System.arraycopy(paramArrayOfByte3, 0, paramArrayOfByte5, paramInt1, paramArrayOfByte3.length);
      paramInt1 += paramArrayOfByte3.length;
      System.arraycopy(paramArrayOfByte4, 0, paramArrayOfByte5, paramInt1, paramArrayOfByte4.length);
      paramInt1 = paramArrayOfByte4.length;
      paramArrayOfByte1 = new byte[24];
      System.arraycopy(paramArrayOfByte3, 0, paramArrayOfByte1, 0, paramArrayOfByte3.length);
      util.int64_to_buf(paramArrayOfByte1, 16, paramLong2);
      paramArrayOfByte1 = MD5.toMD5Byte(paramArrayOfByte1);
      paramArrayOfByte1 = cryptor.encrypt(paramArrayOfByte5, 0, paramArrayOfByte5.length, paramArrayOfByte1);
      this._t106_body_len = paramArrayOfByte1.length;
      fill_head(this._cmd);
      fill_body(paramArrayOfByte1, this._t106_body_len);
      set_length();
      return get_buf();
    }
    byte[] arrayOfByte = new byte[this._t106_body_len];
    util.int16_to_buf(arrayOfByte, 0, this._TGTGTVer);
    int i = 0 + 2;
    util.int32_to_buf(arrayOfByte, i, util.get_rand_32());
    i += 4;
    util.int32_to_buf(arrayOfByte, i, this._SSoVer);
    i += 4;
    util.int32_to_buf(arrayOfByte, i, (int)paramLong1);
    i += 4;
    util.int32_to_buf(arrayOfByte, i, paramInt1);
    paramInt1 = i + 4;
    util.int64_to_buf(arrayOfByte, paramInt1, paramLong2);
    System.arraycopy(paramArrayOfByte1, 0, arrayOfByte, paramInt1 + 8, paramArrayOfByte1.length);
    paramInt1 = paramArrayOfByte1.length + 26;
    System.arraycopy(paramArrayOfByte2, 0, arrayOfByte, paramInt1, paramArrayOfByte2.length);
    paramInt1 += paramArrayOfByte2.length;
    util.int8_to_buf(arrayOfByte, paramInt1, paramInt2);
    paramInt1 += 1;
    System.arraycopy(paramArrayOfByte3, 0, arrayOfByte, paramInt1, paramArrayOfByte3.length);
    paramInt1 += paramArrayOfByte3.length;
    System.arraycopy(paramArrayOfByte4, 0, arrayOfByte, paramInt1, paramArrayOfByte4.length);
    paramInt1 += paramArrayOfByte4.length;
    util.int32_to_buf(arrayOfByte, paramInt1, 0);
    paramInt1 += 4;
    util.int8_to_buf(arrayOfByte, paramInt1, paramInt3);
    paramInt1 += 1;
    if ((paramArrayOfByte5 == null) || (paramArrayOfByte5.length <= 0))
    {
      paramArrayOfByte1 = new byte[16];
      util.int32_to_buf(paramArrayOfByte1, 0, util.get_rand_32());
      util.int32_to_buf(paramArrayOfByte1, 4, util.get_rand_32());
      util.int32_to_buf(paramArrayOfByte1, 8, util.get_rand_32());
      util.int32_to_buf(paramArrayOfByte1, 12, util.get_rand_32());
    }
    for (paramInt1 = paramArrayOfByte1.length;; paramInt1 = paramArrayOfByte5.length)
    {
      paramArrayOfByte1 = new byte[24];
      System.arraycopy(paramArrayOfByte3, 0, paramArrayOfByte1, 0, paramArrayOfByte3.length);
      util.int64_to_buf(paramArrayOfByte1, 16, paramLong2);
      paramArrayOfByte1 = MD5.toMD5Byte(paramArrayOfByte1);
      paramArrayOfByte1 = cryptor.encrypt(arrayOfByte, 0, arrayOfByte.length, paramArrayOfByte1);
      this._t106_body_len = paramArrayOfByte1.length;
      fill_head(this._cmd);
      fill_body(paramArrayOfByte1, this._t106_body_len);
      set_length();
      return get_buf();
      System.arraycopy(paramArrayOfByte5, 0, arrayOfByte, paramInt1, paramArrayOfByte5.length);
    }
  }
}
