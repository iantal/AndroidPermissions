package com.tencent.bugly.proguard;

import android.content.Context;
import com.tencent.bugly.crashreport.common.strategy.b;
import com.tencent.bugly.crashreport.common.strategy.c;
import java.util.HashMap;
import java.util.Map;

public class s
  implements q, Runnable
{
  private final Context a;
  private final O b;
  private final n c;
  private final c d;
  private final p e;
  private final r f;
  private int g = 0;
  private long h = 0L;
  private long i = 0L;
  
  public s(Context paramContext, O paramO, n paramN, c paramC, p paramP, r paramR)
  {
    this.a = paramContext;
    this.c = paramN;
    this.b = paramO;
    this.d = paramC;
    this.e = paramP;
    this.f = paramR;
  }
  
  protected void a()
  {
    this.g = 0;
    this.h = 0L;
    this.i = 0L;
  }
  
  public final void a(long paramLong)
  {
    this.g += 1;
    this.h += paramLong;
  }
  
  protected void a(boolean paramBoolean, int paramInt, String paramString)
  {
    if (paramBoolean) {
      u.a("upload success! %d", new Object[] { Integer.valueOf(this.b.g) });
    }
    for (;;)
    {
      if (this.h + this.i > 0L)
      {
        long l1 = this.f.b();
        long l2 = this.h;
        long l3 = this.i;
        this.f.a(l1 + l2 + l3);
      }
      return;
      u.c("upload fail! %d %d %s", new Object[] { Integer.valueOf(this.b.g), Integer.valueOf(paramInt), paramString });
      c.a().b(this.b.g + " end " + paramInt + " " + paramString);
    }
  }
  
  public final void b(long paramLong)
  {
    this.i += paramLong;
  }
  
  public void run()
  {
    Object localObject1 = null;
    int m = 0;
    long l = this.f.b();
    if (l >= 2097152L) {
      u.c("up too much wait to next time ! %d %d ", new Object[] { Long.valueOf(l), Long.valueOf(2097152L) });
    }
    Object localObject2;
    do
    {
      return;
      for (;;)
      {
        try
        {
          if (this.b == null)
          {
            u.a();
            a();
            if ((this.a != null) && (this.b != null) && (this.c != null) && (this.d != null) && (this.e != null)) {
              break;
            }
            u.c("up task args error! " + this.a + "|" + this.b + "|" + this.c + "|" + this.d + "|" + this.e, new Object[0]);
            a(false, 0, "upload fail, illegal access error! ");
            return;
          }
        }
        catch (Throwable localThrowable)
        {
          if (!u.a(localThrowable)) {
            localThrowable.printStackTrace();
          }
          localObject2 = localThrowable.getClass().getName() + ":" + localThrowable.getMessage();
          c.a().b(this.b.g + " throw " + (String)localObject2);
          return;
        }
        localObject2 = Integer.valueOf(this.b.g);
      }
      localObject2 = this.d.d();
      localObject3 = a.a(this.b);
    } while (localObject3 == null);
    Object localObject4 = new HashMap();
    ((Map)localObject4).put("pid", this.c.d());
    ((Map)localObject4).put("bid", this.c.f());
    ((Map)localObject4).put("pver", this.c.e());
    int j = 0;
    int k = 0;
    Object localObject5;
    for (;;)
    {
      if (k >= 5) {
        break label816;
      }
      if (k != 0) {}
      try
      {
        Thread.sleep(60000L);
        k += 1;
        if (a.j(this.a) == null)
        {
          u.c("try upload fail! %d %s", new Object[] { Integer.valueOf(this.b.g), "Network is not availiable!" });
          j = 0;
        }
      }
      catch (InterruptedException localInterruptedException)
      {
        for (;;)
        {
          localInterruptedException.printStackTrace();
        }
        j = localObject3.length;
        u.a();
        localObject5 = this.e.a(((b)localObject2).h, (byte[])localObject3, this, (Map)localObject4);
        if (localObject5 == null)
        {
          u.c("try upload fail! %d %s", new Object[] { Integer.valueOf(this.b.g), "upload fail, no response! " });
          j = 1;
        }
        else
        {
          j = localObject5.length;
          u.a();
          localObject2 = a.a((byte[])localObject5, (b)localObject2);
          if (localObject2 == null)
          {
            a(false, 1, "upload fail, resp error! ");
            return;
          }
          j = ((P)localObject2).b;
          if (((P)localObject2).c != null) {
            break label605;
          }
        }
      }
    }
    j = 0;
    u.a();
    localObject4 = this.c;
    Object localObject3 = this.d;
    if (localObject2 == null)
    {
      u.b("resp == null!", new Object[0]);
      j = m;
    }
    for (;;)
    {
      if (j == 0)
      {
        a(false, 2, "upload fail, resp error! ");
        return;
        label605:
        j = ((P)localObject2).c.length;
        break;
        if (((P)localObject2).a != 0)
        {
          u.c("resp result error %d", new Object[] { Byte.valueOf(((P)localObject2).a) });
          j = m;
          continue;
        }
        localObject5 = ((P)localObject2).d;
        ((n)localObject4).m();
        u.a();
        ((n)localObject4).e(((P)localObject2).d);
        ((n)localObject4).a(((n)localObject4).m());
        if (((P)localObject2).b != 510) {
          break label826;
        }
        if (((P)localObject2).c == null)
        {
          u.c("remote data is miss! %d", new Object[] { Integer.valueOf(((P)localObject2).b) });
          j = m;
          continue;
        }
        localObject4 = a.b(((P)localObject2).c);
        if (localObject4 == null)
        {
          u.c("remote data is error! %d", new Object[] { Integer.valueOf(((P)localObject2).b) });
          j = m;
          continue;
        }
        boolean bool = ((R)localObject4).a;
        bool = ((R)localObject4).c;
        bool = ((R)localObject4).b;
        u.a();
        ((c)localObject3).a((R)localObject4);
        break label826;
      }
      a(true, 2, null);
      return;
      label816:
      a(false, j, "try OT Fail! ");
      return;
      label826:
      j = 1;
    }
  }
}
