package com.tencent.tmdownloader.internal.logreport;

import com.qq.taf.jce.JceStruct;
import com.tencent.tmassistant.common.a;
import com.tencent.tmassistant.common.jce.ReportLogRequest;
import com.tencent.tmassistant.common.jce.ReportLogResponse;
import com.tencent.tmassistant.common.jce.Request;
import com.tencent.tmassistant.common.jce.Response;
import com.tencent.tmassistant.common.jce.RspHead;
import com.tencent.tmassistantbase.network.PostHttpRequest;
import com.tencent.tmassistantbase.util.GlobalUtil;
import com.tencent.tmassistantbase.util.TMLog;
import com.tencent.tmdownloader.internal.b.c.b;
import java.util.List;

public class h
  extends PostHttpRequest
{
  protected f b = null;
  
  public h() {}
  
  public void a(f paramF)
  {
    this.b = paramF;
  }
  
  public boolean a(byte paramByte, b paramB)
  {
    if (paramB == null) {
      return false;
    }
    Object localObject = GlobalUtil.getAppPackageName(GlobalUtil.getInstance().getContext());
    int i = GlobalUtil.getAppVersionCode(GlobalUtil.getInstance().getContext());
    localObject = (ReportLogRequest)a.a(paramByte, paramB.b, (String)localObject, i, "");
    byte[] arrayOfByte = a.a(a.b((JceStruct)localObject));
    TMLog.i("LogReportHttpRequest", "logReport:" + localObject + " dataSize:" + paramB.b.size());
    return super.sendRequest(arrayOfByte);
  }
  
  protected void onFinished(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2, int paramInt)
  {
    TMLog.i("LogReportHttpRequest", "http onFinished! + errorCode:" + paramInt);
    if ((paramArrayOfByte2 == null) || (paramInt != 0)) {
      if (this.b != null) {
        this.b.a(this, false);
      }
    }
    while (this.b == null) {
      return;
    }
    paramArrayOfByte2 = a.a(paramArrayOfByte2);
    paramArrayOfByte1 = a.a(((Request)a.a(paramArrayOfByte1, Request.class)).body, ReportLogRequest.class);
    TMLog.i("LogReportHttpRequest", "jceResp.head.ret:" + paramArrayOfByte2.head.ret);
    if ((paramArrayOfByte2 != null) && (paramArrayOfByte2.body != null) && (paramArrayOfByte2.head.ret == 0))
    {
      paramArrayOfByte1 = a.a(paramArrayOfByte1, paramArrayOfByte2.body);
      if (paramArrayOfByte1 != null)
      {
        if ((paramArrayOfByte1 instanceof ReportLogResponse))
        {
          if (((ReportLogResponse)paramArrayOfByte1).ret == 0)
          {
            this.b.a(this, true);
            return;
          }
          this.b.a(this, false);
          return;
        }
        TMLog.i("LogReportHttpRequest", "response isn't instanceof ReportLogResponse !");
        return;
      }
      TMLog.i("LogReportHttpRequest", "jceResponse is null !");
      return;
    }
    this.b.a(this, false);
    TMLog.i("LogReportHttpRequest", "jceResp is null !");
  }
}
