package com.tencent.msdk.push;

import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageManager;
import android.content.pm.PackageManager.NameNotFoundException;
import android.graphics.Bitmap;
import android.graphics.drawable.BitmapDrawable;
import android.support.v4.app.NotificationCompat.Builder;
import com.tencent.msdk.push.req.UnRegisterAppReq;
import com.tencent.msdk.tools.Logger;
import com.tencent.msdk.tools.Res;
import com.tencent.msdk.tools.T;

public class PushMsgEmitter
{
  private static final int sActLaunchApp = 1;
  
  public PushMsgEmitter() {}
  
  public void emit(Context paramContext, MsgEntry paramMsgEntry)
  {
    switch (paramMsgEntry.getClickAction())
    {
    default: 
      return;
    }
    showLaunchAppNtf(paramContext, paramMsgEntry);
  }
  
  public void showLaunchAppNtf(Context paramContext, MsgEntry paramMsgEntry)
  {
    if (paramContext == null) {
      Logger.d("Ctx is null");
    }
    NotificationManager localNotificationManager;
    Object localObject2;
    do
    {
      return;
      localNotificationManager = (NotificationManager)paramContext.getSystemService("notification");
      localObject2 = paramMsgEntry.getPkgName();
    } while (T.ckIsEmpty((String)localObject2));
    try
    {
      Object localObject1 = paramContext.getPackageManager().getApplicationIcon((String)localObject2);
      Intent localIntent = new Intent();
      localIntent.setClassName((String)localObject2, (String)localObject2 + ".push." + "ForwardActivity");
      localIntent.setFlags(335544320);
      localIntent.putExtra("PUSH_MSG", paramMsgEntry);
      localObject2 = PendingIntent.getActivity(paramContext, (int)(System.currentTimeMillis() + (int)(Math.random() * 100.0D)), localIntent, 134217728);
      localObject1 = ((BitmapDrawable)localObject1).getBitmap();
      paramContext = new NotificationCompat.Builder(paramContext).setAutoCancel(true).setSmallIcon(new Res(paramContext).drawable("com_tencent_msdk_push_icon")).setLargeIcon((Bitmap)localObject1).setContentIntent((PendingIntent)localObject2).setContentTitle(paramMsgEntry.getTitle()).setContentText(paramMsgEntry.getContent()).setTicker(paramMsgEntry.getTitle()).build();
      localNotificationManager.notify(paramMsgEntry.getId(), paramContext);
      return;
    }
    catch (PackageManager.NameNotFoundException paramContext)
    {
      paramContext.printStackTrace();
      new UnRegisterAppReq().send();
    }
  }
}
