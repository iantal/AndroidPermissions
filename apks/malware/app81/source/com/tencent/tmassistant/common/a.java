package com.tencent.tmassistant.common;

import com.qq.taf.jce.JceInputStream;
import com.qq.taf.jce.JceOutputStream;
import com.qq.taf.jce.JceStruct;
import com.tencent.tmassistant.common.jce.JceCmd;
import com.tencent.tmassistant.common.jce.ReportLogRequest;
import com.tencent.tmassistant.common.jce.ReqHead;
import com.tencent.tmassistant.common.jce.Request;
import com.tencent.tmassistant.common.jce.Response;
import com.tencent.tmassistant.common.jce.RspHead;
import com.tencent.tmassistant.common.jce.Terminal;
import com.tencent.tmassistantbase.util.Cryptor;
import com.tencent.tmassistantbase.util.GlobalUtil;
import com.tencent.tmassistantbase.util.ZipUtils;
import java.util.List;

public class a
{
  public static JceStruct a(byte paramByte, List paramList, String paramString1, int paramInt, String paramString2)
  {
    ReportLogRequest localReportLogRequest = new ReportLogRequest();
    localReportLogRequest.logType = paramByte;
    localReportLogRequest.logData = a(paramList);
    localReportLogRequest.hostAppPackageName = paramString1;
    localReportLogRequest.hostAppVersion = paramInt;
    localReportLogRequest.hostUserId = paramString2;
    return localReportLogRequest;
  }
  
  public static JceStruct a(JceStruct paramJceStruct, byte[] paramArrayOfByte)
  {
    if ((paramJceStruct != null) && (paramArrayOfByte != null))
    {
      paramJceStruct = d(paramJceStruct);
      if (paramJceStruct != null) {
        try
        {
          paramArrayOfByte = new JceInputStream(paramArrayOfByte);
          paramArrayOfByte.setServerEncoding("utf-8");
          paramJceStruct.readFrom(paramArrayOfByte);
          return paramJceStruct;
        }
        catch (Exception paramJceStruct)
        {
          paramJceStruct.printStackTrace();
          return null;
        }
      }
    }
    return null;
  }
  
  public static JceStruct a(byte[] paramArrayOfByte, Class paramClass)
  {
    if (paramArrayOfByte == null) {
      return null;
    }
    try
    {
      paramArrayOfByte = new JceInputStream(paramArrayOfByte);
      paramArrayOfByte.setServerEncoding("utf-8");
      paramClass = (JceStruct)paramClass.newInstance();
      paramClass.readFrom(paramArrayOfByte);
      return paramClass;
    }
    catch (Exception paramArrayOfByte) {}
    return null;
  }
  
  public static ReqHead a(JceStruct paramJceStruct)
  {
    if (paramJceStruct == null) {
      return null;
    }
    ReqHead localReqHead = new ReqHead();
    localReqHead.requestId = GlobalUtil.getMemUUID();
    paramJceStruct = paramJceStruct.getClass().getSimpleName();
    localReqHead.cmdId = JceCmd.convert(paramJceStruct.substring(0, paramJceStruct.length() - "Request".length())).value();
    localReqHead.qua = GlobalUtil.getInstance().mQUA;
    localReqHead.phoneGuid = GlobalUtil.getInstance().getPhoneGuid();
    paramJceStruct = new Terminal();
    paramJceStruct.androidId = GlobalUtil.getInstance().getAndroidIdInPhone();
    paramJceStruct.androidIdSdCard = GlobalUtil.getInstance().getPhoneGuid();
    paramJceStruct.imei = GlobalUtil.getInstance().getImei();
    paramJceStruct.imsi = GlobalUtil.getInstance().getImsi();
    paramJceStruct.macAdress = GlobalUtil.getInstance().getMacAddress();
    localReqHead.terminal = paramJceStruct;
    localReqHead.assistantAPILevel = GlobalUtil.getInstance().getQQDownloaderAPILevel();
    localReqHead.assistantVersionCode = GlobalUtil.getInstance().getQQDownloaderVersionCode();
    return localReqHead;
  }
  
  public static Response a(byte[] paramArrayOfByte)
  {
    if ((paramArrayOfByte == null) || (paramArrayOfByte.length < 4)) {
      paramArrayOfByte = null;
    }
    for (;;)
    {
      return paramArrayOfByte;
      Response localResponse = new Response();
      try
      {
        paramArrayOfByte = new JceInputStream(paramArrayOfByte);
        paramArrayOfByte.setServerEncoding("utf-8");
        localResponse.readFrom(paramArrayOfByte);
        paramArrayOfByte = localResponse;
        if (localResponse.head.ret == 0)
        {
          if ((localResponse.head.encryptWithPack & 0x2) == 2) {
            localResponse.body = b(localResponse.body, "ji*9^&43U0X-~./(".getBytes());
          }
          if ((localResponse.head.encryptWithPack & 0x1) == 1) {
            localResponse.body = ZipUtils.unzip(localResponse.body);
          }
          GlobalUtil.getInstance().setPhoneGuid(localResponse.head.phoneGuid);
          return localResponse;
        }
      }
      catch (Exception paramArrayOfByte)
      {
        paramArrayOfByte.printStackTrace();
      }
    }
    return null;
  }
  
  public static byte[] a(Request paramRequest)
  {
    if (paramRequest == null) {
      return null;
    }
    paramRequest.head.encryptWithPack = 0;
    if (paramRequest.body.length > 256)
    {
      paramRequest.body = ZipUtils.zip(paramRequest.body);
      paramRequest.head.encryptWithPack = ((byte)(paramRequest.head.encryptWithPack | 0x1));
    }
    paramRequest.body = a(paramRequest.body, "ji*9^&43U0X-~./(".getBytes());
    paramRequest.head.encryptWithPack = ((byte)(paramRequest.head.encryptWithPack | 0x2));
    return c(paramRequest);
  }
  
  /* Error */
  public static byte[] a(List paramList)
  {
    // Byte code:
    //   0: new 237	java/io/ByteArrayOutputStream
    //   3: dup
    //   4: invokespecial 238	java/io/ByteArrayOutputStream:<init>	()V
    //   7: astore_1
    //   8: new 240	java/io/DataOutputStream
    //   11: dup
    //   12: aload_1
    //   13: invokespecial 243	java/io/DataOutputStream:<init>	(Ljava/io/OutputStream;)V
    //   16: astore 4
    //   18: aload 4
    //   20: astore_3
    //   21: aload_1
    //   22: astore_2
    //   23: aload_0
    //   24: invokeinterface 249 1 0
    //   29: astore_0
    //   30: aload 4
    //   32: astore_3
    //   33: aload_1
    //   34: astore_2
    //   35: aload_0
    //   36: invokeinterface 255 1 0
    //   41: ifeq +83 -> 124
    //   44: aload 4
    //   46: astore_3
    //   47: aload_1
    //   48: astore_2
    //   49: aload_0
    //   50: invokeinterface 258 1 0
    //   55: checkcast 259	[B
    //   58: astore 5
    //   60: aload 4
    //   62: astore_3
    //   63: aload_1
    //   64: astore_2
    //   65: aload 4
    //   67: aload 5
    //   69: arraylength
    //   70: invokevirtual 263	java/io/DataOutputStream:writeInt	(I)V
    //   73: aload 4
    //   75: astore_3
    //   76: aload_1
    //   77: astore_2
    //   78: aload 4
    //   80: aload 5
    //   82: invokevirtual 266	java/io/DataOutputStream:write	([B)V
    //   85: goto -55 -> 30
    //   88: astore_2
    //   89: aload 4
    //   91: astore_0
    //   92: aload_2
    //   93: astore 4
    //   95: aload_0
    //   96: astore_3
    //   97: aload_1
    //   98: astore_2
    //   99: aload 4
    //   101: invokevirtual 61	java/lang/Exception:printStackTrace	()V
    //   104: aload_1
    //   105: ifnull +7 -> 112
    //   108: aload_1
    //   109: invokevirtual 269	java/io/ByteArrayOutputStream:close	()V
    //   112: aload_0
    //   113: ifnull +7 -> 120
    //   116: aload_0
    //   117: invokevirtual 270	java/io/DataOutputStream:close	()V
    //   120: aconst_null
    //   121: astore_1
    //   122: aload_1
    //   123: areturn
    //   124: aload 4
    //   126: astore_3
    //   127: aload_1
    //   128: astore_2
    //   129: aload_1
    //   130: invokevirtual 273	java/io/ByteArrayOutputStream:toByteArray	()[B
    //   133: astore_0
    //   134: aload_1
    //   135: ifnull +7 -> 142
    //   138: aload_1
    //   139: invokevirtual 269	java/io/ByteArrayOutputStream:close	()V
    //   142: aload_0
    //   143: astore_1
    //   144: aload 4
    //   146: ifnull -24 -> 122
    //   149: aload 4
    //   151: invokevirtual 270	java/io/DataOutputStream:close	()V
    //   154: aload_0
    //   155: areturn
    //   156: astore_1
    //   157: aload_1
    //   158: invokevirtual 274	java/io/IOException:printStackTrace	()V
    //   161: aload_0
    //   162: areturn
    //   163: astore_0
    //   164: aconst_null
    //   165: astore_3
    //   166: aconst_null
    //   167: astore_1
    //   168: aload_1
    //   169: ifnull +7 -> 176
    //   172: aload_1
    //   173: invokevirtual 269	java/io/ByteArrayOutputStream:close	()V
    //   176: aload_3
    //   177: ifnull +7 -> 184
    //   180: aload_3
    //   181: invokevirtual 270	java/io/DataOutputStream:close	()V
    //   184: aload_0
    //   185: athrow
    //   186: astore_1
    //   187: aload_1
    //   188: invokevirtual 274	java/io/IOException:printStackTrace	()V
    //   191: goto -15 -> 176
    //   194: astore_1
    //   195: aload_1
    //   196: invokevirtual 274	java/io/IOException:printStackTrace	()V
    //   199: goto -15 -> 184
    //   202: astore_1
    //   203: aload_1
    //   204: invokevirtual 274	java/io/IOException:printStackTrace	()V
    //   207: goto -95 -> 112
    //   210: astore_0
    //   211: aload_0
    //   212: invokevirtual 274	java/io/IOException:printStackTrace	()V
    //   215: goto -95 -> 120
    //   218: astore_1
    //   219: aload_1
    //   220: invokevirtual 274	java/io/IOException:printStackTrace	()V
    //   223: goto -81 -> 142
    //   226: astore_0
    //   227: aconst_null
    //   228: astore_3
    //   229: goto -61 -> 168
    //   232: astore_0
    //   233: aload_2
    //   234: astore_1
    //   235: goto -67 -> 168
    //   238: astore 4
    //   240: aconst_null
    //   241: astore_0
    //   242: aconst_null
    //   243: astore_1
    //   244: goto -149 -> 95
    //   247: astore 4
    //   249: aconst_null
    //   250: astore_0
    //   251: goto -156 -> 95
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	254	0	paramList	List
    //   7	137	1	localObject1	Object
    //   156	2	1	localIOException1	java.io.IOException
    //   167	6	1	localObject2	Object
    //   186	2	1	localIOException2	java.io.IOException
    //   194	2	1	localIOException3	java.io.IOException
    //   202	2	1	localIOException4	java.io.IOException
    //   218	2	1	localIOException5	java.io.IOException
    //   234	10	1	localObject3	Object
    //   22	56	2	localObject4	Object
    //   88	5	2	localException1	Exception
    //   98	136	2	localObject5	Object
    //   20	209	3	localObject6	Object
    //   16	134	4	localObject7	Object
    //   238	1	4	localException2	Exception
    //   247	1	4	localException3	Exception
    //   58	23	5	arrayOfByte	byte[]
    // Exception table:
    //   from	to	target	type
    //   23	30	88	java/lang/Exception
    //   35	44	88	java/lang/Exception
    //   49	60	88	java/lang/Exception
    //   65	73	88	java/lang/Exception
    //   78	85	88	java/lang/Exception
    //   129	134	88	java/lang/Exception
    //   149	154	156	java/io/IOException
    //   0	8	163	finally
    //   172	176	186	java/io/IOException
    //   180	184	194	java/io/IOException
    //   108	112	202	java/io/IOException
    //   116	120	210	java/io/IOException
    //   138	142	218	java/io/IOException
    //   8	18	226	finally
    //   23	30	232	finally
    //   35	44	232	finally
    //   49	60	232	finally
    //   65	73	232	finally
    //   78	85	232	finally
    //   99	104	232	finally
    //   129	134	232	finally
    //   0	8	238	java/lang/Exception
    //   8	18	247	java/lang/Exception
  }
  
  public static byte[] a(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2)
  {
    return new Cryptor().encrypt(paramArrayOfByte1, paramArrayOfByte2);
  }
  
  public static Request b(JceStruct paramJceStruct)
  {
    if (paramJceStruct == null) {
      return null;
    }
    Request localRequest = new Request();
    localRequest.head = a(paramJceStruct);
    localRequest.body = c(paramJceStruct);
    return localRequest;
  }
  
  public static byte[] b(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2)
  {
    return new Cryptor().decrypt(paramArrayOfByte1, paramArrayOfByte2);
  }
  
  public static byte[] c(JceStruct paramJceStruct)
  {
    if (paramJceStruct == null) {
      return null;
    }
    JceOutputStream localJceOutputStream = new JceOutputStream();
    localJceOutputStream.setServerEncoding("utf-8");
    paramJceStruct.writeTo(localJceOutputStream);
    return localJceOutputStream.toByteArray();
  }
  
  private static JceStruct d(JceStruct paramJceStruct)
  {
    if (paramJceStruct == null) {
      return null;
    }
    paramJceStruct = paramJceStruct.getClass().getName();
    paramJceStruct = paramJceStruct.substring(0, paramJceStruct.length() - "Request".length()) + "Response";
    try
    {
      paramJceStruct = (JceStruct)Class.forName(paramJceStruct).newInstance();
      return paramJceStruct;
    }
    catch (ClassNotFoundException paramJceStruct)
    {
      for (;;)
      {
        paramJceStruct.printStackTrace();
        paramJceStruct = null;
      }
    }
    catch (IllegalAccessException paramJceStruct)
    {
      for (;;)
      {
        paramJceStruct.printStackTrace();
        paramJceStruct = null;
      }
    }
    catch (InstantiationException paramJceStruct)
    {
      for (;;)
      {
        paramJceStruct.printStackTrace();
        paramJceStruct = null;
      }
    }
  }
}
