package com.duowan.mobile.netroid;

import android.os.Process;
import com.duowan.mobile.netroid.a.a;
import com.duowan.mobile.netroid.a.d;
import java.util.concurrent.BlockingQueue;

public class b
  extends Thread
{
  private static final boolean a = r.b;
  private final BlockingQueue b;
  private final BlockingQueue c;
  private final a d;
  private final Delivery e;
  private volatile boolean f = false;
  
  public b(BlockingQueue paramBlockingQueue1, BlockingQueue paramBlockingQueue2, a paramA, Delivery paramDelivery)
  {
    this.d = paramA;
    this.e = paramDelivery;
    this.b = paramBlockingQueue1;
    this.c = paramBlockingQueue2;
  }
  
  public void a()
  {
    this.f = true;
    interrupt();
  }
  
  public void run()
  {
    if (a) {
      r.a("start new dispatcher", new Object[0]);
    }
    Process.setThreadPriority(10);
    if (this.d != null) {
      this.d.a();
    }
    Request localRequest;
    try
    {
      do
      {
        for (;;)
        {
          localRequest = (Request)this.b.take();
          localRequest.a("cache-queue-take");
          this.e.postPreExecute(localRequest);
          if (!localRequest.f()) {
            break;
          }
          localRequest.b("cache-discard-canceled");
          this.e.postCancel(localRequest);
          this.e.postFinish(localRequest);
        }
      } while (!this.f);
    }
    catch (InterruptedException localInterruptedException) {}
    return;
    if (this.d != null) {}
    for (d localD = this.d.a(localRequest.c());; localD = null)
    {
      if (localD == null)
      {
        localRequest.a("cache-miss");
        this.c.put(localRequest);
        this.e.postNetworking(localRequest);
        break;
      }
      if (localD.a())
      {
        localRequest.a("cache-hit-expired");
        this.c.put(localRequest);
        this.e.postNetworking(localRequest);
        break;
      }
      localRequest.a("cache-hit");
      aa localAa = localRequest.a(new w(localD.a, localD.c));
      localRequest.a("cache-hit-parsed");
      this.e.postUsedCache(localRequest);
      if (!localD.b())
      {
        this.e.postResponse(localRequest, localAa);
        break;
      }
      localRequest.a("cache-hit-refresh-needed");
      localAa.d = true;
      this.e.postResponse(localRequest, localAa, new c(this, localRequest));
      break;
    }
  }
}
