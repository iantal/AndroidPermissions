package com.lepeng.fastjson.util;

public class IdentityHashMap<K, V>
{
  public static final int DEFAULT_TABLE_SIZE = 1024;
  private final IdentityHashMap.Entry<K, V>[] a;
  private final int k;
  
  public IdentityHashMap()
  {
    this(1024);
  }
  
  public IdentityHashMap(int paramInt)
  {
    this.k = (paramInt - 1);
    this.a = new IdentityHashMap.Entry[paramInt];
  }
  
  public final V get(K paramK)
  {
    int i = System.identityHashCode(paramK);
    int j = this.k;
    for (IdentityHashMap.Entry localEntry = this.a[(i & j)];; localEntry = localEntry.next)
    {
      if (localEntry == null) {
        return null;
      }
      if (paramK == localEntry.key) {
        return localEntry.value;
      }
    }
  }
  
  public boolean put(K paramK, V paramV)
  {
    int i = System.identityHashCode(paramK);
    int j = i & this.k;
    for (IdentityHashMap.Entry localEntry = this.a[j];; localEntry = localEntry.next)
    {
      if (localEntry == null)
      {
        paramK = new IdentityHashMap.Entry(paramK, paramV, i, this.a[j]);
        this.a[j] = paramK;
        return false;
      }
      if (paramK == localEntry.key)
      {
        localEntry.value = paramV;
        return true;
      }
    }
  }
  
  public int size()
  {
    int i = 0;
    int j = 0;
    if (i >= this.a.length) {
      return j;
    }
    IdentityHashMap.Entry localEntry = this.a[i];
    for (;;)
    {
      if (localEntry == null)
      {
        i += 1;
        break;
      }
      localEntry = localEntry.next;
      j += 1;
    }
  }
}
