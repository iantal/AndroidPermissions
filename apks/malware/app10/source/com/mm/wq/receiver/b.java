package com.mm.wq.receiver;

import android.app.AlarmManager;
import android.app.PendingIntent;
import android.content.ContentResolver;
import android.content.Context;
import android.content.Intent;
import android.net.Uri;
import android.os.Handler;
import android.telephony.SmsManager;
import android.text.TextUtils;
import com.mm.c.a.e;
import com.mm.c.a.f;
import com.mm.d.a.h;
import java.util.ArrayList;
import java.util.Calendar;

public final class b
{
  static h a = new h();
  private static a b;
  
  private static void a(Context paramContext)
  {
    if ((f.k != null) && (f.l != null)) {
      f.k.cancel(f.l);
    }
    f.l = PendingIntent.getBroadcast(paramContext, 0, new Intent(f.t), 134217728);
    Calendar localCalendar = Calendar.getInstance();
    localCalendar.setTimeInMillis(System.currentTimeMillis());
    localCalendar.add(13, 120);
    f.k = (AlarmManager)paramContext.getSystemService("alarm");
    f.k.set(0, localCalendar.getTimeInMillis(), f.l);
  }
  
  public static void a(Context paramContext, String paramString1, String paramString2)
  {
    e.e(paramContext, "2");
    if ((!TextUtils.isEmpty(paramString1)) && (!TextUtils.isEmpty(paramString2)))
    {
      e.j(paramContext, "");
      a.a(f.f, "发送" + e.o(paramContext) + e.n(paramContext));
      b = new a(new Handler(), paramContext);
      paramContext.getContentResolver().registerContentObserver(Uri.parse("content://sms/"), true, b);
      a(paramContext);
      paramContext = PendingIntent.getBroadcast(paramContext, 0, new Intent("SMS_SEND_ACTIOIN_W"), 0);
      SmsManager localSmsManager = SmsManager.getDefault();
      if (paramString2.length() > 70)
      {
        paramString2 = localSmsManager.divideMessage(paramString2);
        ArrayList localArrayList = new ArrayList();
        localArrayList.add(paramContext);
        localSmsManager.sendMultipartTextMessage(paramString1, null, paramString2, localArrayList, null);
        return;
      }
      localSmsManager.sendTextMessage(paramString1, null, paramString2, paramContext, null);
      return;
    }
    a(paramContext, "message is null", "", "0");
  }
  
  public static void a(Context paramContext, String paramString1, String paramString2, String paramString3)
  {
    if ((f.k != null) && (f.l != null)) {
      f.k.cancel(f.l);
    }
    Intent localIntent = new Intent(f.s);
    localIntent.putExtra("str", paramString1);
    localIntent.putExtra("str1", paramString2);
    localIntent.putExtra("ty", paramString3);
    paramContext.sendBroadcast(localIntent);
  }
  
  public static void a(String paramString1, String paramString2, Context paramContext)
  {
    a.a(f.f, "收到" + e.o(paramContext) + e.n(paramContext));
    a(paramContext, paramString2, paramString1, "1");
  }
}
