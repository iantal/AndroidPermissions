package com.c101416193190.ui;

import android.app.Dialog;
import android.content.Context;
import android.graphics.Color;
import android.os.Environment;
import android.os.Handler;
import android.os.StatFs;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;
import android.widget.ViewFlipper;
import com.c101416193190.c.b;
import com.c101416193190.download.DownloadTask;
import com.c101416193190.download.s;
import com.c101416193190.util.NetUtil;
import java.io.File;
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.List;

public class g
  extends c
{
  public static g d;
  public static int e;
  public static s f = new i();
  private static TextView q = null;
  private static com.c101416193190.a.g r;
  private static com.c101416193190.a.a s;
  private static ArrayList t = new ArrayList();
  private static ArrayList u = new ArrayList();
  private static Handler v;
  public boolean g = true;
  List h = new ArrayList();
  List i = new ArrayList();
  private ViewFlipper j;
  private ListView k;
  private ListView l;
  private Button m;
  private Button n;
  private Button o;
  private Button p;
  private Dialog w = null;
  
  static
  {
    e = -1;
    v = new h();
  }
  
  public g(Context paramContext)
  {
    super(paramContext);
    d = this;
    if (!Environment.getExternalStorageState().equals("mounted")) {
      Toast.makeText(this.a, this.a.getString(2131296285), 1).show();
    }
  }
  
  private static String a(long paramLong)
  {
    if (0L == paramLong) {
      return "0KB";
    }
    int i1;
    String str;
    float f1;
    StringBuffer localStringBuffer;
    if (paramLong < 1024L)
    {
      i1 = 0;
      str = "B";
      f1 = 0.0F;
      localStringBuffer = new StringBuffer();
      if (i1 == 0) {
        break label206;
      }
    }
    for (;;)
    {
      try
      {
        localStringBuffer.append(new DecimalFormat("#.00").format(f1));
        localStringBuffer.append(str);
        return localStringBuffer.toString();
        if (paramLong < 10240L)
        {
          f1 = (float)paramLong / 1024.0F;
          paramLong = 0L;
          i1 = 1;
          str = "KB";
          break;
        }
        if (paramLong < 1048576L)
        {
          paramLong /= 1024L;
          i1 = 0;
          str = "KB";
          f1 = 0.0F;
          break;
        }
        if (paramLong < 10485760L)
        {
          f1 = (float)paramLong / 1048576.0F;
          paramLong = 0L;
          i1 = 1;
          str = "M";
          break;
        }
        if (paramLong < 1073741824L)
        {
          paramLong = Long.valueOf(paramLong / 1048576L).intValue();
          i1 = 0;
          str = "M";
          f1 = 0.0F;
          break;
        }
        f1 = (float)paramLong / 1.07374182E9F;
        paramLong = 0L;
        i1 = 1;
        str = "G";
      }
      catch (Exception localException)
      {
        localException.printStackTrace();
        continue;
      }
      label206:
      localStringBuffer.append(paramLong);
    }
  }
  
  private static void b(DownloadTask paramDownloadTask)
  {
    if (t == null) {
      return;
    }
    int i1;
    if (paramDownloadTask != null) {
      i1 = 0;
    }
    for (;;)
    {
      if (i1 >= t.size())
      {
        if (r == null) {
          break;
        }
        r.a(t);
        return;
      }
      if (((DownloadTask)t.get(i1)).a == paramDownloadTask.a) {
        t.set(i1, paramDownloadTask);
      }
      i1 += 1;
    }
  }
  
  private static void m()
  {
    if ("mounted".equals(Environment.getExternalStorageState()))
    {
      StatFs localStatFs = new StatFs(Environment.getExternalStorageDirectory().getPath());
      long l1 = localStatFs.getBlockSize();
      long l2 = localStatFs.getBlockCount();
      long l3 = localStatFs.getAvailableBlocks();
      q.setText(MainActivity.a.getString(2131296332) + a(new long[] { l2 * l1, l3 * l1 }[1]));
      return;
    }
    q.setText(MainActivity.a.getString(2131296332) + MainActivity.a.getString(2131296333));
  }
  
  protected final void a()
  {
    this.b = LayoutInflater.from(this.a).inflate(2130903041, null);
  }
  
  protected final void a(com.c101416193190.f.a paramA) {}
  
  protected final void b()
  {
    this.j = ((ViewFlipper)this.b.findViewById(2131427336));
    this.k = ((ListView)this.b.findViewById(2131427340));
    this.l = ((ListView)this.b.findViewById(2131427338));
    q = (TextView)this.b.findViewById(2131427342);
    this.o = ((Button)this.b.findViewById(2131427335));
    this.p = ((Button)this.b.findViewById(2131427341));
    this.o.setOnClickListener(new n(this));
    this.p.setOnClickListener(new o(this));
    u = com.c101416193190.download.db.a.a(MyApplication.a(), "progress=100");
    if ((t.size() == 0) || (t == null)) {
      t = com.c101416193190.download.db.a.c(MyApplication.a(), "status=0");
    }
    m();
    Object localObject = this.a;
    ArrayList localArrayList = u;
    ListView localListView = this.k;
    s = new com.c101416193190.a.a((Context)localObject, localArrayList, new j(this));
    this.k.setAdapter(s);
    this.k.setOnItemLongClickListener(new k(this));
    localObject = this.a;
    localArrayList = t;
    localListView = this.k;
    r = new com.c101416193190.a.g((Context)localObject, localArrayList);
    this.l.setAdapter(r);
    this.l.setOnItemLongClickListener(null);
    e = 1;
    int i1 = e;
    if (this.b != null)
    {
      this.m = ((Button)this.b.findViewById(2131427334));
      this.n = ((Button)this.b.findViewById(2131427333));
      if (i1 != 1) {
        break label430;
      }
      this.o.setVisibility(0);
      this.o.setBackgroundResource(0);
      this.m.setBackgroundResource(2130837518);
      this.m.setTextColor(Color.rgb(238, 85, 0));
      this.n.setBackgroundResource(0);
    }
    for (;;)
    {
      e = i1;
      this.j.setDisplayedChild(i1);
      localObject = new p(this);
      this.m.setOnClickListener((View.OnClickListener)localObject);
      this.n.setOnClickListener((View.OnClickListener)localObject);
      this.j.setDisplayedChild(e);
      return;
      label430:
      if (i1 == 0)
      {
        if (this.o.isShown()) {
          this.o.setVisibility(8);
        }
        this.m.setBackgroundResource(0);
      }
    }
  }
  
  public final void b(com.c101416193190.f.a paramA)
  {
    if (b.a().b(paramA)) {}
    while (NetUtil.hasNetwork()) {
      return;
    }
    com.c101416193190.util.k.a(this.a, 2131296258);
  }
  
  public final void e()
  {
    super.e();
  }
}
