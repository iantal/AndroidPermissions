package com.w545taxxxg9.pull;

import android.content.Context;
import android.content.res.Resources;
import com.w545taxxxg9.Utils.WebWidgetConfigurationManager;
import com.w545taxxxg9.Utils.WebWidgetConfigutation;
import java.net.URLEncoder;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;

public class StatServerClient
{
  private WebWidgetConfigutation _config;
  private Context _context = null;
  
  public StatServerClient(Context paramContext)
  {
    this._context = paramContext;
    paramContext = WebWidgetConfigurationManager.getInstance(this._context);
    try
    {
      this._config = paramContext.loadConfiguration(this._context);
      return;
    }
    catch (Exception paramContext)
    {
      paramContext.printStackTrace();
    }
  }
  
  private String _createStatUrl(String paramString1, String paramString2)
  {
    String str1 = this._context.getResources().getString(2131230738);
    String str2 = this._context.getString(2131230766);
    String str3 = this._config.getAppGuid();
    return str1 + "pull.php?" + "a=" + paramString1 + "&url=" + URLEncoder.encode(paramString2) + "&app=" + this._config.getApplicationId() + "&v=" + URLEncoder.encode(str2) + "&guid=" + URLEncoder.encode(str3);
  }
  
  private void _sendRequestAsync(final String paramString)
  {
    new Thread()
    {
      public void run()
      {
        try
        {
          DefaultHttpClient localDefaultHttpClient = new DefaultHttpClient();
          HttpGet localHttpGet = new HttpGet(paramString);
          localHttpGet.setHeader("Cache-Control", "no-cache,no-store");
          localDefaultHttpClient.execute(localHttpGet);
          return;
        }
        catch (Exception localException)
        {
          localException.printStackTrace();
        }
      }
    }.start();
  }
  
  public void senMessageClickedAsync(String paramString)
  {
    try
    {
      _sendRequestAsync(_createStatUrl("click", paramString));
      return;
    }
    catch (Exception paramString)
    {
      paramString.printStackTrace();
    }
  }
  
  public void sendMessageAcceptedAsync(String paramString)
  {
    try
    {
      _sendRequestAsync(_createStatUrl("request", paramString));
      return;
    }
    catch (Exception paramString)
    {
      paramString.printStackTrace();
    }
  }
}
