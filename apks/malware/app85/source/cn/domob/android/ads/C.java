package cn.domob.android.ads;

import android.app.Activity;
import android.content.Context;
import android.webkit.WebSettings;
import android.webkit.WebView;

class C
  extends WebView
  implements l.a
{
  protected static final int a = -1;
  private static H b = new H(C.class.getSimpleName());
  private static final String g = "domobBridge";
  private String c;
  private int d = -1;
  private int e;
  private a f;
  
  public C(Context paramContext, String paramString, int paramInt)
  {
    super(paramContext);
    this.c = paramString;
    c();
    getSettings().setJavaScriptEnabled(true);
    getSettings().setPluginsEnabled(true);
    getSettings().setCacheMode(-1);
    if (paramInt != -1)
    {
      b.a("Init DomobWebView with custom background color.");
      setBackgroundColor(paramInt);
    }
  }
  
  /* Error */
  private String a(byte[] paramArrayOfByte, String paramString)
  {
    // Byte code:
    //   0: new 87	java/lang/StringBuilder
    //   3: dup
    //   4: invokespecial 89	java/lang/StringBuilder:<init>	()V
    //   7: aload_0
    //   8: invokevirtual 93	cn/domob/android/ads/C:getContext	()Landroid/content/Context;
    //   11: invokevirtual 99	android/content/Context:getFilesDir	()Ljava/io/File;
    //   14: invokevirtual 104	java/io/File:getAbsolutePath	()Ljava/lang/String;
    //   17: invokevirtual 108	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   20: getstatic 111	java/io/File:separator	Ljava/lang/String;
    //   23: invokevirtual 108	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   26: aload_2
    //   27: invokevirtual 108	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   30: invokevirtual 114	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   33: astore_2
    //   34: new 101	java/io/File
    //   37: dup
    //   38: aload_2
    //   39: invokespecial 115	java/io/File:<init>	(Ljava/lang/String;)V
    //   42: astore_3
    //   43: new 117	java/io/FileOutputStream
    //   46: dup
    //   47: aload_3
    //   48: invokespecial 120	java/io/FileOutputStream:<init>	(Ljava/io/File;)V
    //   51: astore_3
    //   52: aload_3
    //   53: aload_1
    //   54: invokevirtual 124	java/io/FileOutputStream:write	([B)V
    //   57: aload_3
    //   58: invokevirtual 127	java/io/FileOutputStream:close	()V
    //   61: aload_2
    //   62: areturn
    //   63: astore_1
    //   64: aconst_null
    //   65: areturn
    //   66: astore_1
    //   67: getstatic 42	cn/domob/android/ads/C:b	Lcn/domob/android/ads/H;
    //   70: aload_1
    //   71: invokevirtual 130	cn/domob/android/ads/H:a	(Ljava/lang/Throwable;)V
    //   74: aload_2
    //   75: areturn
    //   76: astore_1
    //   77: getstatic 42	cn/domob/android/ads/C:b	Lcn/domob/android/ads/H;
    //   80: aload_1
    //   81: invokevirtual 130	cn/domob/android/ads/H:a	(Ljava/lang/Throwable;)V
    //   84: aload_3
    //   85: invokevirtual 127	java/io/FileOutputStream:close	()V
    //   88: aconst_null
    //   89: areturn
    //   90: astore_1
    //   91: getstatic 42	cn/domob/android/ads/C:b	Lcn/domob/android/ads/H;
    //   94: aload_1
    //   95: invokevirtual 130	cn/domob/android/ads/H:a	(Ljava/lang/Throwable;)V
    //   98: goto -10 -> 88
    //   101: astore_1
    //   102: aload_3
    //   103: invokevirtual 127	java/io/FileOutputStream:close	()V
    //   106: aload_1
    //   107: athrow
    //   108: astore_2
    //   109: getstatic 42	cn/domob/android/ads/C:b	Lcn/domob/android/ads/H;
    //   112: aload_2
    //   113: invokevirtual 130	cn/domob/android/ads/H:a	(Ljava/lang/Throwable;)V
    //   116: goto -10 -> 106
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	119	0	this	C
    //   0	119	1	paramArrayOfByte	byte[]
    //   0	119	2	paramString	String
    //   42	61	3	localObject	Object
    // Exception table:
    //   from	to	target	type
    //   43	52	63	java/io/FileNotFoundException
    //   57	61	66	java/io/IOException
    //   52	57	76	java/io/IOException
    //   84	88	90	java/io/IOException
    //   52	57	101	finally
    //   77	84	101	finally
    //   102	106	108	java/io/IOException
  }
  
  /* Error */
  private String b(String paramString)
  {
    // Byte code:
    //   0: aload_0
    //   1: invokevirtual 93	cn/domob/android/ads/C:getContext	()Landroid/content/Context;
    //   4: invokevirtual 138	android/content/Context:getAssets	()Landroid/content/res/AssetManager;
    //   7: aload_1
    //   8: invokevirtual 144	android/content/res/AssetManager:open	(Ljava/lang/String;)Ljava/io/InputStream;
    //   11: astore_3
    //   12: new 87	java/lang/StringBuilder
    //   15: dup
    //   16: invokespecial 89	java/lang/StringBuilder:<init>	()V
    //   19: aload_0
    //   20: invokevirtual 93	cn/domob/android/ads/C:getContext	()Landroid/content/Context;
    //   23: invokevirtual 99	android/content/Context:getFilesDir	()Ljava/io/File;
    //   26: invokevirtual 104	java/io/File:getAbsolutePath	()Ljava/lang/String;
    //   29: invokevirtual 108	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   32: getstatic 111	java/io/File:separator	Ljava/lang/String;
    //   35: invokevirtual 108	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   38: aload_1
    //   39: invokevirtual 108	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   42: invokevirtual 114	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   45: astore_1
    //   46: new 101	java/io/File
    //   49: dup
    //   50: aload_1
    //   51: invokespecial 115	java/io/File:<init>	(Ljava/lang/String;)V
    //   54: astore 4
    //   56: new 117	java/io/FileOutputStream
    //   59: dup
    //   60: aload 4
    //   62: invokespecial 120	java/io/FileOutputStream:<init>	(Ljava/io/File;)V
    //   65: astore 4
    //   67: sipush 8192
    //   70: newarray byte
    //   72: astore 5
    //   74: aload_3
    //   75: aload 5
    //   77: invokevirtual 150	java/io/InputStream:read	([B)I
    //   80: istore_2
    //   81: iload_2
    //   82: iconst_m1
    //   83: if_icmpeq +42 -> 125
    //   86: aload 4
    //   88: aload 5
    //   90: iconst_0
    //   91: iload_2
    //   92: invokevirtual 153	java/io/FileOutputStream:write	([BII)V
    //   95: goto -21 -> 74
    //   98: astore_1
    //   99: aload_3
    //   100: invokevirtual 154	java/io/InputStream:close	()V
    //   103: aload 4
    //   105: invokevirtual 127	java/io/FileOutputStream:close	()V
    //   108: ldc -100
    //   110: areturn
    //   111: astore_1
    //   112: getstatic 42	cn/domob/android/ads/C:b	Lcn/domob/android/ads/H;
    //   115: aload_1
    //   116: invokevirtual 130	cn/domob/android/ads/H:a	(Ljava/lang/Throwable;)V
    //   119: aconst_null
    //   120: areturn
    //   121: astore_1
    //   122: ldc -100
    //   124: areturn
    //   125: aload_3
    //   126: invokevirtual 154	java/io/InputStream:close	()V
    //   129: aload 4
    //   131: invokevirtual 127	java/io/FileOutputStream:close	()V
    //   134: getstatic 42	cn/domob/android/ads/C:b	Lcn/domob/android/ads/H;
    //   137: new 87	java/lang/StringBuilder
    //   140: dup
    //   141: invokespecial 89	java/lang/StringBuilder:<init>	()V
    //   144: ldc -98
    //   146: invokevirtual 108	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   149: aload_1
    //   150: invokevirtual 108	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   153: invokevirtual 114	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   156: invokevirtual 160	cn/domob/android/ads/H:b	(Ljava/lang/String;)V
    //   159: aload_1
    //   160: areturn
    //   161: astore_1
    //   162: aload_3
    //   163: invokevirtual 154	java/io/InputStream:close	()V
    //   166: aload 4
    //   168: invokevirtual 127	java/io/FileOutputStream:close	()V
    //   171: aload_1
    //   172: athrow
    //   173: astore_3
    //   174: goto -3 -> 171
    //   177: astore_1
    //   178: ldc -100
    //   180: areturn
    //   181: astore_3
    //   182: goto -48 -> 134
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	185	0	this	C
    //   0	185	1	paramString	String
    //   80	12	2	i	int
    //   11	152	3	localInputStream	java.io.InputStream
    //   173	1	3	localIOException1	java.io.IOException
    //   181	1	3	localIOException2	java.io.IOException
    //   54	113	4	localObject	Object
    //   72	17	5	arrayOfByte	byte[]
    // Exception table:
    //   from	to	target	type
    //   74	81	98	java/io/IOException
    //   86	95	98	java/io/IOException
    //   0	12	111	java/lang/Exception
    //   56	67	121	java/io/FileNotFoundException
    //   74	81	161	finally
    //   86	95	161	finally
    //   162	171	173	java/io/IOException
    //   99	108	177	java/io/IOException
    //   125	134	181	java/io/IOException
  }
  
  private void c()
  {
    setHorizontalScrollBarEnabled(false);
    setHorizontalScrollbarOverlay(false);
    setVerticalScrollBarEnabled(false);
    setVerticalScrollbarOverlay(false);
    getSettings().setSupportZoom(false);
  }
  
  protected String a()
  {
    if (this.c == null) {
      this.c = "NO_ID";
    }
    return this.c;
  }
  
  public void a(final l paramL)
  {
    if (paramL.f() == 200)
    {
      final String str = paramL.a();
      b.b("Download finish:" + str);
      new Thread(new Runnable()
      {
        public void run()
        {
          Object localObject = paramL.d();
          localObject = C.a(C.this, (byte[])localObject, paramL.a());
          if (localObject != null)
          {
            C.b().b("Image saved:" + (String)localObject);
            try
            {
              new d().b(C.this.getContext(), str, (String)localObject);
              C.this.a(String.format("%s.assetReady('%s', '%s')", new Object[] { "domobBridge", str, localObject }));
              return;
            }
            catch (Exception localException)
            {
              for (;;)
              {
                C.b().a(localException);
              }
            }
          }
          C.b().e("Error in saving image.");
        }
      }).start();
    }
  }
  
  protected void a(final String paramString)
  {
    if (paramString != null) {}
    try
    {
      paramString = "javascript:" + paramString;
      b.b(String.format("DomobWebView %s execute js: %s", new Object[] { this.c, paramString }));
      ((Activity)getContext()).runOnUiThread(new Runnable()
      {
        public void run()
        {
          C.this.loadUrl(paramString);
        }
      });
      return;
    }
    finally
    {
      paramString = finally;
      throw paramString;
    }
  }
  
  protected void a(String paramString1, String paramString2, int paramInt, a paramA)
  {
    this.d = paramInt;
    this.f = paramA;
    loadDataWithBaseURL(paramString1, paramString2, "text/html", "UTF-8", null);
    if ((this.e == this.d) && (this.f != null)) {
      this.f.d(this);
    }
  }
  
  protected void a(String paramString1, String paramString2, String paramString3)
  {
    try
    {
      d localD = new d();
      if (!localD.a(getContext(), paramString3, paramString2))
      {
        b.a(String.format("There is no pair in DB: %s : %s", new Object[] { paramString3, paramString2 }));
        localD.c(getContext(), paramString2, paramString3);
      }
      if (!localD.d(getContext(), paramString2)) {
        break label284;
      }
      paramString3 = localD.e(getContext(), paramString2);
      if (paramString3 != null)
      {
        b.b(String.format("Get image %s local location = %s from DB.", new Object[] { paramString2, paramString3 }));
        a(String.format("%s.assetReady('%s', '%s')", new Object[] { "domobBridge", paramString2, paramString3 }));
        this.e += 1;
        if (this.e == this.d)
        {
          if (this.f == null) {
            return;
          }
          this.f.d(this);
          return;
        }
        b.a(String.format("Total resources number=%d and replaced number=%d", new Object[] { Integer.valueOf(this.d), Integer.valueOf(this.e) }));
        return;
      }
    }
    catch (Exception paramString1)
    {
      b.a(paramString1);
      return;
    }
    b.a(String.format("Alias %s is in DB but the local location is not available. Need to download.", new Object[] { paramString2 }));
    for (;;)
    {
      b.a(String.format("Alias %s is about to be downloaded.", new Object[] { paramString2 }));
      paramString1 = new l(getContext(), paramString1, this);
      paramString1.a(paramString2);
      paramString1.b();
      return;
      label284:
      b.b(String.format("Alias %s is not in DB. Download and insert.", new Object[] { paramString2 }));
    }
  }
  
  public void loadDataWithBaseURL(String paramString1, String paramString2, String paramString3, String paramString4, String paramString5)
  {
    if (!A.e(paramString2))
    {
      String str = "file://" + b("domob.js");
      paramString2 = "<script src=\"" + str + "\"></script>" + paramString2;
      b.b("data after replace:\n" + paramString2);
      super.loadDataWithBaseURL(paramString1, paramString2, paramString3, paramString4, paramString5);
      return;
    }
    b.e("Data is null or empty while calling 'loadDataWithBaseURL'.");
  }
  
  static abstract interface a
  {
    public abstract void d(C paramC);
  }
}
