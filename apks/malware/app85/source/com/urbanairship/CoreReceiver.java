package com.urbanairship;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import com.urbanairship.analytics.Analytics;
import com.urbanairship.push.PushManager;

public class CoreReceiver
  extends BroadcastReceiver
{
  public CoreReceiver() {}
  
  public void onReceive(Context paramContext, Intent paramIntent)
  {
    paramContext = paramIntent.getAction();
    if (paramContext.equals("android.intent.action.ACTION_SHUTDOWN")) {
      PushManager.stopService();
    }
    do
    {
      return;
      if (paramContext.equals("android.intent.action.BOOT_COMPLETED"))
      {
        PushManager.startService();
        return;
      }
      if ("com.urbanairship.analytics.START".equals(paramContext))
      {
        UAirship.shared().getAnalytics().startUploadingIfNecessary();
        return;
      }
    } while (!paramContext.startsWith("com.urbanairship.push.NOTIFICATION_OPENED_PROXY"));
    Logger.debug("Received push conversion: " + paramIntent.getStringExtra("com.urbanairship.push.PUSH_ID"));
    UAirship.shared().getAnalytics().setConversionPushId(paramIntent.getStringExtra("com.urbanairship.push.PUSH_ID"));
    if (PushManager.shared().getIntentReceiver() != null)
    {
      paramContext = new Intent("com.urbanairship.push.NOTIFICATION_OPENED");
      paramContext.setClass(UAirship.shared().getApplicationContext(), PushManager.shared().getIntentReceiver());
      paramContext.putExtras(paramIntent.getExtras());
      UAirship.shared().getApplicationContext().sendBroadcast(paramContext);
      return;
    }
    Logger.debug("No intent receiver set, not sending ACTION_NOTIFICATION_OPENED");
  }
}
