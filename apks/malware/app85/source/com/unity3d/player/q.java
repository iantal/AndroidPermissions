package com.unity3d.player;

import android.content.Context;
import android.opengl.GLSurfaceView;
import android.opengl.GLSurfaceView.EGLConfigChooser;
import android.opengl.GLSurfaceView.EGLContextFactory;
import android.os.Build.VERSION;
import android.util.Log;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import javax.microedition.khronos.egl.EGL10;
import javax.microedition.khronos.egl.EGLConfig;
import javax.microedition.khronos.egl.EGLContext;
import javax.microedition.khronos.egl.EGLDisplay;

class q
  extends GLSurfaceView
  implements UnityGL
{
  private static boolean a = false;
  private static boolean b;
  private a c = null;
  
  public q(Context paramContext, int paramInt, boolean paramBoolean1, boolean paramBoolean2)
  {
    super(paramContext);
    a = paramBoolean2;
    init(paramInt, paramBoolean1, 16, 16, 0, 0);
  }
  
  public static boolean b()
  {
    return Build.VERSION.SDK_INT >= 9;
  }
  
  public final void a()
  {
    super.onDetachedFromWindow();
  }
  
  public final void a(int paramInt)
  {
    if (this.c != null) {
      this.c.e = paramInt;
    }
  }
  
  public final void a(boolean paramBoolean)
  {
    if (this.c == null) {}
    for (;;)
    {
      return;
      if (paramBoolean) {
        if (Build.VERSION.SDK_INT < 9) {
          break label67;
        }
      }
      label67:
      for (int i = 1; i != 0; i = 0)
      {
        if (!paramBoolean) {
          break label72;
        }
        this.c.a = 8;
        this.c.b = 8;
        this.c.c = 8;
        this.c.d = 8;
        return;
      }
    }
    label72:
    this.c.a = 5;
    this.c.b = 6;
    this.c.c = 5;
    this.c.d = 0;
  }
  
  protected void init(int paramInt1, boolean paramBoolean, int paramInt2, int paramInt3, int paramInt4, int paramInt5)
  {
    int i = 1;
    boolean bool;
    if (paramInt1 == 2)
    {
      bool = true;
      b = bool;
      if (Build.VERSION.SDK_INT < 9) {
        break label126;
      }
      paramInt1 = i;
      label27:
      if (paramInt1 == 0) {
        paramInt2 = 16;
      }
      localObject = getHolder();
      if ((!paramBoolean) && (paramInt2 != 32)) {
        break label131;
      }
      paramInt1 = -3;
      label53:
      ((SurfaceHolder)localObject).setFormat(paramInt1);
      setEGLContextFactory(new b());
      if ((!paramBoolean) && (paramInt2 != 32)) {
        break label136;
      }
    }
    label126:
    label131:
    label136:
    for (Object localObject = new a(8, 8, 8, 8, paramInt3, paramInt4, paramInt5);; localObject = new a(5, 6, 5, 0, paramInt3, paramInt4, paramInt5))
    {
      this.c = ((a)localObject);
      setEGLConfigChooser(this.c);
      return;
      bool = false;
      break;
      paramInt1 = 0;
      break label27;
      paramInt1 = -1;
      break label53;
    }
  }
  
  protected void onDetachedFromWindow()
  {
    if (!a) {
      Log.d("Unity", "onDetachedFromWindow");
    }
  }
  
  public boolean onGenericMotionEvent(MotionEvent paramMotionEvent)
  {
    return false;
  }
  
  static final class a
    implements GLSurfaceView.EGLConfigChooser
  {
    private static final int[] f;
    private static final int[] g;
    private static int[] j;
    protected int a;
    protected int b;
    protected int c;
    protected int d;
    public int e;
    private int h;
    private int i;
    
    static
    {
      if (!q.class.desiredAssertionStatus()) {}
      for (boolean bool = true;; bool = false)
      {
        k = bool;
        f = new int[] { 12324, 4, 12323, 4, 12322, 4, 12352, 4, 12344 };
        g = new int[] { 12324, 5, 12323, 6, 12322, 5, 12352, 1, 12344 };
        j = new int[1];
        return;
      }
    }
    
    public a(int paramInt1, int paramInt2, int paramInt3, int paramInt4, int paramInt5, int paramInt6, int paramInt7)
    {
      this.a = paramInt1;
      this.b = paramInt2;
      this.c = paramInt3;
      this.d = paramInt4;
      this.h = paramInt5;
      this.i = paramInt6;
      this.e = paramInt7;
    }
    
    private static int a(EGL10 paramEGL10, EGLDisplay paramEGLDisplay, EGLConfig paramEGLConfig, int paramInt1, int paramInt2)
    {
      if (paramEGL10.eglGetConfigAttrib(paramEGLDisplay, paramEGLConfig, paramInt1, j)) {
        return j[0];
      }
      paramInt2 = paramEGL10.eglGetError();
      if (paramInt2 != 12292) {
        Log.e("Unity", String.format("findConfigAttrib: EGL error: 0x%x", new Object[] { Integer.valueOf(paramInt2) }));
      }
      q.a("findConfigAttrib (" + Integer.toHexString(paramInt1) + ")", paramEGL10);
      return 0;
    }
    
    private EGLConfig a(EGL10 paramEGL10, EGLDisplay paramEGLDisplay, EGLConfig[] paramArrayOfEGLConfig)
    {
      int n = paramArrayOfEGLConfig.length;
      int m = 0;
      while (m < n)
      {
        EGLConfig localEGLConfig = paramArrayOfEGLConfig[m];
        if ((!k) && (localEGLConfig == null)) {
          throw new AssertionError();
        }
        int i1 = a(paramEGL10, paramEGLDisplay, localEGLConfig, 12325, 0);
        int i2 = a(paramEGL10, paramEGLDisplay, localEGLConfig, 12326, 0);
        int i3 = a(paramEGL10, paramEGLDisplay, localEGLConfig, 12337, 0);
        int i4 = a(paramEGL10, paramEGLDisplay, localEGLConfig, 12513, 0);
        if ((i1 >= this.h) && (i2 >= this.i) && ((i3 >= this.e) || (i4 - 1 >= this.e)))
        {
          i1 = a(paramEGL10, paramEGLDisplay, localEGLConfig, 12324, 0);
          i2 = a(paramEGL10, paramEGLDisplay, localEGLConfig, 12323, 0);
          i3 = a(paramEGL10, paramEGLDisplay, localEGLConfig, 12322, 0);
          i4 = a(paramEGL10, paramEGLDisplay, localEGLConfig, 12321, 0);
          if ((i1 == this.a) && (i2 == this.b) && (i3 == this.c) && (i4 == this.d)) {
            return localEGLConfig;
          }
        }
        m += 1;
      }
      return null;
    }
    
    protected static void printConfig(EGL10 paramEGL10, EGLDisplay paramEGLDisplay, EGLConfig paramEGLConfig)
    {
      int[] arrayOfInt1 = new int[35];
      int[] tmp8_6 = arrayOfInt1;
      tmp8_6[0] = '〠';
      int[] tmp14_8 = tmp8_6;
      tmp14_8[1] = '〡';
      int[] tmp20_14 = tmp14_8;
      tmp20_14[2] = '〢';
      int[] tmp26_20 = tmp20_14;
      tmp26_20[3] = '〣';
      int[] tmp32_26 = tmp26_20;
      tmp32_26[4] = '〤';
      int[] tmp38_32 = tmp32_26;
      tmp38_32[5] = '〥';
      int[] tmp44_38 = tmp38_32;
      tmp44_38[6] = '〦';
      int[] tmp51_44 = tmp44_38;
      tmp51_44[7] = '〧';
      int[] tmp58_51 = tmp51_44;
      tmp58_51[8] = '〨';
      int[] tmp65_58 = tmp58_51;
      tmp65_58[9] = '〩';
      int[] tmp72_65 = tmp65_58;
      tmp72_65[10] = '〪';
      int[] tmp79_72 = tmp72_65;
      tmp79_72[11] = '〫';
      int[] tmp86_79 = tmp79_72;
      tmp86_79[12] = '〬';
      int[] tmp93_86 = tmp86_79;
      tmp93_86[13] = '〭';
      int[] tmp100_93 = tmp93_86;
      tmp100_93[14] = '〮';
      int[] tmp107_100 = tmp100_93;
      tmp107_100[15] = '〯';
      int[] tmp114_107 = tmp107_100;
      tmp114_107[16] = '〰';
      int[] tmp121_114 = tmp114_107;
      tmp121_114[17] = '〱';
      int[] tmp128_121 = tmp121_114;
      tmp128_121[18] = '〲';
      int[] tmp135_128 = tmp128_121;
      tmp135_128[19] = '〳';
      int[] tmp142_135 = tmp135_128;
      tmp142_135[20] = '〴';
      int[] tmp149_142 = tmp142_135;
      tmp149_142[21] = '〷';
      int[] tmp156_149 = tmp149_142;
      tmp156_149[22] = '〶';
      int[] tmp163_156 = tmp156_149;
      tmp163_156[23] = '〵';
      int[] tmp170_163 = tmp163_156;
      tmp170_163[24] = '〹';
      int[] tmp177_170 = tmp170_163;
      tmp177_170[25] = '〺';
      int[] tmp184_177 = tmp177_170;
      tmp184_177[26] = '〻';
      int[] tmp191_184 = tmp184_177;
      tmp191_184[27] = '〼';
      int[] tmp198_191 = tmp191_184;
      tmp198_191[28] = '〽';
      int[] tmp205_198 = tmp198_191;
      tmp205_198[29] = '〾';
      int[] tmp212_205 = tmp205_198;
      tmp212_205[30] = '〿';
      int[] tmp219_212 = tmp212_205;
      tmp219_212[31] = '぀';
      int[] tmp226_219 = tmp219_212;
      tmp226_219[32] = 'あ';
      int[] tmp233_226 = tmp226_219;
      tmp233_226[33] = 'ム';
      int[] tmp240_233 = tmp233_226;
      tmp240_233[34] = 'メ';
      tmp240_233;
      int[] arrayOfInt2 = new int[1];
      int m = 0;
      if (m < arrayOfInt1.length)
      {
        int n = arrayOfInt1[m];
        String str = new String[] { "EGL_BUFFER_SIZE", "EGL_ALPHA_SIZE", "EGL_BLUE_SIZE", "EGL_GREEN_SIZE", "EGL_RED_SIZE", "EGL_DEPTH_SIZE", "EGL_STENCIL_SIZE", "EGL_CONFIG_CAVEAT", "EGL_CONFIG_ID", "EGL_LEVEL", "EGL_MAX_PBUFFER_HEIGHT", "EGL_MAX_PBUFFER_PIXELS", "EGL_MAX_PBUFFER_WIDTH", "EGL_NATIVE_RENDERABLE", "EGL_NATIVE_VISUAL_ID", "EGL_NATIVE_VISUAL_TYPE", "EGL_PRESERVED_RESOURCES", "EGL_SAMPLES", "EGL_SAMPLE_BUFFERS", "EGL_SURFACE_TYPE", "EGL_TRANSPARENT_TYPE", "EGL_TRANSPARENT_RED_VALUE", "EGL_TRANSPARENT_GREEN_VALUE", "EGL_TRANSPARENT_BLUE_VALUE", "EGL_BIND_TO_TEXTURE_RGB", "EGL_BIND_TO_TEXTURE_RGBA", "EGL_MIN_SWAP_INTERVAL", "EGL_MAX_SWAP_INTERVAL", "EGL_LUMINANCE_SIZE", "EGL_ALPHA_MASK_SIZE", "EGL_COLOR_BUFFER_TYPE", "EGL_RENDERABLE_TYPE", "EGL_CONFORMANT", "EGL_COVERAGE_BUFFERS_NV", "EGL_COVERAGE_SAMPLES_NV" }[m];
        if (paramEGL10.eglGetConfigAttrib(paramEGLDisplay, paramEGLConfig, n, arrayOfInt2)) {
          q.a(String.format("  %s: %d\n", new Object[] { str, Integer.valueOf(arrayOfInt2[0]) }));
        }
        for (;;)
        {
          m += 1;
          break;
          q.a("printConfig (" + str + ")", paramEGL10);
        }
      }
    }
    
    public final EGLConfig chooseConfig(EGL10 paramEGL10, EGLDisplay paramEGLDisplay)
    {
      if (q.c()) {}
      int m;
      for (Object localObject1 = f;; localObject1 = g)
      {
        localObject2 = new int[1];
        paramEGL10.eglChooseConfig(paramEGLDisplay, (int[])localObject1, null, 0, (int[])localObject2);
        m = localObject2[0];
        if (m > 0) {
          break;
        }
        throw new IllegalArgumentException("No configs match configSpec");
      }
      EGLConfig[] arrayOfEGLConfig = new EGLConfig[m];
      paramEGL10.eglChooseConfig(paramEGLDisplay, (int[])localObject1, arrayOfEGLConfig, m, (int[])localObject2);
      Object localObject2 = a(paramEGL10, paramEGLDisplay, arrayOfEGLConfig);
      if ((localObject2 == null) && (this.e > 0))
      {
        if (this.e == 2) {}
        for (m = 0;; m = this.e / 2)
        {
          this.e = m;
          localObject2 = a(paramEGL10, paramEGLDisplay, arrayOfEGLConfig);
          break;
        }
      }
      localObject1 = localObject2;
      if (localObject2 == null)
      {
        localObject1 = localObject2;
        if (this.h == 24)
        {
          this.h = 16;
          localObject1 = a(paramEGL10, paramEGLDisplay, arrayOfEGLConfig);
        }
      }
      paramEGL10 = (EGL10)localObject1;
      if (localObject1 == null) {
        paramEGL10 = arrayOfEGLConfig[0];
      }
      return paramEGL10;
    }
  }
  
  static final class b
    implements GLSurfaceView.EGLContextFactory
  {
    private b(byte paramByte) {}
    
    public final EGLContext createContext(EGL10 paramEGL10, EGLDisplay paramEGLDisplay, EGLConfig paramEGLConfig)
    {
      int i = q.a.a(paramEGL10, paramEGLDisplay, paramEGLConfig, 12320);
      int j = q.a.a(paramEGL10, paramEGLDisplay, paramEGLConfig, 12324);
      int k = q.a.a(paramEGL10, paramEGLDisplay, paramEGLConfig, 12323);
      int m = q.a.a(paramEGL10, paramEGLDisplay, paramEGLConfig, 12322);
      int n = q.a.a(paramEGL10, paramEGLDisplay, paramEGLConfig, 12321);
      int i1 = q.a.a(paramEGL10, paramEGLDisplay, paramEGLConfig, 12325);
      int i2 = q.a.a(paramEGL10, paramEGLDisplay, paramEGLConfig, 12326);
      int i3 = q.a.a(paramEGL10, paramEGLDisplay, paramEGLConfig, 12337);
      int i4 = q.a.a(paramEGL10, paramEGLDisplay, paramEGLConfig, 12513);
      Object localObject = new StringBuilder();
      String str;
      if (n == 0)
      {
        str = "RGB";
        localObject = ((StringBuilder)localObject).append(str).append(i).append(" ").append(Integer.toString(j)).append(Integer.toString(k)).append(Integer.toString(m));
        if (n != 0) {
          break label359;
        }
        str = "";
        label169:
        localObject = ((StringBuilder)localObject).append(str).append(" ").append(Integer.toString(i1)).append("/").append(Integer.toString(i2));
        if (i3 >= 2) {
          break label369;
        }
        str = "";
        label214:
        localObject = ((StringBuilder)localObject).append(str);
        if (i4 >= 2) {
          break label397;
        }
        str = "";
        label233:
        localObject = str;
        StringBuilder localStringBuilder = new StringBuilder().append("Creating OpenGL ES ");
        if (!q.c()) {
          break label425;
        }
        str = "2.0";
        label269:
        q.a(str + " context (" + (String)localObject + ")");
        q.a("Before eglCreateContext", paramEGL10);
        if (!q.c()) {
          break label432;
        }
      }
      label359:
      label369:
      label397:
      label425:
      label432:
      for (i = 2;; i = 1)
      {
        paramEGLDisplay = paramEGL10.eglCreateContext(paramEGLDisplay, paramEGLConfig, EGL10.EGL_NO_CONTEXT, new int[] { 12440, i, 12344 });
        q.a("After eglCreateContext", paramEGL10);
        return paramEGLDisplay;
        str = "RGBA";
        break;
        str = Integer.toString(n);
        break label169;
        str = " AAx" + Integer.toString(i3);
        break label214;
        str = " CSAAx" + Integer.toString(i4);
        break label233;
        str = "1.x";
        break label269;
      }
    }
    
    public final void destroyContext(EGL10 paramEGL10, EGLDisplay paramEGLDisplay, EGLContext paramEGLContext)
    {
      paramEGL10.eglDestroyContext(paramEGLDisplay, paramEGLContext);
    }
  }
}
