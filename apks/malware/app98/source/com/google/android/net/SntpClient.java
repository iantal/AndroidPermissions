package com.google.android.net;

public class SntpClient
{
  private static final int NTP_MODE_CLIENT = 3;
  private static final int NTP_PACKET_SIZE = 48;
  private static final int NTP_PORT = 123;
  private static final int NTP_VERSION = 3;
  private static final long OFFSET_1900_TO_1970 = 2208988800L;
  private static final int ORIGINATE_TIME_OFFSET = 24;
  private static final int RECEIVE_TIME_OFFSET = 32;
  private static final int REFERENCE_TIME_OFFSET = 16;
  private static final String TAG = "SntpClient";
  private static final int TRANSMIT_TIME_OFFSET = 40;
  private long mNtpTime;
  private long mNtpTimeReference;
  private long mRoundTripTime;
  
  public SntpClient() {}
  
  private long read32(byte[] paramArrayOfByte, int paramInt)
  {
    int m = paramArrayOfByte[paramInt];
    int i = paramArrayOfByte[(paramInt + 1)];
    int j = paramArrayOfByte[(paramInt + 2)];
    int k = paramArrayOfByte[(paramInt + 3)];
    if ((m & 0x80) == 128)
    {
      paramInt = (m & 0x7F) + 128;
      if ((i & 0x80) != 128) {
        break label142;
      }
      i = (i & 0x7F) + 128;
      label67:
      if ((j & 0x80) != 128) {
        break label145;
      }
      j = (j & 0x7F) + 128;
      label90:
      if ((k & 0x80) != 128) {
        break label148;
      }
      k = (k & 0x7F) + 128;
    }
    label142:
    label145:
    label148:
    for (;;)
    {
      return (paramInt << 24) + (i << 16) + (j << 8) + k;
      paramInt = m;
      break;
      break label67;
      break label90;
    }
  }
  
  private long readTimeStamp(byte[] paramArrayOfByte, int paramInt)
  {
    return (read32(paramArrayOfByte, paramInt) - 2208988800L) * 1000L + 1000L * read32(paramArrayOfByte, paramInt + 4) / 4294967296L;
  }
  
  private void writeTimeStamp(byte[] paramArrayOfByte, int paramInt, long paramLong)
  {
    long l1 = paramLong / 1000L;
    long l2 = l1 + 2208988800L;
    int i = paramInt + 1;
    paramArrayOfByte[paramInt] = ((byte)(int)(l2 >> 24));
    paramInt = i + 1;
    paramArrayOfByte[i] = ((byte)(int)(l2 >> 16));
    i = paramInt + 1;
    paramArrayOfByte[paramInt] = ((byte)(int)(l2 >> 8));
    paramInt = i + 1;
    paramArrayOfByte[i] = ((byte)(int)(l2 >> 0));
    paramLong = 4294967296L * (paramLong - 1000L * l1) / 1000L;
    i = paramInt + 1;
    paramArrayOfByte[paramInt] = ((byte)(int)(paramLong >> 24));
    paramInt = i + 1;
    paramArrayOfByte[i] = ((byte)(int)(paramLong >> 16));
    i = paramInt + 1;
    paramArrayOfByte[paramInt] = ((byte)(int)(paramLong >> 8));
    paramArrayOfByte[i] = ((byte)(int)(Math.random() * 255.0D));
  }
  
  public long getNtpTime()
  {
    return this.mNtpTime;
  }
  
  public long getNtpTimeReference()
  {
    return this.mNtpTimeReference;
  }
  
  public long getRoundTripTime()
  {
    return this.mRoundTripTime;
  }
  
  /* Error */
  public boolean requestTime(String paramString, int paramInt)
  {
    // Byte code:
    //   0: aconst_null
    //   1: astore 17
    //   3: aconst_null
    //   4: astore 18
    //   6: new 71	java/net/DatagramSocket
    //   9: dup
    //   10: invokespecial 72	java/net/DatagramSocket:<init>	()V
    //   13: astore 16
    //   15: aload 16
    //   17: iload_2
    //   18: invokevirtual 76	java/net/DatagramSocket:setSoTimeout	(I)V
    //   21: aload_1
    //   22: invokestatic 82	java/net/InetAddress:getByName	(Ljava/lang/String;)Ljava/net/InetAddress;
    //   25: astore 17
    //   27: bipush 48
    //   29: newarray byte
    //   31: astore_1
    //   32: new 84	java/net/DatagramPacket
    //   35: dup
    //   36: aload_1
    //   37: aload_1
    //   38: arraylength
    //   39: aload 17
    //   41: bipush 123
    //   43: invokespecial 87	java/net/DatagramPacket:<init>	([BILjava/net/InetAddress;I)V
    //   46: astore 17
    //   48: aload_1
    //   49: iconst_0
    //   50: bipush 27
    //   52: bastore
    //   53: invokestatic 92	java/lang/System:currentTimeMillis	()J
    //   56: lstore 7
    //   58: invokestatic 97	android/os/SystemClock:elapsedRealtime	()J
    //   61: lstore_3
    //   62: aload_0
    //   63: aload_1
    //   64: bipush 40
    //   66: lload 7
    //   68: invokespecial 99	com/google/android/net/SntpClient:writeTimeStamp	([BIJ)V
    //   71: aload 16
    //   73: aload 17
    //   75: invokevirtual 103	java/net/DatagramSocket:send	(Ljava/net/DatagramPacket;)V
    //   78: aload 16
    //   80: new 84	java/net/DatagramPacket
    //   83: dup
    //   84: aload_1
    //   85: aload_1
    //   86: arraylength
    //   87: invokespecial 106	java/net/DatagramPacket:<init>	([BI)V
    //   90: invokevirtual 109	java/net/DatagramSocket:receive	(Ljava/net/DatagramPacket;)V
    //   93: invokestatic 97	android/os/SystemClock:elapsedRealtime	()J
    //   96: lstore 5
    //   98: lload 7
    //   100: lload 5
    //   102: lload_3
    //   103: lsub
    //   104: ladd
    //   105: lstore 7
    //   107: aload_0
    //   108: aload_1
    //   109: bipush 24
    //   111: invokespecial 111	com/google/android/net/SntpClient:readTimeStamp	([BI)J
    //   114: lstore 9
    //   116: aload_0
    //   117: aload_1
    //   118: bipush 32
    //   120: invokespecial 111	com/google/android/net/SntpClient:readTimeStamp	([BI)J
    //   123: lstore 11
    //   125: aload_0
    //   126: aload_1
    //   127: bipush 40
    //   129: invokespecial 111	com/google/android/net/SntpClient:readTimeStamp	([BI)J
    //   132: lstore 13
    //   134: aload_0
    //   135: lload 7
    //   137: lload 11
    //   139: lload 9
    //   141: lsub
    //   142: lload 13
    //   144: lload 7
    //   146: lsub
    //   147: ladd
    //   148: ldc2_w 112
    //   151: ldiv
    //   152: ladd
    //   153: putfield 59	com/google/android/net/SntpClient:mNtpTime	J
    //   156: aload_0
    //   157: lload 5
    //   159: putfield 62	com/google/android/net/SntpClient:mNtpTimeReference	J
    //   162: aload_0
    //   163: lload 5
    //   165: lload_3
    //   166: lsub
    //   167: lload 13
    //   169: lload 11
    //   171: lsub
    //   172: lsub
    //   173: putfield 65	com/google/android/net/SntpClient:mRoundTripTime	J
    //   176: aload 16
    //   178: ifnull +8 -> 186
    //   181: aload 16
    //   183: invokevirtual 116	java/net/DatagramSocket:close	()V
    //   186: iconst_1
    //   187: istore 15
    //   189: iload 15
    //   191: ireturn
    //   192: astore_1
    //   193: aload 18
    //   195: astore_1
    //   196: iconst_0
    //   197: istore 15
    //   199: aload_1
    //   200: ifnull -11 -> 189
    //   203: aload_1
    //   204: invokevirtual 116	java/net/DatagramSocket:close	()V
    //   207: iconst_0
    //   208: ireturn
    //   209: astore 16
    //   211: aload 17
    //   213: astore_1
    //   214: aload_1
    //   215: ifnull +7 -> 222
    //   218: aload_1
    //   219: invokevirtual 116	java/net/DatagramSocket:close	()V
    //   222: aload 16
    //   224: athrow
    //   225: astore 17
    //   227: aload 16
    //   229: astore_1
    //   230: aload 17
    //   232: astore 16
    //   234: goto -20 -> 214
    //   237: astore_1
    //   238: aload 16
    //   240: astore_1
    //   241: goto -45 -> 196
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	244	0	this	SntpClient
    //   0	244	1	paramString	String
    //   0	244	2	paramInt	int
    //   61	105	3	l1	long
    //   96	68	5	l2	long
    //   56	89	7	l3	long
    //   114	26	9	l4	long
    //   123	47	11	l5	long
    //   132	36	13	l6	long
    //   187	11	15	bool	boolean
    //   13	169	16	localDatagramSocket	java.net.DatagramSocket
    //   209	19	16	localObject1	Object
    //   232	7	16	localObject2	Object
    //   1	211	17	localObject3	Object
    //   225	6	17	localObject4	Object
    //   4	190	18	localObject5	Object
    // Exception table:
    //   from	to	target	type
    //   6	15	192	java/lang/Exception
    //   6	15	209	finally
    //   15	48	225	finally
    //   53	98	225	finally
    //   107	176	225	finally
    //   15	48	237	java/lang/Exception
    //   53	98	237	java/lang/Exception
    //   107	176	237	java/lang/Exception
  }
}
