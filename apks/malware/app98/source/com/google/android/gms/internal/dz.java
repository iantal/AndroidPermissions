package com.google.android.gms.internal;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageManager.NameNotFoundException;
import android.content.res.Resources;
import android.graphics.Color;
import android.graphics.Point;
import android.graphics.drawable.Drawable;
import android.net.Uri;
import android.os.Bundle;
import android.util.AttributeSet;
import android.util.DisplayMetrics;
import android.util.Log;
import android.util.TypedValue;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.CompoundButton;
import android.widget.FrameLayout;
import android.widget.FrameLayout.LayoutParams;
import android.widget.LinearLayout;
import android.widget.LinearLayout.LayoutParams;
import android.widget.ProgressBar;
import android.widget.TextView;
import com.google.android.gms.common.ConnectionResult;
import com.google.android.gms.common.GooglePlayServicesClient.ConnectionCallbacks;
import com.google.android.gms.common.GooglePlayServicesClient.OnConnectionFailedListener;
import com.google.android.gms.common.GooglePlayServicesUtil;
import com.google.android.gms.plus.PlusClient;
import com.google.android.gms.plus.PlusClient.b;
import com.google.android.gms.plus.PlusOneButton.OnPlusOneClickListener;

public class dz
  extends LinearLayout
  implements GooglePlayServicesClient.ConnectionCallbacks, GooglePlayServicesClient.OnConnectionFailedListener
{
  private static final int hr = Color.parseColor("#666666");
  private int K = 3;
  protected int bi = 1;
  protected PlusClient gY;
  private int hA = 2;
  private Uri[] hB;
  private String[] hC;
  private String[] hD;
  protected String hE;
  protected du hF;
  protected final Resources hG;
  protected final LayoutInflater hH;
  private b hI = new b();
  protected boolean hs;
  protected int ht = 0;
  protected final LinearLayout hu;
  protected final FrameLayout hv;
  protected final CompoundButton hw;
  private final ProgressBar hx;
  protected final ea hy;
  private final dt[] hz = new dt[4];
  
  public dz(Context paramContext, AttributeSet paramAttributeSet)
  {
    super(paramContext, paramAttributeSet);
    x.b(paramContext, "Context must not be null.");
    if (GooglePlayServicesUtil.isGooglePlayServicesAvailable(paramContext) != 0) {
      this.hG = null;
    }
    Context localContext;
    for (this.hH = null;; this.hH = ((LayoutInflater)localContext.getSystemService("layout_inflater")))
    {
      this.K = a(paramContext, paramAttributeSet);
      this.hA = b(paramContext, paramAttributeSet);
      paramAttributeSet = new Point();
      a(paramAttributeSet);
      if (!isInEditMode()) {
        break;
      }
      paramContext = new TextView(paramContext);
      paramContext.setGravity(17);
      paramContext.setText("[ +1 ]");
      addView(paramContext, new LinearLayout.LayoutParams(paramAttributeSet.x, paramAttributeSet.y));
      this.hy = null;
      this.hx = null;
      this.hw = null;
      this.hv = null;
      this.hu = null;
      return;
      localContext = k(paramContext);
      this.hG = localContext.getResources();
    }
    setFocusable(true);
    this.hu = new LinearLayout(paramContext);
    this.hu.setGravity(17);
    this.hu.setOrientation(0);
    addView(this.hu);
    this.hw = new c(paramContext);
    this.hw.setBackgroundDrawable(null);
    this.hy = n(paramContext);
    this.hv = l(paramContext);
    this.hv.addView(this.hw, new FrameLayout.LayoutParams(paramAttributeSet.x, paramAttributeSet.y, 17));
    b(paramAttributeSet);
    this.hx = m(paramContext);
    this.hx.setVisibility(4);
    this.hv.addView(this.hx, new FrameLayout.LayoutParams(paramAttributeSet.x, paramAttributeSet.y, 17));
    int j = this.hz.length;
    int i = 0;
    while (i < j)
    {
      this.hz[i] = o(getContext());
      i += 1;
    }
    bm();
  }
  
  private int a(Context paramContext, AttributeSet paramAttributeSet)
  {
    paramContext = ab.a("http://schemas.android.com/apk/lib/com.google.android.gms.plus", "size", paramContext, paramAttributeSet, true, false, "PlusOneButton");
    if ("SMALL".equalsIgnoreCase(paramContext)) {
      return 0;
    }
    if ("MEDIUM".equalsIgnoreCase(paramContext)) {
      return 1;
    }
    if ("TALL".equalsIgnoreCase(paramContext)) {
      return 2;
    }
    if ("STANDARD".equalsIgnoreCase(paramContext)) {
      return 3;
    }
    return 3;
  }
  
  private void a(Point paramPoint)
  {
    int i = 24;
    int j = 20;
    switch (this.K)
    {
    default: 
      i = 38;
      j = 24;
    }
    for (;;)
    {
      DisplayMetrics localDisplayMetrics = getResources().getDisplayMetrics();
      float f1 = TypedValue.applyDimension(1, i, localDisplayMetrics);
      float f2 = TypedValue.applyDimension(1, j, localDisplayMetrics);
      paramPoint.x = ((int)(f1 + 0.5D));
      paramPoint.y = ((int)(f2 + 0.5D));
      return;
      i = 32;
      continue;
      j = 14;
      continue;
      i = 50;
    }
  }
  
  private void a(Uri[] paramArrayOfUri)
  {
    this.hB = paramArrayOfUri;
    bq();
  }
  
  private int b(Context paramContext, AttributeSet paramAttributeSet)
  {
    int i = 1;
    paramContext = ab.a("http://schemas.android.com/apk/lib/com.google.android.gms.plus", "annotation", paramContext, paramAttributeSet, true, false, "PlusOneButton");
    if ("INLINE".equalsIgnoreCase(paramContext)) {
      i = 2;
    }
    do
    {
      return i;
      if ("NONE".equalsIgnoreCase(paramContext)) {
        return 0;
      }
    } while (!"BUBBLE".equalsIgnoreCase(paramContext));
    return 1;
  }
  
  private void b(Point paramPoint)
  {
    paramPoint.y = ((int)(paramPoint.y - TypedValue.applyDimension(1, 6.0F, getResources().getDisplayMetrics())));
    paramPoint.x = paramPoint.y;
  }
  
  private void bh()
  {
    int i = 1;
    int k = (int)TypedValue.applyDimension(1, 5.0F, getContext().getResources().getDisplayMetrics());
    int m = (int)TypedValue.applyDimension(1, 1.0F, getContext().getResources().getDisplayMetrics());
    int n = this.hz.length;
    int j = 0;
    while (j < n) {
      if (this.hz[j].getVisibility() != 0)
      {
        j += 1;
      }
      else
      {
        LinearLayout.LayoutParams localLayoutParams = new LinearLayout.LayoutParams(this.hz[j].getLayoutParams());
        if (i != 0)
        {
          localLayoutParams.setMargins(k, 0, m, 0);
          i = 0;
        }
        for (;;)
        {
          this.hz[j].setLayoutParams(localLayoutParams);
          break;
          localLayoutParams.setMargins(m, 0, m, 0);
        }
      }
    }
  }
  
  private LinearLayout.LayoutParams bj()
  {
    int j = 0;
    LinearLayout.LayoutParams localLayoutParams;
    switch (this.hA)
    {
    default: 
      localLayoutParams = new LinearLayout.LayoutParams(-2, -2);
      if (this.K == 2)
      {
        i = 1;
        label50:
        localLayoutParams.bottomMargin = i;
        if (this.K != 2) {
          break label106;
        }
      }
      break;
    }
    label106:
    for (int i = j;; i = 1)
    {
      localLayoutParams.leftMargin = i;
      return localLayoutParams;
      localLayoutParams = new LinearLayout.LayoutParams(-2, -1);
      break;
      localLayoutParams = new LinearLayout.LayoutParams(-2, -2);
      break;
      i = 0;
      break label50;
    }
  }
  
  private void bp()
  {
    switch (this.hA)
    {
    default: 
      this.hy.f(null);
      this.hy.setVisibility(8);
      return;
    case 2: 
      this.hy.f(this.hC);
      this.hy.setVisibility(0);
      return;
    }
    this.hy.f(this.hD);
    this.hy.setVisibility(0);
  }
  
  private void bq()
  {
    int i = 0;
    int j;
    if ((this.hB != null) && (this.hA == 2))
    {
      Point localPoint = new Point();
      a(localPoint);
      localPoint.x = localPoint.y;
      j = this.hz.length;
      int k = this.hB.length;
      i = 0;
      if (i < j)
      {
        Uri localUri;
        if (i < k)
        {
          localUri = this.hB[i];
          label74:
          if (localUri != null) {
            break label103;
          }
          this.hz[i].setVisibility(8);
        }
        for (;;)
        {
          i += 1;
          break;
          localUri = null;
          break label74;
          label103:
          this.hz[i].setLayoutParams(new LinearLayout.LayoutParams(localPoint.x, localPoint.y));
          this.hz[i].a(localUri, localPoint.y);
          this.hz[i].setVisibility(0);
        }
      }
    }
    else
    {
      j = this.hz.length;
      while (i < j)
      {
        this.hz[i].setVisibility(8);
        i += 1;
      }
    }
    bh();
  }
  
  private Drawable br()
  {
    if (this.hG == null) {
      return null;
    }
    return this.hG.getDrawable(this.hG.getIdentifier(bs(), "drawable", "com.google.android.gms"));
  }
  
  private String bs()
  {
    switch (this.K)
    {
    default: 
      return "ic_plusone_standard";
    case 0: 
      return "ic_plusone_small";
    case 1: 
      return "ic_plusone_medium";
    }
    return "ic_plusone_tall";
  }
  
  private Uri bt()
  {
    return y.i(bu());
  }
  
  private String bu()
  {
    switch (this.K)
    {
    default: 
      return "global_count_bubble_standard";
    case 1: 
      return "global_count_bubble_medium";
    case 0: 
      return "global_count_bubble_small";
    }
    return "global_count_bubble_tall";
  }
  
  private void c(int paramInt1, int paramInt2)
  {
    this.bi = paramInt2;
    this.K = paramInt1;
    bi();
  }
  
  private void c(View paramView)
  {
    int j = (int)TypedValue.applyDimension(1, 3.0F, getContext().getResources().getDisplayMetrics());
    int i = (int)TypedValue.applyDimension(1, 5.0F, getContext().getResources().getDisplayMetrics());
    if (this.hA == 2) {
      if ((this.K != 2) || (this.hA != 1)) {
        break label76;
      }
    }
    for (;;)
    {
      paramView.setPadding(i, 0, 0, j);
      return;
      i = 0;
      break;
      label76:
      j = 0;
    }
  }
  
  private static int d(int paramInt1, int paramInt2)
  {
    switch (paramInt1)
    {
    case 1: 
    default: 
    case 2: 
      do
      {
        return 13;
      } while (paramInt2 == 2);
      return 15;
    }
    return 11;
  }
  
  private void d(String[] paramArrayOfString)
  {
    this.hC = paramArrayOfString;
    bp();
  }
  
  private void e(String[] paramArrayOfString)
  {
    this.hD = paramArrayOfString;
    bp();
  }
  
  private Context k(Context paramContext)
  {
    try
    {
      paramContext = getContext().createPackageContext("com.google.android.gms", 4);
      return paramContext;
    }
    catch (PackageManager.NameNotFoundException paramContext)
    {
      if (Log.isLoggable("PlusOneButton", 5)) {
        Log.w("PlusOneButton", "Google Play services is not installed");
      }
    }
    return null;
  }
  
  private FrameLayout l(Context paramContext)
  {
    paramContext = new FrameLayout(paramContext);
    paramContext.setFocusable(false);
    return paramContext;
  }
  
  private ProgressBar m(Context paramContext)
  {
    paramContext = new ProgressBar(paramContext, null, 16843400);
    paramContext.setFocusable(false);
    paramContext.setIndeterminate(true);
    return paramContext;
  }
  
  private ea n(Context paramContext)
  {
    ea localEa = new ea(paramContext);
    localEa.setFocusable(false);
    localEa.setGravity(17);
    localEa.setSingleLine();
    localEa.setTextSize(0, TypedValue.applyDimension(2, d(this.K, this.hA), paramContext.getResources().getDisplayMetrics()));
    localEa.setTextColor(hr);
    localEa.setVisibility(0);
    return localEa;
  }
  
  private dt o(Context paramContext)
  {
    paramContext = new dt(paramContext);
    paramContext.setVisibility(8);
    return paramContext;
  }
  
  protected void bc()
  {
    if (this.hF == null) {
      return;
    }
    d(this.hF.bf());
    e(new String[] { this.hF.be() });
    a(this.hF.bg());
    if (this.hF.bd())
    {
      bn();
      return;
    }
    bm();
  }
  
  protected void bi()
  {
    int i = 0;
    if (isInEditMode()) {
      return;
    }
    this.hu.removeAllViews();
    Point localPoint = new Point();
    a(localPoint);
    this.hw.setLayoutParams(new FrameLayout.LayoutParams(localPoint.x, localPoint.y, 17));
    b(localPoint);
    this.hx.setLayoutParams(new FrameLayout.LayoutParams(localPoint.x, localPoint.y, 17));
    if (this.hA == 1)
    {
      this.hy.a(bt());
      bq();
      this.hy.setLayoutParams(bj());
      float f = TypedValue.applyDimension(2, d(this.K, this.hA), getContext().getResources().getDisplayMetrics());
      this.hy.setTextSize(0, f);
      c(this.hy);
      if ((this.K != 2) || (this.hA != 1)) {
        break label230;
      }
      this.hu.setOrientation(1);
      this.hu.addView(this.hy);
      this.hu.addView(this.hv);
    }
    for (;;)
    {
      requestLayout();
      return;
      this.hy.a(null);
      break;
      label230:
      this.hu.setOrientation(0);
      this.hu.addView(this.hv);
      int j = this.hz.length;
      while (i < j)
      {
        this.hu.addView(this.hz[i]);
        i += 1;
      }
      this.hu.addView(this.hy);
    }
  }
  
  public void bk()
  {
    setType(2);
    this.hx.setVisibility(0);
    bo();
  }
  
  public void bl()
  {
    setType(3);
    this.hx.setVisibility(4);
    bo();
  }
  
  protected void bm()
  {
    setType(1);
    this.hx.setVisibility(4);
    bo();
  }
  
  protected void bn()
  {
    setType(0);
    this.hx.setVisibility(4);
    bo();
  }
  
  protected void bo()
  {
    this.hw.setButtonDrawable(br());
    switch (this.bi)
    {
    default: 
      this.hw.setEnabled(false);
      this.hw.setChecked(false);
      return;
    case 0: 
      this.hw.setEnabled(true);
      this.hw.setChecked(true);
      return;
    case 1: 
      this.hw.setEnabled(true);
      this.hw.setChecked(false);
      return;
    }
    this.hw.setEnabled(false);
    this.hw.setChecked(true);
  }
  
  public void initialize(PlusClient paramPlusClient, String paramString, int paramInt)
  {
    int i = 0;
    x.b(paramPlusClient, "Plus client must not be null.");
    x.b(paramString, "URL must not be null.");
    if ((paramInt >= 0) && (paramInt <= 65535)) {}
    for (boolean bool = true;; bool = false)
    {
      x.a(bool, "activityRequestCode must be an unsigned 16 bit integer.");
      this.ht = paramInt;
      this.hE = paramString;
      if (paramPlusClient == this.gY) {
        break;
      }
      if (this.gY != null)
      {
        this.gY.unregisterConnectionCallbacks(this);
        this.gY.unregisterConnectionFailedListener(this);
      }
      this.gY = paramPlusClient;
      this.gY.registerConnectionCallbacks(this);
      this.gY.registerConnectionFailedListener(this);
      int j = this.hz.length;
      paramInt = i;
      while (paramInt < j)
      {
        this.hz[paramInt].a(paramPlusClient);
        paramInt += 1;
      }
    }
    if (this.gY.isConnected()) {
      onConnected(null);
    }
    bi();
  }
  
  protected void onAttachedToWindow()
  {
    super.onAttachedToWindow();
    if (this.gY != null)
    {
      if (!this.gY.isConnectionCallbacksRegistered(this)) {
        this.gY.registerConnectionCallbacks(this);
      }
      if (!this.gY.isConnectionFailedListenerRegistered(this)) {
        this.gY.registerConnectionFailedListener(this);
      }
    }
  }
  
  public void onConnected(Bundle paramBundle)
  {
    if (this.hE != null) {
      this.gY.a(this.hI, this.hE);
    }
  }
  
  public void onConnectionFailed(ConnectionResult paramConnectionResult)
  {
    bl();
  }
  
  protected void onDetachedFromWindow()
  {
    super.onDetachedFromWindow();
    if (this.gY != null)
    {
      if (this.gY.isConnectionCallbacksRegistered(this)) {
        this.gY.unregisterConnectionCallbacks(this);
      }
      if (this.gY.isConnectionFailedListenerRegistered(this)) {
        this.gY.unregisterConnectionFailedListener(this);
      }
    }
  }
  
  public void onDisconnected() {}
  
  public boolean performClick()
  {
    return this.hw.performClick();
  }
  
  public void setAnnotation(int paramInt)
  {
    x.b(Integer.valueOf(paramInt), "Annotation must not be null.");
    this.hA = paramInt;
    bp();
    bi();
  }
  
  public void setOnClickListener(View.OnClickListener paramOnClickListener)
  {
    this.hw.setOnClickListener(paramOnClickListener);
    this.hy.setOnClickListener(paramOnClickListener);
  }
  
  public void setOnPlusOneClickListener(PlusOneButton.OnPlusOneClickListener paramOnPlusOneClickListener)
  {
    setOnClickListener(new a(paramOnPlusOneClickListener));
  }
  
  public void setSize(int paramInt)
  {
    c(paramInt, this.bi);
  }
  
  public void setType(int paramInt)
  {
    c(this.K, paramInt);
  }
  
  class a
    implements View.OnClickListener, PlusOneButton.OnPlusOneClickListener
  {
    private final PlusOneButton.OnPlusOneClickListener hJ;
    
    public a(PlusOneButton.OnPlusOneClickListener paramOnPlusOneClickListener)
    {
      this.hJ = paramOnPlusOneClickListener;
    }
    
    public void onClick(View paramView)
    {
      if ((paramView == dz.this.hw) || (paramView == dz.this.hy)) {
        if (dz.this.hF != null) {
          break label52;
        }
      }
      label52:
      for (paramView = null; this.hJ != null; paramView = dz.this.hF.getIntent())
      {
        this.hJ.onPlusOneClick(paramView);
        return;
      }
      onPlusOneClick(paramView);
    }
    
    public void onPlusOneClick(Intent paramIntent)
    {
      Context localContext = dz.this.getContext();
      if (((localContext instanceof Activity)) && (paramIntent != null)) {
        ((Activity)localContext).startActivityForResult(paramIntent, dz.this.ht);
      }
    }
  }
  
  public class b
    implements PlusClient.b
  {
    protected b() {}
    
    public void a(ConnectionResult paramConnectionResult, du paramDu)
    {
      if (dz.this.hs)
      {
        dz.this.hs = false;
        dz.this.hw.refreshDrawableState();
      }
      if ((paramConnectionResult.isSuccess()) && (paramDu != null))
      {
        dz.this.hF = paramDu;
        dz.this.bc();
        dz.this.bi();
        return;
      }
      dz.this.bl();
    }
  }
  
  class c
    extends CompoundButton
  {
    public c(Context paramContext)
    {
      super();
    }
    
    public void toggle()
    {
      if (dz.this.hs)
      {
        super.toggle();
        return;
      }
      dz.this.hs = true;
      dz.this.bk();
    }
  }
}
