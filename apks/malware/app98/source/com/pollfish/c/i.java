package com.pollfish.c;

import android.app.Activity;
import android.content.Context;
import android.content.res.Resources;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.BitmapFactory.Options;
import android.os.AsyncTask;
import com.pollfish.a.b;
import com.pollfish.a.c;
import com.pollfish.f.b;
import com.pollfish.f.b.a;
import com.pollfish.main.PollFish;
import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.OutputStream;
import java.lang.reflect.Field;
import java.net.URL;

public class i
  extends AsyncTask
{
  private c a;
  private com.pollfish.interfaces.a.a b;
  private Activity c;
  private String d;
  private String e;
  
  public i(c paramC, com.pollfish.interfaces.a.a paramA, Activity paramActivity)
  {
    this.a = paramC;
    this.b = paramA;
    this.c = paramActivity;
    this.d = (paramActivity.getApplicationContext().getCacheDir().getAbsolutePath() + "/" + "pollfish_cache" + paramC.a());
    try
    {
      this.e = this.d.substring(this.d.lastIndexOf("/") + 1, this.d.length());
      return;
    }
    catch (Exception paramC)
    {
      b.b("WriteAssetInInternalCacheTask", "Error retrieving file parent and name: " + this.e);
      a.a(paramC);
    }
  }
  
  private Bitmap a(Context paramContext, String paramString, int paramInt, boolean paramBoolean)
  {
    paramString = PollFish.class.getClassLoader().getResource(paramString);
    BitmapFactory.Options localOptions = new BitmapFactory.Options();
    localOptions.inScaled = paramBoolean;
    if (paramString == null) {
      return BitmapFactory.decodeResource(paramContext.getResources(), paramInt, localOptions);
    }
    try
    {
      paramContext = BitmapFactory.decodeStream(paramString.openStream(), null, localOptions);
      return paramContext;
    }
    catch (Exception paramContext)
    {
      a.a(paramContext);
      b.b("WriteAssetInInternalCacheTask", "BITMAP NOT DECODED: getBitmap error: " + paramContext);
    }
    return null;
  }
  
  private boolean a(Context paramContext, Bitmap paramBitmap, String paramString)
  {
    if (paramBitmap != null) {}
    try
    {
      return a(paramBitmap, paramString);
    }
    catch (Exception paramContext)
    {
      for (;;)
      {
        a.a(paramContext);
        b.b("WriteAssetInInternalCacheTask", "Bitmap not loaded");
      }
    }
    b.a("WriteAssetInInternalCacheTask", "bitmap = null for path: " + paramString);
    return false;
  }
  
  private boolean a(Context paramContext, String paramString, int paramInt, File paramFile)
  {
    InputStream localInputStream = PollFish.class.getClassLoader().getResourceAsStream(paramString);
    if (localInputStream == null)
    {
      b.a("WriteAssetInInternalCacheTask", "opening resource with name  " + paramString + " returned inputStream == null");
      return a(paramContext.getResources().openRawResource(paramInt), paramFile);
    }
    try
    {
      b.a("WriteAssetInInternalCacheTask", "inputStream != null for inputStream with name: " + paramString);
      boolean bool = a(localInputStream, paramFile);
      return bool;
    }
    catch (Exception paramContext)
    {
      a.a(paramContext);
      b.b("WriteAssetInInternalCacheTask", "getIfFileExistsInInternalMemoryAndWrite e: " + paramContext);
    }
    try
    {
      if (paramFile.exists()) {
        paramFile.delete();
      }
      return false;
    }
    catch (Exception paramContext)
    {
      for (;;)
      {
        a.a(paramContext);
        b.b("WriteAssetInInternalCacheTask", "getIfFileExistsInInternalMemoryAndWrite delete() e: " + paramContext);
      }
    }
  }
  
  /* Error */
  private boolean a(Bitmap paramBitmap, String paramString)
  {
    // Byte code:
    //   0: new 43	java/io/File
    //   3: dup
    //   4: aload_2
    //   5: invokespecial 190	java/io/File:<init>	(Ljava/lang/String;)V
    //   8: astore_2
    //   9: new 192	java/io/FileOutputStream
    //   12: dup
    //   13: aload_2
    //   14: invokespecial 195	java/io/FileOutputStream:<init>	(Ljava/io/File;)V
    //   17: astore_3
    //   18: aload_1
    //   19: getstatic 201	android/graphics/Bitmap$CompressFormat:PNG	Landroid/graphics/Bitmap$CompressFormat;
    //   22: bipush 100
    //   24: aload_3
    //   25: invokevirtual 207	android/graphics/Bitmap:compress	(Landroid/graphics/Bitmap$CompressFormat;ILjava/io/OutputStream;)Z
    //   28: pop
    //   29: aload_3
    //   30: invokevirtual 210	java/io/FileOutputStream:flush	()V
    //   33: aload_3
    //   34: invokevirtual 213	java/io/FileOutputStream:close	()V
    //   37: iconst_1
    //   38: ireturn
    //   39: astore_1
    //   40: ldc 82
    //   42: new 28	java/lang/StringBuilder
    //   45: dup
    //   46: invokespecial 29	java/lang/StringBuilder:<init>	()V
    //   49: ldc -41
    //   51: invokevirtual 51	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   54: aload_1
    //   55: invokevirtual 142	java/lang/StringBuilder:append	(Ljava/lang/Object;)Ljava/lang/StringBuilder;
    //   58: invokevirtual 62	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   61: invokestatic 89	com/pollfish/f/b:b	(Ljava/lang/String;Ljava/lang/String;)V
    //   64: aload_1
    //   65: invokestatic 94	com/pollfish/f/b/a:a	(Ljava/lang/Throwable;)V
    //   68: aload_2
    //   69: invokevirtual 178	java/io/File:exists	()Z
    //   72: ifeq +8 -> 80
    //   75: aload_2
    //   76: invokevirtual 181	java/io/File:delete	()Z
    //   79: pop
    //   80: iconst_0
    //   81: ireturn
    //   82: astore_1
    //   83: ldc 82
    //   85: new 28	java/lang/StringBuilder
    //   88: dup
    //   89: invokespecial 29	java/lang/StringBuilder:<init>	()V
    //   92: ldc -41
    //   94: invokevirtual 51	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   97: aload_1
    //   98: invokevirtual 142	java/lang/StringBuilder:append	(Ljava/lang/Object;)Ljava/lang/StringBuilder;
    //   101: invokevirtual 62	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   104: invokestatic 89	com/pollfish/f/b:b	(Ljava/lang/String;Ljava/lang/String;)V
    //   107: aload_1
    //   108: invokestatic 94	com/pollfish/f/b/a:a	(Ljava/lang/Throwable;)V
    //   111: goto -43 -> 68
    //   114: astore_1
    //   115: ldc 82
    //   117: new 28	java/lang/StringBuilder
    //   120: dup
    //   121: invokespecial 29	java/lang/StringBuilder:<init>	()V
    //   124: ldc -41
    //   126: invokevirtual 51	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   129: aload_1
    //   130: invokevirtual 142	java/lang/StringBuilder:append	(Ljava/lang/Object;)Ljava/lang/StringBuilder;
    //   133: invokevirtual 62	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   136: invokestatic 89	com/pollfish/f/b:b	(Ljava/lang/String;Ljava/lang/String;)V
    //   139: aload_1
    //   140: invokestatic 94	com/pollfish/f/b/a:a	(Ljava/lang/Throwable;)V
    //   143: goto -75 -> 68
    //   146: astore_1
    //   147: aload_1
    //   148: invokestatic 94	com/pollfish/f/b/a:a	(Ljava/lang/Throwable;)V
    //   151: ldc 82
    //   153: new 28	java/lang/StringBuilder
    //   156: dup
    //   157: invokespecial 29	java/lang/StringBuilder:<init>	()V
    //   160: ldc -39
    //   162: invokevirtual 51	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   165: aload_1
    //   166: invokevirtual 142	java/lang/StringBuilder:append	(Ljava/lang/Object;)Ljava/lang/StringBuilder;
    //   169: invokevirtual 62	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   172: invokestatic 89	com/pollfish/f/b:b	(Ljava/lang/String;Ljava/lang/String;)V
    //   175: goto -95 -> 80
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	178	0	this	i
    //   0	178	1	paramBitmap	Bitmap
    //   0	178	2	paramString	String
    //   17	17	3	localFileOutputStream	FileOutputStream
    // Exception table:
    //   from	to	target	type
    //   9	37	39	java/io/FileNotFoundException
    //   9	37	82	java/io/IOException
    //   9	37	114	java/lang/Exception
    //   68	80	146	java/lang/Exception
  }
  
  private boolean a(InputStream paramInputStream, File paramFile)
  {
    try
    {
      FileOutputStream localFileOutputStream = new FileOutputStream(paramFile);
      byte[] arrayOfByte = new byte['Ä€'];
      for (;;)
      {
        int i = paramInputStream.read(arrayOfByte);
        if (i == -1) {
          break;
        }
        localFileOutputStream.write(arrayOfByte, 0, i);
      }
      boolean bool;
      return false;
    }
    catch (Exception paramInputStream)
    {
      b.b("WriteAssetInInternalCacheTask", "writeToMemoryFromInputStream error: " + paramInputStream);
      a.a(paramInputStream);
      try
      {
        if (paramFile.exists()) {
          paramFile.delete();
        }
        return false;
      }
      catch (Exception paramInputStream)
      {
        a.a(paramInputStream);
        b.b("WriteAssetInInternalCacheTask", "writeToMemoryFromInputStream error: " + paramInputStream);
      }
      localFileOutputStream.close();
      bool = paramFile.exists();
      return bool;
    }
  }
  
  protected Boolean a(Void... paramVarArgs)
  {
    if (this.a != null) {}
    try
    {
      if (this.a.e() == 0) {}
      for (i = a.b.class.getDeclaredField(this.a.c()).getInt(null);; i = com.pollfish.a.a.class.getDeclaredField(this.a.c()).getInt(null))
      {
        paramVarArgs = new File(this.d);
        boolean bool = paramVarArgs.exists();
        b.a("WriteAssetInInternalCacheTask", "file: " + this.e + " exists in cache: " + bool);
        if (bool) {
          break label247;
        }
        b.a("WriteAssetInInternalCacheTask", "file: " + this.e + " try to copy....");
        if (this.a.e() != 0) {
          break;
        }
        bool = a(this.c, this.a.b(), i, paramVarArgs);
        return Boolean.valueOf(bool);
      }
    }
    catch (NoSuchFieldException paramVarArgs)
    {
      int i;
      for (;;)
      {
        b.b("WriteAssetInInternalCacheTask", "NoSuchFieldException e: " + paramVarArgs);
        i = -1;
      }
      paramVarArgs = a(this.c, this.a.b(), i, true);
      return Boolean.valueOf(a(this.c, paramVarArgs, this.d));
      return Boolean.valueOf(true);
    }
    catch (IllegalArgumentException paramVarArgs)
    {
      b.b("WriteAssetInInternalCacheTask", "WriteAssetInInternalCacheTask: e" + paramVarArgs);
      return Boolean.valueOf(false);
    }
    catch (IllegalAccessException paramVarArgs)
    {
      for (;;)
      {
        b.b("WriteAssetInInternalCacheTask", "WriteAssetInInternalCacheTask: e" + paramVarArgs);
      }
    }
    catch (Exception paramVarArgs)
    {
      for (;;)
      {
        label247:
        b.b("WriteAssetInInternalCacheTask", "WriteAssetInInternalCacheTask: e" + paramVarArgs);
      }
    }
  }
  
  protected void a(Boolean paramBoolean)
  {
    b.a("WriteAssetInInternalCacheTask", "file: " + this.e + " written in cache sucessfully: " + paramBoolean);
    if (paramBoolean.booleanValue()) {
      this.b.a();
    }
    for (;;)
    {
      super.onPostExecute(paramBoolean);
      return;
      this.b.a(this.a);
    }
  }
  
  protected void onPreExecute()
  {
    b.a("WriteAssetInInternalCacheTask", "Trying to copy file: " + this.e + " in internal cache");
    super.onPreExecute();
  }
}
