package com.qbiki.seattleclouds;

import android.app.Activity;
import android.content.res.Configuration;
import android.os.Bundle;
import com.qbiki.ads.AdManager;
import com.qbiki.analytics.SCAnalyticsTracker;
import java.util.Timer;
import java.util.TimerTask;

public class SCActivityHelper
{
  private static final boolean DEBUG = false;
  private static final String TAG = "SCActivityHelper";
  private static boolean appIsInForeground = false;
  private static boolean mAppIsInBackground = true;
  private static SCActivityHelper mInstance;
  private static int mRunningActivitiesCount = 0;
  
  private SCActivityHelper() {}
  
  private void applicationDidBecomeActive(Activity paramActivity)
  {
    if (!App.isPreviewer) {
      SCAnalyticsTracker.getInstance(paramActivity).trackEvent(2);
    }
  }
  
  private void applicationDidEnterBackground(Activity paramActivity)
  {
    mAppIsInBackground = true;
  }
  
  private void applicationWillPotentiallyBecomeActive(Activity paramActivity)
  {
    appIsInForeground = true;
    if (mAppIsInBackground)
    {
      mAppIsInBackground = false;
      applicationDidBecomeActive(paramActivity);
    }
  }
  
  private void applicationWillPotentiallyEnterBackground(final Activity paramActivity)
  {
    appIsInForeground = false;
    new Timer().schedule(new TimerTask()
    {
      public void run()
      {
        if (!SCActivityHelper.appIsInForeground) {
          SCActivityHelper.this.applicationDidEnterBackground(paramActivity);
        }
      }
    }, 5000L);
  }
  
  private void decreaseRunningActivitiesCount(Activity paramActivity)
  {
    if (mRunningActivitiesCount < 0) {}
    for (int i = 0;; i = mRunningActivitiesCount - 1)
    {
      mRunningActivitiesCount = i;
      if (mRunningActivitiesCount == 0) {
        applicationWillPotentiallyEnterBackground(paramActivity);
      }
      return;
    }
  }
  
  public static SCActivityHelper getInstance()
  {
    if (mInstance == null) {
      mInstance = new SCActivityHelper();
    }
    return mInstance;
  }
  
  private void increaseRunningActivitiesCount(Activity paramActivity)
  {
    if (mRunningActivitiesCount < 1) {
      applicationWillPotentiallyBecomeActive(paramActivity);
    }
    mRunningActivitiesCount += 1;
  }
  
  public void onActivityConfigurationChanged(Activity paramActivity, Configuration paramConfiguration)
  {
    AdManager.showPollfishIfActivitySupports(paramActivity);
  }
  
  public void onActivityCreated(Activity paramActivity, Bundle paramBundle)
  {
    appIsInForeground = true;
    if (!App.rotationEnabled) {
      paramActivity.setRequestedOrientation(1);
    }
    AdManager.showRevMob(paramActivity, App.revMobAppid);
  }
  
  public void onActivityDestroyed(Activity paramActivity) {}
  
  public void onActivityPaused(Activity paramActivity) {}
  
  public void onActivityResumed(Activity paramActivity)
  {
    AdManager.showPollfishIfActivitySupports(paramActivity);
  }
  
  public void onActivitySaveInstanceState(Activity paramActivity, Bundle paramBundle) {}
  
  public void onActivityStarted(Activity paramActivity)
  {
    increaseRunningActivitiesCount(paramActivity);
  }
  
  public void onActivityStopped(Activity paramActivity)
  {
    decreaseRunningActivitiesCount(paramActivity);
  }
}
