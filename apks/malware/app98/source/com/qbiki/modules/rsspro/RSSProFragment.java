package com.qbiki.modules.rsspro;

import android.os.Bundle;
import android.support.v4.app.FragmentActivity;
import android.view.View;
import com.qbiki.modules.dynamicpage.DynamicPageFragment;
import com.qbiki.seattleclouds.App;
import com.qbiki.seattleclouds.AppConfig;
import com.qbiki.seattleclouds.Page;
import com.qbiki.util.DialogUtil;
import java.util.Map;
import org.json.JSONObject;

public class RSSProFragment
  extends DynamicPageFragment
{
  public static final String FEED_URL_IDENTIFIER = "FEED_URL_IDENTIFIER";
  
  public RSSProFragment() {}
  
  public void onViewCreated(final View paramView, final Bundle paramBundle)
  {
    paramBundle = getArguments();
    paramView = paramBundle.getString("FEED_URL_IDENTIFIER");
    if (paramView != null)
    {
      paramBundle = paramBundle.getString("PAGE_ID");
      if (paramBundle == null) {
        DialogUtil.showAlert(getActivity(), 2131362418, 2131362420);
      }
    }
    else
    {
      return;
    }
    Object localObject = ((Page)App.appConfig.getPages().get(paramBundle)).getSlidepageid();
    localObject = (Page)App.appConfig.getPages().get(localObject);
    if (localObject != null) {
      ((Page)localObject).setParentRssSourcePageURL(paramBundle);
    }
    super.onProgressStart();
    new Thread(new Runnable()
    {
      public void run()
      {
        JSONObject localJSONObject = RssReader.getInstance().parseRssFeed(paramView);
        if (localJSONObject != null)
        {
          App.appConfig.setRssJsonForPage(paramBundle, localJSONObject);
          RSSProFragment.this.processDynamicData(paramBundle, localJSONObject);
          return;
        }
        RSSProFragment.this.getActivity().runOnUiThread(new Runnable()
        {
          public void run()
          {
            DialogUtil.showAlert(RSSProFragment.this.getActivity(), 2131362418, 2131362419);
          }
        });
      }
    }).start();
  }
}
