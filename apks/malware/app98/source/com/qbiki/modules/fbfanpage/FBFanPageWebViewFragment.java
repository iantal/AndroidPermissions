package com.qbiki.modules.fbfanpage;

import android.annotation.SuppressLint;
import android.graphics.Bitmap;
import android.os.Bundle;
import android.os.Message;
import android.support.v4.app.FragmentActivity;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.view.ViewGroup.LayoutParams;
import android.webkit.WebSettings;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.widget.LinearLayout;
import android.widget.ProgressBar;
import com.qbiki.seattleclouds.App;
import com.qbiki.seattleclouds.SCFragment;

@SuppressLint({"SetJavaScriptEnabled"})
public class FBFanPageWebViewFragment
  extends SCFragment
{
  WebView aWebView;
  private LinearLayout fView = null;
  ProgressBar progressIndicator;
  
  public FBFanPageWebViewFragment() {}
  
  private void unhideWebView()
  {
    this.progressIndicator.setVisibility(8);
    this.aWebView.setVisibility(0);
  }
  
  protected void init()
  {
    this.progressIndicator = new ProgressBar(getActivity());
    this.progressIndicator.setLayoutParams(new ViewGroup.LayoutParams(100, 100));
    this.fView.setLayoutParams(new ViewGroup.LayoutParams(-1, -1));
    this.fView.setGravity(17);
    this.fView.addView(this.progressIndicator);
    this.aWebView = new WebView(getActivity());
    this.aWebView.setVisibility(8);
    this.aWebView.getSettings().setJavaScriptEnabled(true);
    this.aWebView.getSettings().setDomStorageEnabled(true);
    this.aWebView.setWebViewClient(new WebViewClient()
    {
      public void onPageFinished(WebView paramAnonymousWebView, String paramAnonymousString)
      {
        FBFanPageWebViewFragment.this.getActivity().runOnUiThread(new Runnable()
        {
          public void run()
          {
            FBFanPageWebViewFragment.this.unhideWebView();
          }
        });
        super.onPageFinished(paramAnonymousWebView, paramAnonymousString);
      }
      
      public void onPageStarted(WebView paramAnonymousWebView, String paramAnonymousString, Bitmap paramAnonymousBitmap)
      {
        super.onPageStarted(paramAnonymousWebView, paramAnonymousString, paramAnonymousBitmap);
      }
      
      public void onReceivedError(WebView paramAnonymousWebView, int paramAnonymousInt, String paramAnonymousString1, String paramAnonymousString2)
      {
        super.onReceivedError(paramAnonymousWebView, paramAnonymousInt, paramAnonymousString1, paramAnonymousString2);
        App.closePage(FBFanPageWebViewFragment.this);
      }
      
      public void onTooManyRedirects(WebView paramAnonymousWebView, Message paramAnonymousMessage1, Message paramAnonymousMessage2)
      {
        super.onTooManyRedirects(paramAnonymousWebView, paramAnonymousMessage1, paramAnonymousMessage2);
        App.closePage(FBFanPageWebViewFragment.this);
      }
    });
    this.fView.addView(this.aWebView);
    Object localObject = getArguments();
    if (localObject != null)
    {
      localObject = ((Bundle)localObject).getString("pageurl");
      this.aWebView.loadUrl((String)localObject);
      return;
    }
    App.closePageDelayed(this);
  }
  
  public View onCreateView(LayoutInflater paramLayoutInflater, ViewGroup paramViewGroup, Bundle paramBundle)
  {
    this.fView = new LinearLayout(getActivity());
    init();
    return this.fView;
  }
  
  public void onDestroy()
  {
    this.aWebView.setWebViewClient(null);
    this.aWebView.stopLoading();
    super.onDestroy();
  }
}
