package com.qbiki.modules.sharepoint;

import android.app.Activity;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.webkit.WebView;
import java.net.URI;

public class SPFileDetailView
{
  private Activity activity = null;
  private View mLoadingView;
  private View mNoItemsView;
  private View mView = null;
  private String tag = "SPFileDetailView";
  private URI urlResource = null;
  private WebView webView = null;
  
  public SPFileDetailView(Activity paramActivity)
  {
    setActivity(paramActivity);
  }
  
  public SPFileDetailView(Activity paramActivity, URI paramURI)
  {
    this(paramActivity);
    this.urlResource = paramURI;
  }
  
  public View createView(LayoutInflater paramLayoutInflater, ViewGroup paramViewGroup, Bundle paramBundle)
  {
    this.mView = paramLayoutInflater.inflate(2130903211, paramViewGroup, false);
    this.webView = ((WebView)this.mView.findViewById(2131100208));
    this.mLoadingView = this.mView.findViewById(2131099836);
    this.mNoItemsView = this.mView.findViewById(16908292);
    this.mNoItemsView.setVisibility(8);
    this.mLoadingView.setVisibility(8);
    init();
    return this.mView;
  }
  
  public Activity getActivity()
  {
    return this.activity;
  }
  
  public void init()
  {
    if (this.urlResource != null)
    {
      this.mLoadingView.setVisibility(0);
      if ((this.urlResource.getScheme() != null) && (this.urlResource.toString().startsWith(this.urlResource.getScheme() + "://"))) {
        SPServer.getInstance().copyItem(this.urlResource.toString(), new SPResponseListener()
        {
          public void onResponseError(String paramAnonymousString)
          {
            SPFileDetailView.this.mLoadingView.setVisibility(8);
          }
          
          /* Error */
          public void onResponseReceived(java.util.ArrayList<Object> paramAnonymousArrayList, String paramAnonymousString)
          {
            // Byte code:
            //   0: aload_0
            //   1: getfield 17	com/qbiki/modules/sharepoint/SPFileDetailView$1:this$0	Lcom/qbiki/modules/sharepoint/SPFileDetailView;
            //   4: invokestatic 26	com/qbiki/modules/sharepoint/SPFileDetailView:access$000	(Lcom/qbiki/modules/sharepoint/SPFileDetailView;)Landroid/view/View;
            //   7: bipush 8
            //   9: invokevirtual 32	android/view/View:setVisibility	(I)V
            //   12: aload_1
            //   13: iconst_0
            //   14: invokevirtual 44	java/util/ArrayList:get	(I)Ljava/lang/Object;
            //   17: checkcast 46	java/lang/String
            //   20: invokevirtual 50	java/lang/String:toString	()Ljava/lang/String;
            //   23: iconst_0
            //   24: invokestatic 56	android/util/Base64:decode	(Ljava/lang/String;I)[B
            //   27: astore_1
            //   28: new 58	java/lang/StringBuilder
            //   31: dup
            //   32: invokespecial 59	java/lang/StringBuilder:<init>	()V
            //   35: aload_0
            //   36: getfield 17	com/qbiki/modules/sharepoint/SPFileDetailView$1:this$0	Lcom/qbiki/modules/sharepoint/SPFileDetailView;
            //   39: invokevirtual 63	com/qbiki/modules/sharepoint/SPFileDetailView:getActivity	()Landroid/app/Activity;
            //   42: invokevirtual 69	android/app/Activity:getCacheDir	()Ljava/io/File;
            //   45: invokevirtual 74	java/io/File:getAbsolutePath	()Ljava/lang/String;
            //   48: invokevirtual 78	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
            //   51: ldc 80
            //   53: invokevirtual 78	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
            //   56: invokevirtual 81	java/lang/StringBuilder:toString	()Ljava/lang/String;
            //   59: astore_2
            //   60: new 71	java/io/File
            //   63: dup
            //   64: aload_2
            //   65: invokespecial 83	java/io/File:<init>	(Ljava/lang/String;)V
            //   68: astore_3
            //   69: aload_3
            //   70: invokevirtual 87	java/io/File:exists	()Z
            //   73: ifeq +8 -> 81
            //   76: aload_3
            //   77: invokevirtual 90	java/io/File:delete	()Z
            //   80: pop
            //   81: aload_3
            //   82: invokevirtual 87	java/io/File:exists	()Z
            //   85: ifne +8 -> 93
            //   88: aload_3
            //   89: invokevirtual 93	java/io/File:mkdirs	()Z
            //   92: pop
            //   93: new 71	java/io/File
            //   96: dup
            //   97: new 58	java/lang/StringBuilder
            //   100: dup
            //   101: invokespecial 59	java/lang/StringBuilder:<init>	()V
            //   104: aload_2
            //   105: invokevirtual 78	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
            //   108: aload_0
            //   109: getfield 17	com/qbiki/modules/sharepoint/SPFileDetailView$1:this$0	Lcom/qbiki/modules/sharepoint/SPFileDetailView;
            //   112: invokestatic 97	com/qbiki/modules/sharepoint/SPFileDetailView:access$100	(Lcom/qbiki/modules/sharepoint/SPFileDetailView;)Ljava/net/URI;
            //   115: invokevirtual 100	java/net/URI:toString	()Ljava/lang/String;
            //   118: ldc 102
            //   120: ldc 104
            //   122: invokevirtual 108	java/lang/String:replace	(Ljava/lang/CharSequence;Ljava/lang/CharSequence;)Ljava/lang/String;
            //   125: invokestatic 114	com/qbiki/util/StringUtil:getLastPathComponentFromUrl	(Ljava/lang/String;)Ljava/lang/String;
            //   128: invokevirtual 78	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
            //   131: invokevirtual 81	java/lang/StringBuilder:toString	()Ljava/lang/String;
            //   134: invokespecial 83	java/io/File:<init>	(Ljava/lang/String;)V
            //   137: astore_2
            //   138: new 116	java/io/FileOutputStream
            //   141: dup
            //   142: aload_2
            //   143: iconst_1
            //   144: invokespecial 119	java/io/FileOutputStream:<init>	(Ljava/io/File;Z)V
            //   147: astore_3
            //   148: aload_3
            //   149: aload_1
            //   150: invokevirtual 123	java/io/FileOutputStream:write	([B)V
            //   153: aload_3
            //   154: invokevirtual 126	java/io/FileOutputStream:flush	()V
            //   157: aload_3
            //   158: invokevirtual 129	java/io/FileOutputStream:close	()V
            //   161: aload_0
            //   162: getfield 17	com/qbiki/modules/sharepoint/SPFileDetailView$1:this$0	Lcom/qbiki/modules/sharepoint/SPFileDetailView;
            //   165: invokestatic 97	com/qbiki/modules/sharepoint/SPFileDetailView:access$100	(Lcom/qbiki/modules/sharepoint/SPFileDetailView;)Ljava/net/URI;
            //   168: ifnull +35 -> 203
            //   171: aload_0
            //   172: getfield 17	com/qbiki/modules/sharepoint/SPFileDetailView$1:this$0	Lcom/qbiki/modules/sharepoint/SPFileDetailView;
            //   175: invokestatic 133	com/qbiki/modules/sharepoint/SPFileDetailView:access$300	(Lcom/qbiki/modules/sharepoint/SPFileDetailView;)Landroid/webkit/WebView;
            //   178: new 58	java/lang/StringBuilder
            //   181: dup
            //   182: invokespecial 59	java/lang/StringBuilder:<init>	()V
            //   185: ldc -121
            //   187: invokevirtual 78	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
            //   190: aload_2
            //   191: invokevirtual 74	java/io/File:getAbsolutePath	()Ljava/lang/String;
            //   194: invokevirtual 78	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
            //   197: invokevirtual 81	java/lang/StringBuilder:toString	()Ljava/lang/String;
            //   200: invokevirtual 140	android/webkit/WebView:loadUrl	(Ljava/lang/String;)V
            //   203: return
            //   204: astore_1
            //   205: aload_0
            //   206: getfield 17	com/qbiki/modules/sharepoint/SPFileDetailView$1:this$0	Lcom/qbiki/modules/sharepoint/SPFileDetailView;
            //   209: invokestatic 144	com/qbiki/modules/sharepoint/SPFileDetailView:access$200	(Lcom/qbiki/modules/sharepoint/SPFileDetailView;)Ljava/lang/String;
            //   212: aload_1
            //   213: invokevirtual 147	java/io/FileNotFoundException:getMessage	()Ljava/lang/String;
            //   216: invokestatic 153	android/util/Log:e	(Ljava/lang/String;Ljava/lang/String;)I
            //   219: pop
            //   220: return
            //   221: astore_1
            //   222: aload_0
            //   223: getfield 17	com/qbiki/modules/sharepoint/SPFileDetailView$1:this$0	Lcom/qbiki/modules/sharepoint/SPFileDetailView;
            //   226: invokestatic 144	com/qbiki/modules/sharepoint/SPFileDetailView:access$200	(Lcom/qbiki/modules/sharepoint/SPFileDetailView;)Ljava/lang/String;
            //   229: aload_1
            //   230: invokevirtual 154	java/io/IOException:getMessage	()Ljava/lang/String;
            //   233: invokestatic 153	android/util/Log:e	(Ljava/lang/String;Ljava/lang/String;)I
            //   236: pop
            //   237: goto -76 -> 161
            // Local variable table:
            //   start	length	slot	name	signature
            //   0	240	0	this	1
            //   0	240	1	paramAnonymousArrayList	java.util.ArrayList<Object>
            //   0	240	2	paramAnonymousString	String
            //   68	90	3	localObject	Object
            // Exception table:
            //   from	to	target	type
            //   138	148	204	java/io/FileNotFoundException
            //   148	161	221	java/io/IOException
          }
          
          public void onResponseTimeout()
          {
            SPFileDetailView.this.mLoadingView.setVisibility(8);
          }
        });
      }
    }
    else
    {
      return;
    }
    this.webView.loadUrl("file:///" + this.urlResource.toString());
    this.mLoadingView.setVisibility(8);
  }
  
  public void refreshView(URI paramURI)
  {
    this.urlResource = paramURI;
    init();
  }
  
  public void setActivity(Activity paramActivity)
  {
    this.activity = paramActivity;
  }
}
