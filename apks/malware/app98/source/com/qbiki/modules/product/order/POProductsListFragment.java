package com.qbiki.modules.product.order;

import android.os.Bundle;
import android.support.v4.app.FragmentActivity;
import android.view.View;
import android.widget.ListView;
import android.widget.SimpleAdapter;
import com.actionbarsherlock.view.Menu;
import com.actionbarsherlock.view.MenuInflater;
import com.actionbarsherlock.view.MenuItem;
import com.qbiki.seattleclouds.App;
import com.qbiki.seattleclouds.FragmentInfo;
import com.qbiki.seattleclouds.SCListFragment;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

public class POProductsListFragment
  extends SCListFragment
{
  public static final String INDEX_KEY = "INDEX_KEY";
  public static final String PAGE_ID_KEY = "PAGE_ID_KEY";
  public static final String PICKUP_ADDRESS_KEY = "ADDRESS_KEY";
  private int mCurrentCategoryIndex = -1;
  private String mPageId = null;
  private String mPickupAddress = "";
  private List<Map<String, String>> productsNamesList = new ArrayList();
  
  public POProductsListFragment() {}
  
  private void initList()
  {
    this.productsNamesList = POContext.getInstance().getHashMapProducts(this.mPageId, this.mCurrentCategoryIndex);
    setListAdapter(new SimpleAdapter(getActivity(), this.productsNamesList, 2130903191, new String[] { "product", "product_details", "price" }, new int[] { 2131100133, 2131100135, 2131100134 }));
    setEmptyText(getActivity().getString(2131362332));
  }
  
  public void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    setHasOptionsMenu(true);
    paramBundle = getArguments();
    if (paramBundle != null)
    {
      this.mPageId = paramBundle.getString("PAGE_ID_KEY");
      this.mCurrentCategoryIndex = paramBundle.getInt("INDEX_KEY");
      this.mPickupAddress = paramBundle.getString("ADDRESS_KEY");
    }
  }
  
  public void onCreateOptionsMenu(Menu paramMenu, MenuInflater paramMenuInflater)
  {
    super.onCreateOptionsMenu(paramMenu, paramMenuInflater);
    paramMenuInflater.inflate(2131558429, paramMenu);
  }
  
  public void onListItemClick(ListView paramListView, View paramView, int paramInt, long paramLong)
  {
    showProductDetailsForProduct(paramInt);
    super.onListItemClick(paramListView, paramView, paramInt, paramLong);
  }
  
  public boolean onOptionsItemSelected(MenuItem paramMenuItem)
  {
    switch (paramMenuItem.getItemId())
    {
    default: 
      return super.onOptionsItemSelected(paramMenuItem);
    }
    POContext.getInstance().openOrderPage(getActivity(), this, "");
    return true;
  }
  
  public void onViewCreated(View paramView, Bundle paramBundle)
  {
    initList();
    super.onViewCreated(paramView, paramBundle);
  }
  
  void showProductDetailsForProduct(int paramInt)
  {
    Bundle localBundle = new Bundle();
    localBundle.putString("PAGE_ID_KEY", this.mPageId);
    localBundle.putString("ADDRESS_KEY", this.mPickupAddress);
    localBundle.putInt("CATEGORY_INDEX_KEY", this.mCurrentCategoryIndex);
    localBundle.putInt("PRODUCT_INDEX_KEY", paramInt);
    App.showPage(new FragmentInfo(POProductDetailsFragment.class.getName(), localBundle), this);
  }
}
