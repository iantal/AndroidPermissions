package com.qbiki.modules.quiz;

import android.os.Bundle;
import android.view.KeyEvent;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.TextView.OnEditorActionListener;
import com.qbiki.seattleclouds.App;
import com.qbiki.seattleclouds.SCFragment;
import com.qbiki.util.StyleUtil;

public class QuizResultsFragment
  extends SCFragment
{
  private Button finishButton;
  private View mView;
  private EditText nameTextInput;
  private TextView pointsAmountTV;
  private Bundle style;
  
  public QuizResultsFragment() {}
  
  protected boolean didSaveScore()
  {
    String str = this.nameTextInput.getText().toString();
    if (str.length() > 0) {
      return QuizSharedDataManager.getInstance(getActivity()).didSaveScore(Integer.valueOf(QuizPlayController.getInstance(getActivity()).getCurrentPoints()), QuizPlayController.getInstance(getActivity()).getCurrentQuizPageId(), str);
    }
    return false;
  }
  
  protected void init()
  {
    Bundle localBundle = getArguments();
    if (localBundle != null) {
      this.style = localBundle.getBundle("PAGE_STYLE");
    }
    this.pointsAmountTV = ((TextView)this.mView.findViewById(2131100156));
    this.pointsAmountTV.setText(Integer.toString(QuizPlayController.getInstance(getActivity()).getCurrentPoints()));
    this.nameTextInput = ((EditText)this.mView.findViewById(2131100157));
    this.nameTextInput.setOnEditorActionListener(new TextView.OnEditorActionListener()
    {
      public boolean onEditorAction(TextView paramAnonymousTextView, int paramAnonymousInt, KeyEvent paramAnonymousKeyEvent)
      {
        boolean bool = QuizResultsFragment.this.didSaveScore();
        App.closePage(QuizResultsFragment.this);
        return bool;
      }
    });
    this.finishButton = ((Button)this.mView.findViewById(2131100158));
    this.finishButton.setOnClickListener(new View.OnClickListener()
    {
      public void onClick(View paramAnonymousView)
      {
        QuizResultsFragment.this.didSaveScore();
        App.closePage(QuizResultsFragment.this);
      }
    });
    StyleUtil.setTextColor(this.nameTextInput, this.style);
    StyleUtil.setTextColor(this.pointsAmountTV, this.style);
  }
  
  public View onCreateView(LayoutInflater paramLayoutInflater, ViewGroup paramViewGroup, Bundle paramBundle)
  {
    this.mView = paramLayoutInflater.inflate(2130903198, paramViewGroup, false);
    init();
    this.mView.setBackgroundDrawable(App.getDrawableResource(QuizPlayController.getInstance(getActivity()).getCurrentQuizBgImage()));
    StyleUtil.setBackground(this.mView, this.style);
    return this.mView;
  }
}
