package com.qbiki.modules.starbucks;

import android.content.Intent;
import android.os.Bundle;
import android.text.Editable;
import android.text.TextWatcher;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;
import com.qbiki.seattleclouds.SCActivity;

public class AddCardActivity
  extends SCActivity
{
  private Button mCardAddButton;
  private TextView mCardNumberInput;
  private TextView mCardSecurityCodeInput;
  private CardStorageManager mCardsManager;
  private String mStorePath;
  
  public AddCardActivity() {}
  
  protected void initParams()
  {
    Bundle localBundle = getIntent().getExtras();
    if (localBundle != null) {
      this.mStorePath = localBundle.getString("storePath");
    }
  }
  
  protected void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    initParams();
    setContentView(2130903223);
    this.mCardsManager = new CardStorageManager(this.mStorePath);
    this.mCardNumberInput = ((TextView)findViewById(2131100220));
    this.mCardSecurityCodeInput = ((TextView)findViewById(2131100221));
    this.mCardAddButton = ((Button)findViewById(2131100222));
    this.mCardAddButton.setEnabled(false);
    this.mCardAddButton.setOnClickListener(new View.OnClickListener()
    {
      public void onClick(View paramAnonymousView)
      {
        paramAnonymousView = AddCardActivity.this.mCardNumberInput.getText().toString();
        String str = AddCardActivity.this.mCardSecurityCodeInput.getText().toString();
        AddCardActivity.this.mCardsManager.saveCard(paramAnonymousView, str, "$0");
        AddCardActivity.this.finish();
      }
    });
    paramBundle = new TextWatcher()
    {
      public void afterTextChanged(Editable paramAnonymousEditable) {}
      
      public void beforeTextChanged(CharSequence paramAnonymousCharSequence, int paramAnonymousInt1, int paramAnonymousInt2, int paramAnonymousInt3) {}
      
      public void onTextChanged(CharSequence paramAnonymousCharSequence, int paramAnonymousInt1, int paramAnonymousInt2, int paramAnonymousInt3)
      {
        paramAnonymousCharSequence = AddCardActivity.this.mCardNumberInput.getText().toString();
        String str = AddCardActivity.this.mCardSecurityCodeInput.getText().toString();
        if ((paramAnonymousCharSequence.length() == 16) && (str.length() == 8))
        {
          AddCardActivity.this.mCardAddButton.setEnabled(true);
          return;
        }
        AddCardActivity.this.mCardAddButton.setEnabled(false);
      }
    };
    this.mCardNumberInput.addTextChangedListener(paramBundle);
    this.mCardSecurityCodeInput.addTextChangedListener(paramBundle);
  }
}
