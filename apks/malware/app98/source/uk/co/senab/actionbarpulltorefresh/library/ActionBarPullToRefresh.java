package uk.co.senab.actionbarpulltorefresh.library;

import android.app.Activity;
import android.view.View;
import android.view.ViewGroup;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map.Entry;
import java.util.Set;
import uk.co.senab.actionbarpulltorefresh.library.listeners.OnRefreshListener;
import uk.co.senab.actionbarpulltorefresh.library.viewdelegates.ViewDelegate;

public class ActionBarPullToRefresh
{
  public ActionBarPullToRefresh() {}
  
  public static SetupWizard from(Activity paramActivity)
  {
    return new SetupWizard(paramActivity, null);
  }
  
  public static final class SetupWizard
  {
    private final Activity mActivity;
    private OnRefreshListener mOnRefreshListener;
    private Options mOptions;
    private HashMap<Class, ViewDelegate> mViewDelegates;
    private ViewGroup mViewGroupToInsertInto;
    private int[] refreshableViewIds;
    private View[] refreshableViews;
    
    private SetupWizard(Activity paramActivity)
    {
      this.mActivity = paramActivity;
    }
    
    private static void insertLayoutIntoViewGroup(ViewGroup paramViewGroup, PullToRefreshLayout paramPullToRefreshLayout)
    {
      for (View localView = paramViewGroup.getChildAt(0); localView != null; localView = paramViewGroup.getChildAt(0))
      {
        paramViewGroup.removeViewAt(0);
        paramPullToRefreshLayout.addView(localView);
      }
      paramViewGroup.addView(paramPullToRefreshLayout, -1, -1);
    }
    
    public SetupWizard allChildrenArePullable()
    {
      this.refreshableViewIds = null;
      this.refreshableViews = null;
      return this;
    }
    
    public SetupWizard insertLayoutInto(ViewGroup paramViewGroup)
    {
      this.mViewGroupToInsertInto = paramViewGroup;
      return this;
    }
    
    public SetupWizard listener(OnRefreshListener paramOnRefreshListener)
    {
      this.mOnRefreshListener = paramOnRefreshListener;
      return this;
    }
    
    public SetupWizard options(Options paramOptions)
    {
      this.mOptions = paramOptions;
      return this;
    }
    
    public void setup(PullToRefreshLayout paramPullToRefreshLayout)
    {
      PullToRefreshAttacher localPullToRefreshAttacher = paramPullToRefreshLayout.createPullToRefreshAttacher(this.mActivity, this.mOptions);
      localPullToRefreshAttacher.setOnRefreshListener(this.mOnRefreshListener);
      if (this.mViewGroupToInsertInto != null) {
        insertLayoutIntoViewGroup(this.mViewGroupToInsertInto, paramPullToRefreshLayout);
      }
      paramPullToRefreshLayout.setPullToRefreshAttacher(localPullToRefreshAttacher);
      if (this.refreshableViewIds != null) {
        paramPullToRefreshLayout.addChildrenAsPullable(this.refreshableViewIds);
      }
      while (this.mViewDelegates != null)
      {
        paramPullToRefreshLayout = this.mViewDelegates.entrySet().iterator();
        while (paramPullToRefreshLayout.hasNext())
        {
          Map.Entry localEntry = (Map.Entry)paramPullToRefreshLayout.next();
          localPullToRefreshAttacher.useViewDelegate((Class)localEntry.getKey(), (ViewDelegate)localEntry.getValue());
        }
        if (this.refreshableViews != null) {
          paramPullToRefreshLayout.addChildrenAsPullable(this.refreshableViews);
        } else {
          paramPullToRefreshLayout.addAllChildrenAsPullable();
        }
      }
    }
    
    public SetupWizard theseChildrenArePullable(int... paramVarArgs)
    {
      this.refreshableViewIds = paramVarArgs;
      this.refreshableViews = null;
      return this;
    }
    
    public SetupWizard theseChildrenArePullable(View... paramVarArgs)
    {
      this.refreshableViews = paramVarArgs;
      this.refreshableViewIds = null;
      return this;
    }
    
    public SetupWizard useViewDelegate(Class<?> paramClass, ViewDelegate paramViewDelegate)
    {
      if (this.mViewDelegates == null) {
        this.mViewDelegates = new HashMap();
      }
      this.mViewDelegates.put(paramClass, paramViewDelegate);
      return this;
    }
  }
}
