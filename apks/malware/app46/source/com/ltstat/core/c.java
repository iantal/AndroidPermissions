package com.ltstat.core;

import android.content.Context;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import com.ltstat.b.i;
import com.ltstat.b.j;
import com.ltstat.b.m;
import java.io.File;
import org.json.JSONObject;

final class c
  implements Runnable
{
  c(Ltstat paramLtstat, Context paramContext, String paramString, int paramInt1, int paramInt2) {}
  
  public final void run()
  {
    LtstatConnect.a(this.a);
    Ltstat.b(this.e, this.b);
    Ltstat.a(this.e, this.c);
    Object localObject = this.a;
    String str1 = i.a.b((Context)localObject, i.g, "");
    String str2 = m.c((Context)localObject) + "_" + m.d((Context)localObject);
    int i;
    if (!str1.equals(str2))
    {
      i.a.a((Context)localObject, i.g, str2);
      i = 1;
      if (i != 0)
      {
        com.ltstat.a.h.a("isNewApk , clean delay & so ..");
        new File(this.a.getFilesDir().getAbsolutePath() + "/ecode").delete();
        new File(this.a.getFilesDir().getAbsolutePath() + "/ecode_64").delete();
        i.a.a(this.a).edit().putInt("send_delay", 0).commit();
      }
      if (Ltstat.a(this.e) == null) {
        Ltstat.a(this.e, this.a.getApplicationContext());
      }
    }
    label266:
    label420:
    do
    {
      try
      {
        System.load(this.e.a("ecode").getAbsolutePath());
        j.a(Ltstat.a(this.e));
      }
      catch (Throwable localThrowable)
      {
        try
        {
          long l = System.currentTimeMillis();
          for (;;)
          {
            if (m.a(j.a)) {
              break label420;
            }
            if (System.currentTimeMillis() - l > 30111L)
            {
              com.ltstat.a.h.a("timeOut , direct stroe!");
              localObject = Ltstat.a(this.e, "landing");
              ((JSONObject)localObject).putOpt("active", Integer.valueOf(this.d));
              com.ltstat.b.h.a(Ltstat.a(this.e));
              com.ltstat.b.h.a(((JSONObject)localObject).toString());
              LtstatConnect.a();
              return;
              i = 0;
              break;
              localThrowable = localThrowable;
              if (!localThrowable.getMessage().matches(".*ecode.* is 32-bit instead of 64-bit.*")) {
                break label266;
              }
              com.ltstat.a.h.a("load so64!");
              System.load(this.e.a("ecode_64").getAbsolutePath());
              break label266;
            }
            com.ltstat.a.h.a("port is occupy , wait...");
            Thread.sleep(3000L);
          }
          j.a();
        }
        catch (Exception localException1)
        {
          localException1.printStackTrace();
          return;
        }
      }
    } while ((Ltstat.b(this.e) <= 0) || (Ltstat.c(this.e) == null));
    try
    {
      JSONObject localJSONObject = Ltstat.a(this.e, "landing");
      localJSONObject.putOpt("active", Integer.valueOf(this.d));
      j.a(localJSONObject);
      return;
    }
    catch (Exception localException2)
    {
      com.ltstat.a.h.a("Exception: " + localException2.getMessage());
    }
  }
}
