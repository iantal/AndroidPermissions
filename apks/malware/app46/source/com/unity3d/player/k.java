package com.unity3d.player;

import android.view.Choreographer;
import android.view.Choreographer.FrameCallback;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

public final class k
  implements h
{
  private Choreographer a = null;
  private long b = 0L;
  private Choreographer.FrameCallback c;
  private Lock d = new ReentrantLock();
  
  public k() {}
  
  public final void a()
  {
    this.d.lock();
    if (this.a != null) {
      this.a.removeFrameCallback(this.c);
    }
    this.a = null;
    this.d.unlock();
  }
  
  public final void a(final UnityPlayer paramUnityPlayer)
  {
    this.d.lock();
    if (this.a == null)
    {
      this.a = Choreographer.getInstance();
      if (this.a != null)
      {
        l.Log(4, "Choreographer available: Enabling VSYNC timing");
        this.c = new Choreographer.FrameCallback()
        {
          public final void doFrame(long paramAnonymousLong)
          {
            
            if (t.c()) {
              paramUnityPlayer.nativeAddVSyncTime(paramAnonymousLong);
            }
            UnityPlayer.unlockNativeAccess();
            k.a(k.this).lock();
            if (k.b(k.this) != null) {
              k.b(k.this).postFrameCallback(k.c(k.this));
            }
            k.a(k.this).unlock();
          }
        };
        this.a.postFrameCallback(this.c);
      }
    }
    this.d.unlock();
  }
}
