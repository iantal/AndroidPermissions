package com.ltad.interstitial;

import android.app.Activity;
import android.content.Context;
import android.content.SharedPreferences;
import android.preference.PreferenceManager;
import android.util.Log;
import com.google.android.gms.ads.InterstitialAd;
import com.ltad.a.i;
import com.ltad.core.Adunion;
import com.ltad.util.InterstitialUtil;
import com.ltad.util.PropertyUtil;

public class InterstitialAdmob
  extends InterstitialAdapter
{
  public static final int BILLING_RESPONSE_RESULT_OK = 0;
  private static final String TAG = "Joy_InterstitialAdmob";
  private String iapIds = "";
  private boolean isAdClosed = true;
  private boolean isIap = false;
  private boolean isLoaded = false;
  private boolean isShow = false;
  private int loadTimes = 0;
  private Context mAppContext;
  private String mAppId;
  private InterstitialAd mInterstitialAd = null;
  
  public InterstitialAdmob() {}
  
  private String getCheckoutKey(Context paramContext)
  {
    Object localObject = "";
    try
    {
      paramContext = PropertyUtil.getPropertyFromAssets(paramContext, "checkout_key", "", "joy_sdk.chg");
      localObject = paramContext;
      if (paramContext.trim().equals("")) {
        localObject = null;
      }
      return localObject;
    }
    catch (Exception paramContext)
    {
      for (;;)
      {
        paramContext = (Context)localObject;
      }
    }
  }
  
  private void initAppId()
  {
    this.iapIds = PropertyUtil.getPropertyDefault(this.mAppContext, "iapIds", "");
    Log.e("iapIds", this.iapIds);
    if (!this.iapIds.trim().equals(""))
    {
      String[] arrayOfString = this.iapIds.split(i.a(720912));
      if ((arrayOfString != null) && (arrayOfString.length == 4))
      {
        String str = PreferenceManager.getDefaultSharedPreferences(this.mAppContext).getString("showType", "");
        if (str.equals(Adunion.IAD_TYPE_GAMESTART))
        {
          if (!arrayOfString[0].trim().equals("*"))
          {
            this.isIap = true;
            this.mAppId = arrayOfString[0].trim();
          }
        }
        else
        {
          if (str.equals(Adunion.IAD_TYPE_GAMEPAUSE))
          {
            if (arrayOfString[1].trim().equals("*")) {
              break label263;
            }
            this.isIap = true;
            this.mAppId = arrayOfString[1].trim();
          }
          label158:
          if (str.equals(Adunion.IAD_TYPE_GAMEGIFT))
          {
            if (arrayOfString[2].trim().equals("*")) {
              break label289;
            }
            this.isIap = true;
          }
        }
        for (this.mAppId = arrayOfString[2].trim();; this.mAppId = PropertyUtil.getPropertyDefault(this.mAppContext, i.a(458764), ""))
        {
          if (str.equals(Adunion.IAD_TYPE_GAMEEXIT))
          {
            if (arrayOfString[3].trim().equals("*")) {
              break label315;
            }
            this.isIap = true;
            this.mAppId = arrayOfString[3].trim();
          }
          return;
          this.isIap = false;
          this.mAppId = PropertyUtil.getPropertyDefault(this.mAppContext, i.a(458764), "");
          break;
          label263:
          this.isIap = false;
          this.mAppId = PropertyUtil.getPropertyDefault(this.mAppContext, i.a(458764), "");
          break label158;
          label289:
          this.isIap = false;
        }
        label315:
        this.isIap = false;
        this.mAppId = PropertyUtil.getPropertyDefault(this.mAppContext, i.a(458764), "");
        return;
      }
      this.isIap = false;
      this.mAppId = PropertyUtil.getPropertyDefault(this.mAppContext, i.a(458764), "");
      return;
    }
    this.isIap = false;
    this.mAppId = PropertyUtil.getPropertyDefault(this.mAppContext, i.a(458764), "");
  }
  
  public void destroy()
  {
    this.isAdClosed = true;
    Log.i("Joy_InterstitialAdmob", "Destroy Complete");
  }
  
  public String getTag()
  {
    return "Joy_InterstitialAdmob";
  }
  
  public void init(Context paramContext)
  {
    this.mAppContext = paramContext.getApplicationContext();
    initAppId();
    if ((this.mAppId == null) || ("".equals(this.mAppId)))
    {
      Log.e("Joy_InterstitialAdmob", "Appid is not exist");
      return;
    }
    Log.i("Joy_InterstitialAdmob", "admob_appid: " + this.mAppId);
    try
    {
      Class.forName(i.a(458765));
      InterstitialUtil.getInstance(this.mAppContext).addSupportInterstitial(i.a(458757), this);
      Log.i("Joy_InterstitialAdmob", "Init Complete");
      return;
    }
    catch (ClassNotFoundException paramContext)
    {
      Log.e("Joy_InterstitialAdmob", "Exception:" + paramContext.getMessage());
    }
  }
  
  public void preload(Activity paramActivity)
  {
    Log.i("Joy_InterstitialAdmob", "admob_appId: " + this.mAppId);
    if (this.isIap)
    {
      Log.e("Joy_InterstitialAdmob", "key:" + getCheckoutKey(paramActivity));
      this.mInterstitialAd = null;
    }
    this.mInterstitialAd = new InterstitialAd(paramActivity);
    if (this.isIap) {
      this.mInterstitialAd.setPlayStorePurchaseParams(new InterstitialAdmob.1(this, paramActivity), getCheckoutKey(paramActivity));
    }
    this.mInterstitialAd.setAdUnitId(this.mAppId);
    this.mInterstitialAd.setAdListener(new InterstitialAdmob.2(this, paramActivity));
    paramActivity.runOnUiThread(new InterstitialAdmob.3(this));
  }
  
  public boolean preloadResult()
  {
    return this.isLoaded;
  }
  
  public void setAdClosed(boolean paramBoolean)
  {
    this.isAdClosed = paramBoolean;
  }
  
  public void show(Activity paramActivity)
  {
    this.isAdClosed = false;
    this.isShow = true;
    initAppId();
    if (this.isIap) {
      this.isLoaded = false;
    }
    if ((this.isLoaded) && (this.isShow) && (!this.isAdClosed) && (this.mInterstitialAd != null) && (this.mInterstitialAd.isLoaded()))
    {
      this.mInterstitialAd.show();
      this.isShow = false;
      this.isLoaded = false;
    }
    preload(paramActivity);
  }
}
