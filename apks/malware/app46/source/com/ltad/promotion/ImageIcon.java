package com.ltad.promotion;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.content.res.Resources;
import android.graphics.drawable.AnimationDrawable;
import android.util.AttributeSet;
import android.util.DisplayMetrics;
import android.util.Log;
import android.view.View.OnClickListener;
import android.view.View.OnTouchListener;
import android.view.ViewTreeObserver;
import android.view.WindowManager;
import android.view.WindowManager.LayoutParams;
import android.widget.ImageView;
import com.ltad.a.i;
import com.ltad.util.CommonUtil;
import java.lang.ref.WeakReference;

public class ImageIcon
  extends ImageView
{
  private final String TAG = "Joy_ImageIcon";
  View.OnClickListener clickListener = new ImageIcon.1(this);
  private float density;
  private final int height = 64;
  private int heightPixels;
  private WeakReference mActivityRef;
  private Context mAppContext;
  private WindowManager.LayoutParams mIconParams;
  private WeakReference managerRef;
  View.OnTouchListener touchListener = new ImageIcon.2(this);
  private final int width = 64;
  private int widthPixels;
  
  public ImageIcon(Activity paramActivity)
  {
    super(paramActivity.getApplicationContext());
    init(paramActivity);
  }
  
  public ImageIcon(Activity paramActivity, AttributeSet paramAttributeSet)
  {
    super(paramActivity.getApplicationContext(), paramAttributeSet);
    init(paramActivity);
  }
  
  private void init(Activity paramActivity)
  {
    this.mActivityRef = new WeakReference(paramActivity);
    this.mAppContext = paramActivity.getApplicationContext();
    paramActivity = ((Activity)this.mActivityRef.get()).getResources().getDisplayMetrics();
    this.density = paramActivity.density;
    this.widthPixels = paramActivity.widthPixels;
    this.heightPixels = paramActivity.heightPixels;
    setBackgroundDrawable(CommonUtil.getResourceAnimationDrawable(this.mAppContext, i.a(589824)));
    paramActivity = (AnimationDrawable)getBackground();
    getViewTreeObserver().addOnPreDrawListener(new ImageIcon.3(this, paramActivity));
    setOnClickListener(this.clickListener);
    setOnTouchListener(this.touchListener);
  }
  
  private void jumpToExchangeActivity(Context paramContext)
  {
    Intent localIntent = new Intent();
    localIntent.setPackage(paramContext.getPackageName());
    localIntent.setAction(i.a(131073));
    localIntent.addCategory("android.intent.category.DEFAULT");
    localIntent.putExtra(i.a(131074), -1);
    localIntent.putExtra(i.a(131075), "");
    localIntent.putExtra(i.a(131076), true);
    try
    {
      paramContext.startActivity(localIntent);
      return;
    }
    catch (Exception paramContext)
    {
      paramContext.printStackTrace();
    }
  }
  
  private void setPosition(int paramInt)
  {
    int i = 0;
    float f1 = this.density * 64.0F;
    float f2 = this.density * 64.0F;
    switch (paramInt)
    {
    default: 
      paramInt = 0;
    }
    for (;;)
    {
      this.mIconParams.x = paramInt;
      this.mIconParams.y = i;
      return;
      paramInt = (int)((this.widthPixels - f1) / 2.0F);
      continue;
      paramInt = (int)(this.widthPixels - f1);
      continue;
      i = (int)((this.heightPixels - f2) / 2.0F);
      paramInt = 0;
      continue;
      paramInt = (int)((this.widthPixels - f1) / 2.0F);
      i = (int)((this.heightPixels - f2) / 2.0F);
      continue;
      paramInt = (int)(this.widthPixels - f1);
      i = (int)((this.heightPixels - f2) / 2.0F);
      continue;
      i = (int)(this.heightPixels - f2);
      paramInt = 0;
      continue;
      paramInt = (int)((this.widthPixels - f1) / 2.0F);
      i = (int)(this.heightPixels - f2);
      continue;
      paramInt = (int)(this.widthPixels - f1);
      i = (int)(this.heightPixels - f2);
    }
  }
  
  public void destroy()
  {
    if (this.managerRef != null)
    {
      ((WindowManager)this.managerRef.get()).removeView(this);
      this.managerRef.clear();
      this.managerRef = null;
    }
    setBackgroundDrawable(null);
    this.mActivityRef.clear();
    Log.i("Joy_ImageIcon", "Destroy Complete");
  }
  
  public void show(int paramInt)
  {
    this.managerRef = new WeakReference(((Activity)this.mActivityRef.get()).getWindowManager());
    this.mIconParams = new WindowManager.LayoutParams();
    this.mIconParams.flags = 8;
    this.mIconParams.type = 2;
    this.mIconParams.format = 1;
    this.mIconParams.gravity = 51;
    this.mIconParams.width = ((int)(this.density * 64.0F));
    this.mIconParams.height = ((int)(this.density * 64.0F));
    setPosition(paramInt);
    ((Activity)this.mActivityRef.get()).runOnUiThread(new ImageIcon.4(this));
  }
}
