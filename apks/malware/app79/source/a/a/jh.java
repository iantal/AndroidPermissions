package a.a;

import android.content.Context;
import com.umeng.analytics.AnalyticsConfig;
import com.umeng.analytics.h;
import com.umeng.analytics.h.a;

public class jh
{
  private hm a;
  private ij b;
  private final int c = 1;
  private Context d;
  private b e;
  private jc f;
  private fs g;
  private boolean h = false;
  private boolean i;
  
  public jh(Context paramContext, b paramB)
  {
    this.a = hm.a(paramContext);
    this.b = ij.a(paramContext);
    this.d = paramContext;
    this.e = paramB;
    this.f = new jc(paramContext);
    this.f.a(this.e);
  }
  
  private int a(byte[] paramArrayOfByte)
  {
    ew localEw = new ew();
    gu localGu = new gu(new hl());
    try
    {
      localGu.a(localEw, paramArrayOfByte);
      if (localEw.a == 1)
      {
        this.b.b(localEw.d());
        this.b.c();
      }
      gh.a("MobclickAgent", "send log:" + localEw.b());
    }
    catch (Exception paramArrayOfByte)
    {
      for (;;)
      {
        paramArrayOfByte.printStackTrace();
      }
    }
    if (localEw.a == 1) {
      return 2;
    }
    return 3;
  }
  
  private void b()
  {
    h.a(this.d).i().a(new ji(this));
  }
  
  private byte[] b(fs paramFs)
  {
    if (paramFs == null) {
      return null;
    }
    try
    {
      byte[] arrayOfByte = new gx().a(paramFs);
      if (gh.a) {
        gh.c("MobclickAgent", paramFs.toString());
      }
      return arrayOfByte;
    }
    catch (Exception paramFs)
    {
      gh.b("MobclickAgent", "Fail to serialize log ...", paramFs);
    }
    return null;
  }
  
  private void c()
  {
    this.a.a();
    Object localObject = this.g;
    ((fs)localObject).a(this.a.b());
    localObject = b((fs)localObject);
    if (localObject == null)
    {
      gh.d("MobclickAgent", "message is null");
      return;
    }
    label65:
    byte[] arrayOfByte;
    if (!this.h)
    {
      localObject = gl.a(this.d, AnalyticsConfig.getAppkey(this.d), (byte[])localObject);
      localObject = ((gl)localObject).c();
      h.a(this.d).g();
      arrayOfByte = this.f.a((byte[])localObject);
      if (arrayOfByte != null) {
        break label170;
      }
    }
    label170:
    for (int j = 1;; j = a(arrayOfByte)) {
      switch (j)
      {
      default: 
        return;
      case 1: 
        if (!this.i) {
          h.a(this.d).b((byte[])localObject);
        }
        gh.b("MobclickAgent", "connection error");
        return;
        localObject = gl.b(this.d, AnalyticsConfig.getAppkey(this.d), (byte[])localObject);
        break label65;
      }
    }
    if (this.e.h()) {
      this.e.g();
    }
    this.a.c();
    this.e.f();
    return;
    this.e.f();
  }
  
  public void a()
  {
    if (this.g != null)
    {
      c();
      return;
    }
    b();
  }
  
  public void a(fs paramFs)
  {
    this.g = paramFs;
  }
  
  public void a(jf paramJf)
  {
    this.b.a(paramJf);
  }
  
  public void a(boolean paramBoolean)
  {
    this.h = paramBoolean;
  }
  
  public void b(boolean paramBoolean)
  {
    this.i = paramBoolean;
  }
}
