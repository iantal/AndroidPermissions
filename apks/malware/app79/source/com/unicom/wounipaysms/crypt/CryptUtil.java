package com.unicom.wounipaysms.crypt;

import java.io.PrintStream;
import java.io.UnsupportedEncodingException;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.SecretKey;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

public class CryptUtil
{
  private static final char[] DIGITS = { 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 97, 98, 99, 100, 101, 102 };
  private static final byte[] defaultIV = { 48, 48, 48, 48, 48, 48, 48, 48 };
  private static final String desAlgorithm = "DESede/CBC/PKCS5Padding ";
  private static final String desKeyAlgorithm = "DESede";
  
  public CryptUtil() {}
  
  private static IvParameterSpec IvGenerator(byte[] paramArrayOfByte)
  {
    return new IvParameterSpec(paramArrayOfByte);
  }
  
  private static SecretKey KeyGenerator(String paramString)
  {
    Object localObject = null;
    try
    {
      paramString = md5Hex(paramString).substring(0, 24).getBytes("GBK");
      return new SecretKeySpec(paramString, "DESede");
    }
    catch (UnsupportedEncodingException paramString)
    {
      for (;;)
      {
        paramString.printStackTrace();
        paramString = localObject;
      }
    }
  }
  
  public static byte[] cryptBy3Des(String paramString, int paramInt, byte[] paramArrayOfByte1, byte[] paramArrayOfByte2)
  {
    SecretKey localSecretKey = KeyGenerator(paramString);
    if (paramArrayOfByte1 == null) {}
    for (paramString = IvGenerator(defaultIV);; paramString = IvGenerator(paramArrayOfByte1)) {
      try
      {
        paramArrayOfByte1 = Cipher.getInstance("DESede/CBC/PKCS5Padding ");
        paramArrayOfByte1.init(paramInt, localSecretKey, paramString);
        paramString = paramArrayOfByte1.doFinal(paramArrayOfByte2);
        return paramString;
      }
      catch (NoSuchAlgorithmException paramString)
      {
        paramString.printStackTrace();
        return null;
      }
      catch (NoSuchPaddingException paramString)
      {
        for (;;)
        {
          paramString.printStackTrace();
        }
      }
      catch (InvalidKeyException paramString)
      {
        for (;;)
        {
          paramString.printStackTrace();
        }
      }
      catch (InvalidAlgorithmParameterException paramString)
      {
        for (;;)
        {
          paramString.printStackTrace();
        }
      }
      catch (IllegalBlockSizeException paramString)
      {
        for (;;)
        {
          paramString.printStackTrace();
        }
      }
      catch (BadPaddingException paramString)
      {
        for (;;)
        {
          paramString.printStackTrace();
        }
      }
    }
  }
  
  public static byte[] decryptBy3Des(byte[] paramArrayOfByte, String paramString)
  {
    return cryptBy3Des(paramString, 2, null, paramArrayOfByte);
  }
  
  public static String decryptBy3DesAndBase64(String paramString1, String paramString2)
  {
    return decryptBy3DesAndBase64(paramString1, paramString2, "UTF-8");
  }
  
  public static String decryptBy3DesAndBase64(String paramString1, String paramString2, String paramString3)
  {
    try
    {
      paramString1 = new String(decryptBy3Des(Base64.decode(paramString1), paramString2), paramString3).trim();
      return paramString1;
    }
    catch (UnsupportedEncodingException paramString1)
    {
      paramString1.printStackTrace();
    }
    return null;
  }
  
  public static String doMD5(String paramString)
  {
    int j = 0;
    for (;;)
    {
      Object localObject;
      byte[] arrayOfByte;
      int i;
      try
      {
        localObject = MessageDigest.getInstance("MD5");
        paramString = paramString.toCharArray();
        arrayOfByte = new byte[paramString.length];
        i = 0;
        if (i >= paramString.length)
        {
          paramString = ((MessageDigest)localObject).digest(arrayOfByte);
          localObject = new StringBuffer();
          i = j;
          if (i < paramString.length) {
            break label88;
          }
          return ((StringBuffer)localObject).toString();
        }
      }
      catch (Exception paramString)
      {
        System.out.println(paramString.toString());
        paramString.printStackTrace();
        return "";
      }
      arrayOfByte[i] = ((byte)paramString[i]);
      i += 1;
      continue;
      label88:
      j = paramString[i] & 0xFF;
      if (j < 16) {
        ((StringBuffer)localObject).append("0");
      }
      ((StringBuffer)localObject).append(Integer.toHexString(j));
      i += 1;
    }
  }
  
  public static char[] encodeHex(byte[] paramArrayOfByte)
  {
    int j = 0;
    int k = paramArrayOfByte.length;
    char[] arrayOfChar = new char[k << 1];
    int i = 0;
    for (;;)
    {
      if (i >= k) {
        return arrayOfChar;
      }
      int m = j + 1;
      arrayOfChar[j] = DIGITS[((paramArrayOfByte[i] & 0xF0) >>> 4)];
      j = m + 1;
      arrayOfChar[m] = DIGITS[(paramArrayOfByte[i] & 0xF)];
      i += 1;
    }
  }
  
  public static byte[] encryptBy3Des(byte[] paramArrayOfByte, String paramString)
  {
    return cryptBy3Des(paramString, 1, null, paramArrayOfByte);
  }
  
  public static String encryptBy3DesAndBase64(String paramString1, String paramString2)
  {
    return encryptBy3DesAndBase64(paramString1, paramString2, "UTF-8");
  }
  
  public static String encryptBy3DesAndBase64(String paramString1, String paramString2, String paramString3)
  {
    try
    {
      int j = paramString1.length() % 8;
      int i;
      if (j != 0)
      {
        paramString1 = new StringBuffer(paramString1);
        i = 0;
        if (i < 8 - j) {}
      }
      for (paramString1 = new String(paramString1).getBytes(paramString3);; paramString1 = paramString1.getBytes(paramString3))
      {
        return Base64.encode(encryptBy3Des(paramString1, paramString2)).replaceAll("[\\n\\r]", "");
        paramString1.append(' ');
        i += 1;
        break;
      }
      return null;
    }
    catch (UnsupportedEncodingException paramString1)
    {
      paramString1.printStackTrace();
    }
  }
  
  /* Error */
  public static String md5Hex(String paramString)
  {
    // Byte code:
    //   0: aconst_null
    //   1: astore_1
    //   2: ldc -114
    //   4: invokestatic 147	java/security/MessageDigest:getInstance	(Ljava/lang/String;)Ljava/security/MessageDigest;
    //   7: astore_2
    //   8: aload_2
    //   9: astore_1
    //   10: aload_1
    //   11: aload_0
    //   12: ldc 64
    //   14: invokevirtual 68	java/lang/String:getBytes	(Ljava/lang/String;)[B
    //   17: invokevirtual 220	java/security/MessageDigest:update	([B)V
    //   20: new 58	java/lang/String
    //   23: dup
    //   24: aload_1
    //   25: invokevirtual 223	java/security/MessageDigest:digest	()[B
    //   28: invokestatic 225	com/unicom/wounipaysms/crypt/CryptUtil:encodeHex	([B)[C
    //   31: invokespecial 228	java/lang/String:<init>	([C)V
    //   34: areturn
    //   35: astore_2
    //   36: aload_2
    //   37: invokevirtual 109	java/security/NoSuchAlgorithmException:printStackTrace	()V
    //   40: goto -30 -> 10
    //   43: astore_0
    //   44: aload_0
    //   45: invokevirtual 76	java/io/UnsupportedEncodingException:printStackTrace	()V
    //   48: goto -28 -> 20
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	51	0	paramString	String
    //   1	24	1	localObject	Object
    //   7	2	2	localMessageDigest	MessageDigest
    //   35	2	2	localNoSuchAlgorithmException	NoSuchAlgorithmException
    // Exception table:
    //   from	to	target	type
    //   2	8	35	java/security/NoSuchAlgorithmException
    //   10	20	43	java/io/UnsupportedEncodingException
  }
}
