package com.popgame.popcentersdk.business;

import android.content.Context;
import com.popgame.popcentersdk.AppInfo;
import com.popgame.popcentersdk.N0Run;
import com.popgame.popcentersdk.PopManager;
import com.popgame.popcentersdk.business.db.PopDBManager;
import com.popgame.popcentersdk.util.XPUtils;
import java.util.Hashtable;
import java.util.Random;
import org.json.JSONException;
import org.json.JSONObject;

public class PopChargeBusiness
{
  public static String ChargeParam = null;
  public static JSONObject chargeTable = null;
  public static JSONObject curChargeTb = null;
  private static Hashtable other_para = new Hashtable();
  
  public PopChargeBusiness() {}
  
  public static void cancelChargeBack(String paramString)
  {
    if (N0Run.N0RunDebug) {
      XPUtils.xpPrint("======JAVA======cancelChargeBack()");
    }
    if (paramString != null) {}
    try
    {
      boolean bool = N0Run.N0RunDebug;
      chargeTable.remove(paramString);
      return;
    }
    catch (Throwable paramString)
    {
      while (!N0Run.N0RunDebug) {}
      paramString.printStackTrace();
    }
  }
  
  public static boolean changeOtherPara(String paramString)
  {
    boolean bool = false;
    int i = 0;
    if (paramString.length() != 0) {
      paramString = paramString.split("&");
    }
    for (;;)
    {
      if (i == paramString.length)
      {
        other_para.put("channelId", N0Run.m_para);
        bool = true;
        return bool;
      }
      other_para.put(paramString[(i + 1)], paramString[i]);
      i += 2;
    }
  }
  
  public static Hashtable changeOtherPara1(String paramString)
  {
    Hashtable localHashtable = new Hashtable();
    int i = 0;
    paramString = paramString.split("&");
    try
    {
      for (;;)
      {
        if (i == paramString.length)
        {
          localHashtable.put("channelId", N0Run.m_para);
          return localHashtable;
        }
        localHashtable.put(paramString[(i + 1)], paramString[i]);
        i += 2;
      }
      return null;
    }
    catch (Exception paramString) {}
  }
  
  private static String checkChargeParm(String paramString)
  {
    try
    {
      paramString = new JSONObject(paramString);
      paramString.getString("userid");
      paramString.getString("price");
      paramString.getString("currency");
      paramString.getString("iapname");
      paramString.getString("reserved");
      paramString.getString("amount");
      paramString.getString("roleid");
      paramString.getString("rolename");
      paramString.getString("zonename");
      paramString.getString("rolelevel");
      paramString.getString("type");
      paramString.getString("appname");
      paramString.getString("pname");
      paramString.getString("pinfo");
      return "yes";
    }
    catch (JSONException paramString)
    {
      paramString.printStackTrace();
      XPUtils.xpPrint(paramString.toString());
    }
    return "no";
  }
  
  public static void dataChargerSynchronizeBack(String paramString)
  {
    getInstance().dataChargerSynchronizeBackSelf(paramString);
  }
  
  public static PopChargeBusiness getInstance()
  {
    return new PopChargeBusiness();
  }
  
  public static void startCharge()
  {
    XPUtils.xpPrint("startCharge enter");
    if (PopManager.errResult == null) {
      PopManager.errResult = new JSONObject();
    }
    try
    {
      PopManager.errResult.put("status", "-2");
    }
    catch (Throwable localThrowable1)
    {
      try
      {
        for (;;)
        {
          PopChargeRun.getInstance().chargeStart();
          return;
          localThrowable1 = localThrowable1;
          if (N0Run.N0RunDebug)
          {
            localThrowable1.printStackTrace();
            XPUtils.xpPrint(localThrowable1.toString());
          }
        }
      }
      catch (Throwable localThrowable2)
      {
        while (!N0Run.N0RunDebug) {}
        localThrowable2.printStackTrace();
        XPUtils.xpPrint("startCharge 3");
      }
    }
  }
  
  public static JSONObject stringSplit(String paramString)
  {
    int i = 0;
    JSONObject localJSONObject = new JSONObject();
    try
    {
      paramString = paramString.split("&");
      for (;;)
      {
        if (i == paramString.length) {
          return localJSONObject;
        }
        String[] arrayOfString = paramString[i].split(":");
        localJSONObject.put(arrayOfString[0], arrayOfString[1]);
        i += 1;
      }
      return null;
    }
    catch (Exception paramString) {}
  }
  
  public void chargeHeartBack(int paramInt, String paramString1, String paramString2)
  {
    if ((paramString1 == null) || (paramString2 == null)) {}
    for (;;)
    {
      return;
      try
      {
        N0Run.GetCenterListener().CenterResult("Charge####" + paramString2);
        if (paramInt != 2) {
          continue;
        }
        try
        {
          PopManager.dbManager.insertIapInfo(paramString2);
          return;
        }
        catch (Throwable paramString1) {}
        return;
      }
      catch (Throwable paramString1)
      {
        paramString1.printStackTrace();
      }
    }
  }
  
  public String chargeRun(Context paramContext, String paramString)
  {
    try
    {
      paramContext = checkChargeParm(paramString);
      if (paramContext.equals("no")) {
        return paramContext;
      }
      chargeRunself(paramString);
      return "yes";
    }
    catch (Throwable paramContext)
    {
      paramContext.printStackTrace();
    }
    return "no";
  }
  
  public String chargeRunself(String paramString)
  {
    XPUtils.xpPrint("PopChargeBusiness  enter");
    paramString = initChargeInfo(paramString);
    if (paramString.indexOf("@@") == 0) {
      return paramString.substring(2);
    }
    startCharge();
    return "";
  }
  
  public void dataChargerSynchronizeBackSelf(String paramString)
  {
    if (N0Run.N0RunDebug) {
      XPUtils.xpPrint("======JAVA======dataSynchronizeBack()");
    }
    if (paramString == null) {}
    int i;
    do
    {
      do
      {
        return;
        try
        {
          paramString = paramString.split("@0@");
          i = Integer.valueOf(paramString[0].toString()).intValue();
          if (i != 0) {
            break;
          }
          startWebCharge(paramString);
          return;
        }
        catch (Throwable paramString) {}
      } while (!N0Run.N0RunDebug);
      paramString.printStackTrace();
      XPUtils.xpPrint("======JAVA======dataSynchronizeBack() error");
      return;
    } while (i != 1);
    errorCharge(paramString);
  }
  
  public void errorCharge(String[] paramArrayOfString)
  {
    int i = 0;
    try
    {
      String[] arrayOfString1 = paramArrayOfString[1].toString().split("&1");
      JSONObject localJSONObject1 = new JSONObject();
      JSONObject localJSONObject2 = new JSONObject();
      JSONObject localJSONObject3 = new JSONObject();
      paramArrayOfString = "";
      String str1 = "";
      String str2 = "";
      String str3 = "";
      String str4 = "";
      for (;;)
      {
        if (i >= arrayOfString1.length)
        {
          PopChargeRun.getInstance().sendFeeRecord(paramArrayOfString, str1, str2, str3, str4, "0", AppInfo.m_chargeId);
          localJSONObject2.put("iapNum", String.valueOf(arrayOfString1.length));
          localJSONObject2.put("iapData", localJSONObject3);
          localJSONObject1.put("status", "1");
          localJSONObject1.put("receipt", localJSONObject2);
          return;
        }
        String[] arrayOfString2 = arrayOfString1[i].toString().split("&0");
        JSONObject localJSONObject4 = new JSONObject();
        paramArrayOfString = curChargeTb.get("userId").toString();
        str1 = arrayOfString2[0];
        str3 = arrayOfString2[1];
        str4 = arrayOfString2[2];
        str2 = arrayOfString2[4];
        localJSONObject4.put("iapName", arrayOfString2[0]);
        localJSONObject4.put("price", arrayOfString2[1]);
        localJSONObject4.put("currency", arrayOfString2[2]);
        localJSONObject4.put("information", arrayOfString2[3]);
        i += 1;
      }
      return;
    }
    catch (Throwable paramArrayOfString)
    {
      if (N0Run.N0RunDebug) {
        paramArrayOfString.printStackTrace();
      }
    }
  }
  
  /* Error */
  public String initChargeInfo(String paramString)
  {
    // Byte code:
    //   0: getstatic 291	com/popgame/popcentersdk/business/PopUserBusiness:Userstatues	Ljava/lang/String;
    //   3: ifnonnull +31 -> 34
    //   6: ldc_w 293
    //   9: invokestatic 46	com/popgame/popcentersdk/util/XPUtils:xpPrint	(Ljava/lang/Object;)V
    //   12: new 176	java/lang/StringBuilder
    //   15: dup
    //   16: ldc -40
    //   18: invokestatic 296	java/lang/String:valueOf	(Ljava/lang/Object;)Ljava/lang/String;
    //   21: invokespecial 179	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   24: ldc_w 293
    //   27: invokevirtual 183	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   30: invokevirtual 184	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   33: areturn
    //   34: getstatic 291	com/popgame/popcentersdk/business/PopUserBusiness:Userstatues	Ljava/lang/String;
    //   37: ldc -1
    //   39: invokevirtual 206	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   42: ifeq +9 -> 51
    //   45: ldc_w 298
    //   48: invokestatic 46	com/popgame/popcentersdk/util/XPUtils:xpPrint	(Ljava/lang/Object;)V
    //   51: new 48	org/json/JSONObject
    //   54: dup
    //   55: aload_1
    //   56: invokespecial 88	org/json/JSONObject:<init>	(Ljava/lang/String;)V
    //   59: putstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   62: new 48	org/json/JSONObject
    //   65: dup
    //   66: invokespecial 146	org/json/JSONObject:<init>	()V
    //   69: putstatic 24	com/popgame/popcentersdk/business/PopChargeBusiness:chargeTable	Lorg/json/JSONObject;
    //   72: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   75: ldc_w 300
    //   78: invokestatic 303	com/popgame/popcentersdk/N0Run:getChannelNum	()Ljava/lang/String;
    //   81: invokevirtual 153	org/json/JSONObject:put	(Ljava/lang/String;Ljava/lang/Object;)Lorg/json/JSONObject;
    //   84: pop
    //   85: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   88: invokevirtual 304	org/json/JSONObject:toString	()Ljava/lang/String;
    //   91: invokestatic 46	com/popgame/popcentersdk/util/XPUtils:xpPrint	(Ljava/lang/Object;)V
    //   94: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   97: ldc 99
    //   99: invokevirtual 281	org/json/JSONObject:get	(Ljava/lang/String;)Ljava/lang/Object;
    //   102: invokevirtual 282	java/lang/Object:toString	()Ljava/lang/String;
    //   105: ifnull +60 -> 165
    //   108: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   111: ldc 95
    //   113: invokevirtual 281	org/json/JSONObject:get	(Ljava/lang/String;)Ljava/lang/Object;
    //   116: invokevirtual 282	java/lang/Object:toString	()Ljava/lang/String;
    //   119: ifnull +46 -> 165
    //   122: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   125: ldc 97
    //   127: invokevirtual 281	org/json/JSONObject:get	(Ljava/lang/String;)Ljava/lang/Object;
    //   130: invokevirtual 282	java/lang/Object:toString	()Ljava/lang/String;
    //   133: ifnull +32 -> 165
    //   136: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   139: ldc_w 300
    //   142: invokevirtual 281	org/json/JSONObject:get	(Ljava/lang/String;)Ljava/lang/Object;
    //   145: invokevirtual 282	java/lang/Object:toString	()Ljava/lang/String;
    //   148: ifnull +17 -> 165
    //   151: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   154: ldc 101
    //   156: invokevirtual 281	org/json/JSONObject:get	(Ljava/lang/String;)Ljava/lang/Object;
    //   159: invokevirtual 282	java/lang/Object:toString	()Ljava/lang/String;
    //   162: ifnonnull +64 -> 226
    //   165: ldc_w 306
    //   168: invokestatic 46	com/popgame/popcentersdk/util/XPUtils:xpPrint	(Ljava/lang/Object;)V
    //   171: new 176	java/lang/StringBuilder
    //   174: dup
    //   175: ldc -40
    //   177: invokestatic 296	java/lang/String:valueOf	(Ljava/lang/Object;)Ljava/lang/String;
    //   180: invokespecial 179	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   183: ldc_w 308
    //   186: invokevirtual 183	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   189: invokevirtual 184	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   192: astore_1
    //   193: aload_1
    //   194: areturn
    //   195: astore_1
    //   196: ldc_w 272
    //   199: invokestatic 46	com/popgame/popcentersdk/util/XPUtils:xpPrint	(Ljava/lang/Object;)V
    //   202: new 176	java/lang/StringBuilder
    //   205: dup
    //   206: ldc -40
    //   208: invokestatic 296	java/lang/String:valueOf	(Ljava/lang/Object;)Ljava/lang/String;
    //   211: invokespecial 179	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   214: ldc_w 308
    //   217: invokevirtual 183	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   220: invokevirtual 184	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   223: astore_1
    //   224: aload_1
    //   225: areturn
    //   226: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   229: ldc 90
    //   231: invokevirtual 281	org/json/JSONObject:get	(Ljava/lang/String;)Ljava/lang/Object;
    //   234: invokevirtual 282	java/lang/Object:toString	()Ljava/lang/String;
    //   237: putstatic 311	com/popgame/popcentersdk/AppInfo:m_userId	Ljava/lang/String;
    //   240: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   243: ldc 95
    //   245: invokevirtual 281	org/json/JSONObject:get	(Ljava/lang/String;)Ljava/lang/Object;
    //   248: invokevirtual 282	java/lang/Object:toString	()Ljava/lang/String;
    //   251: putstatic 314	com/popgame/popcentersdk/AppInfo:m_price	Ljava/lang/String;
    //   254: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   257: ldc 99
    //   259: invokevirtual 281	org/json/JSONObject:get	(Ljava/lang/String;)Ljava/lang/Object;
    //   262: invokevirtual 282	java/lang/Object:toString	()Ljava/lang/String;
    //   265: putstatic 317	com/popgame/popcentersdk/AppInfo:m_iapName	Ljava/lang/String;
    //   268: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   271: ldc 97
    //   273: invokevirtual 281	org/json/JSONObject:get	(Ljava/lang/String;)Ljava/lang/Object;
    //   276: invokevirtual 282	java/lang/Object:toString	()Ljava/lang/String;
    //   279: putstatic 320	com/popgame/popcentersdk/AppInfo:m_currency	Ljava/lang/String;
    //   282: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   285: ldc_w 300
    //   288: invokevirtual 281	org/json/JSONObject:get	(Ljava/lang/String;)Ljava/lang/Object;
    //   291: invokevirtual 282	java/lang/Object:toString	()Ljava/lang/String;
    //   294: putstatic 323	com/popgame/popcentersdk/AppInfo:m_channelId	Ljava/lang/String;
    //   297: getstatic 26	com/popgame/popcentersdk/business/PopChargeBusiness:curChargeTb	Lorg/json/JSONObject;
    //   300: ldc 101
    //   302: invokevirtual 281	org/json/JSONObject:get	(Ljava/lang/String;)Ljava/lang/Object;
    //   305: invokevirtual 282	java/lang/Object:toString	()Ljava/lang/String;
    //   308: putstatic 326	com/popgame/popcentersdk/AppInfo:m_reserved	Ljava/lang/String;
    //   311: getstatic 311	com/popgame/popcentersdk/AppInfo:m_userId	Ljava/lang/String;
    //   314: ifnonnull +8 -> 322
    //   317: ldc -28
    //   319: putstatic 311	com/popgame/popcentersdk/AppInfo:m_userId	Ljava/lang/String;
    //   322: getstatic 329	com/popgame/popcentersdk/AppInfo:m_uuid	Ljava/lang/String;
    //   325: ifnull +12 -> 337
    //   328: getstatic 329	com/popgame/popcentersdk/AppInfo:m_uuid	Ljava/lang/String;
    //   331: invokevirtual 63	java/lang/String:length	()I
    //   334: ifne +66 -> 400
    //   337: invokestatic 335	java/util/UUID:randomUUID	()Ljava/util/UUID;
    //   340: invokevirtual 336	java/util/UUID:toString	()Ljava/lang/String;
    //   343: putstatic 329	com/popgame/popcentersdk/AppInfo:m_uuid	Ljava/lang/String;
    //   346: ldc -40
    //   348: areturn
    //   349: astore_1
    //   350: aload_1
    //   351: invokevirtual 55	java/lang/Throwable:printStackTrace	()V
    //   354: ldc -40
    //   356: areturn
    //   357: astore_1
    //   358: new 176	java/lang/StringBuilder
    //   361: dup
    //   362: ldc -40
    //   364: invokestatic 296	java/lang/String:valueOf	(Ljava/lang/Object;)Ljava/lang/String;
    //   367: invokespecial 179	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   370: ldc_w 338
    //   373: invokevirtual 183	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   376: invokevirtual 184	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   379: astore_2
    //   380: aload_1
    //   381: invokevirtual 55	java/lang/Throwable:printStackTrace	()V
    //   384: aload_2
    //   385: areturn
    //   386: astore_1
    //   387: aload_1
    //   388: invokevirtual 55	java/lang/Throwable:printStackTrace	()V
    //   391: ldc_w 340
    //   394: invokestatic 46	com/popgame/popcentersdk/util/XPUtils:xpPrint	(Ljava/lang/Object;)V
    //   397: goto -86 -> 311
    //   400: ldc -40
    //   402: areturn
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	403	0	this	PopChargeBusiness
    //   0	403	1	paramString	String
    //   379	6	2	str	String
    // Exception table:
    //   from	to	target	type
    //   51	165	195	java/lang/Throwable
    //   165	193	195	java/lang/Throwable
    //   311	322	349	java/lang/Throwable
    //   322	337	349	java/lang/Throwable
    //   337	346	349	java/lang/Throwable
    //   0	34	357	java/lang/Throwable
    //   34	51	357	java/lang/Throwable
    //   196	224	357	java/lang/Throwable
    //   350	354	357	java/lang/Throwable
    //   387	397	357	java/lang/Throwable
    //   226	311	386	java/lang/Throwable
  }
  
  public void startWebCharge(String[] paramArrayOfString)
  {
    try
    {
      String str1 = paramArrayOfString[1].toString();
      chargeTable.put(str1, curChargeTb);
      paramArrayOfString = paramArrayOfString[2].toString().split("####");
      int i = new Random().nextInt(paramArrayOfString.length);
      Object localObject = curChargeTb;
      XPUtils.xpPrint(curChargeTb.toString());
      XPUtils.xpPrint(((JSONObject)localObject).toString());
      String str2 = ((JSONObject)localObject).get("iapname").toString();
      ((JSONObject)localObject).get("price").toString();
      localObject = ((JSONObject)localObject).get("currency").toString();
      AppInfo.m_chargeId = str1;
      str2 = paramArrayOfString[i].split("#@@#")[0] + "?pid=" + AppInfo.m_channelId + "&runNumber=" + str1 + "&chargePoint=" + str2 + "&bizhong=" + (String)localObject + "&id1=" + AppInfo.m_imei + "&id2=" + AppInfo.m_macAddress + "&id3=&version=" + AppInfo.m_gameVersion + "&userid=" + AppInfo.m_userId + "&reserved=" + AppInfo.m_reserved + "&device=" + AppInfo.m_imei;
      XPUtils.xpPrint("chargeWebUrl-->" + str2);
      PopMessageHandler.postPopMsg(2, str2, null);
      PopChargeRun.getInstance().heartStart(str1, paramArrayOfString[i].split("#@@#")[1].replaceAll("http://", ""));
      return;
    }
    catch (Throwable paramArrayOfString)
    {
      paramArrayOfString.printStackTrace();
    }
  }
}
