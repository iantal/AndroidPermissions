package com.hzpz.pay;

import android.text.TextUtils;
import com.hzpz.pay.jsoup.Connection;
import com.hzpz.pay.jsoup.Jsoup;
import com.hzpz.pay.jsoup.nodes.Document;
import com.hzpz.pay.jsoup.nodes.Element;
import com.hzpz.pay.jsoup.select.Elements;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;

final class bv
  implements Runnable
{
  bv(PzPay paramPzPay) {}
  
  public final void run()
  {
    int i = PzPay.k(this.a).size() - 1;
    boolean bool1 = true;
    if (i < 0)
    {
      aP.a("包月OVER");
      return;
    }
    U localU = (U)PzPay.k(this.a).remove(i);
    Object localObject2;
    String str1;
    if ("16".equals(localU.o))
    {
      localObject2 = new bw(this);
      str1 = localU.r;
      String str2 = localU.t;
    }
    for (;;)
    {
      Object localObject3;
      Object localObject4;
      Object localObject1;
      try
      {
        localObject3 = Jsoup.a(str1);
        ((Connection)localObject3).a(5000);
        localObject3 = ((Connection)localObject3).a();
        try
        {
          localObject4 = ((Document)localObject3).b("form").a("[action=/play.msp]").c();
          if (localObject4 != null) {
            break label368;
          }
          localObject4 = ((Document)localObject3).a("a").iterator();
          if (((Iterator)localObject4).hasNext()) {
            break label286;
          }
          throw new aT(505, str1 + "[" + ((Document)localObject3).s() + "]");
        }
        catch (Exception localException1)
        {
          ((aS)localObject2).a(localU, localException1, bool1);
          if (!(localException1 instanceof aT)) {
            break label1049;
          }
        }
        localObject1 = (aT)localException1;
        aP.a("TAG", ((aT)localObject1).a + "#" + ((aT)localObject1).b);
        i -= 1;
        bool1 = false;
      }
      catch (Exception localException2)
      {
        throw new aT(405, (String)localObject1);
      }
      label286:
      Object localObject5 = (Element)((Iterator)localObject4).next();
      if ((((Element)localObject5).d("href") != null) && (((Element)localObject5).d("href").startsWith(localException2)))
      {
        aP.a("TAG", "已经订购" + ((Element)localObject5).d("href"));
        throw new aT(201, ((Element)localObject5).d("href"));
        label368:
        Object localObject6 = ((Element)localObject4).a("input[name]");
        if (localObject6 == null) {
          throw new aT(505, localObject1 + "[" + ((Document)localObject3).s() + "]");
        }
        localObject3 = ((String)localObject1).substring(0, ((String)localObject1).indexOf("/", 10));
        localObject4 = localObject3 + "/play.msp";
        localObject1 = new StringBuffer("[");
        localObject5 = new HashMap();
        localObject6 = ((Elements)localObject6).iterator();
        if (!((Iterator)localObject6).hasNext())
        {
          ((StringBuffer)localObject1).append("]");
          aP.a("TAG", "订购参数" + ((StringBuffer)localObject1).toString());
        }
        label923:
        do
        {
          for (;;)
          {
            try
            {
              localObject6 = Jsoup.a((String)localObject4);
              ((Connection)localObject6).a(60000);
              ((Connection)localObject6).a((Map)localObject5);
              localObject5 = ((Connection)localObject6).b();
              localObject6 = ((Document)localObject5).a("a");
              localObject1 = null;
              localObject6 = ((Elements)localObject6).iterator();
              if (!((Iterator)localObject6).hasNext())
              {
                boolean bool2 = TextUtils.isEmpty((CharSequence)localObject1);
                if (bool2) {
                  break label1005;
                }
              }
            }
            catch (Exception localException3)
            {
              throw new aT(406, localObject4 + ((StringBuffer)localObject1).toString());
            }
            try
            {
              localObject4 = Jsoup.a(localObject3 + (String)localObject1);
              ((Connection)localObject4).a(60000);
              localObject4 = ((Connection)localObject4).a();
              localObject5 = ((Document)localObject4).a("a").iterator();
              if (((Iterator)localObject5).hasNext()) {
                break label923;
              }
              throw new aT(507, localObject3 + (String)localObject1 + "[" + ((Document)localObject4).s() + "]");
            }
            catch (Exception localException4)
            {
              throw new aT(407, localObject3 + (String)localObject1);
            }
            Element localElement = (Element)((Iterator)localObject6).next();
            ((Map)localObject5).put(localElement.d("name"), localElement.d("value"));
            ((StringBuffer)localObject1).append("\n" + localElement.d("name") + "=" + localElement.d("value"));
            break;
            localElement = (Element)((Iterator)localObject6).next();
            if ((localElement.d("href") != null) && (localElement.d("href").startsWith("/order.msp"))) {
              localObject1 = localElement.d("href");
            }
          }
          localObject6 = (Element)((Iterator)localObject5).next();
        } while ((((Element)localObject6).d("href") == null) || (!((Element)localObject6).d("href").startsWith(localException4)));
        aP.a("TAG", "订购成功" + ((Element)localObject6).d("href"));
        throw new aT(200, ((Element)localObject6).d("href"));
        label1005:
        throw new aT(506, localObject4 + "[" + ((Document)localObject5).s() + "]");
        label1049:
        aP.a("TAG", ((Exception)localObject1).getMessage());
        ((Exception)localObject1).printStackTrace();
        continue;
        if ("17".equals(localU.o))
        {
          localObject1 = new bx(this);
          localObject2 = this.a.l;
          PzPay.1.1.a(localU, bool1, (aS)localObject1);
        }
      }
    }
  }
}
