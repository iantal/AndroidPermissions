package com.e.a;

import com.e.a.a.a;
import java.io.ByteArrayOutputStream;
import java.security.KeyFactory;
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.security.SecureRandom;
import java.security.interfaces.RSAPrivateKey;
import java.security.interfaces.RSAPublicKey;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;
import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;

public class c
{
  private static RSAPublicKey a;
  private static RSAPrivateKey b;
  
  public static String a()
  {
    return b.a(a.getEncoded());
  }
  
  public static String a(String paramString1, String paramString2, String paramString3, String paramString4)
  {
    paramString2 = a(paramString2 + paramString3 + paramString4);
    paramString3 = new byte[8];
    System.arraycopy(paramString2, 0, paramString3, 0, 8);
    try
    {
      paramString1 = a.a(a(paramString1.getBytes(), paramString3, true), 0);
      return paramString1;
    }
    catch (Exception paramString1)
    {
      paramString1.printStackTrace();
    }
    return "";
  }
  
  private static byte[] a(String paramString)
  {
    try
    {
      paramString = MessageDigest.getInstance("MD5").digest(paramString.getBytes());
      return paramString;
    }
    catch (NoSuchAlgorithmException paramString)
    {
      paramString.printStackTrace();
    }
    return null;
  }
  
  public static byte[] a(byte[] paramArrayOfByte, String paramString)
  {
    if (paramString == null) {
      return null;
    }
    paramString = new PKCS8EncodedKeySpec(b.a(paramString));
    paramString = KeyFactory.getInstance("RSA").generatePrivate(paramString);
    Cipher localCipher = Cipher.getInstance("RSA/ECB/PKCS1Padding");
    localCipher.init(2, paramString);
    int k = paramArrayOfByte.length;
    ByteArrayOutputStream localByteArrayOutputStream = new ByteArrayOutputStream();
    int i = 0;
    int j = 0;
    if (k - i <= 0)
    {
      paramArrayOfByte = localByteArrayOutputStream.toByteArray();
      localByteArrayOutputStream.close();
      return paramArrayOfByte;
    }
    if (k - i > 128) {}
    for (paramString = localCipher.doFinal(paramArrayOfByte, i, 128);; paramString = localCipher.doFinal(paramArrayOfByte, i, k - i))
    {
      j += 1;
      localByteArrayOutputStream.write(paramString, 0, paramString.length);
      i = j * 128;
      break;
    }
  }
  
  public static byte[] a(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2, boolean paramBoolean)
  {
    Cipher localCipher = Cipher.getInstance("DES/ECB/NoPadding");
    paramArrayOfByte2 = new SecretKeySpec(paramArrayOfByte2, "DES");
    if (!paramBoolean) {
      localCipher.init(2, paramArrayOfByte2);
    }
    for (;;)
    {
      paramArrayOfByte2 = new byte[(paramArrayOfByte1.length + 7) / 8 * 8];
      System.arraycopy(paramArrayOfByte1, 0, paramArrayOfByte2, 0, paramArrayOfByte1.length);
      return localCipher.doFinal(paramArrayOfByte2);
      localCipher.init(1, paramArrayOfByte2);
    }
  }
  
  public static void b()
  {
    if ((a == null) || (b == null))
    {
      Object localObject = KeyPairGenerator.getInstance("RSA");
      ((KeyPairGenerator)localObject).initialize(1024, new SecureRandom());
      localObject = ((KeyPairGenerator)localObject).generateKeyPair();
      a = (RSAPublicKey)((KeyPair)localObject).getPublic();
      b = (RSAPrivateKey)((KeyPair)localObject).getPrivate();
    }
  }
  
  public static byte[] b(byte[] paramArrayOfByte, String paramString)
  {
    if ((paramArrayOfByte != null) && (paramString != null))
    {
      paramString = new X509EncodedKeySpec(b.a(paramString));
      paramString = KeyFactory.getInstance("RSA").generatePublic(paramString);
      Cipher localCipher = Cipher.getInstance("RSA/ECB/PKCS1Padding");
      localCipher.init(1, paramString);
      int k = paramArrayOfByte.length;
      ByteArrayOutputStream localByteArrayOutputStream = new ByteArrayOutputStream();
      int i = 0;
      int j = 0;
      if (k - i <= 0)
      {
        paramArrayOfByte = localByteArrayOutputStream.toByteArray();
        localByteArrayOutputStream.close();
        return paramArrayOfByte;
      }
      if (k - i > 117) {}
      for (paramString = localCipher.doFinal(paramArrayOfByte, i, 117);; paramString = localCipher.doFinal(paramArrayOfByte, i, k - i))
      {
        j += 1;
        localByteArrayOutputStream.write(paramString, 0, paramString.length);
        i = j * 117;
        break;
      }
    }
    return null;
  }
  
  public static String c()
  {
    return b.a(b.getEncoded());
  }
}
