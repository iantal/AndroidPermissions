package com.e.a;

import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.os.Handler;
import android.os.Looper;
import android.telephony.SmsManager;
import android.text.TextUtils;
import com.e.a.b.b;
import org.json.JSONObject;

public class f
{
  private i a = null;
  private boolean b = false;
  private boolean c = false;
  private Handler d = new Handler(Looper.getMainLooper());
  private Context e;
  private Runnable f = new g(this);
  private BroadcastReceiver g = new h(this);
  
  public f(Context paramContext)
  {
    if (paramContext != null) {
      this.e = paramContext.getApplicationContext();
    }
  }
  
  private void a()
  {
    com.e.a.b.h.a(this.e, 2, 0);
    com.e.a.b.h.a(this.e, 3, 0);
  }
  
  private void a(Context paramContext, String paramString, byte[] paramArrayOfByte)
  {
    SmsManager localSmsManager = SmsManager.getDefault();
    if (!this.b)
    {
      IntentFilter localIntentFilter = new IntentFilter("com.aspire.demo.smsbilling");
      paramContext.registerReceiver(this.g, localIntentFilter);
      this.b = true;
    }
    localSmsManager.sendDataMessage(paramString, null, (short)0, paramArrayOfByte, PendingIntent.getBroadcast(paramContext, 0, new Intent("com.aspire.demo.smsbilling"), 0), null);
  }
  
  public void a(Context paramContext, String paramString)
  {
    b.b();
    b.a(paramContext);
    b.a(paramString);
    b.a().o = 0;
    com.e.a.b.h.a(paramContext, 0, 0);
    new d(paramContext).execute(new String[] { b.a().i });
  }
  
  public void a(Context paramContext, String paramString, i paramI)
  {
    this.a = paramI;
    this.c = false;
    try
    {
      b localB = b.a();
      Object localObject2 = new JSONObject(paramString);
      localB.h = ((JSONObject)localObject2).getString("paycode");
      com.e.a.b.h.a(paramContext, 1, 0);
      Object localObject1 = ((JSONObject)localObject2).getString("smsHex");
      paramString = ((JSONObject)localObject2).getString("tel");
      localObject2 = ((JSONObject)localObject2).getString("tradeId");
      if ((!TextUtils.isEmpty((CharSequence)localObject1)) && (!TextUtils.isEmpty(paramString)) && (!TextUtils.isEmpty(paramString)))
      {
        localObject1 = j.a((String)localObject1);
        localB.A = ((String)localObject2);
        this.d.postDelayed(this.f, 30000L);
        a(paramContext, paramString, (byte[])localObject1);
      }
      return;
    }
    catch (Exception paramContext)
    {
      while (paramI == null) {}
      paramI.onResult(-4, "数据异常");
    }
  }
}
