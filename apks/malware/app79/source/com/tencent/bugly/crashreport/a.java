package com.tencent.bugly.crashreport;

import android.content.Context;
import android.text.TextUtils;
import com.tencent.bugly.a.ao;
import com.tencent.bugly.a.av;
import com.tencent.bugly.a.b;
import com.tencent.bugly.a.bc;
import com.tencent.bugly.a.bf;
import com.tencent.bugly.a.bh;
import com.tencent.bugly.a.bl;
import com.tencent.bugly.crashreport.common.strategy.BuglyBroadcastRecevier;
import com.tencent.bugly.crashreport.common.strategy.StrategyBean;
import java.util.Iterator;
import java.util.List;

public class a
{
  public static boolean a;
  private static Context b;
  
  private static void a(Context paramContext, com.tencent.bugly.crashreport.common.info.c paramC)
  {
    List localList = paramC.I();
    if ((localList == null) || (localList.size() == 0)) {}
    do
    {
      bf.a("not have bugly channel version", new Object[0]);
      do
      {
        return;
      } while (localList.size() == 1);
      paramContext = new StringBuilder(16).append((String)localList.get(1));
      int i = 2;
      while (i < localList.size())
      {
        paramContext.append(",").append((String)localList.get(i));
        i += 1;
      }
    } while (a(localList, paramC.H()));
    paramC = String.format("# BUGLY CRASH REPORTER EXISTS IN MULTIPLE SDK. FOR MORE EFFICIENCY, \n# PLEASE SET <meta-data> IN [AndroidManifest.xml]:\n# <application>\n# ...\n#     <meta-data android:name=\"BUGLY_DISABLE\" android:value=\"%s\"/>\n# ...\n# </application>\n# FOR MORE INFOMATION, VISIT:\n# http://bugly.qq.com/androidsdk", new Object[] { paramContext });
    paramContext = String.format("# 您的App中含有多个异常上报模块，为了节省您的资源，\n# 请在[AndroidManifest.xml]中添加meta-data配置：[AndroidManifest.xml]:\n# <application>\n# ...\n#     <meta-data android:name=\"BUGLY_DISABLE\" android:value=\"%s\"/>\n# ...\n# </application>\n# 更多信息请参见：\n# http://bugly.qq.com/androidsdk", new Object[] { paramContext });
    bf.e("--------------------------BUGLY TIPS--------------------------", new Object[0]);
    bf.e(paramC, new Object[0]);
    bf.e("--------------------------------------------------------------", new Object[0]);
    bf.e(paramContext, new Object[0]);
    bf.e("--------------------------------------------------------------", new Object[0]);
    throw new d(paramC);
  }
  
  public static void a(Context paramContext, String paramString, boolean paramBoolean, c paramC)
  {
    if (paramBoolean) {}
    Context localContext;
    try
    {
      a = true;
      bf.a(new bl());
      bf.d("'isDebug' is true , so running in debug model , close it when you release!", new Object[0]);
      bf.b("[init] bugly in debug mode, will print log.", new Object[0]);
      if ((paramC == null) || (c.a(paramC)))
      {
        bh.a(paramContext);
        bf.a("BuglyLog is inited.", new Object[0]);
      }
      if (b != null)
      {
        bf.d("already inited ! nothing to do !", new Object[0]);
        return;
      }
      localContext = com.tencent.bugly.a.d.a(paramContext);
      b = localContext;
      if (localContext == null) {
        throw new d("init arg 'appContext' should not be null!");
      }
    }
    finally {}
    com.tencent.bugly.crashreport.common.info.c localC = com.tencent.bugly.crashreport.common.info.c.a(localContext);
    a(localContext, localC);
    Object localObject2 = localC.H();
    if (localC.h().equals("")) {}
    for (Object localObject1 = "bugly";; localObject1 = localC.h())
    {
      if ((localObject2 == null) || (!((List)localObject2).contains(localObject1))) {
        break label201;
      }
      bf.a("[init] bugly(%s) is closed.", new Object[] { localObject1 });
      break;
    }
    label201:
    if ((localObject2 != null) && (((List)localObject2).size() > 0))
    {
      localObject1 = ((List)localObject2).iterator();
      while (((Iterator)localObject1).hasNext())
      {
        localObject2 = (String)((Iterator)localObject1).next();
        bf.a("[Configuration] channel disabled: " + (String)localObject2, new Object[0]);
      }
    }
    bf.a(localC.h() + " crash report start init!", new Object[0]);
    bf.b("[init] bugly start init...", new Object[0]);
    if (paramString == null) {
      throw new d("init arg 'crashReportAppID' should not be null!");
    }
    localC.b(paramString);
    bf.a("setted APPID:%s", new Object[] { paramString });
    if (paramC != null)
    {
      paramString = c.b(paramC);
      if (!TextUtils.isEmpty(paramString))
      {
        if (paramString.length() <= 100) {
          break label992;
        }
        localObject1 = paramString.substring(0, 100);
        bf.d("appVersion %s length is over limit %d substring to %s", new Object[] { paramString, Integer.valueOf(100), localObject1 });
        paramString = (String)localObject1;
      }
    }
    label832:
    label971:
    label989:
    label992:
    for (;;)
    {
      localC.d(paramString);
      bf.a("setted APPVERSION:%s", new Object[] { c.b(paramC) });
      localObject1 = c.c(paramC);
      paramString = (String)localObject1;
      if (!TextUtils.isEmpty((CharSequence)localObject1))
      {
        paramString = (String)localObject1;
        if (((String)localObject1).length() > 100)
        {
          paramString = ((String)localObject1).substring(0, 100);
          bf.d("appChannel %s length is over limit %d substring to %s", new Object[] { localObject1, Integer.valueOf(100), paramString });
        }
        localC.g(paramString);
        bf.a("setted APPCHANNEL:%s", new Object[] { c.c(paramC) });
      }
      localObject1 = c.d(paramC);
      if (!TextUtils.isEmpty((CharSequence)localObject1))
      {
        if (((String)localObject1).length() <= 100) {
          break label989;
        }
        localObject2 = ((String)localObject1).substring(0, 100);
        bf.d("appPackageName %s length is over limit %d substring to %s", new Object[] { localObject1, Integer.valueOf(100), localObject2 });
        localObject1 = localObject2;
      }
      for (;;)
      {
        localC.c((String)localObject1);
        bf.a("setted PACKAGENAME:%s", new Object[] { c.d(paramC) });
        localObject1 = c.e(paramC);
        if (!TextUtils.isEmpty((CharSequence)localObject1))
        {
          localC.h((String)localObject1);
          bf.a("setted libBugly.so file path :%s", new Object[] { localObject1 });
        }
        localObject2 = c.f(paramC);
        if (localObject2 != null)
        {
          localObject1 = localObject2;
          if (((String)localObject2).length() > 100)
          {
            localObject1 = ((String)localObject2).substring(0, 100);
            bf.d("deviceId %s length is over limit %d substring to %s", new Object[] { paramString, Integer.valueOf(100), localObject1 });
          }
          localC.e((String)localObject1);
          bf.a("setted deviceId :%s", new Object[] { localObject1 });
        }
        localObject1 = bc.a();
        localObject2 = ao.a(localContext);
        av localAv = av.a(localContext, (bc)localObject1, localC, (ao)localObject2);
        com.tencent.bugly.crashreport.common.strategy.f localF = com.tencent.bugly.crashreport.common.strategy.f.a(localContext, localC, new StrategyBean(), ao.a(localContext), localAv, (bc)localObject1);
        if ((paramC != null) && (c.g(paramC) > 0L))
        {
          localF.a(c.g(paramC));
          bf.a("setted APP_REPORT_DELAY %d", new Object[] { Long.valueOf(c.g(paramC)) });
          com.tencent.bugly.crashreport.biz.f.a().a(paramContext, localF);
          paramString = null;
          paramContext = paramString;
          if (paramC != null)
          {
            paramContext = paramString;
            if (paramC.a() != null)
            {
              paramContext = paramC.a();
              bf.a("setted CrashHanldeCallback", new Object[0]);
            }
          }
          paramContext = com.tencent.bugly.crashreport.crash.d.a(localContext, (ao)localObject2, localF, localAv, localC, (bc)localObject1, paramBoolean, paramContext);
          paramContext.b();
          if ((paramC != null) && (paramC.b() != true)) {
            break label971;
          }
          paramContext.d();
        }
        for (;;)
        {
          paramContext.e();
          paramContext = BuglyBroadcastRecevier.a();
          paramContext.a("android.net.conn.CONNECTIVITY_CHANGE");
          paramContext.a(localContext);
          a(localC);
          bf.a("crash report inited!", new Object[0]);
          bf.b("[init] bugly init finished.", new Object[0]);
          break;
          localF.f();
          break label832;
          bf.a("closed native!", new Object[0]);
          paramContext.c();
        }
      }
    }
  }
  
  private static void a(com.tencent.bugly.crashreport.common.info.c paramC)
  {
    try
    {
      Class localClass = Class.forName("com.tencent.bugly.unity.UnityAgent");
      String str1 = "com.tencent.bugly";
      String str2 = paramC.h();
      if (!"".equals(str2)) {
        str1 = "com.tencent.bugly" + "." + str2;
      }
      b.a(localClass, "sdkPackageName", str1, null);
      return;
    }
    catch (Throwable localThrowable)
    {
      for (;;)
      {
        try
        {
          localClass = Class.forName("com.tencent.bugly.cococs.Cocos2dxAgent");
          str1 = "com.tencent.bugly";
          str2 = paramC.h();
          paramC = str1;
          if (!"".equals(str2)) {
            paramC = "com.tencent.bugly" + "." + str2;
          }
          b.a(localClass, "sdkPackageName", paramC, null);
          return;
        }
        catch (Throwable paramC)
        {
          bf.a("no cocos agent", new Object[0]);
        }
        localThrowable = localThrowable;
        bf.a("no unity agent", new Object[0]);
      }
    }
  }
  
  private static boolean a(List<String> paramList1, List<String> paramList2)
  {
    if ((paramList2 == null) || (paramList2.size() == 0)) {}
    label72:
    label73:
    for (;;)
    {
      return false;
      paramList2 = paramList2.iterator();
      int i = 0;
      if (paramList2.hasNext())
      {
        if (!paramList1.contains((String)paramList2.next())) {
          break label72;
        }
        i += 1;
      }
      for (;;)
      {
        break;
        if (i < paramList1.size() - 1) {
          break label73;
        }
        return true;
      }
    }
  }
}
