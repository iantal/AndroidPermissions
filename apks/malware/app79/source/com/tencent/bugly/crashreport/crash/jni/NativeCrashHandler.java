package com.tencent.bugly.crashreport.crash.jni;

import android.content.Context;
import com.tencent.bugly.a.bc;
import com.tencent.bugly.a.bf;
import com.tencent.bugly.a.d;
import com.tencent.bugly.crashreport.common.strategy.StrategyBean;
import com.tencent.bugly.crashreport.common.strategy.e;
import com.tencent.bugly.crashreport.common.strategy.f;
import java.io.File;

public class NativeCrashHandler
  implements e
{
  private static NativeCrashHandler a;
  private final int b = 1;
  private final Context c;
  private final com.tencent.bugly.crashreport.common.info.c d;
  private final bc e;
  private final b f;
  private final String g;
  private final boolean h;
  private boolean i = false;
  private boolean j = false;
  private boolean k = false;
  
  protected NativeCrashHandler(Context paramContext, com.tencent.bugly.crashreport.common.info.c paramC, com.tencent.bugly.crashreport.crash.c paramC1, f paramF, com.tencent.bugly.crashreport.b paramB, bc paramBc, boolean paramBoolean)
  {
    this.c = d.a(paramContext);
    this.g = paramContext.getDir("bugly", 0).getAbsolutePath();
    this.d = paramC;
    this.f = new c(paramContext, paramC, paramC1, paramF, paramB, this.g);
    this.e = paramBc;
    this.h = paramBoolean;
  }
  
  public static NativeCrashHandler a(Context paramContext, com.tencent.bugly.crashreport.common.info.c paramC, com.tencent.bugly.crashreport.crash.c paramC1, f paramF, com.tencent.bugly.crashreport.b paramB, bc paramBc, boolean paramBoolean)
  {
    try
    {
      if (a == null) {
        a = new NativeCrashHandler(paramContext, paramC, paramC1, paramF, paramB, paramBc, paramBoolean);
      }
      paramContext = a;
      return paramContext;
    }
    finally {}
  }
  
  private void d(boolean paramBoolean)
  {
    try
    {
      if (this.k != paramBoolean)
      {
        bf.a("user change anr %b", new Object[] { Boolean.valueOf(paramBoolean) });
        this.k = paramBoolean;
      }
      return;
    }
    finally
    {
      localObject = finally;
      throw localObject;
    }
  }
  
  /* Error */
  public void a()
  {
    // Byte code:
    //   0: aload_0
    //   1: monitorenter
    //   2: aload_0
    //   3: getfield 34	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:i	Z
    //   6: ifeq +14 -> 20
    //   9: aload_0
    //   10: aload_0
    //   11: getfield 74	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:h	Z
    //   14: invokevirtual 101	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:a	(Z)V
    //   17: aload_0
    //   18: monitorexit
    //   19: return
    //   20: aload_0
    //   21: getfield 63	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:d	Lcom/tencent/bugly/crashreport/common/info/c;
    //   24: invokevirtual 106	com/tencent/bugly/crashreport/common/info/c:E	()Ljava/lang/String;
    //   27: astore_1
    //   28: aload_1
    //   29: ifnonnull +111 -> 140
    //   32: ldc 108
    //   34: invokestatic 114	java/lang/System:loadLibrary	(Ljava/lang/String;)V
    //   37: aload_0
    //   38: iconst_1
    //   39: putfield 34	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:i	Z
    //   42: aload_0
    //   43: getfield 72	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:e	Lcom/tencent/bugly/a/bc;
    //   46: new 116	com/tencent/bugly/crashreport/crash/jni/a
    //   49: dup
    //   50: aload_0
    //   51: invokespecial 119	com/tencent/bugly/crashreport/crash/jni/a:<init>	(Lcom/tencent/bugly/crashreport/crash/jni/NativeCrashHandler;)V
    //   54: invokevirtual 124	com/tencent/bugly/a/bc:c	(Ljava/lang/Runnable;)Z
    //   57: pop
    //   58: aload_0
    //   59: getfield 34	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:i	Z
    //   62: ifeq -45 -> 17
    //   65: aload_0
    //   66: aload_0
    //   67: getfield 74	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:h	Z
    //   70: invokevirtual 101	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:a	(Z)V
    //   73: goto -56 -> 17
    //   76: astore_1
    //   77: aload_0
    //   78: monitorexit
    //   79: aload_1
    //   80: athrow
    //   81: astore_1
    //   82: ldc 126
    //   84: iconst_0
    //   85: anewarray 4	java/lang/Object
    //   88: invokestatic 128	com/tencent/bugly/a/bf:d	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   91: pop
    //   92: ldc 126
    //   94: iconst_0
    //   95: anewarray 4	java/lang/Object
    //   98: invokestatic 130	com/tencent/bugly/a/bf:b	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   101: pop
    //   102: aload_0
    //   103: getfield 63	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:d	Lcom/tencent/bugly/crashreport/common/info/c;
    //   106: invokevirtual 132	com/tencent/bugly/crashreport/common/info/c:h	()Ljava/lang/String;
    //   109: ldc -122
    //   111: invokevirtual 140	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   114: ifne -56 -> 58
    //   117: ldc -114
    //   119: iconst_0
    //   120: anewarray 4	java/lang/Object
    //   123: invokestatic 128	com/tencent/bugly/a/bf:d	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   126: pop
    //   127: ldc -114
    //   129: iconst_0
    //   130: anewarray 4	java/lang/Object
    //   133: invokestatic 130	com/tencent/bugly/a/bf:b	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   136: pop
    //   137: goto -79 -> 58
    //   140: aload_0
    //   141: getfield 63	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:d	Lcom/tencent/bugly/crashreport/common/info/c;
    //   144: invokevirtual 106	com/tencent/bugly/crashreport/common/info/c:E	()Ljava/lang/String;
    //   147: invokestatic 114	java/lang/System:loadLibrary	(Ljava/lang/String;)V
    //   150: aload_0
    //   151: iconst_1
    //   152: putfield 34	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:i	Z
    //   155: goto -97 -> 58
    //   158: astore_1
    //   159: ldc -112
    //   161: iconst_1
    //   162: anewarray 4	java/lang/Object
    //   165: dup
    //   166: iconst_0
    //   167: aload_0
    //   168: getfield 63	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:d	Lcom/tencent/bugly/crashreport/common/info/c;
    //   171: invokevirtual 106	com/tencent/bugly/crashreport/common/info/c:E	()Ljava/lang/String;
    //   174: aastore
    //   175: invokestatic 146	com/tencent/bugly/a/bf:e	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   178: pop
    //   179: goto -121 -> 58
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	182	0	this	NativeCrashHandler
    //   27	2	1	str	String
    //   76	4	1	localObject	Object
    //   81	1	1	localThrowable1	Throwable
    //   158	1	1	localThrowable2	Throwable
    // Exception table:
    //   from	to	target	type
    //   2	17	76	finally
    //   20	28	76	finally
    //   32	58	76	finally
    //   58	73	76	finally
    //   82	137	76	finally
    //   140	155	76	finally
    //   159	179	76	finally
    //   32	58	81	java/lang/Throwable
    //   140	155	158	java/lang/Throwable
  }
  
  /* Error */
  public void a(StrategyBean paramStrategyBean)
  {
    // Byte code:
    //   0: iconst_1
    //   1: istore_2
    //   2: aload_0
    //   3: monitorenter
    //   4: aload_1
    //   5: ifnull +34 -> 39
    //   8: aload_1
    //   9: getfield 151	com/tencent/bugly/crashreport/common/strategy/StrategyBean:d	Z
    //   12: aload_0
    //   13: getfield 36	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:j	Z
    //   16: if_icmpeq +23 -> 39
    //   19: ldc -103
    //   21: iconst_1
    //   22: anewarray 4	java/lang/Object
    //   25: dup
    //   26: iconst_0
    //   27: aload_1
    //   28: getfield 151	com/tencent/bugly/crashreport/common/strategy/StrategyBean:d	Z
    //   31: invokestatic 92	java/lang/Boolean:valueOf	(Z)Ljava/lang/Boolean;
    //   34: aastore
    //   35: invokestatic 128	com/tencent/bugly/a/bf:d	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   38: pop
    //   39: invokestatic 158	com/tencent/bugly/crashreport/common/strategy/f:a	()Lcom/tencent/bugly/crashreport/common/strategy/f;
    //   42: invokevirtual 161	com/tencent/bugly/crashreport/common/strategy/f:d	()Lcom/tencent/bugly/crashreport/common/strategy/StrategyBean;
    //   45: getfield 151	com/tencent/bugly/crashreport/common/strategy/StrategyBean:d	Z
    //   48: ifeq +43 -> 91
    //   51: aload_0
    //   52: getfield 38	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:k	Z
    //   55: ifeq +36 -> 91
    //   58: iload_2
    //   59: aload_0
    //   60: getfield 36	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:j	Z
    //   63: if_icmpeq +25 -> 88
    //   66: ldc -93
    //   68: iconst_1
    //   69: anewarray 4	java/lang/Object
    //   72: dup
    //   73: iconst_0
    //   74: iload_2
    //   75: invokestatic 92	java/lang/Boolean:valueOf	(Z)Ljava/lang/Boolean;
    //   78: aastore
    //   79: invokestatic 97	com/tencent/bugly/a/bf:a	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   82: pop
    //   83: aload_0
    //   84: iload_2
    //   85: invokevirtual 165	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:b	(Z)V
    //   88: aload_0
    //   89: monitorexit
    //   90: return
    //   91: iconst_0
    //   92: istore_2
    //   93: goto -35 -> 58
    //   96: astore_1
    //   97: aload_0
    //   98: monitorexit
    //   99: aload_1
    //   100: athrow
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	101	0	this	NativeCrashHandler
    //   0	101	1	paramStrategyBean	StrategyBean
    //   1	92	2	bool	boolean
    // Exception table:
    //   from	to	target	type
    //   8	39	96	finally
    //   39	58	96	finally
    //   58	88	96	finally
  }
  
  /* Error */
  protected void a(boolean paramBoolean)
  {
    // Byte code:
    //   0: aload_0
    //   1: monitorenter
    //   2: aload_0
    //   3: getfield 36	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:j	Z
    //   6: ifeq +16 -> 22
    //   9: ldc -89
    //   11: iconst_0
    //   12: anewarray 4	java/lang/Object
    //   15: invokestatic 128	com/tencent/bugly/a/bf:d	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   18: pop
    //   19: aload_0
    //   20: monitorexit
    //   21: return
    //   22: aload_0
    //   23: aload_0
    //   24: getfield 61	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:g	Ljava/lang/String;
    //   27: iload_1
    //   28: iconst_1
    //   29: invokevirtual 171	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:regist	(Ljava/lang/String;ZI)Ljava/lang/String;
    //   32: astore_2
    //   33: aload_2
    //   34: ifnull +41 -> 75
    //   37: ldc -83
    //   39: iconst_0
    //   40: anewarray 4	java/lang/Object
    //   43: invokestatic 97	com/tencent/bugly/a/bf:a	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   46: pop
    //   47: aload_0
    //   48: getfield 63	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:d	Lcom/tencent/bugly/crashreport/common/info/c;
    //   51: aload_2
    //   52: invokevirtual 175	com/tencent/bugly/crashreport/common/info/c:i	(Ljava/lang/String;)V
    //   55: aload_0
    //   56: iconst_1
    //   57: putfield 36	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:j	Z
    //   60: goto -41 -> 19
    //   63: astore_2
    //   64: aload_2
    //   65: invokestatic 178	com/tencent/bugly/a/bf:a	(Ljava/lang/Throwable;)Z
    //   68: ifne +7 -> 75
    //   71: aload_2
    //   72: invokevirtual 181	java/lang/Throwable:printStackTrace	()V
    //   75: aload_0
    //   76: iconst_0
    //   77: putfield 34	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:i	Z
    //   80: goto -61 -> 19
    //   83: astore_2
    //   84: aload_0
    //   85: monitorexit
    //   86: aload_2
    //   87: athrow
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	88	0	this	NativeCrashHandler
    //   0	88	1	paramBoolean	boolean
    //   32	20	2	str	String
    //   63	9	2	localThrowable	Throwable
    //   83	4	2	localObject	Object
    // Exception table:
    //   from	to	target	type
    //   22	33	63	java/lang/Throwable
    //   37	60	63	java/lang/Throwable
    //   2	19	83	finally
    //   22	33	83	finally
    //   37	60	83	finally
    //   64	75	83	finally
    //   75	80	83	finally
  }
  
  /* Error */
  protected void b()
  {
    // Byte code:
    //   0: aload_0
    //   1: monitorenter
    //   2: aload_0
    //   3: getfield 36	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:j	Z
    //   6: ifne +16 -> 22
    //   9: ldc -73
    //   11: iconst_0
    //   12: anewarray 4	java/lang/Object
    //   15: invokestatic 128	com/tencent/bugly/a/bf:d	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   18: pop
    //   19: aload_0
    //   20: monitorexit
    //   21: return
    //   22: aload_0
    //   23: invokevirtual 186	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:unregist	()Ljava/lang/String;
    //   26: ifnull +33 -> 59
    //   29: ldc -68
    //   31: iconst_0
    //   32: anewarray 4	java/lang/Object
    //   35: invokestatic 97	com/tencent/bugly/a/bf:a	(Ljava/lang/String;[Ljava/lang/Object;)Z
    //   38: pop
    //   39: aload_0
    //   40: iconst_0
    //   41: putfield 36	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:j	Z
    //   44: goto -25 -> 19
    //   47: astore_1
    //   48: aload_1
    //   49: invokestatic 190	com/tencent/bugly/a/bf:b	(Ljava/lang/Throwable;)Z
    //   52: ifne +7 -> 59
    //   55: aload_1
    //   56: invokevirtual 181	java/lang/Throwable:printStackTrace	()V
    //   59: aload_0
    //   60: iconst_0
    //   61: putfield 34	com/tencent/bugly/crashreport/crash/jni/NativeCrashHandler:i	Z
    //   64: goto -45 -> 19
    //   67: astore_1
    //   68: aload_0
    //   69: monitorexit
    //   70: aload_1
    //   71: athrow
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	72	0	this	NativeCrashHandler
    //   47	9	1	localThrowable	Throwable
    //   67	4	1	localObject	Object
    // Exception table:
    //   from	to	target	type
    //   22	44	47	java/lang/Throwable
    //   2	19	67	finally
    //   22	44	67	finally
    //   48	59	67	finally
    //   59	64	67	finally
  }
  
  protected void b(boolean paramBoolean)
  {
    if (paramBoolean) {}
    for (;;)
    {
      try
      {
        a();
        return;
      }
      finally {}
      b();
    }
  }
  
  protected void c()
  {
    long l1 = d.b();
    Object localObject1 = new File(this.g);
    if ((((File)localObject1).exists()) && (((File)localObject1).isDirectory()))
    {
      localObject1 = ((File)localObject1).listFiles();
      if ((localObject1 != null) && (localObject1.length != 0)) {}
    }
    else
    {
      return;
    }
    int i2 = "tomb_".length();
    int i3 = localObject1.length;
    int m = 0;
    Object localObject2;
    String str;
    int i1;
    for (int n = 0;; n = i1)
    {
      if (m >= i3) {
        break label182;
      }
      localObject2 = localObject1[m];
      str = localObject2.getName();
      i1 = n;
      if (str.startsWith("tomb_")) {}
      try
      {
        i1 = str.indexOf(".txt");
        if (i1 <= 0) {
          break;
        }
        long l2 = Long.parseLong(str.substring(i2, i1));
        if (l2 < l1 - 604800000L) {
          break;
        }
        i1 = n;
      }
      catch (Throwable localThrowable)
      {
        for (;;)
        {
          bf.e("tomb format error delete %s", new Object[] { str });
          i1 = n;
          if (localObject2.delete()) {
            i1 = n + 1;
          }
        }
      }
      m += 1;
    }
    label182:
    bf.c("clean tombs %d", new Object[] { Integer.valueOf(n) });
  }
  
  public void c(boolean paramBoolean)
  {
    d(paramBoolean);
    if ((f.a().d().d) && (d())) {}
    for (paramBoolean = true;; paramBoolean = false)
    {
      if (paramBoolean != this.j)
      {
        bf.a("native changed to %b", new Object[] { Boolean.valueOf(paramBoolean) });
        b(paramBoolean);
      }
      return;
    }
  }
  
  public boolean d()
  {
    try
    {
      boolean bool = this.k;
      return bool;
    }
    finally
    {
      localObject = finally;
      throw localObject;
    }
  }
  
  protected native String regist(String paramString, boolean paramBoolean, int paramInt);
  
  protected native String unregist();
}
