package com.splunk.mint;

import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

class DataSaver
  extends BaseExecutor
  implements InterfaceExecutor
{
  private static final String LAST_SAVED_NAME = "/Mint-lastsavedfile";
  private static final int MAX_FILE_SIZE = 140000;
  
  DataSaver() {}
  
  /* Error */
  private String getLastSavedName()
  {
    // Byte code:
    //   0: aload_0
    //   1: monitorenter
    //   2: new 36	java/io/File
    //   5: dup
    //   6: new 38	java/lang/StringBuilder
    //   9: dup
    //   10: invokespecial 39	java/lang/StringBuilder:<init>	()V
    //   13: getstatic 44	com/splunk/mint/Properties:FILES_PATH	Ljava/lang/String;
    //   16: invokevirtual 48	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   19: ldc 12
    //   21: invokevirtual 48	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   24: invokevirtual 51	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   27: invokespecial 53	java/io/File:<init>	(Ljava/lang/String;)V
    //   30: astore_1
    //   31: aload_1
    //   32: invokevirtual 56	java/io/File:getAbsolutePath	()Ljava/lang/String;
    //   35: invokestatic 62	com/splunk/mint/Utils:readFile	(Ljava/lang/String;)Ljava/lang/String;
    //   38: invokevirtual 67	java/lang/String:trim	()Ljava/lang/String;
    //   41: astore_1
    //   42: aload_0
    //   43: monitorexit
    //   44: aload_1
    //   45: areturn
    //   46: astore_1
    //   47: aconst_null
    //   48: astore_1
    //   49: goto -7 -> 42
    //   52: astore_1
    //   53: aload_0
    //   54: monitorexit
    //   55: aload_1
    //   56: athrow
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	57	0	this	DataSaver
    //   30	15	1	localObject1	Object
    //   46	1	1	localException	Exception
    //   48	1	1	localObject2	Object
    //   52	4	1	localObject3	Object
    // Exception table:
    //   from	to	target	type
    //   31	42	46	java/lang/Exception
    //   2	31	52	finally
    //   31	42	52	finally
  }
  
  /* Error */
  private void saveLastSavedName(String paramString)
  {
    // Byte code:
    //   0: aload_0
    //   1: monitorenter
    //   2: new 36	java/io/File
    //   5: dup
    //   6: new 38	java/lang/StringBuilder
    //   9: dup
    //   10: invokespecial 39	java/lang/StringBuilder:<init>	()V
    //   13: getstatic 44	com/splunk/mint/Properties:FILES_PATH	Ljava/lang/String;
    //   16: invokevirtual 48	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   19: ldc 12
    //   21: invokevirtual 48	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   24: invokevirtual 51	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   27: invokespecial 53	java/io/File:<init>	(Ljava/lang/String;)V
    //   30: astore 4
    //   32: aload 4
    //   34: ifnull +25 -> 59
    //   37: aload 4
    //   39: invokevirtual 73	java/io/File:exists	()Z
    //   42: istore_2
    //   43: iload_2
    //   44: ifne +15 -> 59
    //   47: aload 4
    //   49: invokevirtual 76	java/io/File:delete	()Z
    //   52: pop
    //   53: aload 4
    //   55: invokevirtual 79	java/io/File:createNewFile	()Z
    //   58: pop
    //   59: aconst_null
    //   60: astore_3
    //   61: aconst_null
    //   62: astore 5
    //   64: new 81	java/io/BufferedWriter
    //   67: dup
    //   68: new 83	java/io/FileWriter
    //   71: dup
    //   72: aload 4
    //   74: invokespecial 86	java/io/FileWriter:<init>	(Ljava/io/File;)V
    //   77: invokespecial 89	java/io/BufferedWriter:<init>	(Ljava/io/Writer;)V
    //   80: astore 4
    //   82: aload 4
    //   84: aload_1
    //   85: invokevirtual 67	java/lang/String:trim	()Ljava/lang/String;
    //   88: invokevirtual 92	java/io/BufferedWriter:write	(Ljava/lang/String;)V
    //   91: aload 4
    //   93: invokevirtual 95	java/io/BufferedWriter:flush	()V
    //   96: aload 4
    //   98: invokevirtual 98	java/io/BufferedWriter:close	()V
    //   101: aload 4
    //   103: ifnull +114 -> 217
    //   106: aload 4
    //   108: invokevirtual 98	java/io/BufferedWriter:close	()V
    //   111: aload_0
    //   112: monitorexit
    //   113: return
    //   114: astore_3
    //   115: aload_3
    //   116: invokevirtual 101	java/io/IOException:printStackTrace	()V
    //   119: goto -60 -> 59
    //   122: astore_1
    //   123: aload_0
    //   124: monitorexit
    //   125: aload_1
    //   126: athrow
    //   127: astore_1
    //   128: aload_1
    //   129: invokevirtual 101	java/io/IOException:printStackTrace	()V
    //   132: goto -21 -> 111
    //   135: astore 4
    //   137: aload 5
    //   139: astore_1
    //   140: aload_1
    //   141: astore_3
    //   142: ldc 103
    //   144: invokestatic 108	com/splunk/mint/Logger:logWarning	(Ljava/lang/String;)V
    //   147: aload_1
    //   148: astore_3
    //   149: getstatic 114	com/splunk/mint/Mint:DEBUG	Z
    //   152: ifeq +10 -> 162
    //   155: aload_1
    //   156: astore_3
    //   157: aload 4
    //   159: invokevirtual 101	java/io/IOException:printStackTrace	()V
    //   162: aload_1
    //   163: ifnull -52 -> 111
    //   166: aload_1
    //   167: invokevirtual 98	java/io/BufferedWriter:close	()V
    //   170: goto -59 -> 111
    //   173: astore_1
    //   174: aload_1
    //   175: invokevirtual 101	java/io/IOException:printStackTrace	()V
    //   178: goto -67 -> 111
    //   181: astore_1
    //   182: aload_3
    //   183: ifnull +7 -> 190
    //   186: aload_3
    //   187: invokevirtual 98	java/io/BufferedWriter:close	()V
    //   190: aload_1
    //   191: athrow
    //   192: astore_3
    //   193: aload_3
    //   194: invokevirtual 101	java/io/IOException:printStackTrace	()V
    //   197: goto -7 -> 190
    //   200: astore_1
    //   201: aload 4
    //   203: astore_3
    //   204: goto -22 -> 182
    //   207: astore_3
    //   208: aload 4
    //   210: astore_1
    //   211: aload_3
    //   212: astore 4
    //   214: goto -74 -> 140
    //   217: goto -106 -> 111
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	220	0	this	DataSaver
    //   0	220	1	paramString	String
    //   42	2	2	bool	boolean
    //   60	1	3	localObject1	Object
    //   114	2	3	localIOException1	java.io.IOException
    //   141	46	3	str	String
    //   192	2	3	localIOException2	java.io.IOException
    //   203	1	3	localIOException3	java.io.IOException
    //   207	5	3	localIOException4	java.io.IOException
    //   30	77	4	localObject2	Object
    //   135	74	4	localIOException5	java.io.IOException
    //   212	1	4	localObject3	Object
    //   62	76	5	localObject4	Object
    // Exception table:
    //   from	to	target	type
    //   47	59	114	java/io/IOException
    //   2	32	122	finally
    //   37	43	122	finally
    //   47	59	122	finally
    //   106	111	122	finally
    //   115	119	122	finally
    //   128	132	122	finally
    //   166	170	122	finally
    //   174	178	122	finally
    //   186	190	122	finally
    //   190	192	122	finally
    //   193	197	122	finally
    //   106	111	127	java/io/IOException
    //   64	82	135	java/io/IOException
    //   166	170	173	java/io/IOException
    //   64	82	181	finally
    //   142	147	181	finally
    //   149	155	181	finally
    //   157	162	181	finally
    //   186	190	192	java/io/IOException
    //   82	101	200	finally
    //   82	101	207	java/io/IOException
  }
  
  public ExecutorService getExecutor()
  {
    if (executor == null) {
      executor = Executors.newFixedThreadPool(1);
    }
    return executor;
  }
  
  public void save(final String paramString)
  {
    try
    {
      paramString = new LowPriorityThreadFactory().newThread(new Runnable()
      {
        /* Error */
        public void run()
        {
          // Byte code:
          //   0: aload_0
          //   1: getfield 19	com/splunk/mint/DataSaver$1:this$0	Lcom/splunk/mint/DataSaver;
          //   4: invokestatic 32	com/splunk/mint/DataSaver:access$000	(Lcom/splunk/mint/DataSaver;)Ljava/lang/String;
          //   7: astore_2
          //   8: aload_2
          //   9: ifnull +10 -> 19
          //   12: aload_2
          //   13: invokevirtual 38	java/lang/String:length	()I
          //   16: ifne +179 -> 195
          //   19: new 40	java/io/File
          //   22: dup
          //   23: invokestatic 46	com/splunk/mint/SplunkFileFilter:createNewFile	()Ljava/lang/String;
          //   26: invokespecial 48	java/io/File:<init>	(Ljava/lang/String;)V
          //   29: astore_2
          //   30: iconst_0
          //   31: istore_1
          //   32: aload_2
          //   33: astore_3
          //   34: aload_2
          //   35: invokevirtual 51	java/io/File:length	()J
          //   38: ldc2_w 52
          //   41: lcmp
          //   42: iflt +16 -> 58
          //   45: new 40	java/io/File
          //   48: dup
          //   49: invokestatic 46	com/splunk/mint/SplunkFileFilter:createNewFile	()Ljava/lang/String;
          //   52: invokespecial 48	java/io/File:<init>	(Ljava/lang/String;)V
          //   55: astore_3
          //   56: iconst_1
          //   57: istore_1
          //   58: new 55	com/splunk/mint/DataSaverResponse
          //   61: dup
          //   62: aload_0
          //   63: getfield 21	com/splunk/mint/DataSaver$1:val$jsonData	Ljava/lang/String;
          //   66: aload_3
          //   67: invokevirtual 58	java/io/File:getAbsolutePath	()Ljava/lang/String;
          //   70: invokespecial 61	com/splunk/mint/DataSaverResponse:<init>	(Ljava/lang/String;Ljava/lang/String;)V
          //   73: astore 6
          //   75: aload_3
          //   76: ifnull +15 -> 91
          //   79: aload_3
          //   80: invokevirtual 65	java/io/File:exists	()Z
          //   83: ifne +8 -> 91
          //   86: aload_3
          //   87: invokevirtual 67	java/io/File:createNewFile	()Z
          //   90: pop
          //   91: aconst_null
          //   92: astore_2
          //   93: aconst_null
          //   94: astore 5
          //   96: new 69	java/io/BufferedWriter
          //   99: dup
          //   100: new 71	java/io/FileWriter
          //   103: dup
          //   104: aload_3
          //   105: iconst_1
          //   106: invokespecial 74	java/io/FileWriter:<init>	(Ljava/io/File;Z)V
          //   109: invokespecial 77	java/io/BufferedWriter:<init>	(Ljava/io/Writer;)V
          //   112: astore 4
          //   114: aload 4
          //   116: aload_0
          //   117: getfield 21	com/splunk/mint/DataSaver$1:val$jsonData	Ljava/lang/String;
          //   120: invokevirtual 81	java/io/BufferedWriter:append	(Ljava/lang/CharSequence;)Ljava/io/Writer;
          //   123: pop
          //   124: aload 4
          //   126: invokevirtual 84	java/io/BufferedWriter:flush	()V
          //   129: aload 4
          //   131: invokevirtual 87	java/io/BufferedWriter:close	()V
          //   134: aload_0
          //   135: getfield 19	com/splunk/mint/DataSaver$1:this$0	Lcom/splunk/mint/DataSaver;
          //   138: aload_3
          //   139: invokevirtual 90	java/io/File:getName	()Ljava/lang/String;
          //   142: invokestatic 93	com/splunk/mint/DataSaver:access$100	(Lcom/splunk/mint/DataSaver;Ljava/lang/String;)V
          //   145: aload 4
          //   147: ifnull +8 -> 155
          //   150: aload 4
          //   152: invokevirtual 87	java/io/BufferedWriter:close	()V
          //   155: aload 6
          //   157: iconst_1
          //   158: invokestatic 99	java/lang/Boolean:valueOf	(Z)Ljava/lang/Boolean;
          //   161: invokevirtual 103	com/splunk/mint/DataSaverResponse:setSavedSuccessfully	(Ljava/lang/Boolean;)V
          //   164: getstatic 109	com/splunk/mint/Mint:mintCallback	Lcom/splunk/mint/MintCallback;
          //   167: ifnull +13 -> 180
          //   170: getstatic 109	com/splunk/mint/Mint:mintCallback	Lcom/splunk/mint/MintCallback;
          //   173: aload 6
          //   175: invokeinterface 115 2 0
          //   180: iload_1
          //   181: ifeq +249 -> 430
          //   184: new 117	com/splunk/mint/DataFlusher
          //   187: dup
          //   188: invokespecial 118	com/splunk/mint/DataFlusher:<init>	()V
          //   191: invokevirtual 121	com/splunk/mint/DataFlusher:send	()V
          //   194: return
          //   195: new 40	java/io/File
          //   198: dup
          //   199: new 123	java/lang/StringBuilder
          //   202: dup
          //   203: invokespecial 124	java/lang/StringBuilder:<init>	()V
          //   206: getstatic 129	com/splunk/mint/Properties:FILES_PATH	Ljava/lang/String;
          //   209: invokevirtual 132	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
          //   212: ldc -122
          //   214: invokevirtual 132	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
          //   217: aload_2
          //   218: invokevirtual 132	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
          //   221: invokevirtual 137	java/lang/StringBuilder:toString	()Ljava/lang/String;
          //   224: invokespecial 48	java/io/File:<init>	(Ljava/lang/String;)V
          //   227: astore_2
          //   228: goto -198 -> 30
          //   231: astore_2
          //   232: aload_2
          //   233: invokevirtual 140	java/io/IOException:printStackTrace	()V
          //   236: goto -145 -> 91
          //   239: astore_2
          //   240: aload_2
          //   241: invokevirtual 140	java/io/IOException:printStackTrace	()V
          //   244: goto -89 -> 155
          //   247: astore 4
          //   249: aload 5
          //   251: astore_3
          //   252: aload_3
          //   253: astore_2
          //   254: aload 4
          //   256: invokevirtual 140	java/io/IOException:printStackTrace	()V
          //   259: aload_3
          //   260: astore_2
          //   261: aload 6
          //   263: aload 4
          //   265: invokevirtual 144	com/splunk/mint/DataSaverResponse:setException	(Ljava/lang/Exception;)V
          //   268: aload_3
          //   269: astore_2
          //   270: aload 6
          //   272: iconst_0
          //   273: invokestatic 99	java/lang/Boolean:valueOf	(Z)Ljava/lang/Boolean;
          //   276: invokevirtual 103	com/splunk/mint/DataSaverResponse:setSavedSuccessfully	(Ljava/lang/Boolean;)V
          //   279: aload_3
          //   280: astore_2
          //   281: getstatic 109	com/splunk/mint/Mint:mintCallback	Lcom/splunk/mint/MintCallback;
          //   284: ifnull +15 -> 299
          //   287: aload_3
          //   288: astore_2
          //   289: getstatic 109	com/splunk/mint/Mint:mintCallback	Lcom/splunk/mint/MintCallback;
          //   292: aload 6
          //   294: invokeinterface 115 2 0
          //   299: aload_3
          //   300: ifnull +7 -> 307
          //   303: aload_3
          //   304: invokevirtual 87	java/io/BufferedWriter:close	()V
          //   307: aload 6
          //   309: iconst_1
          //   310: invokestatic 99	java/lang/Boolean:valueOf	(Z)Ljava/lang/Boolean;
          //   313: invokevirtual 103	com/splunk/mint/DataSaverResponse:setSavedSuccessfully	(Ljava/lang/Boolean;)V
          //   316: getstatic 109	com/splunk/mint/Mint:mintCallback	Lcom/splunk/mint/MintCallback;
          //   319: ifnull +13 -> 332
          //   322: getstatic 109	com/splunk/mint/Mint:mintCallback	Lcom/splunk/mint/MintCallback;
          //   325: aload 6
          //   327: invokeinterface 115 2 0
          //   332: iload_1
          //   333: ifeq -139 -> 194
          //   336: new 117	com/splunk/mint/DataFlusher
          //   339: dup
          //   340: invokespecial 118	com/splunk/mint/DataFlusher:<init>	()V
          //   343: invokevirtual 121	com/splunk/mint/DataFlusher:send	()V
          //   346: return
          //   347: astore_2
          //   348: aload_2
          //   349: invokevirtual 140	java/io/IOException:printStackTrace	()V
          //   352: goto -45 -> 307
          //   355: astore_3
          //   356: aload_2
          //   357: ifnull +7 -> 364
          //   360: aload_2
          //   361: invokevirtual 87	java/io/BufferedWriter:close	()V
          //   364: aload 6
          //   366: iconst_1
          //   367: invokestatic 99	java/lang/Boolean:valueOf	(Z)Ljava/lang/Boolean;
          //   370: invokevirtual 103	com/splunk/mint/DataSaverResponse:setSavedSuccessfully	(Ljava/lang/Boolean;)V
          //   373: getstatic 109	com/splunk/mint/Mint:mintCallback	Lcom/splunk/mint/MintCallback;
          //   376: ifnull +13 -> 389
          //   379: getstatic 109	com/splunk/mint/Mint:mintCallback	Lcom/splunk/mint/MintCallback;
          //   382: aload 6
          //   384: invokeinterface 115 2 0
          //   389: iload_1
          //   390: ifeq +13 -> 403
          //   393: new 117	com/splunk/mint/DataFlusher
          //   396: dup
          //   397: invokespecial 118	com/splunk/mint/DataFlusher:<init>	()V
          //   400: invokevirtual 121	com/splunk/mint/DataFlusher:send	()V
          //   403: aload_3
          //   404: athrow
          //   405: astore_2
          //   406: aload_2
          //   407: invokevirtual 140	java/io/IOException:printStackTrace	()V
          //   410: goto -46 -> 364
          //   413: astore_3
          //   414: aload 4
          //   416: astore_2
          //   417: goto -61 -> 356
          //   420: astore_2
          //   421: aload 4
          //   423: astore_3
          //   424: aload_2
          //   425: astore 4
          //   427: goto -175 -> 252
          //   430: return
          // Local variable table:
          //   start	length	slot	name	signature
          //   0	431	0	this	1
          //   31	359	1	i	int
          //   7	221	2	localObject1	Object
          //   231	2	2	localIOException1	java.io.IOException
          //   239	2	2	localIOException2	java.io.IOException
          //   253	36	2	localObject2	Object
          //   347	14	2	localIOException3	java.io.IOException
          //   405	2	2	localIOException4	java.io.IOException
          //   416	1	2	localObject3	Object
          //   420	5	2	localIOException5	java.io.IOException
          //   33	271	3	localObject4	Object
          //   355	49	3	localObject5	Object
          //   413	1	3	localObject6	Object
          //   423	1	3	localObject7	Object
          //   112	39	4	localBufferedWriter	java.io.BufferedWriter
          //   247	175	4	localIOException6	java.io.IOException
          //   425	1	4	localIOException7	java.io.IOException
          //   94	156	5	localObject8	Object
          //   73	310	6	localDataSaverResponse	DataSaverResponse
          // Exception table:
          //   from	to	target	type
          //   86	91	231	java/io/IOException
          //   150	155	239	java/io/IOException
          //   96	114	247	java/io/IOException
          //   303	307	347	java/io/IOException
          //   96	114	355	finally
          //   254	259	355	finally
          //   261	268	355	finally
          //   270	279	355	finally
          //   281	287	355	finally
          //   289	299	355	finally
          //   360	364	405	java/io/IOException
          //   114	145	413	finally
          //   114	145	420	java/io/IOException
        }
      });
      if (getExecutor() != null) {
        getExecutor().execute(paramString);
      }
      return;
    }
    finally
    {
      paramString = finally;
      throw paramString;
    }
  }
}
