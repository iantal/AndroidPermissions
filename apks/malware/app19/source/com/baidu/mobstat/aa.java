package com.baidu.mobstat;

import android.content.Context;
import android.net.wifi.WifiManager;
import android.os.Handler;
import android.os.HandlerThread;
import java.lang.ref.WeakReference;
import java.util.Date;
import java.util.Timer;

class aa
{
  private static HandlerThread a = new HandlerThread("LogSenderThread");
  private static Handler i;
  private static aa j = new aa();
  private boolean b = false;
  private SendStrategyEnum c = SendStrategyEnum.APP_START;
  private int d = 1;
  private Timer e;
  private int f = 0;
  private boolean g = false;
  private WeakReference h;
  
  private aa()
  {
    a.start();
    i = new Handler(a.getLooper());
  }
  
  public static aa a()
  {
    return j;
  }
  
  private void e(Context paramContext)
  {
    if (paramContext == null) {
      au.a().a("sdkstat", "initContext context=" + null);
    }
    if ((this.h == null) && (paramContext != null)) {
      this.h = new WeakReference(paramContext);
    }
  }
  
  public void a(int paramInt)
  {
    if ((paramInt >= 0) && (paramInt <= 30)) {
      this.f = paramInt;
    }
  }
  
  /* Error */
  public void a(Context paramContext)
  {
    // Byte code:
    //   0: aload_0
    //   1: aload_1
    //   2: invokespecial 122	com/baidu/mobstat/aa:e	(Landroid/content/Context;)V
    //   5: getstatic 47	com/baidu/mobstat/SendStrategyEnum:APP_START	Lcom/baidu/mobstat/SendStrategyEnum;
    //   8: astore 5
    //   10: aload_1
    //   11: ldc 124
    //   13: invokestatic 129	com/baidu/mobstat/ao:a	(Landroid/content/Context;Ljava/lang/String;)Ljava/lang/String;
    //   16: astore_3
    //   17: aload_3
    //   18: ldc -125
    //   20: invokevirtual 137	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   23: ifne +27 -> 50
    //   26: aload_3
    //   27: ldc -117
    //   29: invokevirtual 137	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   32: ifeq +173 -> 205
    //   35: invokestatic 144	com/baidu/mobstat/y:a	()Lcom/baidu/mobstat/y;
    //   38: aload_1
    //   39: invokevirtual 146	com/baidu/mobstat/y:a	(Landroid/content/Context;)V
    //   42: invokestatic 152	com/baidu/mobstat/BasicStoreTools:getInstance	()Lcom/baidu/mobstat/BasicStoreTools;
    //   45: aload_1
    //   46: iconst_1
    //   47: invokevirtual 156	com/baidu/mobstat/BasicStoreTools:setExceptionTurn	(Landroid/content/Context;Z)V
    //   50: aload 5
    //   52: astore_3
    //   53: aload_1
    //   54: ldc -98
    //   56: invokestatic 129	com/baidu/mobstat/ao:a	(Landroid/content/Context;Ljava/lang/String;)Ljava/lang/String;
    //   59: astore 6
    //   61: aload 5
    //   63: astore 4
    //   65: aload 5
    //   67: astore_3
    //   68: aload 6
    //   70: ldc -125
    //   72: invokevirtual 137	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   75: ifne +43 -> 118
    //   78: aload 5
    //   80: astore_3
    //   81: aload 6
    //   83: getstatic 47	com/baidu/mobstat/SendStrategyEnum:APP_START	Lcom/baidu/mobstat/SendStrategyEnum;
    //   86: invokevirtual 161	com/baidu/mobstat/SendStrategyEnum:name	()Ljava/lang/String;
    //   89: invokevirtual 137	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   92: ifeq +152 -> 244
    //   95: aload 5
    //   97: astore_3
    //   98: getstatic 47	com/baidu/mobstat/SendStrategyEnum:APP_START	Lcom/baidu/mobstat/SendStrategyEnum;
    //   101: astore 4
    //   103: aload 4
    //   105: astore_3
    //   106: invokestatic 152	com/baidu/mobstat/BasicStoreTools:getInstance	()Lcom/baidu/mobstat/BasicStoreTools;
    //   109: aload_1
    //   110: aload 4
    //   112: invokevirtual 165	com/baidu/mobstat/SendStrategyEnum:ordinal	()I
    //   115: invokevirtual 169	com/baidu/mobstat/BasicStoreTools:setSendStrategy	(Landroid/content/Context;I)V
    //   118: aload_1
    //   119: ldc -85
    //   121: invokestatic 129	com/baidu/mobstat/ao:a	(Landroid/content/Context;Ljava/lang/String;)Ljava/lang/String;
    //   124: astore_3
    //   125: aload_3
    //   126: ldc -125
    //   128: invokevirtual 137	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   131: ifne +40 -> 171
    //   134: aload_3
    //   135: invokestatic 177	java/lang/Integer:parseInt	(Ljava/lang/String;)I
    //   138: istore_2
    //   139: aload 4
    //   141: invokevirtual 165	com/baidu/mobstat/SendStrategyEnum:ordinal	()I
    //   144: getstatic 180	com/baidu/mobstat/SendStrategyEnum:SET_TIME_INTERVAL	Lcom/baidu/mobstat/SendStrategyEnum;
    //   147: invokevirtual 165	com/baidu/mobstat/SendStrategyEnum:ordinal	()I
    //   150: if_icmpne +21 -> 171
    //   153: iload_2
    //   154: ifle +17 -> 171
    //   157: iload_2
    //   158: bipush 24
    //   160: if_icmpgt +11 -> 171
    //   163: invokestatic 152	com/baidu/mobstat/BasicStoreTools:getInstance	()Lcom/baidu/mobstat/BasicStoreTools;
    //   166: aload_1
    //   167: iload_2
    //   168: invokevirtual 183	com/baidu/mobstat/BasicStoreTools:setSendStrategyTime	(Landroid/content/Context;I)V
    //   171: aload_1
    //   172: ldc -71
    //   174: invokestatic 129	com/baidu/mobstat/ao:a	(Landroid/content/Context;Ljava/lang/String;)Ljava/lang/String;
    //   177: astore_3
    //   178: aload_3
    //   179: ldc -125
    //   181: invokevirtual 137	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   184: ifne +20 -> 204
    //   187: aload_3
    //   188: ldc -117
    //   190: invokevirtual 137	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   193: ifeq +196 -> 389
    //   196: invokestatic 152	com/baidu/mobstat/BasicStoreTools:getInstance	()Lcom/baidu/mobstat/BasicStoreTools;
    //   199: aload_1
    //   200: iconst_1
    //   201: invokevirtual 188	com/baidu/mobstat/BasicStoreTools:setOnlyWifi	(Landroid/content/Context;Z)V
    //   204: return
    //   205: aload_3
    //   206: ldc -66
    //   208: invokevirtual 137	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   211: ifeq -161 -> 50
    //   214: invokestatic 152	com/baidu/mobstat/BasicStoreTools:getInstance	()Lcom/baidu/mobstat/BasicStoreTools;
    //   217: aload_1
    //   218: iconst_0
    //   219: invokevirtual 156	com/baidu/mobstat/BasicStoreTools:setExceptionTurn	(Landroid/content/Context;Z)V
    //   222: goto -172 -> 50
    //   225: astore_3
    //   226: invokestatic 87	com/baidu/mobstat/au:a	()Lcom/baidu/mobstat/at;
    //   229: iconst_1
    //   230: anewarray 4	java/lang/Object
    //   233: dup
    //   234: iconst_0
    //   235: aload_3
    //   236: aastore
    //   237: invokevirtual 193	com/baidu/mobstat/at:a	([Ljava/lang/Object;)I
    //   240: pop
    //   241: goto -191 -> 50
    //   244: aload 5
    //   246: astore_3
    //   247: aload 6
    //   249: getstatic 196	com/baidu/mobstat/SendStrategyEnum:ONCE_A_DAY	Lcom/baidu/mobstat/SendStrategyEnum;
    //   252: invokevirtual 161	com/baidu/mobstat/SendStrategyEnum:name	()Ljava/lang/String;
    //   255: invokevirtual 137	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   258: ifeq +65 -> 323
    //   261: aload 5
    //   263: astore_3
    //   264: getstatic 196	com/baidu/mobstat/SendStrategyEnum:ONCE_A_DAY	Lcom/baidu/mobstat/SendStrategyEnum;
    //   267: astore 4
    //   269: aload 4
    //   271: astore_3
    //   272: invokestatic 152	com/baidu/mobstat/BasicStoreTools:getInstance	()Lcom/baidu/mobstat/BasicStoreTools;
    //   275: aload_1
    //   276: aload 4
    //   278: invokevirtual 165	com/baidu/mobstat/SendStrategyEnum:ordinal	()I
    //   281: invokevirtual 169	com/baidu/mobstat/BasicStoreTools:setSendStrategy	(Landroid/content/Context;I)V
    //   284: aload 4
    //   286: astore_3
    //   287: invokestatic 152	com/baidu/mobstat/BasicStoreTools:getInstance	()Lcom/baidu/mobstat/BasicStoreTools;
    //   290: aload_1
    //   291: bipush 24
    //   293: invokevirtual 183	com/baidu/mobstat/BasicStoreTools:setSendStrategyTime	(Landroid/content/Context;I)V
    //   296: goto -178 -> 118
    //   299: astore 4
    //   301: invokestatic 87	com/baidu/mobstat/au:a	()Lcom/baidu/mobstat/at;
    //   304: iconst_1
    //   305: anewarray 4	java/lang/Object
    //   308: dup
    //   309: iconst_0
    //   310: aload 4
    //   312: aastore
    //   313: invokevirtual 193	com/baidu/mobstat/at:a	([Ljava/lang/Object;)I
    //   316: pop
    //   317: aload_3
    //   318: astore 4
    //   320: goto -202 -> 118
    //   323: aload 5
    //   325: astore 4
    //   327: aload 5
    //   329: astore_3
    //   330: aload 6
    //   332: getstatic 180	com/baidu/mobstat/SendStrategyEnum:SET_TIME_INTERVAL	Lcom/baidu/mobstat/SendStrategyEnum;
    //   335: invokevirtual 161	com/baidu/mobstat/SendStrategyEnum:name	()Ljava/lang/String;
    //   338: invokevirtual 137	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   341: ifeq -223 -> 118
    //   344: aload 5
    //   346: astore_3
    //   347: getstatic 180	com/baidu/mobstat/SendStrategyEnum:SET_TIME_INTERVAL	Lcom/baidu/mobstat/SendStrategyEnum;
    //   350: astore 4
    //   352: aload 4
    //   354: astore_3
    //   355: invokestatic 152	com/baidu/mobstat/BasicStoreTools:getInstance	()Lcom/baidu/mobstat/BasicStoreTools;
    //   358: aload_1
    //   359: aload 4
    //   361: invokevirtual 165	com/baidu/mobstat/SendStrategyEnum:ordinal	()I
    //   364: invokevirtual 169	com/baidu/mobstat/BasicStoreTools:setSendStrategy	(Landroid/content/Context;I)V
    //   367: goto -249 -> 118
    //   370: astore_3
    //   371: invokestatic 87	com/baidu/mobstat/au:a	()Lcom/baidu/mobstat/at;
    //   374: iconst_1
    //   375: anewarray 4	java/lang/Object
    //   378: dup
    //   379: iconst_0
    //   380: aload_3
    //   381: aastore
    //   382: invokevirtual 193	com/baidu/mobstat/at:a	([Ljava/lang/Object;)I
    //   385: pop
    //   386: goto -215 -> 171
    //   389: aload_3
    //   390: ldc -66
    //   392: invokevirtual 137	java/lang/String:equals	(Ljava/lang/Object;)Z
    //   395: ifeq -191 -> 204
    //   398: invokestatic 152	com/baidu/mobstat/BasicStoreTools:getInstance	()Lcom/baidu/mobstat/BasicStoreTools;
    //   401: aload_1
    //   402: iconst_0
    //   403: invokevirtual 188	com/baidu/mobstat/BasicStoreTools:setOnlyWifi	(Landroid/content/Context;Z)V
    //   406: return
    //   407: astore_1
    //   408: invokestatic 87	com/baidu/mobstat/au:a	()Lcom/baidu/mobstat/at;
    //   411: iconst_1
    //   412: anewarray 4	java/lang/Object
    //   415: dup
    //   416: iconst_0
    //   417: aload_1
    //   418: aastore
    //   419: invokevirtual 193	com/baidu/mobstat/at:a	([Ljava/lang/Object;)I
    //   422: pop
    //   423: return
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	424	0	this	aa
    //   0	424	1	paramContext	Context
    //   138	30	2	k	int
    //   16	190	3	localObject1	Object
    //   225	11	3	localException1	Exception
    //   246	109	3	localObject2	Object
    //   370	20	3	localException2	Exception
    //   63	222	4	localSendStrategyEnum1	SendStrategyEnum
    //   299	12	4	localException3	Exception
    //   318	42	4	localObject3	Object
    //   8	337	5	localSendStrategyEnum2	SendStrategyEnum
    //   59	272	6	str	String
    // Exception table:
    //   from	to	target	type
    //   10	50	225	java/lang/Exception
    //   205	222	225	java/lang/Exception
    //   53	61	299	java/lang/Exception
    //   68	78	299	java/lang/Exception
    //   81	95	299	java/lang/Exception
    //   98	103	299	java/lang/Exception
    //   106	118	299	java/lang/Exception
    //   247	261	299	java/lang/Exception
    //   264	269	299	java/lang/Exception
    //   272	284	299	java/lang/Exception
    //   287	296	299	java/lang/Exception
    //   330	344	299	java/lang/Exception
    //   347	352	299	java/lang/Exception
    //   355	367	299	java/lang/Exception
    //   118	153	370	java/lang/Exception
    //   163	171	370	java/lang/Exception
    //   171	204	407	java/lang/Exception
    //   389	406	407	java/lang/Exception
  }
  
  public void a(Context paramContext, SendStrategyEnum paramSendStrategyEnum, int paramInt, boolean paramBoolean)
  {
    if (paramSendStrategyEnum.equals(SendStrategyEnum.SET_TIME_INTERVAL)) {
      if ((paramInt > 0) && (paramInt <= 24))
      {
        this.d = paramInt;
        this.c = SendStrategyEnum.SET_TIME_INTERVAL;
        BasicStoreTools.getInstance().setSendStrategy(paramContext, this.c.ordinal());
        BasicStoreTools.getInstance().setSendStrategyTime(paramContext, this.d);
      }
    }
    for (;;)
    {
      this.b = paramBoolean;
      BasicStoreTools.getInstance().setOnlyWifi(paramContext, this.b);
      au.a().a("sdkstat", "sstype is:" + this.c.name() + " And time_interval is:" + this.d + " And m_only_wifi:" + this.b);
      return;
      au.a().c(new Object[] { "setSendLogStrategy", "time_interval is invalid, new strategy does not work" });
      continue;
      this.c = paramSendStrategyEnum;
      BasicStoreTools.getInstance().setSendStrategy(paramContext, this.c.ordinal());
      if (paramSendStrategyEnum.equals(SendStrategyEnum.ONCE_A_DAY)) {
        BasicStoreTools.getInstance().setSendStrategyTime(paramContext, 24);
      }
    }
  }
  
  protected void a(Context paramContext, boolean paramBoolean)
  {
    if (paramBoolean) {
      try
      {
        if (!((WifiManager)paramContext.getSystemService("wifi")).isWifiEnabled())
        {
          au.a().a("statsdk", "sendLogData() does not send because of only_wifi setting");
          return;
        }
      }
      catch (Exception paramContext)
      {
        au.a().a("statsdk", "sendLogData exception when get wifimanager");
        return;
      }
    }
    DataCore.getInstance().sendLogData(paramContext);
  }
  
  public void a(boolean paramBoolean, Context paramContext)
  {
    e(paramContext);
    this.g = paramBoolean;
    au.a().a("sdkstat", "APP_ANALYSIS_EXCEPTION is:" + this.g);
    BasicStoreTools.getInstance().setExceptionTurn(paramContext, this.g);
  }
  
  public void b(Context paramContext)
  {
    e(paramContext);
    Context localContext = paramContext;
    if (paramContext == null)
    {
      localContext = paramContext;
      if (this.h.get() != null) {
        localContext = (Context)this.h.get();
      }
    }
    i.post(new ab(this, localContext));
  }
  
  public void c(Context paramContext)
  {
    BasicStoreTools.getInstance().setLastSendTime(paramContext, new Date().getTime());
  }
  
  public void d(Context paramContext)
  {
    this.e = new Timer();
    this.e.schedule(new ad(this, paramContext), this.d * 3600000, this.d * 3600000);
  }
}
