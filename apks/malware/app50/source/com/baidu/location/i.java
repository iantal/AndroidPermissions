package com.baidu.location;

import android.os.Bundle;
import android.os.DeadObjectException;
import android.os.Message;
import android.os.Messenger;
import android.util.Log;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.Locale;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

class i
  implements au, l
{
  private static i bs = null;
  private boolean bq = false;
  private ArrayList br = null;
  private boolean bt = false;
  
  private i() {}
  
  private void e()
  {
    i();
    j();
  }
  
  private void i()
  {
    Iterator localIterator = this.br.iterator();
    boolean bool1 = false;
    boolean bool2 = false;
    if (localIterator.hasNext())
    {
      a localA = (a)localIterator.next();
      if (localA.jdField_do.jdField_for) {
        bool2 = true;
      }
      if (!localA.jdField_do.jdField_else) {
        break label89;
      }
      bool1 = true;
    }
    label89:
    for (;;)
    {
      break;
      c.a1 = bool1;
      if (this.bt != bool2)
      {
        this.bt = bool2;
        v.aR().jdMethod_int(this.bt);
      }
      return;
    }
  }
  
  private a jdMethod_if(Messenger paramMessenger)
  {
    if (this.br == null) {
      return null;
    }
    Iterator localIterator = this.br.iterator();
    while (localIterator.hasNext())
    {
      a localA = (a)localIterator.next();
      if (localA.jdField_for.equals(paramMessenger)) {
        return localA;
      }
    }
    return null;
  }
  
  private void jdMethod_if(a paramA)
  {
    if (paramA == null) {
      return;
    }
    if (jdMethod_if(paramA.jdField_for) != null)
    {
      a.a(paramA, 14);
      return;
    }
    this.br.add(paramA);
    a.a(paramA, 13);
  }
  
  public static i m()
  {
    if (bs == null) {
      bs = new i();
    }
    return bs;
  }
  
  public void d()
  {
    Iterator localIterator = this.br.iterator();
    while (localIterator.hasNext()) {
      ((a)localIterator.next()).a();
    }
  }
  
  public void jdMethod_do(Message paramMessage)
  {
    paramMessage = jdMethod_if(paramMessage.replyTo);
    if (paramMessage != null) {
      this.br.remove(paramMessage);
    }
    aw.b6().b8();
    ac.bc().bb();
    e.jdMethod_for().jdMethod_do();
    e();
  }
  
  public void jdMethod_do(BDLocation paramBDLocation)
  {
    Object localObject = new ArrayList();
    Iterator localIterator = this.br.iterator();
    while (localIterator.hasNext())
    {
      a localA = (a)localIterator.next();
      localA.a(paramBDLocation);
      if (localA.jdField_if > 4) {
        ((ArrayList)localObject).add(localA);
      }
    }
    if ((localObject != null) && (((ArrayList)localObject).size() > 0))
    {
      paramBDLocation = ((ArrayList)localObject).iterator();
      while (paramBDLocation.hasNext())
      {
        localObject = (a)paramBDLocation.next();
        this.br.remove(localObject);
      }
    }
  }
  
  public int jdMethod_for(Message paramMessage)
  {
    if ((paramMessage == null) || (paramMessage.replyTo == null)) {}
    do
    {
      return 1;
      paramMessage = jdMethod_if(paramMessage.replyTo);
    } while ((paramMessage == null) || (paramMessage.jdField_do == null));
    return paramMessage.jdField_do.f;
  }
  
  public boolean h()
  {
    return this.bt;
  }
  
  public String jdMethod_if(Message paramMessage)
  {
    Object localObject2 = null;
    Object localObject1 = localObject2;
    if (paramMessage != null)
    {
      if (paramMessage.replyTo != null) {
        break label19;
      }
      localObject1 = localObject2;
    }
    label19:
    a localA;
    do
    {
      do
      {
        return localObject1;
        localA = jdMethod_if(paramMessage.replyTo);
        localObject1 = localObject2;
      } while (localA == null);
      localA.jdField_do.jdField_goto = paramMessage.getData().getInt("num", localA.jdField_do.jdField_goto);
      localA.jdField_do.jdField_void = paramMessage.getData().getFloat("distance", localA.jdField_do.jdField_void);
      localA.jdField_do.c = paramMessage.getData().getBoolean("extraInfo", localA.jdField_do.c);
      localA.jdField_do.jdField_new = true;
      paramMessage = String.format(Locale.CHINA, "&poi=%.1f|%d", new Object[] { Float.valueOf(localA.jdField_do.jdField_void), Integer.valueOf(localA.jdField_do.jdField_goto) });
      localObject1 = paramMessage;
    } while (!localA.jdField_do.c);
    return paramMessage + "|1";
  }
  
  public void jdMethod_if(BDLocation paramBDLocation, int paramInt)
  {
    Object localObject = new ArrayList();
    Iterator localIterator = this.br.iterator();
    while (localIterator.hasNext())
    {
      a localA = (a)localIterator.next();
      localA.a(paramBDLocation, paramInt);
      if (localA.jdField_if > 4) {
        ((ArrayList)localObject).add(localA);
      }
    }
    if ((localObject != null) && (((ArrayList)localObject).size() > 0))
    {
      paramBDLocation = ((ArrayList)localObject).iterator();
      while (paramBDLocation.hasNext())
      {
        localObject = (a)paramBDLocation.next();
        this.br.remove(localObject);
      }
    }
  }
  
  public void jdMethod_if(BDLocation paramBDLocation, Message paramMessage)
  {
    if ((paramBDLocation == null) || (paramMessage == null)) {}
    do
    {
      do
      {
        return;
        paramMessage = jdMethod_if(paramMessage.replyTo);
      } while (paramMessage == null);
      paramMessage.a(paramBDLocation);
    } while (paramMessage.jdField_if <= 4);
    this.br.remove(paramMessage);
  }
  
  public boolean jdMethod_int(Message paramMessage)
  {
    boolean bool2 = false;
    a localA = jdMethod_if(paramMessage.replyTo);
    if (localA == null) {
      return false;
    }
    int i = localA.jdField_do.jdField_int;
    localA.jdField_do.jdField_int = paramMessage.getData().getInt("scanSpan", localA.jdField_do.jdField_int);
    boolean bool1;
    String str;
    LocationClientOption localLocationClientOption;
    if (localA.jdField_do.jdField_int < 1000)
    {
      e.jdMethod_for().a();
      aw.b6().b8();
      ac.bc().bb();
      v.aR().aN();
      bool1 = bool2;
      if (localA.jdField_do.jdField_int > 999)
      {
        bool1 = bool2;
        if (i < 1000)
        {
          bool1 = true;
          if (localA.jdField_do.e)
          {
            ac.bc().jdMethod_try(localA.jdField_do.e);
            ac.bc().bd();
          }
          aw.b6().b5();
        }
      }
      localA.jdField_do.jdField_for = paramMessage.getData().getBoolean("openGPS", localA.jdField_do.jdField_for);
      str = paramMessage.getData().getString("coorType");
      localLocationClientOption = localA.jdField_do;
      if ((str == null) || (str.equals(""))) {
        break label395;
      }
      label219:
      localLocationClientOption.jdField_do = str;
      str = paramMessage.getData().getString("addrType");
      localLocationClientOption = localA.jdField_do;
      if ((str == null) || (str.equals(""))) {
        break label408;
      }
    }
    for (;;)
    {
      localLocationClientOption.jdField_char = str;
      if (!c.av.equals(localA.jdField_do.jdField_char)) {
        ad.al().am();
      }
      c.av = localA.jdField_do.jdField_char;
      localA.jdField_do.b = paramMessage.getData().getInt("timeOut", localA.jdField_do.b);
      localA.jdField_do.jdField_else = paramMessage.getData().getBoolean("location_change_notify", localA.jdField_do.jdField_else);
      localA.jdField_do.f = paramMessage.getData().getInt("priority", localA.jdField_do.f);
      e();
      return bool1;
      e.jdMethod_for().jdMethod_if();
      break;
      label395:
      str = localA.jdField_do.jdField_do;
      break label219;
      label408:
      str = localA.jdField_do.jdField_char;
    }
  }
  
  public void j()
  {
    Iterator localIterator = this.br.iterator();
    while (localIterator.hasNext()) {
      ((a)localIterator.next()).jdMethod_if();
    }
  }
  
  public void k()
  {
    this.br.clear();
    e();
  }
  
  public String l()
  {
    Object localObject = new StringBuffer(256);
    if (this.br.isEmpty()) {
      return "&prod=" + aw.iw + ":" + aw.iq;
    }
    a localA = (a)this.br.get(0);
    if (localA.jdField_do.jdField_if != null) {
      ((StringBuffer)localObject).append(localA.jdField_do.jdField_if);
    }
    if (localA.jdField_int != null)
    {
      ((StringBuffer)localObject).append(":");
      ((StringBuffer)localObject).append(localA.jdField_int);
      ((StringBuffer)localObject).append("|");
    }
    localObject = ((StringBuffer)localObject).toString();
    if ((localObject != null) && (!((String)localObject).equals(""))) {
      return "&prod=" + (String)localObject;
    }
    return null;
  }
  
  public void jdMethod_new(Message paramMessage)
  {
    if ((paramMessage == null) || (paramMessage.replyTo == null)) {
      return;
    }
    jdMethod_if(new a(paramMessage));
    e();
  }
  
  public void jdMethod_try(String paramString)
  {
    BDLocation localBDLocation = new BDLocation(paramString);
    ah.a().jdField_new = paramString;
    paramString = this.br.iterator();
    while (paramString.hasNext()) {
      ((a)paramString.next()).jdMethod_if(localBDLocation);
    }
  }
  
  private class a
  {
    public LocationClientOption jdField_do = new LocationClientOption();
    public Messenger jdField_for = null;
    public int jdField_if = 0;
    public String jdField_int = null;
    
    public a(Message paramMessage)
    {
      this.jdField_for = paramMessage.replyTo;
      this.jdField_int = paramMessage.getData().getString("packName");
      this.jdField_do.jdField_if = paramMessage.getData().getString("prodName");
      aw.b6().jdMethod_new(this.jdField_do.jdField_if, this.jdField_int);
      this.jdField_do.jdField_do = paramMessage.getData().getString("coorType");
      this.jdField_do.jdField_char = paramMessage.getData().getString("addrType");
      c.av = this.jdField_do.jdField_char;
      this.jdField_do.jdField_for = paramMessage.getData().getBoolean("openGPS");
      this.jdField_do.jdField_int = paramMessage.getData().getInt("scanSpan");
      this.jdField_do.b = paramMessage.getData().getInt("timeOut");
      this.jdField_do.f = paramMessage.getData().getInt("priority");
      this.jdField_do.jdField_else = paramMessage.getData().getBoolean("location_change_notify");
      this.jdField_do.e = paramMessage.getData().getBoolean("needDirect");
      if (this.jdField_do.e)
      {
        ac.bc().jdMethod_try(this.jdField_do.e);
        ac.bc().bd();
      }
      if (this.jdField_do.jdField_int > 1000)
      {
        aw.b6().b5();
        e.jdMethod_for().jdMethod_int();
      }
      if (this.jdField_do.getLocationMode() == LocationClientOption.LocationMode.Hight_Accuracy)
      {
        if (!ao.bC().bF()) {
          Log.w("baidu_location_service", "use hight accuracy mode does not use open wifi");
        }
        if (!v.aR().aO()) {
          Log.w("baidu_location_service", "use hight accuracy mode does not use open gps");
        }
      }
    }
    
    private void a(int paramInt)
    {
      Message localMessage = Message.obtain(null, paramInt);
      try
      {
        if (this.jdField_for != null) {
          this.jdField_for.send(localMessage);
        }
        this.jdField_if = 0;
        return;
      }
      catch (Exception localException)
      {
        while (!(localException instanceof DeadObjectException)) {}
        this.jdField_if += 1;
      }
    }
    
    private void a(int paramInt, String paramString, BDLocation paramBDLocation)
    {
      Bundle localBundle = new Bundle();
      localBundle.putParcelable(paramString, paramBDLocation);
      paramString = Message.obtain(null, paramInt);
      paramString.setData(localBundle);
      try
      {
        if (this.jdField_for != null) {
          this.jdField_for.send(paramString);
        }
        this.jdField_if = 0;
        return;
      }
      catch (Exception paramString)
      {
        while (!(paramString instanceof DeadObjectException)) {}
        this.jdField_if += 1;
      }
    }
    
    public void a()
    {
      a(23);
    }
    
    public void a(BDLocation paramBDLocation)
    {
      a(paramBDLocation, 21);
    }
    
    public void a(BDLocation paramBDLocation, int paramInt)
    {
      int i = 0;
      paramBDLocation = new BDLocation(paramBDLocation);
      if (paramBDLocation == null) {
        return;
      }
      if (paramInt == 21) {
        a(27, "locStr", paramBDLocation);
      }
      double d1;
      double d2;
      Object localObject;
      if ((this.jdField_do.jdField_do != null) && (!this.jdField_do.jdField_do.equals("gcj02")))
      {
        d1 = paramBDLocation.getLongitude();
        d2 = paramBDLocation.getLatitude();
        if ((d1 != Double.MIN_VALUE) && (d2 != Double.MIN_VALUE))
        {
          localObject = Jni.jdMethod_if(d1, d2, this.jdField_do.jdField_do);
          paramBDLocation.setLongitude(localObject[0]);
          paramBDLocation.setLatitude(localObject[1]);
        }
        if ((!this.jdField_do.jdField_new) || (paramInt != 26)) {}
      }
      try
      {
        if ((paramBDLocation.getLocType() == 161) && (paramBDLocation.hasPoi()))
        {
          localObject = new JSONObject(paramBDLocation.getPoi());
          JSONArray localJSONArray = ((JSONObject)localObject).getJSONArray("p");
          while (i < localJSONArray.length())
          {
            JSONObject localJSONObject = localJSONArray.getJSONObject(i);
            d1 = Double.parseDouble(localJSONObject.getString("x"));
            d2 = Double.parseDouble(localJSONObject.getString("y"));
            if ((d1 != Double.MIN_VALUE) && (d2 != Double.MIN_VALUE))
            {
              double[] arrayOfDouble = Jni.jdMethod_if(d1, d2, this.jdField_do.jdField_do);
              localJSONObject.put("x", String.valueOf(arrayOfDouble[0]));
              localJSONObject.put("y", String.valueOf(arrayOfDouble[1]));
              localJSONArray.put(i, localJSONObject);
              i += 1;
            }
          }
          ((JSONObject)localObject).put("p", localJSONArray);
          paramBDLocation.setPoi(((JSONObject)localObject).toString());
        }
      }
      catch (JSONException localJSONException)
      {
        for (;;) {}
      }
      a(paramInt, "locStr", paramBDLocation);
    }
    
    public void jdMethod_if()
    {
      if (this.jdField_do.jdField_else == true)
      {
        if (c.al) {
          a(54);
        }
      }
      else {
        return;
      }
      a(55);
    }
    
    public void jdMethod_if(BDLocation paramBDLocation)
    {
      if ((this.jdField_do.jdField_else != true) || (ab.a5().a6())) {
        return;
      }
      a(paramBDLocation);
      ah.a().a(null);
      ah.a().jdMethod_if(ah.a().jdField_new);
    }
  }
}
