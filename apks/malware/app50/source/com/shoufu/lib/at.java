package com.shoufu.lib;

import android.content.Context;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.util.Log;
import java.util.HashMap;

public class at
  extends Handler
{
  private boolean a = false;
  private aw b = null;
  
  public at() {}
  
  public int a(Context paramContext, aw paramAw, String paramString1, String paramString2)
  {
    Log.d("IAP", "Payment Init");
    if (this.b == null)
    {
      if ((paramContext == null) || (paramAw == null)) {
        return 64536;
      }
      int i = av.a(paramContext, paramString1, paramString2);
      this.b = paramAw;
      paramContext = obtainMessage();
      paramContext.arg1 = 1;
      paramContext.arg2 = i;
      paramContext.sendToTarget();
      return i;
    }
    if (paramString2 != null) {
      av.b(paramString2);
    }
    if (paramString1 != null) {
      av.a(paramString1);
    }
    if (av.l())
    {
      Log.d("IAP", "m_channel_id:" + av.g() + ",channel_id:" + paramString1);
      Log.d("IAP", "m_app_id:" + av.h() + ",app_id:" + paramString2);
    }
    return 0;
  }
  
  public int a(String paramString)
  {
    if (this.b == null) {
      return 64531;
    }
    if (av.l()) {
      Log.d("IAP", "isLocked:" + a());
    }
    if (!a()) {
      try
      {
        b();
        new au(this, paramString, this, false).start();
        return 0;
      }
      catch (Exception paramString)
      {
        c();
        Log.d("IAP", "order exception:" + paramString.getMessage());
        return 64535;
      }
    }
    return 64530;
  }
  
  public boolean a()
  {
    return this.a;
  }
  
  public void b()
  {
    if (!this.a) {
      this.a = true;
    }
  }
  
  public void c()
  {
    if (this.a) {
      this.a = false;
    }
  }
  
  public void handleMessage(Message paramMessage)
  {
    c();
    if (this.b != null)
    {
      Bundle localBundle = paramMessage.getData();
      HashMap localHashMap = new HashMap();
      localHashMap.put("TradeID", localBundle.getString("TradeID"));
      localHashMap.put("Paycode", localBundle.getString("Paycode"));
      localHashMap.put("Result", localBundle.getString("Result"));
      localHashMap.put("Port", localBundle.getString("Port"));
      localHashMap.put("Msg", localBundle.getString("Msg"));
      this.b.a(paramMessage.arg1, paramMessage.arg2, localHashMap);
    }
    super.handleMessage(paramMessage);
  }
}
