package com.shoufu.lib;

import android.os.Bundle;
import android.os.Message;
import android.util.Base64;
import android.util.Log;
import java.util.LinkedList;
import org.apache.http.client.utils.URLEncodedUtils;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONObject;

public class ar
{
  private String a = null;
  private String b = null;
  private int c = 0;
  private String d = null;
  private String e = null;
  private String f = null;
  private String g = null;
  private int h = 2;
  private int i = 55336;
  private String j = null;
  private at k = null;
  private String l = null;
  private String m = null;
  
  public ar() {}
  
  public static ar a(String paramString1, String paramString2, at paramAt, String paramString3)
  {
    ar localAr = new ar();
    int n;
    for (;;)
    {
      try
      {
        localAr.j = paramString2;
        localAr.k = paramAt;
        localAr.m = paramString3;
        paramString2 = new JSONObject(paramString1);
        n = paramString2.getInt("result");
        if ((n != 0) && (n != 1)) {
          break label332;
        }
        if (paramString2.has("smsmsg"))
        {
          localAr.a = paramString2.getString("smsmsg");
          if (paramString2.has("smsport"))
          {
            localAr.b = paramString2.getString("smsport");
            localAr.d = paramString2.getString("sid");
            localAr.c = paramString2.getInt("notify");
            localAr.e = paramString2.getString("provider");
            localAr.f = paramString2.getString("app_name");
            localAr.g = paramString2.getString("paycode_name");
            localAr.h = paramString2.getInt("dis_display");
            localAr.i = n;
            paramString1 = "N";
            if (paramString2.has("sms")) {
              paramString1 = paramString2.getString("sms");
            }
            if (paramString1 != null) {
              paramString1.equals("N");
            }
            paramString1 = paramString2.getString("notifypage");
            if (paramString1 != null) {
              paramString1.equals("Y");
            }
            paramString1 = paramString2.getString("confirmpage");
            if (paramString1 != null) {
              paramString1.equals("Y");
            }
            if (paramString2.has("app_price")) {
              paramString2.getInt("app_price");
            }
            if (!paramString2.has("tid")) {
              break;
            }
            localAr.l = paramString2.getString("tid");
            return localAr;
          }
        }
        else
        {
          localAr.a = "";
          continue;
        }
        localAr.b = "";
      }
      catch (Exception paramString1)
      {
        Log.e("IAP", "IAPPayment parseFromJson error:" + paramString1.getMessage());
        return localAr;
      }
    }
    localAr.l = "";
    return localAr;
    label332:
    localAr.i = (n + localAr.i);
    if (av.l()) {
      Log.d("IAP", "parseFromJson error:" + localAr.i);
    }
    return localAr;
  }
  
  public static ar a(String paramString1, String paramString2, String paramString3, String paramString4, String paramString5, String paramString6, at paramAt)
  {
    LinkedList localLinkedList = new LinkedList();
    localLinkedList.add(new BasicNameValuePair("operation", "102"));
    localLinkedList.add(new BasicNameValuePair("telecom", paramString6));
    localLinkedList.add(new BasicNameValuePair("paycode", paramString2));
    localLinkedList.add(new BasicNameValuePair("imsi", av.a()));
    localLinkedList.add(new BasicNameValuePair("imei", av.b()));
    localLinkedList.add(new BasicNameValuePair("model", av.d()));
    localLinkedList.add(new BasicNameValuePair("phoneos", "android"));
    localLinkedList.add(new BasicNameValuePair("wifimac", av.f()));
    localLinkedList.add(new BasicNameValuePair("sdk", av.c()));
    localLinkedList.add(new BasicNameValuePair("release", av.e()));
    localLinkedList.add(new BasicNameValuePair("channel_id", paramString5));
    localLinkedList.add(new BasicNameValuePair("sdk_version", "3.3.8"));
    localLinkedList.add(new BasicNameValuePair("sid", paramString3));
    localLinkedList.add(new BasicNameValuePair("app_id", paramString4));
    localLinkedList.add(new BasicNameValuePair("screen_width", String.valueOf(av.m())));
    localLinkedList.add(new BasicNameValuePair("screen_height", String.valueOf(av.n())));
    localLinkedList.add(new BasicNameValuePair("lac", String.valueOf(av.o())));
    localLinkedList.add(new BasicNameValuePair("cid", String.valueOf(av.p())));
    paramString3 = URLEncodedUtils.format(localLinkedList, "UTF-8");
    paramString4 = new aq(Base64.encodeToString(paramString3.getBytes(), 0)).b();
    paramString5 = new LinkedList();
    paramString5.add(new BasicNameValuePair("operation", "102"));
    paramString5 = URLEncodedUtils.format(paramString5, "UTF-8");
    paramString5 = paramString1 + "?" + paramString5;
    if (av.l())
    {
      Log.d("IAP", "102 operation:" + paramString5);
      Log.d("IAP", "102 params:" + paramString3);
      Log.d("IAP", "102 data:" + paramString4);
    }
    paramString3 = null;
    paramString4 = be.a(paramString5, paramString4);
    if (paramString4 != null)
    {
      paramString2 = a(paramString4, paramString1, paramAt, paramString2);
      paramString1 = paramString2;
      if (paramString2.f() < 0) {
        Log.d("IAP", "102 operation http get result error");
      }
    }
    for (paramString1 = paramString2;; paramString1 = paramString3)
    {
      if (av.l()) {
        Log.d("IAP", "102 operation data:" + paramString4);
      }
      return paramString1;
      Log.d("IAP", "102 operation http get result is null");
    }
  }
  
  public static void a(ar paramAr, int paramInt)
  {
    if (paramAr.k != null)
    {
      Message localMessage = paramAr.k.obtainMessage();
      localMessage.arg1 = 2;
      localMessage.arg2 = paramInt;
      Bundle localBundle = new Bundle();
      localBundle.putString("TradeID", paramAr.e());
      localBundle.putString("Paycode", paramAr.m);
      localBundle.putString("Result", paramAr.f());
      localBundle.putString("Port", paramAr.b());
      localBundle.putString("Msg", paramAr.a());
      localMessage.setData(localBundle);
      localMessage.sendToTarget();
      if (av.l()) {
        Log.d("IAP", "102 operation send sms status:" + paramInt);
      }
    }
    if (paramAr.c() == 1) {
      ap.a(paramAr.h(), paramAr.d(), paramInt, "", "102");
    }
  }
  
  public static ar b(String paramString1, String paramString2, at paramAt, String paramString3)
  {
    ar localAr = new ar();
    for (;;)
    {
      try
      {
        localAr.j = paramString2;
        localAr.k = paramAt;
        localAr.m = paramString3;
        paramString1 = new JSONObject(paramString1);
        int n = paramString1.getInt("result");
        if (n == 0)
        {
          localAr.a = paramString1.getString("smsmsg");
          localAr.d = paramString1.getString("sid");
          localAr.l = paramString1.getString("tradeid");
          localAr.c = 0;
          localAr.e = "";
          localAr.f = "";
          localAr.g = "";
          localAr.h = 0;
          localAr.i = n;
          localAr.b = paramString1.getString("smsport");
          if ((localAr.b != null) && (localAr.b.length() != 0)) {
            break;
          }
          localAr.b = "1065842410";
          return localAr;
        }
        if (localAr.i < 0)
        {
          localAr.i += n;
          if (!av.l()) {
            break;
          }
          Log.d("IAP", "parseFromJson error:" + localAr.i);
          return localAr;
        }
      }
      catch (Exception paramString1)
      {
        Log.e("IAP", "IAPPayment parseFromJson error:" + paramString1.getMessage());
        return localAr;
      }
      localAr.i = 1;
    }
    return localAr;
  }
  
  public static ar b(String paramString1, String paramString2, String paramString3, String paramString4, String paramString5, String paramString6, at paramAt)
  {
    paramString6 = new LinkedList();
    paramString6.add(new BasicNameValuePair("operation", "102"));
    paramString6.add(new BasicNameValuePair("imsi", av.a()));
    paramString6.add(new BasicNameValuePair("imei", av.b()));
    paramString6.add(new BasicNameValuePair("channel_id", paramString5));
    paramString6.add(new BasicNameValuePair("sid", paramString3));
    paramString6.add(new BasicNameValuePair("app_id", paramString4));
    paramString6.add(new BasicNameValuePair("paycode", paramString2));
    paramString3 = URLEncodedUtils.format(paramString6, "UTF-8");
    paramString4 = paramString1 + "?" + paramString3;
    if (av.l())
    {
      Log.d("IAP", "102 operation:" + paramString4);
      Log.d("IAP", "102 params:" + paramString3);
    }
    paramString3 = null;
    paramString4 = be.a(paramString4);
    if (paramString4 != null)
    {
      paramString2 = b(paramString4, paramString1, paramAt, paramString2);
      paramString1 = paramString2;
      if (paramString2.f() < 0) {
        Log.d("IAP", "MTK102 operation http get result error");
      }
    }
    for (paramString1 = paramString2;; paramString1 = paramString3)
    {
      if (av.l()) {
        Log.d("IAP", "MTK102 operation data:" + paramString4);
      }
      return paramString1;
      Log.d("IAP", "MTK102 operation http get result is null");
    }
  }
  
  public static int c(String paramString1, String paramString2, String paramString3, String paramString4, String paramString5, String paramString6, at paramAt)
  {
    if (av.l()) {
      Log.d("IAP", "url: " + paramString1);
    }
    if (paramString1 != null)
    {
      paramString1 = a(paramString1, paramString2, paramString3, paramString4, paramString5, paramString6, paramAt);
      if ((paramString1 != null) && ((paramString1.f() == 0) || (paramString1.f() == 1)))
      {
        paramString1.g();
        return 0;
      }
    }
    else
    {
      return 64534;
    }
    if (paramString1 != null)
    {
      a(paramString1, paramString1.f());
      return 0;
    }
    return 64534;
  }
  
  public static int d(String paramString1, String paramString2, String paramString3, String paramString4, String paramString5, String paramString6, at paramAt)
  {
    int n = 0;
    paramString1 = b(paramString1, paramString2, paramString3, paramString4, paramString5, paramString6, paramAt);
    if ((paramString1 == null) || (paramString1.f() != 0))
    {
      if (paramString1 != null)
      {
        n = paramString1.f();
        a(paramString1, n);
      }
    }
    else {
      return n;
    }
    return 64534;
  }
  
  public String a()
  {
    if (this.a != null) {
      return new String(Base64.decode(this.a, 0));
    }
    return null;
  }
  
  public String b()
  {
    return this.b;
  }
  
  public int c()
  {
    return this.c;
  }
  
  public String d()
  {
    return this.d;
  }
  
  public String e()
  {
    try
    {
      if (this.l != null)
      {
        String str = new String(Base64.decode(this.l, 0), "UTF-8");
        return str;
      }
      return null;
    }
    catch (Exception localException) {}
    return null;
  }
  
  public int f()
  {
    return this.i;
  }
  
  public void g()
  {
    if (av.q() != null)
    {
      if (av.l()) {
        Log.d("IAP", "IAPPayment::doConfirm getSMS ");
      }
      a(this, 0);
      return;
    }
    if (av.l()) {
      Log.d("IAP", "IAPPayment::doConfirm no ctx ");
    }
    a(this, 64533);
  }
  
  public String h()
  {
    return this.j;
  }
}
