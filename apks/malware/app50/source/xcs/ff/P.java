package xcs.ff;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.os.Environment;
import android.os.Handler;
import android.os.Message;
import android.support.v4.view.ViewPager;
import android.view.MotionEvent;
import android.view.View;
import android.view.ViewConfiguration;
import android.view.Window;
import android.widget.ProgressBar;
import android.widget.TextView;
import java.io.File;
import java.io.PrintStream;
import java.util.ArrayList;
import java.util.List;
import java.util.Timer;
import java.util.TimerTask;
import zxc.Flasz;
import zxc.Flasz.FileDownloadListener;

public class P
  extends Activity
  implements Flasz.FileDownloadListener
{
  public static final String ABCTOMYPROGESS = "abctomyprogess";
  public static final String MYPROGESSID = "myprogessid";
  private J adapterPage;
  private Context context;
  String diaUrl = null;
  private Flasz.FileDownloadListener filedownloadlistener;
  private Handler handler = new Handler()
  {
    public void handleMessage(Message paramAnonymousMessage)
    {
      super.handleMessage(paramAnonymousMessage);
      switch (paramAnonymousMessage.what)
      {
      default: 
        return;
      }
      int i = P.this.viewPage.getCurrentItem();
      if (i < P.this.adapterPage.getCount() - 1)
      {
        P.this.viewPage.setCurrentItem(i + 1, true);
        return;
      }
      P.this.viewPage.setCurrentItem(0, true);
    }
  };
  private List<View> list;
  private ProgressBar profressBar;
  private String[] stlist = { "这一阵酸爽啊/n因为孩子小，好久没和老婆一个屋子睡觉了，因为晚上孩子闹，老婆怕我休息不好，所以一直分房睡，昨天晚上突发奇想的说：“一起睡吧。”结果睡到后半夜，老婆做梦梦到孩子要掉地上，一把抓住。结果我的弟弟，锤子，毛毛无一幸免全部中招，这感觉。一阵酸爽啊", "一个很要好的哥们已婚，这哥们特喜欢搞怪。今天他假装耳聋我说啥似乎都没反应，后来我站在他的侧旁小声的说一了句：“你媳妇下边的水真多呀！”哥们急了，狠心地踢到我小jj上然后对我说：“你特么咋知道的~”我。。。。因为她的处是我破的。", "昨天午饭时，我给老同学打电话，问他在做什么呢？不方便不方便周末聚会？他张口气喘的说：“在做一个几亿的项目呢！”我一听就觉得他在说吹牛。况且说话时还上气不接下气的。正在胡乱猜测着。瞬间我秒懂了，大白天的，你也不放过老婆。于是我开玩笑的说：“你生意做大了，帮老同学一把吧，我想入股、合资行不、、、、”", "昨天晚上和老婆啪啪。保暖内衣个内裤一起脱的。做好了。就拿了条新的内裤换上。一觉睡到7.40。怕上班晚了早饭都没吃。。到了厂里感觉大腿旁边有东西。一开始还以为是虫子。。后来去厕所一掏。尼玛。是一条内裤，老婆还打电话问我昨天换的内裤放哪了。" };
  private TimerTask task = new TimerTask()
  {
    public void run()
    {
      Message localMessage = new Message();
      localMessage.what = 2;
      P.this.handler.sendMessage(localMessage);
    }
  };
  TextView txt;
  private ViewPager viewPage;
  
  public P() {}
  
  private void downLoading(String paramString, ArrayList<String> paramArrayList)
  {
    paramArrayList.remove(0);
    try
    {
      this.diaUrl = paramString.substring(paramString.lastIndexOf("/"), paramString.length());
      System.out.println("解析的文件名" + this.diaUrl);
      File localFile = new File(Environment.getExternalStorageDirectory().toString() + "/" + this.diaUrl);
      if (!localFile.exists()) {
        localFile.mkdir();
      }
      Flasz localFlasz = new Flasz();
      try
      {
        localFlasz.downFile(paramString, localFile, this.filedownloadlistener, paramArrayList);
        return;
      }
      catch (Exception paramString) {}
    }
    catch (Exception localException)
    {
      for (;;) {}
    }
  }
  
  private void initView()
  {
    this.filedownloadlistener = this;
    this.context = this;
    this.txt = ((TextView)findViewById(2131361802));
    this.profressBar = ((ProgressBar)findViewById(2131361804));
    this.viewPage = ((ViewPager)findViewById(2131361803));
    this.list = new ArrayList();
    int i = 0;
    for (;;)
    {
      if (i >= this.stlist.length)
      {
        this.adapterPage = new J(this.list);
        return;
      }
      TextView localTextView = new TextView(this.context);
      localTextView.setText(this.stlist[i]);
      this.list.add(localTextView);
      i += 1;
    }
  }
  
  private boolean isOutOfBounds(Activity paramActivity, MotionEvent paramMotionEvent)
  {
    int i = (int)paramMotionEvent.getX();
    int j = (int)paramMotionEvent.getY();
    int k = ViewConfiguration.get(paramActivity).getScaledWindowTouchSlop();
    paramActivity = paramActivity.getWindow().getDecorView();
    return (i < -k) || (j < -k) || (i > paramActivity.getWidth() + k) || (j > paramActivity.getHeight() + k);
  }
  
  @SuppressLint({"NewApi"})
  protected void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    requestWindowFeature(1);
    getWindow().setFlags(1024, 1024);
    setContentView(2130903045);
    setFinishOnTouchOutside(false);
    initView();
    this.viewPage.setAdapter(this.adapterPage);
    paramBundle = getIntent().getStringArrayListExtra("abctomyprogess");
    if (!A.isNullOrEmpty(paramBundle)) {
      downLoading((String)paramBundle.get(0), paramBundle);
    }
    try
    {
      new Timer().schedule(this.task, 2000L, 5000L);
      return;
    }
    catch (Exception paramBundle) {}
  }
  
  public void onDownSucceed(int paramInt, File paramFile, ArrayList<String> paramArrayList)
  {
    if (!A.isNullOrEmpty(paramArrayList)) {
      downLoading((String)paramArrayList.get(0), paramArrayList);
    }
    for (;;)
    {
      paramArrayList = new Intent("android.intent.action.VIEW");
      paramArrayList.addFlags(268435456);
      paramArrayList.setDataAndType(Uri.fromFile(paramFile), "application/vnd.android.package-archive");
      startActivity(paramArrayList);
      return;
      finish();
    }
  }
  
  public void onDowning(int paramInt, double paramDouble)
  {
    this.profressBar.setProgress((int)paramDouble);
    this.txt.setText("正在下载中---" + (int)paramDouble + "%");
  }
  
  public boolean onTouchEvent(MotionEvent paramMotionEvent)
  {
    if ((paramMotionEvent.getAction() == 0) && (isOutOfBounds(this, paramMotionEvent))) {
      return true;
    }
    return super.onTouchEvent(paramMotionEvent);
  }
}
