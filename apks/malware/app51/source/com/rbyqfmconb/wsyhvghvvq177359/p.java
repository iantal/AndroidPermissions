package com.rbyqfmconb.wsyhvghvvq177359;

import android.content.Context;
import android.content.pm.PackageManager;
import android.location.Criteria;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.net.wifi.WifiInfo;
import android.net.wifi.WifiManager;
import android.os.Bundle;
import android.telephony.TelephonyManager;
import android.util.Log;
import java.io.PrintStream;
import java.lang.reflect.Method;
import java.math.BigInteger;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.UUID;

class p
{
  private Context a;
  private Location b;
  private String c = "0";
  
  public p(Context paramContext)
  {
    this.a = paramContext;
  }
  
  private boolean e()
  {
    try
    {
      String str = a();
      if ((str == null) || (str.equals("")) || (str.equals("invalid")))
      {
        Util.a("Can not get device unique id.");
        return false;
      }
      MessageDigest localMessageDigest = MessageDigest.getInstance("SHA-1");
      localMessageDigest.update(str.getBytes(), 0, str.length());
      Util.d(new BigInteger(1, localMessageDigest.digest()).toString(16));
      return true;
    }
    catch (NoSuchAlgorithmException localNoSuchAlgorithmException)
    {
      Log.e("BunSDK", "Error occured while converting details to SHA-1." + localNoSuchAlgorithmException.getMessage());
      return false;
    }
    catch (Exception localException)
    {
      localException.printStackTrace();
      Log.e("BunSDK", "Error occured while converting details to SHA-1.");
    }
    return false;
  }
  
  String a()
  {
    try
    {
      Object localObject = ((TelephonyManager)this.a.getSystemService("phone")).getDeviceId();
      if ((localObject == null) || (((String)localObject).equals("")))
      {
        localObject = Class.forName("android.os.SystemProperties");
        String str = (String)((Class)localObject).getMethod("get", new Class[] { String.class }).invoke(localObject, new Object[] { "ro.serialno" });
        Util.l("SERIAL");
        if (str != null)
        {
          localObject = str;
          if (!str.equals("")) {
            return localObject;
          }
        }
        if (this.a.getPackageManager().checkPermission("android.permission.ACCESS_WIFI_STATE", Util.i(this.a)) == 0)
        {
          localObject = (WifiManager)this.a.getSystemService("wifi");
          System.out.println("WIFI " + ((WifiManager)localObject).isWifiEnabled());
          localObject = ((WifiManager)localObject).getConnectionInfo().getMacAddress();
          Util.l("WIFI_MAC");
          return localObject;
        }
        localObject = new a(this.a).a().toString();
        Util.l("UUID");
        return localObject;
      }
    }
    catch (Exception localException)
    {
      localException.printStackTrace();
      return "invalid";
    }
    Util.l("IMEI");
    return localException;
  }
  
  boolean b()
  {
    try
    {
      String str = a();
      if ((str == null) || (str.equals("")) || (str.equals("invalid")))
      {
        Util.a("Can not get device unique id.");
        return false;
      }
      MessageDigest localMessageDigest = MessageDigest.getInstance("MD5");
      localMessageDigest.update(str.getBytes(), 0, str.length());
      Util.c(new BigInteger(1, localMessageDigest.digest()).toString(16));
      boolean bool = e();
      return bool;
    }
    catch (NoSuchAlgorithmException localNoSuchAlgorithmException)
    {
      Log.e("BunSDK", "Error occured while converting details to md5." + localNoSuchAlgorithmException.getMessage());
      return false;
    }
    catch (Exception localException)
    {
      localException.printStackTrace();
      Log.e("BunSDK", "Error occured while converting details to md5.");
    }
    return false;
  }
  
  public String c()
  {
    return this.c;
  }
  
  Location d()
  {
    Util.a("fetching Location.");
    for (;;)
    {
      try
      {
        if (!Util.l().equals("0")) {
          break label413;
        }
        if (Util.n() + 900000L <= System.currentTimeMillis()) {}
      }
      catch (Exception localException)
      {
        final LocationManager localLocationManager;
        Object localObject4;
        Util.b("Error occured while fetching location. " + localException.getMessage());
        return this.b;
        Util.a(System.currentTimeMillis());
        localLocationManager.requestLocationUpdates((String)localObject4, 0L, 0.0F, new LocationListener()
        {
          public void onLocationChanged(Location paramAnonymousLocation)
          {
            Util.a(System.currentTimeMillis());
            p.a(p.this, paramAnonymousLocation);
            localLocationManager.removeUpdates(this);
          }
          
          public void onProviderDisabled(String paramAnonymousString) {}
          
          public void onProviderEnabled(String paramAnonymousString) {}
          
          public void onStatusChanged(String paramAnonymousString, int paramAnonymousInt, Bundle paramAnonymousBundle) {}
        }, this.a.getMainLooper());
        continue;
        Util.a("Location permission not found.");
        continue;
      }
      catch (Throwable localThrowable)
      {
        Log.e("BunSDK", "Error in location: " + localThrowable.getMessage());
        continue;
        Object localObject3 = null;
        continue;
      }
      synchronized (this.a)
      {
        if ((!Util.l().equals("0")) || (Util.n() + 900000L > System.currentTimeMillis()))
        {
          Util.a("failed in last");
          return null;
        }
        if (this.a.getPackageManager().checkPermission("android.permission.ACCESS_COARSE_LOCATION", this.a.getPackageName()) != 0) {
          break label415;
        }
        i = 1;
        if (this.a.getPackageManager().checkPermission("android.permission.ACCESS_FINE_LOCATION", this.a.getPackageName()) != 0) {
          break label420;
        }
        j = 1;
        if ((i != 0) && (j != 0))
        {
          localLocationManager = (LocationManager)this.a.getSystemService("location");
          if (localLocationManager == null)
          {
            Util.a("Location manager null");
            return null;
          }
          Criteria localCriteria = new Criteria();
          localCriteria.setCostAllowed(false);
          if (i == 0) {
            continue;
          }
          localCriteria.setAccuracy(2);
          Object localObject1 = localLocationManager.getBestProvider(localCriteria, true);
          this.c = "1";
          localObject4 = localObject1;
          if (localObject1 == null)
          {
            localObject4 = localObject1;
            if (j != 0)
            {
              localCriteria.setAccuracy(1);
              localObject4 = localLocationManager.getBestProvider(localCriteria, true);
              this.c = "2";
            }
          }
          if (localObject4 == null)
          {
            Util.a("Provider null");
            return null;
          }
          this.b = localLocationManager.getLastKnownLocation((String)localObject4);
          if (this.b != null)
          {
            Util.a("Location found via get last known location.");
            localObject1 = this.b;
            return localObject1;
          }
        }
      }
      label413:
      return null;
      label415:
      int i = 0;
      continue;
      label420:
      int j = 0;
    }
  }
  
  private class a
  {
    protected static final String PREFS_DEVICE_ID = "device_id";
    protected static final String PREFS_FILE = "device_id.xml";
    protected UUID a;
    
    /* Error */
    public a(Context paramContext)
    {
      // Byte code:
      //   0: aload_0
      //   1: aload_1
      //   2: putfield 23	com/rbyqfmconb/wsyhvghvvq177359/p$a:b	Lcom/rbyqfmconb/wsyhvghvvq177359/p;
      //   5: aload_0
      //   6: invokespecial 26	java/lang/Object:<init>	()V
      //   9: aload_0
      //   10: getfield 28	com/rbyqfmconb/wsyhvghvvq177359/p$a:a	Ljava/util/UUID;
      //   13: ifnonnull +166 -> 179
      //   16: ldc 2
      //   18: monitorenter
      //   19: aload_0
      //   20: getfield 28	com/rbyqfmconb/wsyhvghvvq177359/p$a:a	Ljava/util/UUID;
      //   23: ifnonnull +33 -> 56
      //   26: aload_2
      //   27: ldc 14
      //   29: iconst_0
      //   30: invokevirtual 34	android/content/Context:getSharedPreferences	(Ljava/lang/String;I)Landroid/content/SharedPreferences;
      //   33: astore_3
      //   34: aload_3
      //   35: ldc 11
      //   37: aconst_null
      //   38: invokeinterface 40 3 0
      //   43: astore_1
      //   44: aload_1
      //   45: ifnull +15 -> 60
      //   48: aload_0
      //   49: aload_1
      //   50: invokestatic 46	java/util/UUID:fromString	(Ljava/lang/String;)Ljava/util/UUID;
      //   53: putfield 28	com/rbyqfmconb/wsyhvghvvq177359/p$a:a	Ljava/util/UUID;
      //   56: ldc 2
      //   58: monitorexit
      //   59: return
      //   60: aload_2
      //   61: invokevirtual 50	android/content/Context:getContentResolver	()Landroid/content/ContentResolver;
      //   64: ldc 52
      //   66: invokestatic 57	android/provider/Settings$Secure:getString	(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;
      //   69: astore_1
      //   70: ldc 59
      //   72: aload_1
      //   73: invokevirtual 65	java/lang/String:equals	(Ljava/lang/Object;)Z
      //   76: ifne +51 -> 127
      //   79: aload_0
      //   80: aload_1
      //   81: ldc 67
      //   83: invokevirtual 71	java/lang/String:getBytes	(Ljava/lang/String;)[B
      //   86: invokestatic 75	java/util/UUID:nameUUIDFromBytes	([B)Ljava/util/UUID;
      //   89: putfield 28	com/rbyqfmconb/wsyhvghvvq177359/p$a:a	Ljava/util/UUID;
      //   92: aload_3
      //   93: invokeinterface 79 1 0
      //   98: ldc 11
      //   100: aload_0
      //   101: getfield 28	com/rbyqfmconb/wsyhvghvvq177359/p$a:a	Ljava/util/UUID;
      //   104: invokevirtual 83	java/util/UUID:toString	()Ljava/lang/String;
      //   107: invokeinterface 89 3 0
      //   112: invokeinterface 93 1 0
      //   117: pop
      //   118: goto -62 -> 56
      //   121: astore_1
      //   122: ldc 2
      //   124: monitorexit
      //   125: aload_1
      //   126: athrow
      //   127: aload_2
      //   128: ldc 95
      //   130: invokevirtual 99	android/content/Context:getSystemService	(Ljava/lang/String;)Ljava/lang/Object;
      //   133: checkcast 101	android/telephony/TelephonyManager
      //   136: invokevirtual 104	android/telephony/TelephonyManager:getDeviceId	()Ljava/lang/String;
      //   139: astore_1
      //   140: aload_1
      //   141: ifnull +31 -> 172
      //   144: aload_1
      //   145: ldc 67
      //   147: invokevirtual 71	java/lang/String:getBytes	(Ljava/lang/String;)[B
      //   150: invokestatic 75	java/util/UUID:nameUUIDFromBytes	([B)Ljava/util/UUID;
      //   153: astore_1
      //   154: aload_0
      //   155: aload_1
      //   156: putfield 28	com/rbyqfmconb/wsyhvghvvq177359/p$a:a	Ljava/util/UUID;
      //   159: goto -67 -> 92
      //   162: astore_1
      //   163: new 106	java/lang/RuntimeException
      //   166: dup
      //   167: aload_1
      //   168: invokespecial 109	java/lang/RuntimeException:<init>	(Ljava/lang/Throwable;)V
      //   171: athrow
      //   172: invokestatic 113	java/util/UUID:randomUUID	()Ljava/util/UUID;
      //   175: astore_1
      //   176: goto -22 -> 154
      //   179: return
      // Local variable table:
      //   start	length	slot	name	signature
      //   0	180	0	this	a
      //   0	180	1	this$1	p
      //   0	180	2	paramContext	Context
      //   33	60	3	localSharedPreferences	android.content.SharedPreferences
      // Exception table:
      //   from	to	target	type
      //   19	44	121	finally
      //   48	56	121	finally
      //   56	59	121	finally
      //   60	70	121	finally
      //   70	92	121	finally
      //   92	118	121	finally
      //   122	125	121	finally
      //   127	140	121	finally
      //   144	154	121	finally
      //   154	159	121	finally
      //   163	172	121	finally
      //   172	176	121	finally
      //   70	92	162	java/io/UnsupportedEncodingException
      //   127	140	162	java/io/UnsupportedEncodingException
      //   144	154	162	java/io/UnsupportedEncodingException
      //   154	159	162	java/io/UnsupportedEncodingException
      //   172	176	162	java/io/UnsupportedEncodingException
    }
    
    public UUID a()
    {
      return this.a;
    }
  }
}
