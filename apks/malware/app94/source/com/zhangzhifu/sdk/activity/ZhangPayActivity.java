package com.zhangzhifu.sdk.activity;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.os.Handler;
import android.view.KeyEvent;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.FrameLayout;
import com.zhangzhifu.sdk.ZhangPayEngine;
import com.zhangzhifu.sdk.db.SharePreferUtil;
import com.zhangzhifu.sdk.ui.FeeView;
import com.zhangzhifu.sdk.ui.LoadingView;
import com.zhangzhifu.sdk.util.SystemInfo;
import com.zhangzhifu.sdk.util.ZhangPayLog;
import com.zhangzhifu.sdk.util.json.MsgResponse_init;
import java.io.PrintStream;
import java.util.HashMap;

public class ZhangPayActivity
  extends Activity
  implements View.OnClickListener
{
  public static final String TAG = "ZhangPayActivity";
  public static String errorCode;
  public static boolean isBack;
  public static boolean isLiadong;
  public static boolean isMM;
  public static MsgResponse_init response;
  public static int sendsms;
  public String appName;
  private FrameLayout au;
  private FeeView av;
  private boolean aw = false;
  private LoadingView ax;
  public String cpOrderId;
  public String cpPrivateKeyString;
  public int cpidString;
  public int feeIdString;
  public int feeString;
  private int flags;
  public Context mContext;
  private Handler mHandler = new j(this);
  public String order;
  public int textViewCode;
  
  public ZhangPayActivity() {}
  
  private void o()
  {
    this.au.removeAllViews();
    this.ax = new LoadingView(this, null);
    this.ax.setLoadingText("准备中...");
    this.au.addView(this.ax);
  }
  
  private void p()
  {
    this.au.invalidate();
    SystemInfo.updateIMSI(this);
    this.av.updateUI();
    this.av.setVisibility(0);
    this.au.invalidate();
  }
  
  private void q()
  {
    this.au.removeAllViews();
    this.av = new FeeView(this, null);
    this.av.setVisibility(8);
    this.av.setBtnClick(new l(this));
    this.au.addView(this.av);
  }
  
  private void r()
  {
    ZhangPayLog.d("ZhangPayActivity", "关闭界面");
    if (!this.aw)
    {
      ZhangPayLog.d("ZhangPayActivity", "未计费，付费结果写入sharedPreferences中！");
      SharePreferUtil.getInstance().setSmsResult(this, 1002);
    }
    finish();
  }
  
  public void onClick(View paramView) {}
  
  protected void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    requestWindowFeature(1);
    this.mContext = this;
    this.au = new FrameLayout(this);
    setContentView(this.au);
    this.flags = getIntent().getIntExtra("enterType", 0);
    if (this.flags == 1111)
    {
      q();
      p();
    }
    for (;;)
    {
      paramBundle = System.out;
      StringBuilder localStringBuilder = new StringBuilder("总共发了多少条短信");
      SharePreferUtil.getInstance();
      paramBundle.println(SharePreferUtil.getSendSMSCountDD(this));
      return;
      o();
      try
      {
        new Thread(new k(this, (HashMap)getIntent().getSerializableExtra("map"))).start();
      }
      catch (Exception paramBundle)
      {
        ZhangPayLog.e("zhangPay_log", "map is null? or map is not HashMap?");
      }
    }
  }
  
  public boolean onKeyDown(int paramInt, KeyEvent paramKeyEvent)
  {
    if (paramInt == 4)
    {
      ZhangPayLog.d("ZhangPayActivity", "是否正在计费中？" + this.aw);
      if (!this.aw) {
        ZhangPayEngine.getInstance().getSmsSendResult(this);
      }
      r();
    }
    return super.onKeyDown(paramInt, paramKeyEvent);
  }
  
  public boolean onKeyUp(int paramInt, KeyEvent paramKeyEvent)
  {
    return super.onKeyUp(paramInt, paramKeyEvent);
  }
}
