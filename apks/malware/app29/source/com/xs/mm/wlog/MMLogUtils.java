package com.xs.mm.wlog;

import android.content.Context;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.os.Handler;
import android.os.HandlerThread;
import android.text.TextUtils;
import java.util.Random;

public class MMLogUtils
{
  public static final int FINISHLOG = 3;
  public static final int INITLOG = 0;
  public static final int PAYLOG = 2;
  public static final int TRUSTLOG = 1;
  public static Context context;
  static HandlerThread handlerThread = new HandlerThread("reqHandler");
  static Handler reqHandler = new MMLogUtils.ReqHandler(handlerThread.getLooper());
  
  static
  {
    handlerThread.start();
  }
  
  public MMLogUtils() {}
  
  private static boolean checkLog(Context paramContext, String paramString)
  {
    boolean bool2 = false;
    SharedPreferences localSharedPreferences = paramContext.getSharedPreferences("weaklogconfig", 0);
    boolean bool1 = bool2;
    if (localSharedPreferences != null)
    {
      String str = localSharedPreferences.getString("appid", "");
      bool1 = bool2;
      if (!TextUtils.isEmpty(paramString))
      {
        bool1 = bool2;
        if (!str.equals(paramString))
        {
          clearAllData(paramContext);
          bool1 = true;
          paramContext = localSharedPreferences.edit();
          paramContext.putString("appid", paramString);
          paramContext.commit();
        }
      }
    }
    return bool1;
  }
  
  private static void clearAllData(Context paramContext)
  {
    Object localObject = paramContext.getPackageName();
    String[] arrayOfString = new String[4];
    arrayOfString[0] = ("MoblieAgent_config_one" + (String)localObject);
    arrayOfString[1] = ("MoblieAgent_state_one" + (String)localObject);
    arrayOfString[2] = "MoblieAgent_sys_configone";
    arrayOfString[3] = ("MoblieAgent_upload_one" + (String)localObject);
    int i = 0;
    for (;;)
    {
      if (i >= arrayOfString.length) {
        return;
      }
      localObject = paramContext.getSharedPreferences(arrayOfString[i], 0).edit();
      ((SharedPreferences.Editor)localObject).clear();
      ((SharedPreferences.Editor)localObject).commit();
      i += 1;
    }
  }
  
  public static int getRamdomNum(int paramInt1, int paramInt2)
  {
    return new Random().nextInt(paramInt2) % (paramInt2 - paramInt1) + paramInt1;
  }
  
  public static int ranNum(int paramInt1, int paramInt2)
  {
    return new Random().nextInt(paramInt2) % (paramInt2 - paramInt1) + paramInt1;
  }
  
  private static void sendFinishLog(Context paramContext)
  {
    DAHelper.payStatus = 5;
    MobileAgent.onEventRT(paramContext, DAHelper.getPayStatus(), DAHelper.getLogStr(paramContext, 0));
  }
  
  private static int sendInitLog(Context paramContext, String paramString)
  {
    checkLog(paramContext, paramString);
    DAHelper.payStatus = 1;
    DAHelper.joinDuInit(paramContext, paramString, CheckInformation.getInsance().channelId);
    DAHelper.setStartTime();
    DAHelper.setFinishTime();
    DAHelper.onEventRT(paramContext);
    CheckInformation.getInsance().payStyle = 1;
    return -1;
  }
  
  private static void sendLayTimeLog(Context paramContext, String paramString)
  {
    DAHelper.payStatus = 3;
    if (!TextUtils.isEmpty(paramString)) {
      CheckInformation.getInsance().paycode = paramString;
    }
    MobileAgent.onEventRT(paramContext, DAHelper.getPayStatus(), DAHelper.getLogStr(paramContext, 0));
  }
  
  public static void sendReqHandlerMsg(Context paramContext, int paramInt1, int paramInt2)
  {
    context = paramContext;
    reqHandler.sendEmptyMessageDelayed(paramInt1, paramInt2);
  }
  
  private static void sendTrustLog(Context paramContext)
  {
    int i = ranNum(1, 5);
    DAHelper.payStatus = 2;
    DAHelper.setStartTime();
    DAHelper.setFinishTime(i);
    MobileAgent.onEventRT(paramContext, DAHelper.getPayStatus(), DAHelper.getLogStr(paramContext, 0));
    MobileAgent.onEventRT(paramContext, DAHelper.getPayStatus(), DAHelper.getLogStr(paramContext, 1));
  }
}
