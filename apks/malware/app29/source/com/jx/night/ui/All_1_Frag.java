package com.jx.night.ui;

import android.app.Dialog;
import android.content.Context;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.webkit.WebChromeClient;
import android.webkit.WebSettings;
import android.webkit.WebView;
import android.widget.TextView;
import com.jx.night.ad.b;
import com.jx.night.unit.MyConst;
import com.jx.night.unit.MyWebInterface;
import com.jx.night.unit.g;
import com.jx.night.unit.n;
import com.litesuits.http.LiteHttp;
import com.litesuits.http.request.AbstractRequest;
import com.litesuits.http.request.FileRequest;

public class All_1_Frag
  extends Fragment
{
  private static String e = MyConst.R;
  private WebView a;
  private Context b;
  private boolean c = false;
  private String d = "";
  private String f = "";
  private boolean g = false;
  private com.jx.night.ad.a.a h;
  private TextView i;
  private Dialog j;
  private int k = 0;
  
  public All_1_Frag() {}
  
  private void a(long paramLong1, long paramLong2)
  {
    int m = (int)((float)paramLong2 / (float)paramLong1 * 100.0F);
    String str;
    if (this.k != m)
    {
      this.k = m;
      str = "正在下载,已完成" + this.k + "%";
      if (this.i != null) {
        this.i.setText(str);
      }
    }
    else
    {
      return;
    }
    n.a(this.b, str);
  }
  
  private void c()
  {
    if (!MyConst.n) {}
    while (this.g) {
      return;
    }
    this.g = true;
    b.a().f();
  }
  
  private void d()
  {
    if (this.h == null) {
      this.h = b.a().c();
    }
    if (this.c) {}
    do
    {
      return;
      if (!"".equals(this.f))
      {
        this.h.h = b.a(this.f, this.h.j);
        com.jx.night.unit.a.b(this.b, this.f);
        return;
      }
    } while (this.h == null);
    Object localObject = com.jx.night.ad.a.a(this.h.a);
    if (g.c((String)localObject + ".tmp")) {
      g.b((String)localObject + ".tmp");
    }
    localObject = (FileRequest)new FileRequest(this.h.j, (String)localObject + ".tmp").setHttpListener(new c(this, true, true, false, (String)localObject));
    MyConst.y.executeAsync((AbstractRequest)localObject);
  }
  
  private void e()
  {
    WebSettings localWebSettings = this.a.getSettings();
    localWebSettings.supportMultipleWindows();
    localWebSettings.setJavaScriptEnabled(true);
    localWebSettings.setJavaScriptCanOpenWindowsAutomatically(true);
    localWebSettings.setAllowFileAccess(true);
    this.a.setWebChromeClient(new WebChromeClient());
    this.a.setWebViewClient(new e(this));
    this.a.loadUrl(e);
    this.a.requestFocus();
  }
  
  private boolean f()
  {
    this.h = b.a().c();
    if (this.h == null) {}
    String str;
    do
    {
      return true;
      str = this.h.h;
    } while (("".equals(str)) || (com.jx.night.unit.a.c(this.b, str)));
    return false;
  }
  
  private void g()
  {
    Dialog localDialog = new Dialog(this.b, 2131099660);
    View localView = LayoutInflater.from(this.b).inflate(2130903040, null);
    TextView localTextView = (TextView)localView.findViewById(2131361793);
    ((TextView)localView.findViewById(2131361792)).setText("本服务由“" + this.h.b + "”提供，请安装" + this.h.b + "APP才能正常观看");
    localTextView.setText("立即安装" + this.h.b);
    this.i = localTextView;
    localTextView.setOnClickListener(new d(this));
    localDialog.setContentView(localView);
    this.j = localDialog;
    localDialog.show();
  }
  
  public void a()
  {
    if (this.a != null) {
      this.a.loadUrl(e);
    }
    c();
  }
  
  public void a(View paramView)
  {
    this.a = ((WebView)paramView.findViewById(2131361834));
    this.a.setScrollBarStyle(0);
    this.a.addJavascriptInterface(new MyWebInterface(this.b), "APP");
    e();
  }
  
  public boolean b()
  {
    if (this.a == null) {}
    while (!this.a.canGoBack()) {
      return false;
    }
    this.a.goBack();
    return true;
  }
  
  public void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    this.b = getActivity();
    this.f = "";
  }
  
  public View onCreateView(LayoutInflater paramLayoutInflater, ViewGroup paramViewGroup, Bundle paramBundle)
  {
    paramLayoutInflater = paramLayoutInflater.inflate(2130903050, null);
    a(paramLayoutInflater);
    e();
    return paramLayoutInflater;
  }
}
