package com.push2.sdk.util;

import android.content.Context;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.content.pm.PackageManager.NameNotFoundException;
import android.util.Log;
import com.push2.sdk.b.b;
import java.io.File;
import java.text.SimpleDateFormat;
import java.util.Date;

public class e
{
  private static String a = "errorFile.json";
  private static String b;
  private static String d;
  private static String e;
  private static String f = "1";
  private static String g = "1.0.0";
  private Context c;
  
  public e() {}
  
  public e(Context paramContext, String paramString1, String paramString2)
  {
    this.c = paramContext;
    d = paramString1;
    e = paramString2;
    b = paramContext.getApplicationContext().getFilesDir().getAbsolutePath() + File.separator + "pushsdk" + paramString1 + paramString2 + File.separator;
    try
    {
      paramString1 = paramContext.getPackageManager().getPackageInfo(paramContext.getPackageName(), 1);
      if (paramString1 != null)
      {
        paramContext = paramString1.versionName;
        if (paramContext == null) {}
        for (paramContext = "null";; paramContext = paramString1.versionName)
        {
          g = paramContext;
          f = paramString1.versionCode;
          return;
        }
      }
      return;
    }
    catch (PackageManager.NameNotFoundException paramContext)
    {
      Log.e("GZ", "an error occured when collect package info", paramContext);
    }
  }
  
  public static String a()
  {
    return g.a(b, a);
  }
  
  public static void a(b paramB)
  {
    if (b == null) {
      return;
    }
    paramB.d(c());
    String str = g.a(b, a);
    StringBuffer localStringBuffer = new StringBuffer();
    if (str == null)
    {
      localStringBuffer.append("[{");
      localStringBuffer.append("\"name\":").append("\"").append(paramB.a()).append("\",");
      localStringBuffer.append("\"content\":").append("\"").append(paramB.b().replaceAll("\"", "'")).append("\",");
      localStringBuffer.append("\"errorCode\":").append("\"").append(paramB.c()).append("\",");
      localStringBuffer.append("\"time\":").append("\"").append(c()).append("\",");
      localStringBuffer.append("\"versionCode\":").append("\"").append(paramB.d()).append("\",");
      localStringBuffer.append("\"versionName\":").append("\"").append(paramB.e()).append("\"");
      localStringBuffer.append("}]");
      g.a(b, a, localStringBuffer.toString(), false);
      return;
    }
    localStringBuffer.append(str);
    localStringBuffer.deleteCharAt(localStringBuffer.length() - 1);
    localStringBuffer.append(",{");
    localStringBuffer.append("\"name\":").append("\"").append(paramB.a()).append("\",");
    localStringBuffer.append("\"content\":").append("\"").append(paramB.b().replaceAll("\"", "'")).append("\",");
    localStringBuffer.append("\"errorCode\":").append("\"").append(paramB.c()).append("\",");
    localStringBuffer.append("\"time\":").append("\"").append(c()).append("\",");
    localStringBuffer.append("\"versionCode\":").append("\"").append(paramB.d()).append("\",");
    localStringBuffer.append("\"versionName\":").append("\"").append(paramB.e()).append("\"");
    localStringBuffer.append("}]");
    g.a(b, a, localStringBuffer.toString(), false);
  }
  
  public static boolean b()
  {
    return g.b(b, a);
  }
  
  public static String c()
  {
    return new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new Date(System.currentTimeMillis()));
  }
  
  public static String d()
  {
    return f;
  }
  
  public static String e()
  {
    return g;
  }
}
