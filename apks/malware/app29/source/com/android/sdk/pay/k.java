package com.android.sdk.pay;

import android.content.Context;
import android.os.Handler;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Set;
import java.util.zip.GZIPInputStream;
import org.apache.http.Header;
import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.StatusLine;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.client.methods.HttpRequestBase;
import org.apache.http.client.methods.HttpUriRequest;
import org.apache.http.entity.ByteArrayEntity;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.params.HttpConnectionParams;
import org.apache.http.params.HttpParams;
import org.apache.http.util.EntityUtils;
import org.json.JSONException;
import org.json.JSONObject;

public class k
  implements Runnable
{
  private static final String a = k.class.getSimpleName();
  private String b;
  private int c;
  private Handler d = null;
  private List e;
  private byte[] f;
  private int g;
  private Context h;
  private int i;
  
  public k(Context paramContext, Handler paramHandler)
  {
    this.h = paramContext;
    this.d = paramHandler;
  }
  
  public static boolean a(HttpResponse paramHttpResponse)
  {
    boolean bool2 = false;
    paramHttpResponse = paramHttpResponse.getHeaders("Content-Encoding");
    boolean bool1 = bool2;
    if (paramHttpResponse != null)
    {
      bool1 = bool2;
      if (paramHttpResponse.length > 0)
      {
        bool1 = bool2;
        if ("gzip".equalsIgnoreCase(paramHttpResponse[0].getValue())) {
          bool1 = true;
        }
      }
    }
    return bool1;
  }
  
  public static byte[] a(byte[] paramArrayOfByte)
  {
    ByteArrayOutputStream localByteArrayOutputStream = new ByteArrayOutputStream();
    paramArrayOfByte = new GZIPInputStream(new ByteArrayInputStream(paramArrayOfByte));
    byte[] arrayOfByte = new byte['Ð€'];
    for (;;)
    {
      try
      {
        j = paramArrayOfByte.read(arrayOfByte);
        if (j >= 0) {
          continue;
        }
      }
      catch (IOException paramArrayOfByte)
      {
        int j;
        ActivityTool.c(a, paramArrayOfByte.getMessage());
        continue;
      }
      return localByteArrayOutputStream.toByteArray();
      localByteArrayOutputStream.write(arrayOfByte, 0, j);
    }
  }
  
  private JSONObject b()
  {
    if (this.e == null) {
      return null;
    }
    JSONObject localJSONObject = new JSONObject();
    Iterator localIterator = this.e.iterator();
    for (;;)
    {
      if (!localIterator.hasNext()) {
        return localJSONObject;
      }
      NameValuePair localNameValuePair = (NameValuePair)localIterator.next();
      try
      {
        localJSONObject.put(localNameValuePair.getName(), localNameValuePair.getValue());
      }
      catch (JSONException localJSONException)
      {
        localJSONException.printStackTrace();
      }
    }
  }
  
  public static boolean b(HttpResponse paramHttpResponse)
  {
    boolean bool2 = false;
    paramHttpResponse = paramHttpResponse.getHeaders("Content-Type");
    boolean bool1 = bool2;
    if (paramHttpResponse != null)
    {
      bool1 = bool2;
      if (paramHttpResponse.length > 0) {
        if (!ActivityTool.a(paramHttpResponse[0].getValue()).contains("video")) {
          break label68;
        }
      }
    }
    label68:
    for (bool1 = true;; bool1 = false)
    {
      if (ActivityTool.a(paramHttpResponse[0].getValue()).contains("audio")) {
        bool1 = true;
      }
      return bool1;
    }
  }
  
  public void a(int paramInt1, String paramString, List paramList, byte[] paramArrayOfByte, int paramInt2, int paramInt3)
  {
    ActivityTool.b(a, "method:" + paramInt1 + " ,url:" + paramString + " ,data:" + paramList + "rspType:" + paramInt2);
    this.c = paramInt1;
    this.b = paramString;
    this.e = paramList;
    this.f = paramArrayOfByte;
    this.g = paramInt2;
    this.i = paramInt3;
    l.a().a(this);
  }
  
  public void a(String paramString, List paramList, int paramInt1, int paramInt2)
  {
    a(1, paramString, paramList, null, paramInt1, paramInt2);
  }
  
  public byte[] a()
  {
    h.b(this.h);
    label383:
    label418:
    for (;;)
    {
      Object localObject3;
      Object localObject4;
      try
      {
        ActivityTool.b(a, "conProcess");
        localObject3 = new DefaultHttpClient();
        HttpConnectionParams.setConnectionTimeout(((HttpClient)localObject3).getParams(), 30000);
        HttpConnectionParams.setSoTimeout(((HttpClient)localObject3).getParams(), 45000);
        ((HttpClient)localObject3).getParams().setParameter("http.protocol.handle-redirects", Boolean.valueOf(true));
        ActivityTool.b(a, "ConMgr.apn_is_wap=" + g.a + ";url=" + this.b);
        Object localObject1;
        if (this.c == 0)
        {
          localObject1 = new HttpGet(this.b);
          localObject4 = ActivityTool.a().entrySet().iterator();
          if (!((Iterator)localObject4).hasNext())
          {
            int j = g.b(this.h);
            ActivityTool.b(a, "curConnType=" + j);
            ((HttpRequestBase)localObject1).setHeader("C_C_TP", String.valueOf(j));
            localObject4 = ((HttpClient)localObject3).execute((HttpUriRequest)localObject1);
            j = ((HttpResponse)localObject4).getStatusLine().getStatusCode();
            ActivityTool.b(a, "status_code=" + j);
            if ((j == 200) || (j == 206)) {
              break label383;
            }
            return null;
          }
        }
        else
        {
          localObject1 = new HttpPost(this.b);
          if (this.e != null)
          {
            ((HttpPost)localObject1).setEntity(new UrlEncodedFormEntity(this.e, "UTF-8"));
            continue;
          }
          if (this.f == null) {
            break label418;
          }
          localObject4 = new ByteArrayEntity(this.f);
          ((ByteArrayEntity)localObject4).setContentType("application/octet-stream");
          ((HttpPost)localObject1).setEntity((HttpEntity)localObject4);
          break label418;
        }
        Map.Entry localEntry = (Map.Entry)((Iterator)localObject4).next();
        ((HttpRequestBase)localObject1).setHeader((String)localEntry.getKey(), (String)localEntry.getValue());
        continue;
        localObject3 = EntityUtils.toByteArray(((HttpResponse)localObject4).getEntity());
      }
      catch (Exception localException)
      {
        ActivityTool.c(a, localException.getMessage());
        return null;
      }
      Object localObject2 = localObject3;
      if (a((HttpResponse)localObject4)) {
        localObject2 = a((byte[])localObject3);
      }
      ActivityTool.a(a, (byte[])localObject2);
      return localObject2;
    }
  }
  
  /* Error */
  public void run()
  {
    // Byte code:
    //   0: getstatic 31	com/android/sdk/pay/k:a	Ljava/lang/String;
    //   3: ldc_w 346
    //   6: invokestatic 177	com/android/sdk/pay/ActivityTool:b	(Ljava/lang/String;Ljava/lang/String;)V
    //   9: iconst_0
    //   10: istore_1
    //   11: iload_1
    //   12: iconst_1
    //   13: iadd
    //   14: istore_2
    //   15: iload_1
    //   16: iconst_3
    //   17: if_icmplt +85 -> 102
    //   20: iload_2
    //   21: iconst_4
    //   22: if_icmpne +59 -> 81
    //   25: new 105	org/json/JSONObject
    //   28: dup
    //   29: invokespecial 106	org/json/JSONObject:<init>	()V
    //   32: astore_3
    //   33: aload_3
    //   34: ldc_w 348
    //   37: ldc_w 350
    //   40: invokevirtual 132	org/json/JSONObject:put	(Ljava/lang/String;Ljava/lang/Object;)Lorg/json/JSONObject;
    //   43: pop
    //   44: aload_3
    //   45: ldc_w 352
    //   48: aload_0
    //   49: invokespecial 354	com/android/sdk/pay/k:b	()Lorg/json/JSONObject;
    //   52: invokevirtual 132	org/json/JSONObject:put	(Ljava/lang/String;Ljava/lang/Object;)Lorg/json/JSONObject;
    //   55: pop
    //   56: aload_0
    //   57: getfield 38	com/android/sdk/pay/k:d	Landroid/os/Handler;
    //   60: ifnull +21 -> 81
    //   63: aload_0
    //   64: getfield 38	com/android/sdk/pay/k:d	Landroid/os/Handler;
    //   67: aload_0
    //   68: getfield 38	com/android/sdk/pay/k:d	Landroid/os/Handler;
    //   71: bipush -102
    //   73: aload_3
    //   74: invokestatic 360	android/os/Message:obtain	(Landroid/os/Handler;ILjava/lang/Object;)Landroid/os/Message;
    //   77: invokevirtual 366	android/os/Handler:sendMessage	(Landroid/os/Message;)Z
    //   80: pop
    //   81: ldc2_w 367
    //   84: invokestatic 371	com/android/sdk/pay/ActivityTool:a	(J)V
    //   87: invokestatic 192	com/android/sdk/pay/l:a	()Lcom/android/sdk/pay/l;
    //   90: aload_0
    //   91: invokevirtual 373	com/android/sdk/pay/l:b	(Ljava/lang/Runnable;)V
    //   94: aload_0
    //   95: getfield 40	com/android/sdk/pay/k:h	Landroid/content/Context;
    //   98: invokestatic 376	com/android/sdk/pay/g:c	(Landroid/content/Context;)V
    //   101: return
    //   102: aload_0
    //   103: getfield 40	com/android/sdk/pay/k:h	Landroid/content/Context;
    //   106: aload_0
    //   107: getfield 187	com/android/sdk/pay/k:i	I
    //   110: invokestatic 379	com/android/sdk/pay/g:a	(Landroid/content/Context;I)V
    //   113: getstatic 31	com/android/sdk/pay/k:a	Ljava/lang/String;
    //   116: new 151	java/lang/StringBuilder
    //   119: dup
    //   120: ldc_w 381
    //   123: invokespecial 156	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   126: iload_2
    //   127: invokevirtual 160	java/lang/StringBuilder:append	(I)Ljava/lang/StringBuilder;
    //   130: invokevirtual 175	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   133: invokestatic 177	com/android/sdk/pay/ActivityTool:b	(Ljava/lang/String;Ljava/lang/String;)V
    //   136: aload_0
    //   137: invokevirtual 383	com/android/sdk/pay/k:a	()[B
    //   140: astore_3
    //   141: aload_3
    //   142: ifnonnull +14 -> 156
    //   145: ldc2_w 367
    //   148: invokestatic 371	com/android/sdk/pay/ActivityTool:a	(J)V
    //   151: iload_2
    //   152: istore_1
    //   153: goto -142 -> 11
    //   156: aload_0
    //   157: getfield 38	com/android/sdk/pay/k:d	Landroid/os/Handler;
    //   160: ifnull -140 -> 20
    //   163: getstatic 31	com/android/sdk/pay/k:a	Ljava/lang/String;
    //   166: new 151	java/lang/StringBuilder
    //   169: dup
    //   170: ldc_w 385
    //   173: invokespecial 156	java/lang/StringBuilder:<init>	(Ljava/lang/String;)V
    //   176: aload_0
    //   177: getfield 185	com/android/sdk/pay/k:g	I
    //   180: invokevirtual 160	java/lang/StringBuilder:append	(I)Ljava/lang/StringBuilder;
    //   183: invokevirtual 175	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   186: invokestatic 177	com/android/sdk/pay/ActivityTool:b	(Ljava/lang/String;Ljava/lang/String;)V
    //   189: aload_0
    //   190: getfield 185	com/android/sdk/pay/k:g	I
    //   193: iconst_1
    //   194: if_icmpne +159 -> 353
    //   197: new 58	java/lang/String
    //   200: dup
    //   201: aload_3
    //   202: ldc_w 305
    //   205: invokespecial 388	java/lang/String:<init>	([BLjava/lang/String;)V
    //   208: astore_3
    //   209: aload_3
    //   210: ifnonnull +135 -> 345
    //   213: ldc_w 390
    //   216: astore_3
    //   217: new 105	org/json/JSONObject
    //   220: dup
    //   221: aload_3
    //   222: invokespecial 391	org/json/JSONObject:<init>	(Ljava/lang/String;)V
    //   225: astore_3
    //   226: aload_3
    //   227: ldc_w 352
    //   230: aload_0
    //   231: invokespecial 354	com/android/sdk/pay/k:b	()Lorg/json/JSONObject;
    //   234: invokevirtual 132	org/json/JSONObject:put	(Ljava/lang/String;Ljava/lang/Object;)Lorg/json/JSONObject;
    //   237: pop
    //   238: aload_0
    //   239: getfield 38	com/android/sdk/pay/k:d	Landroid/os/Handler;
    //   242: aload_0
    //   243: getfield 38	com/android/sdk/pay/k:d	Landroid/os/Handler;
    //   246: bipush -103
    //   248: aload_3
    //   249: invokestatic 360	android/os/Message:obtain	(Landroid/os/Handler;ILjava/lang/Object;)Landroid/os/Message;
    //   252: invokevirtual 366	android/os/Handler:sendMessage	(Landroid/os/Message;)Z
    //   255: pop
    //   256: goto -236 -> 20
    //   259: astore 4
    //   261: aload 4
    //   263: invokevirtual 392	java/lang/Exception:printStackTrace	()V
    //   266: new 105	org/json/JSONObject
    //   269: dup
    //   270: invokespecial 106	org/json/JSONObject:<init>	()V
    //   273: astore_3
    //   274: aload_3
    //   275: ldc_w 348
    //   278: aload 4
    //   280: invokevirtual 393	java/lang/Exception:toString	()Ljava/lang/String;
    //   283: invokevirtual 132	org/json/JSONObject:put	(Ljava/lang/String;Ljava/lang/Object;)Lorg/json/JSONObject;
    //   286: pop
    //   287: aload_3
    //   288: ldc_w 352
    //   291: aload_0
    //   292: invokespecial 354	com/android/sdk/pay/k:b	()Lorg/json/JSONObject;
    //   295: invokevirtual 132	org/json/JSONObject:put	(Ljava/lang/String;Ljava/lang/Object;)Lorg/json/JSONObject;
    //   298: pop
    //   299: aload_0
    //   300: getfield 38	com/android/sdk/pay/k:d	Landroid/os/Handler;
    //   303: ifnull +21 -> 324
    //   306: aload_0
    //   307: getfield 38	com/android/sdk/pay/k:d	Landroid/os/Handler;
    //   310: aload_0
    //   311: getfield 38	com/android/sdk/pay/k:d	Landroid/os/Handler;
    //   314: bipush -102
    //   316: aload_3
    //   317: invokestatic 360	android/os/Message:obtain	(Landroid/os/Handler;ILjava/lang/Object;)Landroid/os/Message;
    //   320: invokevirtual 366	android/os/Handler:sendMessage	(Landroid/os/Message;)Z
    //   323: pop
    //   324: ldc2_w 367
    //   327: invokestatic 371	com/android/sdk/pay/ActivityTool:a	(J)V
    //   330: invokestatic 192	com/android/sdk/pay/l:a	()Lcom/android/sdk/pay/l;
    //   333: aload_0
    //   334: invokevirtual 373	com/android/sdk/pay/l:b	(Ljava/lang/Runnable;)V
    //   337: aload_0
    //   338: getfield 40	com/android/sdk/pay/k:h	Landroid/content/Context;
    //   341: invokestatic 376	com/android/sdk/pay/g:c	(Landroid/content/Context;)V
    //   344: return
    //   345: aload_3
    //   346: invokevirtual 396	java/lang/String:trim	()Ljava/lang/String;
    //   349: astore_3
    //   350: goto -133 -> 217
    //   353: aload_0
    //   354: getfield 38	com/android/sdk/pay/k:d	Landroid/os/Handler;
    //   357: aload_0
    //   358: getfield 38	com/android/sdk/pay/k:d	Landroid/os/Handler;
    //   361: bipush -103
    //   363: aload_3
    //   364: invokestatic 360	android/os/Message:obtain	(Landroid/os/Handler;ILjava/lang/Object;)Landroid/os/Message;
    //   367: invokevirtual 366	android/os/Handler:sendMessage	(Landroid/os/Message;)Z
    //   370: pop
    //   371: goto -351 -> 20
    //   374: astore_3
    //   375: ldc2_w 367
    //   378: invokestatic 371	com/android/sdk/pay/ActivityTool:a	(J)V
    //   381: invokestatic 192	com/android/sdk/pay/l:a	()Lcom/android/sdk/pay/l;
    //   384: aload_0
    //   385: invokevirtual 373	com/android/sdk/pay/l:b	(Ljava/lang/Runnable;)V
    //   388: aload_0
    //   389: getfield 40	com/android/sdk/pay/k:h	Landroid/content/Context;
    //   392: invokestatic 376	com/android/sdk/pay/g:c	(Landroid/content/Context;)V
    //   395: aload_3
    //   396: athrow
    //   397: astore 4
    //   399: aload 4
    //   401: invokevirtual 135	org/json/JSONException:printStackTrace	()V
    //   404: goto -348 -> 56
    //   407: astore 4
    //   409: aload 4
    //   411: invokevirtual 135	org/json/JSONException:printStackTrace	()V
    //   414: goto -115 -> 299
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	417	0	this	k
    //   10	143	1	j	int
    //   14	138	2	k	int
    //   32	332	3	localObject1	Object
    //   374	22	3	localObject2	Object
    //   259	20	4	localException	Exception
    //   397	3	4	localJSONException1	JSONException
    //   407	3	4	localJSONException2	JSONException
    // Exception table:
    //   from	to	target	type
    //   25	33	259	java/lang/Exception
    //   33	56	259	java/lang/Exception
    //   56	81	259	java/lang/Exception
    //   102	141	259	java/lang/Exception
    //   145	151	259	java/lang/Exception
    //   156	209	259	java/lang/Exception
    //   217	256	259	java/lang/Exception
    //   345	350	259	java/lang/Exception
    //   353	371	259	java/lang/Exception
    //   399	404	259	java/lang/Exception
    //   25	33	374	finally
    //   33	56	374	finally
    //   56	81	374	finally
    //   102	141	374	finally
    //   145	151	374	finally
    //   156	209	374	finally
    //   217	256	374	finally
    //   261	274	374	finally
    //   274	299	374	finally
    //   299	324	374	finally
    //   345	350	374	finally
    //   353	371	374	finally
    //   399	404	374	finally
    //   409	414	374	finally
    //   33	56	397	org/json/JSONException
    //   274	299	407	org/json/JSONException
  }
}
