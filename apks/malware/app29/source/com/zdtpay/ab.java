package com.zdtpay;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.text.TextUtils;
import com.zdtpay.a.a;
import com.zdtpay.tools.MyLogPrinter;
import com.zdtpay.tools.c;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;
import org.json.JSONObject;

class ab
  extends BroadcastReceiver
{
  ab(ZTbje paramZTbje) {}
  
  private void a(HashMap paramHashMap)
  {
    new Thread(new ac(this, paramHashMap)).start();
  }
  
  public void onReceive(Context paramContext, Intent paramIntent)
  {
    if (paramIntent == null) {
      break label4;
    }
    label4:
    while (!paramIntent.getAction().equals(this.a.p)) {
      return;
    }
    a localA = ZTbje.c(this.a);
    Object localObject1 = ZTbje.c(this.a).d();
    int i = 0;
    for (;;)
    {
      Object localObject3;
      Object localObject2;
      int j;
      if (i >= ((ArrayList)localObject1).size())
      {
        int k = this.a.d.getInt(c.E, 0);
        localObject3 = new boolean[k];
        localObject1 = new HashMap();
        localObject2 = paramIntent.getStringExtra(c.t);
        paramIntent.getStringExtra(c.t + "tid");
        if ((localObject2 != null) && (((String)localObject2).endsWith("_x"))) {
          break;
        }
        if (com.zdtpay.tools.b.a == null) {
          break label720;
        }
        if (localObject2 == null) {
          break label715;
        }
        this.a.d.edit().putBoolean((String)localObject2, true).commit();
        i = 1;
        j = 0;
        label179:
        if (j < k) {
          break label619;
        }
        ((Map)localObject1).put("order", localObject2);
        label198:
        localObject3 = localA.b();
        if (i == 0) {
          break label670;
        }
        paramIntent = "1";
        label212:
        ((Map)localObject1).put("isLast", paramIntent);
        ((Map)localObject1).put("code", localObject3);
        ((Map)localObject1).put("err_msg", localA.a());
        ((Map)localObject1).put("paymoney", ZTbje.a(this.a).getPrice());
        ((Map)localObject1).put("extra", ZTbje.a(this.a).getExtra());
      }
      switch (getResultCode())
      {
      default: 
        MyLogPrinter.a("短信发送失败" + getResultCode());
        ((Map)localObject1).put("code", "-4");
        ((Map)localObject1).put("err_msg", "短信发送失败");
        com.zdtpay.tools.b.a.onFail((Map)localObject1);
        label368:
        if (i == 0) {
          break;
        }
        this.a.a();
        return;
        localObject2 = (com.zdtpay.a.b)((ArrayList)localObject1).get(i);
        localObject3 = ((com.zdtpay.a.b)localObject2).a();
        MyLogPrinter.a("migu: " + (String)localObject3);
        if ((TextUtils.isEmpty((CharSequence)localObject3)) || (this.a.k.getBoolean(((com.zdtpay.a.b)localObject2).d(), false))) {}
        break;
      }
      try
      {
        Object localObject4 = new JSONObject((String)localObject3);
        localObject3 = ((JSONObject)localObject4).optString("order");
        String str1 = ((JSONObject)localObject4).optString("tid");
        String str2 = ((JSONObject)localObject4).optString("imei");
        String str3 = ((JSONObject)localObject4).optString("imsi");
        String str4 = ((JSONObject)localObject4).optString("url");
        if (((JSONObject)localObject4).optString("cgflag").equals("ok"))
        {
          localObject4 = new HashMap();
          ((HashMap)localObject4).put("TID", str1);
          ((HashMap)localObject4).put("URL", str4);
          ((HashMap)localObject4).put("IMSI", str3);
          ((HashMap)localObject4).put("IMEI", str2);
          ((HashMap)localObject4).put("ORDER", localObject3);
          a((HashMap)localObject4);
          this.a.k.edit().putBoolean(((com.zdtpay.a.b)localObject2).d(), true).commit();
        }
        i += 1;
        continue;
        label619:
        localObject3[j] = this.a.d.getBoolean(((com.zdtpay.a.b)localA.d().get(j)).k(), false);
        i |= localObject3[j];
        j += 1;
        break label179;
        label670:
        paramIntent = "0";
        break label212;
        MyLogPrinter.a("短信发送成功");
        com.zdtpay.tools.b.a.onSuccess((Map)localObject1);
        ZTbje.a(paramContext, "e:" + (String)localObject2);
        break label368;
        label715:
        i = 1;
        break label198;
        label720:
        i = 1;
      }
      catch (Exception localException)
      {
        for (;;) {}
      }
    }
  }
}
