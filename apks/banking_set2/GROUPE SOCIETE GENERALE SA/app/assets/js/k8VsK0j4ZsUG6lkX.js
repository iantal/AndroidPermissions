Class.ns("Bankingapp.functions.deposits.create");$().loadJavaScript("/js/cgNwwbdYOEs1FwR4.js");$().loadJavaScript("/js/icz25N39YleqstwB.js");Bankingapp.functions.deposits.create.DepositTimePeriodSelection=Class.extend(Bankingapp.framework.View,{container:null,forecastDataFunctionAttributeId:"DEPOSITCREATE_FORECASTDATA",formDataFunctionAttributeId:"DEPOSITCREATE_FORMDATA",depositDataFunctionAttributeId:"DEPOSITTYPE_DATA",progressIndicatorStepCount:8,progressIndicatorCurrentStep:6,formDataField:"depositMaturityCount",idProperty:"depositMaturityCount",layoutRender:function(){this.depositData=getFunctionAttribute(this.depositDataFunctionAttributeId);this.formData=getFunctionAttribute(this.formDataFunctionAttributeId);this.container=$("<div>",{id:"depositTimePeriodMainContainer","class":"maincontainer"});this.container.append(new Bankingapp.ui.ProgressIndicator(this.progressIndicatorStepCount,this.progressIndicatorCurrentStep));this.containerList=$("<div>",{id:"depositTimePeriodListContainer","class":"list maincontainer"});this.depositTimePeriodTypeInformationLabel=new Bankingapp.ui.Label(resolve("bankingapp_brd_function_deposits_create_timedeposittype_information_label"),{"class":"pagetitle separator textcenter"});this.depositTimePeriodTypeListLabel=new Bankingapp.ui.Label(resolve("bankingapp_brd_function_deposits_create_timedeposittype_list_title"),{"class":"listtitle"});this.selectedRolloverItem=getFunctionAttribute("_SELECTED_ROLLOVERTYPE_");this.depositTimePeriodTypeList=new Bankingapp.ui.List({baseClass:"list",listData:this.selectedRolloverItem.depositTimePeriodList,itemRenderer:Bankingapp.ui.DepositTimePeriodListItem,noresultKey:"emptyListResourceKey",activeProperty:true,idProperty:this.idProperty,itemConfig:{depositMaturityCountField:"depositMaturityCount",depositMaturityTypeField:"depositMaturityType",depositMaturityInterestField:"depositMaturityInterest"}});this.depositTimePeriodTypeList.bind("itemClick",$.proxy(this.clickHandler,this));var a=this.formData[this.formDataField]?this.formData[this.formDataField]:null;if(a){if(this.depositTimePeriodTypeList.getItem(a)){this.depositTimePeriodTypeList.getItem(a).addClass("state_selected");}}this.containerList.append(this.depositTimePeriodTypeInformationLabel);this.containerList.append(this.depositTimePeriodTypeListLabel);this.containerList.append(this.depositTimePeriodTypeList);this.container.append(this.containerList);return this.container;},clickHandler:function(b,f){var c=f.depositMaturityCount;if(c){$.each(this.depositTimePeriodTypeList.itemsMap,function(d,e){e.removeClass("state_selected");});if(this.depositTimePeriodTypeList.getItem(c)){this.depositTimePeriodTypeList.getItem(c).addClass("state_selected");}}$.extend(this.formData,{maturity:c,interestRate:f.depositMaturityInterest,depositCode:f.depositOriginalProductCode});setFunctionAttribute(this.formDataFunctionAttributeId,this.formData);var a={termDeposit:{sourceAccount:this.formData.sourceAccount.accountNumber,maturity:this.formData.maturity,interestRate:this.formData.interestRate,depositType:this.formData.depositType,depositCode:this.formData.depositCode,depositCodeName:this.formData.depositCodeName,interestType:this.formData.depositInterestType,amount:this.formData.amount,currency:this.formData.currency,interestPayment:this.formData.interestPayment,revolving:this.formData.depositRolloverType=="OD"?false:true,capitalizationOfInterest:this.formData.depositRolloverType=="RC"?true:false}};Bankingapp.framework.Application.callService("/depositcreate/forecast.do",{DepositCreateForecastRequest:a},$.proxy(this.handleForecastResult,this));},handleForecastResult:function(a){setFunctionAttribute("FORECAST_DATA",a);loadView("view://brd/bankingapp/function/deposits/create/Confirm");}});Bankingapp.framework.Application.setView(Bankingapp.functions.deposits.create.DepositTimePeriodSelection);