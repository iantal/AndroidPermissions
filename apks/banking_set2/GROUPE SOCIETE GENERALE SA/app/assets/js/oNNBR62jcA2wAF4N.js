Class.ns("Bankingapp.functions.deposits.create");$().loadJavaScript("/js/1hyf9OWY93mTBudZ.js");$().loadJavaScript("/js/CF0WiFs1SjIy0Szl.js");$().loadJavaScript("/js/icz25N39YleqstwB.js");Bankingapp.functions.deposits.create.Result=Class.extend(Bankingapp.framework.View,{container:null,dateFormatPatternResourceKey:"bankingapp_common_dateFormatPattern",formDataFunctionAttributeId:"DEPOSITCREATE_FORMDATA",depositDataFunctionAttributeId:"DEPOSITTYPE_DATA",forecastDataFunctionAttributeId:"DEPOSITCREATE_FORECASTDATA",performDataFunctionAttributeId:"DEPOSITCREATE_PERFORMREPLY",separator:" - ",layoutRender:function(){this.depositData=getFunctionAttribute(this.depositDataFunctionAttributeId);this.formData=getFunctionAttribute(this.formDataFunctionAttributeId);this.forecastData=getFunctionAttribute(this.forecastDataFunctionAttributeId);this.container=$("<div>",{id:"depositCreateResultMainContainer","class":"maincontainer"});this.containerDetails=$("<div>",{id:"depositCreateConfirmDetailsContainer","class":""});debugLog("html: "+this.container.html());return this.container;},run:function(){debugLog("Bankingapp.functions.deposits.create.Result run ...");Bankingapp.framework.event.BrdServiceMessageHandler.handleMessages();this.performData=getFunctionAttribute("PERFORM_RESULT");debugLog(this.formData);debugLog(this.depositData);this.transactionId=this.performData.transactionId;var d=$().dateParserWithoutTime(this.forecastData.depositDueDate);var b=new Array();if(this.forecastData.depositPeriodStartDate){var g=$().dateParserWithoutTime(this.forecastData.depositPeriodStartDate);b.push(g.dateFormat(resolve(this.dateFormatPatternResourceKey)));}if(this.forecastData.depositPeriodEndDate){var i=$().dateParserWithoutTime(this.forecastData.depositPeriodEndDate);b.push(i.dateFormat(resolve(this.dateFormatPatternResourceKey)));}var a=b.join(this.separator);var h=this.formData.sourceAccount.accountName+" - "+this.formData.sourceAccount.currency;var f=$().dateParserWithoutTimezone(this.performData.created);var c={status:"successful",message:resolve("bankingapp_brd_function_deposits_create_result_success"),title:["",this.depositData.depositCodeName+" ("+this.depositData.depositCurrency+")"],timestamp:f,displayDateFormatKey:"bankingapp_common_timeFormatPattern",id:resolve("bankingapp_brd_function_deposits_create_result_no")+this.performData.transactionId,details:[{label:resolve("bankingapp_brd_function_deposits_create_result_interestrate"),value:$().interestFormatter(this.formData.interestRate)},{label:resolve("bankingapp_brd_function_deposits_create_result_interesttype"),value:resolve("bankingapp_brd_function_deposits_details_interesttype_"+(this.depositData.depositInterestType["$"]=="V"?"Y":"N"))},{label:resolve("bankingapp_brd_function_deposits_create_result_amount"),value:new Bankingapp.functions.util.component.Amount({currency:this.formData.currency,amount:this.formData.amount,decorate:false})},{label:resolve("bankingapp_brd_function_deposits_create_result_sourceaccount"),value:h},{label:resolve("bankingapp_brd_function_deposits_create_result_maturity"),value:$().defaultMaturityFormatter(this.formData.maturity)},{label:resolve("bankingapp_brd_function_deposits_create_result_duedate"),value:d.dateFormat(resolve(this.dateFormatPatternResourceKey))},{label:resolve("bankingapp_brd_function_deposits_create_result_currentperiod"),value:a},{label:resolve("bankingapp_brd_function_deposits_create_result_revolving"),value:$().revolvingFormatter(this.formData.depositRolloverType)},{label:resolve("bankingapp_brd_function_deposits_create_result_capofinterest"),value:$().capofinterestFormatter(this.formData.depositRolloverType)}]};this.registerDetailsTypes();this.container.append(Bankingapp.ui.DynamicDetailsFactory.getDetailsComponent("result",c));this.downloadProofOfPaymentButton=new Bankingapp.ui.ComplexButton(resolve("bankingapp_brd_function_transactionhistory_downloadpdf"),{id:"downloadProofOfPaymentButton","class":"downloadProofOfPaymentButton"});this.downloadProofOfPaymentButton.bind("buttonClick",$.proxy(this.downloadPdfClickHandler,this));this.container.append(this.downloadProofOfPaymentButton);var e=new Bankingapp.ui.ComplexButton(resolve("bankingapp_brd_function_deposits_backtohome"));e.bind("buttonClick",$.proxy(this.homeBtnHandler,this));Bankingapp.framework.event.ButtonHandler.setButtonHandler("BACK",$.proxy(this.backBtnHandler,this));this.container.append(e);debugLog("html: "+this.container.html());},registerDetailsTypes:function(){Bankingapp.ui.DynamicDetailsFactory.register("result",Bankingapp.ui.DetailsResultComponent);},clearFunctionScope:function(){var a=getFunctionAttributeNames();debugLog(a);if(a){for(var b=0;b<a.length;b++){removeFunctionAttribute(a[b]);}}else{removeFunctionAttribute("ACCOUNT_DETAILS");removeFunctionAttribute("BOUND_FIELD_MAP");removeFunctionAttribute("DEPOSITCREATE_FORMDATA");removeFunctionAttribute("DEPOSITTYPE_DATA");removeFunctionAttribute("_SELECTED_INTERESTPAYMENT_");removeFunctionAttribute("_SELECTED_ROLLOVERTYPE_");removeFunctionAttribute("DEPOSIT_CREATE_FORECAST_REQUEST");removeFunctionAttribute("DEPOSITCREATE_FORECASTDATA");removeFunctionAttribute("DEPOSIT_CREATE_SIGN_CREDENTIAL");removeFunctionAttribute("DEPOSIT_ACCOUNTS");removeFunctionAttribute("PENSION_FUNDS");}},backBtnHandler:function(a){this.goToDepositListView();},homeBtnHandler:function(){this.clearFunctionScope();this.goToDepositListView();},goToDepositListView:function(){goToPreviousView("view://brd/bankingapp/function/finances/finances");},downloadPdfClickHandler:function(a,b){debugLog("downloadPdfClickHandler ...");if(this.transactionId){Functions.transferfunds.TransferUtils.getDocumentDownloadKey(this.transactionId);}else{debugLog("The authentication reply is not available");showError(resolve("bankingapp_brd_function_payments_download_proofofpayments_failure"));}}});Bankingapp.framework.Application.setView(Bankingapp.functions.deposits.create.Result);