Class.ns("Bankingapp.functions.deposits.terminate");$().loadJavaScript("/js/1hyf9OWY93mTBudZ.js");$().loadJavaScript("/js/IKqUtneuHWrtYhbp.js");$().loadJavaScript("/js/VB9ISfod2qY3FuCr.js");$().loadJavaScript("/js/icz25N39YleqstwB.js");$().loadJavaScript("/js/AZPz8vN1TNFqZWpw.js");Bankingapp.functions.deposits.terminate.Confirm=Class.extend(Bankingapp.framework.View,{container:null,performDataFunctionAttributeId:"DEPOSITTERMINATE_PERFORMREPLY",showProgressIndicator:true,progressIndicatorStepCount:3,progressIndicatorCurrentStep:2,layoutRender:function(){this.container=$("<div>",{id:"depositTerminateConfirmMainContainer","class":"maincontainer"});if(this.showProgressIndicator){this.container.append(new Bankingapp.ui.ProgressIndicator(this.progressIndicatorStepCount,this.progressIndicatorCurrentStep));}this.containerDetails=$("<div>",{id:"depositTerminateConfirmDetailsContainer","class":""});return this.container;},errorMessageHandler:function(b,a){Bankingapp.framework.event.ServiceMessageHandler.errorMessageHandler(b,a);this.signBlock.remove();this.signBlock=new Bankingapp.ui.ManualSignBlock({signMode:Functions.transferfunds.TransferUtils.SIGNMODE});this.signBlock.bind("formSubmitted",$.proxy(this.depositTerminateSignHandler,this));this.container.append(this.signBlock);},onResume:function(){},run:function(){Bankingapp.framework.Application.unBind("onErrorMessageReceived");$("body").bind("onErrorMessageReceived",$.proxy(this.errorMessageHandler,this));Bankingapp.framework.event.BrdServiceMessageHandler.handleMessages();this.deposit=getFunctionAttribute("deposit");this.forecastData=getFunctionAttribute("FORECAST_DATA");if(getFunctionAttribute("SOURCE_ACCOUNT_FOR_DEPOSIT_TERMINATION")){var a=getFunctionAttribute("SOURCE_ACCOUNT_FOR_DEPOSIT_TERMINATION");this.deposit.depositSourceAccountName=a.accountName;this.deposit.depositSourceAccount=a.accountNumber;this.deposit.depositSourceAccountCurrency=a.currency;}else{this.deposit.depositSourceAccountCurrency=this.deposit.currency;}this.depositDetail=new Bankingapp.ui.DetailsDepositComponent({detailsData:this.deposit,displayDateFormat:resolve("bankingapp_common_dateFormatPattern"),displayTimeFormat:resolve("bankingapp_common_timeFormatPattern")});this.containerDetails.append(this.depositDetail);this.container.append(this.containerDetails);this.informationLabel=new Bankingapp.ui.Label(resolve("bankingapp_brd_function_deposits_terminate_confirm_info"),{id:"depositTerminationInfo","class":"depositTerminationInfo pagetitle separator"});this.container.append(this.informationLabel);this.addSignBlock();},errorMessageHandler:function(b,a){this.signBlock.remove();this.addSignBlock();Bankingapp.framework.event.ServiceMessageHandler.errorMessageHandler(b,a);},addSignBlock:function(){this.signBlock=new Bankingapp.ui.BrdSignBlock({signMode:Functions.transferfunds.TransferUtils.SIGNMODE});this.signBlock.bind("formSubmitted",$.proxy(this.depositTerminateSignHandler,this));this.container.append(this.signBlock);},depositTerminateSignHandler:function(a,b){if(this.signBlock.getCredential()==""||this.signBlock.getCredential()==undefined||this.signBlock.getCredential()==null){this.signBlock.remove();this.addSignBlock();}else{Bankingapp.framework.Application.callService("/depositterminate/perform",{PerformTransactionOperationRequest:{credential:this.signBlock.getCredential(),book:true,sign:true,fingerPrint:this.signBlock.getIsFingerprint()}},$.proxy(this.handleSignResult,this));}},handleSignResult:function(a){setFunctionAttribute("PERFORM_RESULT",a);loadView("view://brd/bankingapp/function/deposits/terminate/Result",null);}});Bankingapp.framework.Application.setView(Bankingapp.functions.deposits.terminate.Confirm);