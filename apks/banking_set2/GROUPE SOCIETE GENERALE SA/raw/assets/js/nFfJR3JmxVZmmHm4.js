$().loadJavaScript("/js/KAcDLELn6aH5JstN.js");Class.ns("Bankingapp.functions.login");Bankingapp.functions.login.TokenLogin=Class.extend(Bankingapp.functions.login.AbstractLogin,{container:null,form:null,inputFieldContainer:null,tokenField:null,loginButton:null,requestTokenButton:null,layoutRender:function(){Bankingapp.framework.Application.bind("onErrorMessageReceived",$.proxy(this.initView,this));this.container=$("<div>",{id:"loginMainContainer","class":"login maincontainer"});this.form=new Bankingapp.ui.Form({id:"loginform"});this.container.append(this.form);this.initView();return this.container;},initView:function(){if(this.inputFieldContainer!=null){this.inputFieldContainer.remove();}if(this.loginButton!=null){this.loginButton.remove();}this.requestTokenButton=new Bankingapp.ui.SubmitButton(resolve("bankingapp_function_login_login"));this.form.append(this.requestTokenButton);this.form.unbind("formSubmit");this.form.bind("formSubmit",$.proxy(this.requestTokenButtonClickHandler,this));this.form.enable();},requestTokenButtonClickHandler:function(){this.form.unbind("formSubmit");this.requestTokenButton.disable();Bankingapp.framework.Application.bind("onTokenReceived",$.proxy(this.onTokenReceived,this));requestToken(null);},onTokenReceived:function(b,a){this.requestTokenButton.remove();this.inputFieldContainer=$("<div>",{id:"inputFieldContainer","class":"groupContainer"});this.form.append(this.inputFieldContainer);this.tokenField=new Bankingapp.ui.InputField(resolve("bankingapp_function_login_password"),{id:"password",name:"password",type:"password",value:a,validation:{required:true,whitelist:false}},{"for":null},{"class":""});this.inputFieldContainer.append(this.tokenField);this.loginButton=new Bankingapp.ui.SubmitButton(resolve("bankingapp_function_login_login"));this.form.append(this.loginButton);this.form.bind("formSubmit",$.proxy(this.loginButtonClickHandler,this));},loginButtonClickHandler:function(){this.form.disable();var b=getApplicationOption("TOKEN_SERIAL");var a=b.split(":",1);callService({serviceName:"/security/pegasus_security_check",request:{TokenCredentialValidatorUserInput:{"@xsi:type":"pegasus.component.inas.security.bean.TokenCredentialValidatorUserInput",groupId:a[0],credentials:this.tokenField.val()}},callback:Bankingapp.framework.Application.proxy(this.handleLoginResult,this,true)});this.tokenField.setValue("");}});Bankingapp.framework.Application.setView(Bankingapp.functions.login.TokenLogin);