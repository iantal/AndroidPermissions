$().loadJavaScript("/js/9Ek8EHPwp4t1yMds.js");Class.ns("Bankingapp.functions.transferfunds.qrpayment");Bankingapp.functions.transferfunds.qrpayment.AbstractAccountSelection=Class.extend(Bankingapp.framework.View,{container:null,containerId:"accountSelectionContainer",containerClass:"accountSelection",accountListTitleResource:null,showProgressIndicator:true,progressIndicatorStepCount:5,progressIndicatorCurrentStep:0,showPageInstructions:true,pageInstructionsResourceKey:null,accountList:null,formDataField:null,formDataFunctionAttributeId:null,formData:null,listData:[],accountItemIdField:"accountNumberUuid",emptyListResourceKey:"bankingapp_function_transferfunds_no_enabled_account",nextView:null,layoutRender:function(){this.container=$("<div>",{id:this.containerId,"class":"maincontainer"});this.container.addClass(this.containerClass);if(this.showProgressIndicator){this.container.append(new Bankingapp.ui.ProgressIndicator(this.progressIndicatorStepCount,this.progressIndicatorCurrentStep));}if(this.showPageInstructions){this.container.append(new Bankingapp.ui.Label(resolve(this.pageInstructionsResourceKey),{"class":"pagetitle separator"}));}this.container.append(new Bankingapp.ui.Label(resolve("demo_bankingapp_function_accountinfo_title_account"),{baseClass:"listtitle"}));return this.container;},run:function(){Bankingapp.framework.Application.unBind("onErrorMessageReceived");$("body").bind("onErrorMessageReceived",$.proxy(this.errorMessageHandler,this));this.getAccounts();},getAccounts:function(){},handleGetAccountsResponse:function(a){this.setAccounts(a);},setAccounts:function(a){this.listData=a;this.renderAccountList();},itemClickHandler:function(b,a){var c=this.accountList.getItem(a[this.accountItemIdField]);if(c){$.each(this.accountList.itemsMap,function(e,f){f.removeClass("state_selected");});c.removeClass("state_default");c.addClass("state_selected");}var d={};d[this.formDataField]=a;$.extend(this.formData,d);setFunctionAttribute(this.formDataFunctionAttributeId,this.formData);this.accountClickHandler(b,a);},accountClickHandler:function(b,a){loadView(this.nextView,null);},renderAccountList:function(){this.formData=getFunctionAttribute(this.formDataFunctionAttributeId);if((this.formData==undefined)||(this.formData==null)){this.formData={};}if(this.accountList){this.accountList.remove();}this.accountList=new Bankingapp.ui.List({baseClass:"list",idProperty:this.accountItemIdField,listData:this.listData,itemRenderer:Functions.transferfunds.AccountListItem,noresultKey:this.emptyListResourceKey,itemConfig:{nameField:"accountName",typeField:"accountType",currencyField:"currency",balanceField:"availableBalance",baseClass:"accountListItem"}});var a=this.formData[this.formDataField]?this.formData[this.formDataField]:null;if(a){this.accountList.getItem(a[this.accountItemIdField]).addClass("state_selected");}if(!(this.accountListTitleResource===null)){if(this.accountListLabel){this.accountListLabel.remove();}this.accountListLabel=new Bankingapp.ui.Label(resolve(this.accountListTitleResource),{"class":"listtitle"});this.container.append(this.accountListLabel);}this.container.append(this.accountList);this.accountList.bind("itemClick",$.proxy(this.itemClickHandler,this));bindFieldToView(this.formDataField);},clear:function(){removeFunctionAttribute(this.formDataField);},errorMessageHandler:function(b,a){Bankingapp.framework.event.ServiceMessageHandler.errorMessageHandler(b,a);this.renderAccountList();}});