Class.ns("Bankingapp.functions.accountinfo");Bankingapp.functions.accountinfo.StatementFilter=Class.extend(Bankingapp.framework.View,{container:null,statementFilter:{},accountStatementFilterAttributeName:"STATEMENT_FILTER",displayDateFormat:resolve("bankingapp_common_dateFormatPattern"),filterDateFormat:resolve("bankingapp_common_parsedatepattern_withouttime"),layoutRender:function(){this.container=$("<div>",{id:"transactionHistoryFilterContainer","class":"list maincontainer"});this.statementFilter=getSessionAttribute("STATEMENT_FILTER");debugLog(this.statementFilter);this.statementFilterTitle=new Bankingapp.ui.Label(resolve("bankingapp_brd_function_statement_filter_title"),{"class":"pagetitle separator"});this.statementFilterDateContainer=$("<div>",{"class":"groupcontainer"});var a=$().dateParserWithoutTimezone(this.statementFilter.FromDate).dateFormat(this.displayDateFormat);var b=$().dateParserWithoutTimezone(this.statementFilter.EndDate).dateFormat(this.displayDateFormat);this.statementFilterFromDateButton=new Bankingapp.ui.ComplexButton([a],{id:"FromDate","class":"calendar"});this.statementFilterEndDateButton=new Bankingapp.ui.ComplexButton([b],{id:"EndDate","class":"calendar"});this.statementFilterFromDateButton.bind("buttonClick",$.proxy(this.statementFilterAfterButtonClickHandler,this));this.statementFilterEndDateButton.bind("buttonClick",$.proxy(this.statementFilterBeforeButtonClickHandler,this));this.statementFilterDateContainer.append(new Bankingapp.ui.LabeledComponent({labelText:resolve("bankingapp_brd_function_statement_filter_fromdate"),valueComponent:this.statementFilterFromDateButton}));this.statementFilterDateContainer.append(new Bankingapp.ui.LabeledComponent({labelText:resolve("bankingapp_brd_function_statement_filter_enddate"),valueComponent:this.statementFilterEndDateButton}));this.statementFilterDebitCredit=$("<div>",{"class":"groupcontainer"});this.debitCheckboxElement=new Bankingapp.ui.Checkbox({id:"OnlyCurrentUser",value:this.statementFilter.Debit});this.debitCheckbox=new Bankingapp.ui.LabeledComponent({labelConfig:{value:resolve("bankingapp_brd_function_statement_filter_debit")},valueComponent:this.debitCheckboxElement});this.statementFilterDebitCredit.append(this.debitCheckbox);this.creditCheckboxElement=new Bankingapp.ui.Checkbox({id:"OnlyCurrentUser",value:this.statementFilter.Credit});this.creditCheckbox=new Bankingapp.ui.LabeledComponent({labelConfig:{value:resolve("bankingapp_brd_function_statement_filter_credit")},valueComponent:this.creditCheckboxElement});this.statementFilterDebitCredit.append(this.creditCheckbox);this.statementFilterSetFilterButton=new Bankingapp.ui.SubmitButton(resolve("bankingapp_brd_function_statement_filter_setfilterbutton"),{id:"setFilterButton","class":"setFilterButton"});this.statementFilterSetDefaultFilterButton=new Bankingapp.ui.SubmitButton(resolve("bankingapp_brd_function_statement_filter_setdefaultfilterbutton"),{id:"setDefaultFilterButton","class":"setDefaultFilterButton"});this.statementFilterSetFilterButton.bind("buttonClick",$.proxy(this.setFilterHandler,this));this.statementFilterSetDefaultFilterButton.bind("buttonClick",$.proxy(this.setDefaultFilterHandler,this));this.form=new Bankingapp.ui.Form({id:"statementFilterForm",submitHandler:$.proxy(this.setFilterHandler,this),"class":this.formClass});this.form.append(this.statementFilterDateContainer);this.form.append(this.statementFilterDebitCredit);this.container.append(this.statementFilterTitle);this.container.append(this.form);this.container.append(this.statementFilterSetFilterButton);this.container.append(this.statementFilterSetDefaultFilterButton);return this.container;},run:function(){},setFilterHandler:function(b,c){this.statementFilter.Credit=this.creditCheckboxElement.val();this.statementFilter.Debit=this.debitCheckboxElement.val();setSessionAttribute("statementFilterMode","new");setFunctionAttribute("details_tab","from_filter");var a={AccountNumber:getSessionAttribute(this.accountStatementFilterAttributeName).AccountNumber,FromDate:this.statementFilter.FromDate?this.statementFilter.FromDate:getSessionAttribute(this.accountStatementFilterAttributeName).FromDate,EndDate:this.statementFilter.EndDate?this.statementFilter.EndDate:getSessionAttribute(this.accountStatementFilterAttributeName).EndDate,Credit:getSessionAttribute(this.accountStatementFilterAttributeName).Credit,Debit:getSessionAttribute(this.accountStatementFilterAttributeName).Debit};Bankingapp.framework.Application.callService("/statement/validateStatementFilter",{StatementListRequest:a},$.proxy(this.handleValidateResult,this));},handleValidateResult:function(a){setSessionAttribute("STATEMENT_FILTER",this.statementFilter);loadView(getFunctionAttribute("details_view"),null);},setDefaultFilterHandler:function(c,f){var a=new Date();var b=new Date();b.setDate(a.getDate()-30);this.statementFilter.FromDate=b;this.statementFilter.EndDate=a;setSessionAttribute("STATEMENT_FILTER",this.statementFilter);setSessionAttribute("statementFilterMode","default");setFunctionAttribute("details_tab","from_filter");loadView(getFunctionAttribute("details_view"),null);},statementFilterAfterButtonClickHandler:function(b,a){showDatePicker(Bankingapp.framework.Application.proxy(this.afterDatePickerHandler,this,true));},statementFilterBeforeButtonClickHandler:function(b,a){showDatePicker(Bankingapp.framework.Application.proxy(this.beforeDatePickerHandler,this,true));},afterDatePickerHandler:function(a){this.statementFilter.FromDate=a.dateFormat(this.filterDateFormat);$("#FromDate").find(".row0").text(a.dateFormat(this.displayDateFormat));},beforeDatePickerHandler:function(a){this.statementFilter.EndDate=a.dateFormat(this.filterDateFormat);$("#EndDate").find(".row0").text(a.dateFormat(this.displayDateFormat));},displayAfterDate:function(a){}});Bankingapp.framework.Application.setView(Bankingapp.functions.accountinfo.StatementFilter);