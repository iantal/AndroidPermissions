Class.ns("Bankingapp.ui");Bankingapp.ui.ExpandableList=Class.extend(Bankingapp.ui.List,{containerClass:"expandable",expandedClass:"expanded",subItemClass:"subItem",mainItemClass:"mainItem",secondLevelListName:null,secondLevelItemRenderer:null,toggleListItem:function(a){if(a.hasClass(this.expandedClass)){this.collapseListItem(a);}else{this.expandListItem(a);}},expandListItem:function(a){a.addClass(this.expandedClass);var e=a.itemData[this.secondLevelListName]||[];var c=null;var d=$();for(var b=0;b<e.length;b++){if(this.secondLevelItemRenderer==null){c=new this.itemRenderer(e[b],this.getItemConfig(e[b]));}else{c=new this.secondLevelItemRenderer(e[b],this.getItemConfig(e[b]));}c.addClass(this.expandedClass).addClass(this.subItemClass).hide();this.registerItem(c,e[b]);d.push(c[0]);}a.after(d);d.slideDown(300);if(a.hasClass(this.lastClass)&&c){c.addClass(this.lastClass);a.removeClass(this.lastClass);}},collapseListItem:function(a){var e=this.expandedClass;var b=this.lastClass;var d=a.next(".subItem");while(d.length>0){var c=d;d=d.next(".subItem");c.slideUp(300,function(){if(c.hasClass(b)){a.addClass(b);}$(this).remove();a.removeClass(e);});}},constructor:function(b,a){Bankingapp.ui.ExpandableList.superclass.constructor.apply(this,arguments);this.addClass(this.containerClass);},initComponent:function(){this.appendItems();},appendItems:function(d){var a=null;if(d&&$.isArray(d)){this.listData=this.listData.concat(d);a=d;if((a.length>0)&&(this.itemsArray.length>0)){this.getItemAt(this.itemsArray.length-1).removeClass(this.lastClass);}}else{a=this.listData;this.empty();}for(var b=0;b<a.length;b++){var c=new this.itemRenderer(a[b],this.getItemConfig(a[b]));if(this.itemClass){c.addClass(this.itemClass);}if(this.itemsArray.length==0){c.addClass(this.firstClass);}if(b==(a.length-1)){c.addClass(this.lastClass);}if(this.tableColumns==null){this.append(c);}else{if(this.tr==null||this.tr.children().length>=this.tableColumns){this.tr=$("<tr>");this.append(this.tr);}this.tr.append(c);}this.registerItem(c,a[b]);}this.renderNoResult();},renderNoResult:function(a){if(this.showNoresult==true){if(this.isEmpty()){this.noresultLabel=new Bankingapp.ui.Label(resolve(this.noresultKey),{"class":this.noresultClass});if(a){a.append(this.noresultLabel);}else{this.append(this.noresultLabel);}this.addClass(this.noresultClass);}else{if(this.noresultLabel!=null){this.noresultLabel.remove();}this.removeClass(this.noresultClass);}}},setItems:function(b,a){if(b&&$.isArray(b)){if(a&&(a===false)){this.appendItems(b);}else{this.listData=b;this.appendItems();}}},getItem:function(a){if(this.itemsMap){return this.itemsMap[a];}return null;},getItemAt:function(a){if(this.itemsArray.length>a){return this.itemsArray[a];}return null;},getSize:function(a){return this.itemsArray.length;},handleClick:function(a,b){if(a.itemData.isMain){this.toggleListItem(a);}else{this.trigger("itemClick",b.data);}},registerItem:function(a,b){if(b.isMain){a.addClass(this.mainItemClass);}this.itemsArray.push(a);if(this.idProperty&&b[this.idProperty]){this.itemsMap[b[this.idProperty]]=a;}a.click(b,$.proxy(this.handleClick,this,a));},getItemConfig:function(a){a.isMain=a[this.secondLevelListName]!==undefined;var b=Bankingapp.ui.ExpandableList.superclass.getItemConfig.apply(this,arguments);return b;}});