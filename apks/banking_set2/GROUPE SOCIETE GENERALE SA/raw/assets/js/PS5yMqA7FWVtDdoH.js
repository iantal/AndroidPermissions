$().loadJavaScript("/js/1hyf9OWY93mTBudZ.js");$().loadJavaScript("/js/SZANNrGlkovJNvLL.js");Class.ns("Bankingapp.functions.receivemoney.qrpayment");Bankingapp.functions.receivemoney.qrpayment.GenerateQRCode=Class.extend(Bankingapp.framework.View,{pcsTransactionType:"pain.001.001.03",pcsCountryCode:null,qrCodeImageType:"jpg",qrCodeDimension:null,pageOrientation:null,layoutRender:function(){this.container=$("<div>",{id:"landingPageCt","class":"qrCodeContainer"});Bankingapp.framework.Application.bind("onOrientationChanged",$.proxy(this.onOrientationChanged,this));var a=getApplicationOption("ORIENTATION");onOrientationChanged(a);return this.container;},renderQrCode:function(){var e=getDeviceInformation();debugLog("xxx device information");debugLog(JSON.stringify(e));var h=e.screenWidth;var d=e.screenHeight;var c=e.dpi;var g={};g["240PORTRAIT"]="2.0";g["240LANDSCAPE"]="1.6";g["320PORTRAIT"]="2.0";g["320LANDSCAPE"]="1.6";g["480PORTRAIT"]="2.0";g["480LANDSCAPE"]="1.6";g["600PORTRAIT"]="2.0";g["600LANDSCAPE"]="1.6";g["720PORTRAIT"]="2.25";g["720PORTRAIT320"]="1.7";g["720LANDSCAPE320"]="1.4";g["720LANDSCAPE"]="1.8";g["768PORTRAIT"]="2.5";g["768LANDSCAPE"]="3.9";g["1024PORTRAIT"]="2.25";g["1024LANDSCAPE"]="1.8";g["1080PORTRAIT"]="2.25";g["1080LANDSCAPE"]="1.8";g["1600PORTRAIT"]="3.0";g["1600LANDSCAPE"]="3.7";var b=(h<d)?h:d;var a=g[b+this.pageOrientation+c];if(a===null||a===undefined){a=g[b+this.pageOrientation];}if(a===null||a===undefined){a=g["240"+this.pageOrientation];}var f=parseFloat(c)*parseFloat(a);this.qrCodeDimension=f;var i={};i[Functions.transferfunds.QRNodeNamesISO20022.BENEFICIARY_NAME]=getSessionAttribute("CURRENT_CUSTOMER").name;i[Functions.transferfunds.QRNodeNamesISO20022.BENEFICIARY_ACCOUNT]=getFunctionAttribute("QRPAYMENT_TARGET_ACCOUNT").accountNumberIban;if(getFunctionAttribute("QRPAYMENT_TARGET_ACCOUNT").currency!=Functions.transferfunds.TransferUtils.DEFAULT_CURRENCY){i[Functions.transferfunds.QRNodeNamesISO20022.BENEFICIARY_ACCOUNT_CURRENCY]=getFunctionAttribute("QRPAYMENT_TARGET_ACCOUNT").currency;}i[Functions.transferfunds.QRNodeNamesISO20022.BENEFICIARY_ADDRESS]=getSessionAttribute("CURRENT_CUSTOMER").customerAddress;generatePaymentUrl({transactionType:this.pcsTransactionType,countryCode:this.pcsCountryCode,transactionData:i,callback:Bankingapp.framework.Application.proxy(this.handleGeneratePaymentUrlResponse,this,true)});},handleGeneratePaymentUrlResponse:function(a){generateQrCode({content:encodeURI(a),dimension:this.qrCodeDimension,type:this.qrCodeImageType,callback:Bankingapp.framework.Application.proxy(this.handleGenerateQrCodeResponse,this,true)});},handleGenerateQrCodeResponse:function(b){var c=new Bankingapp.ui.ImageView({imageData:b,imageMime:"image/"+this.qrCodeImageType,imageWidthInPx:this.qrCodeDimension,imageHeightInPx:this.qrCodeDimension},{"class":"qrCodeImage"});$("#qrCodeImageDiv").remove();$("#readyAndCloseButton").remove();var a=$("<div>",{id:"qrCodeImageDiv"});a.append(c);this.container.append(a);this.readyAndCloseButton=new Bankingapp.ui.SubmitButton(resolve("bankingapp_brd_function_qrpayment_receive_readyandclose"),{id:"readyAndCloseButton","class":"buttonClass"});this.readyAndCloseButton.bind("buttonClick",$.proxy(this.onButtonPressed,this));this.container.append(this.readyAndCloseButton);hideLoadingPopup();},onOrientationChanged:function(a,b){showLoadingPopup();this.pageOrientation=b;this.renderQrCode();},onButtonPressed:function(a,b){goToPreviousView("view://brd/bankingapp/function/payments/payments");}});Bankingapp.framework.Application.setView(Bankingapp.functions.receivemoney.qrpayment.GenerateQRCode);